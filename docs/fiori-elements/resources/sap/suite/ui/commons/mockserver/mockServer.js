sap.ui.define(["sap/ui/base/ManagedObject","jquery.sap.global","sap/ui/thirdparty/sinon"],function(e,t,a){"use strict";return e.extend("sap.ovp.Mockserver.mockServer",{started:null,init:function(){this.started=t.get("test-resources/sap/suite/ui/commons/demokit/sample/CloudFilePicker/mockserver/FileShareItems.json").then(function(e,a,n){this.mockData=e;return t.get("test-resources/sap/suite/ui/commons/demokit/sample/CloudFilePicker/mockserver/metadata.xml")}.bind(this)).then(function(e,t,n){this.metadata=n.responseText;var r=a.fakeServer.create();r.autoRespond=true;r.xhr.useFilters=true;r.xhr.addFilter(function(e,t){return!t.match(/\/sap\/opu\/odata4\//)});var i=this.metadata;var o=this.mockData;s(r);function s(e){e.respondWith("GET",RegExp("/sap","i"),function(e,t){if(e.url.indexOf("metadata")>-1){return e.respond(200,{"Content-Type":"application/xml","OData-Version":"4.0"},i)}});e.respondWith("POST",RegExp("/sap","i"),function(e,a){var n=new RegExp("\\$batch([?#].*)?");var r={};r["@odata.context"]=o["@odata.context"];r["@odata.metadataEtag"]=o["@odata.metadataEtag"];if(e.requestBody.includes("FileShareItems(FileShare='ZPERSONAL',FileShareItem='0ACGgV1bbQGeXUk9PVA')/_Children")){r["value"]=o["fileShareItemsChildrenValue"];t(e,n,r)}else{r["value"]=o["value"];if(e.requestBody.includes("GET FileShares")||e.requestBody.includes("GET FileShares('ZPERSONAL')/_Root")){t(e,n,r)}}});function t(e,t,a){if(t.test(e.url)){var n=e.requestBody;var r=new RegExp("--batch_[a-z0-9-]*");var i=r.exec(n)[0];if(i){var o=n.split(i);var s=new RegExp("GET (.*) HTTP");var c="--165E5739E3F501AD01EF9E72DC8ED0870";o.forEach(function(t,n){if(s.exec(t)){var r;var i=a;if(e.url.indexOf("$count")!==-1){r=u(i,"text/plain")}else{r=u(i)}c=c+"\r\n"+"Content-Type: application/http"+"\r\n"+"Content-Length:"+r.length+"\r\n"+"content-transfer-encoding: binary"+"\r\n\r\n"+r+"--165E5739E3F501AD01EF9E72DC8ED0870"}});c+="--";return e.respond(200,{"Content-Type":"multipart/mixed; boundary=165E5739E3F501AD01EF9E72DC8ED0870","OData-Version":"4.0"},c)}}}}function u(e,t){var a;a=JSON.stringify(e)||"";t=t||"application/json;ieee754compatible=true;odata.metadata=minimal";return"HTTP/1.1 "+"200 OK"+"\r\nContent-Type:"+t+"\r\nContent-Length: "+a.length+"\r\nodata-version: 4.0"+"\r\ncache-control: no-cache, no-store, must-revalidate\r\n\r\n"+a+"\r\n"}}.bind(this))}})},true);