/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/suite/ui/commons/library","./LayoutAlgorithm","./Geometry","./D3ForceWrapper","./LayoutTask","sap/ui/performance/Measurement"],function(e,t,a,r,o,i){"use strict";var n=e.networkgraph.LayoutRenderType,u=12;var s=t.extend("sap.suite.ui.commons.networkgraph.layout.ForceBasedLayout",{metadata:{properties:{alpha:{type:"float",group:"Behavior",defaultValue:.3},charge:{type:"float",group:"Behavior",defaultValue:-30},friction:{type:"float",group:"Behavior",defaultValue:.9},maximumDuration:{type:"int",group:"Behavior",defaultValue:1e3}}}});s.prototype.getLayoutRenderType=function(){return n.Forces};s.prototype.isLayered=function(){return false};s.prototype.layout=function(){return new o(function(e,t,o){var n={nodes:[],links:[]},s=this.getParent();if(!s){t("The algorithm must be associated with a graph.");return}i.start("NetworkGraph - ForceBasedLayout","Layouting of a graph "+s.getId());s.getNodes().forEach(function(e,t){n.nodes.push({id:e.getKey()});e.iIndex=t});s.getNodes().forEach(function(e){e.aChildren.forEach(function(t){n.links.push({source:e.iIndex,target:t.iIndex,value:1})})});r.layout({graph:n,alpha:this.getAlpha(),friction:this.getFriction(),charge:this.getCharge(),maximumDuration:this.getMaximumDuration()}).then(function(t){if(o.isTerminated()){e();return}var r=t.graph||t;var i=a.getBoundingBox(r.nodes),n=i.p1.x*-u+100,h=i.p1.y*-u+100;r.nodes.forEach(function(e){var t=s.getNodeByKey(e.id);t.setX(e.x*u+n);t.setY(e.y*u+h)});this._normalizeLines();this._alignCoordinatesWithView();e()}.bind(this),t)}.bind(this))};return s});