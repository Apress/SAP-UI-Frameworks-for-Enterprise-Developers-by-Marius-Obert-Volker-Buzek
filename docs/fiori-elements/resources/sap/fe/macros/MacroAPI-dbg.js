/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/merge","sap/base/util/uid","sap/fe/core/converters/ConverterContext","sap/fe/core/helpers/ClassSupport","sap/ui/core/Component","sap/ui/core/Control"],function(e,t,n,r,i,o){"use strict";var a,s,c,l,u,p,f,d,g,h,m,b;var v=r.property;var C=r.implementInterface;var y=r.defineUI5Class;var P=r.aggregation;function _(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function w(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function M(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;x(e,t)}function x(e,t){x=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return x(e,t)}function O(e,t,n,r,i){var o={};Object.keys(r).forEach(function(e){o[e]=r[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},o);if(i&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(i):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,t,o);o=null}return o}function z(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}const D="sap.fe.macros.MacroAPI";let j=(a=y(D),s=C("sap.ui.core.IFormContent"),c=v({type:"string"}),l=v({type:"string"}),u=P({type:"sap.ui.core.Control",multiple:false,isDefault:true}),a(p=(f=(b=function(e){M(t,e);function t(n){var r;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++){o[a-1]=arguments[a]}r=e.call(this,n,...o)||this;_(r,"__implements__sap_ui_core_IFormContent",d,w(r));_(r,"contextPath",g,w(r));_(r,"metaPath",h,w(r));_(r,"content",m,w(r));r.parentContextToBind={};t.registerInstance(w(r));return r}var n=t.prototype;n.init=function t(){e.prototype.init.call(this);if(!this.getModel("_pageModel")){var n;const e=(n=i.getOwnerComponentFor(this))===null||n===void 0?void 0:n.getModel("_pageModel");if(e){this.setModel(e,"_pageModel")}}};t.registerInstance=function e(t){if(!this.instanceMap.get(t.constructor)){this.instanceMap.set(t.constructor,[])}this.instanceMap.get(t.constructor).push(t)};t.render=function e(t,n){t.renderControl(n.content)};n.rerender=function e(){this.content.rerender()};n.getDomRef=function t(){const n=this.content;return n?n.getDomRef():e.prototype.getDomRef.call(this)};n.getController=function e(){return this.getModel("$view").getObject().getController()};t.getAPI=function e(t){let n=t.getSource();if(this.isDependentBound){while(n&&!n.isA(D)&&n.getParent){const e=n.getDependents();const t=e.find(e=>e.isA(D));if(t){n=t}else{n=n.getParent()}}}else{while(n&&!n.isA(D)&&n.getParent){n=n.getParent()}}if(!n||!n.isA(D)){const e=this.instanceMap.get(this);n=e===null||e===void 0?void 0:e[e.length-1]}return n&&n.isA(D)&&n};n.setParentBindingContext=function e(t,n){this.parentContextToBind[t]=n};n.setParent=function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++){r[i]=arguments[i]}e.prototype.setParent.call(this,...r);Object.keys(this.parentContextToBind).forEach(e=>{this.getParent().bindObject({path:this.parentContextToBind[e],model:e,events:{change:function(){const e=this.getBoundContext();if(e&&!e.getObject()){e.setProperty("",{})}}}})})};return t}(o),b.namespace="sap.fe.macros",b.macroName="Macro",b.fragment="sap.fe.macros.Macro",b.hasValidation=true,b.instanceMap=new WeakMap,b.isDependentBound=false,b.getConverterContext=function(t,r,i){const o=i.appComponent;const a=i.models.viewData&&i.models.viewData.getData();return n.createConverterContextForMacro(t.startingEntitySet.name,i.models.metaModel,o&&o.getDiagnostics(),e,t.contextLocation,a)},b.createBindingContext=function(e,n){const r=`/uid--${t()}`;n.models.converterContext.setProperty(r,e);return n.models.converterContext.createBindingContext(r)},b),d=O(f.prototype,"__implements__sap_ui_core_IFormContent",[s],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),g=O(f.prototype,"contextPath",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),h=O(f.prototype,"metaPath",[l],{configurable:true,enumerable:true,writable:true,initializer:null}),m=O(f.prototype,"content",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),f))||p);return j},false);