/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/SemanticDateOperators","sap/ui/base/ManagedObjectObserver","sap/ui/core/Control","sap/ui/mdc/condition/Condition","sap/ui/mdc/enum/ConditionValidated","sap/ui/mdc/field/ConditionsType","sap/ui/model/json/JSONModel"],function(e,t,i,n,o,r,l,a){"use strict";var s,u,c,d,p,f,h,g,b,v,y,_,C,m,w,O;var F={};var M=e.property;var A=e.implementInterface;var I=e.event;var L=e.defineUI5Class;var S=e.aggregation;function E(e,t,i,n){if(!i)return;Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function j(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function z(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;V(e,t)}function V(e,t){V=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,i){t.__proto__=i;return t};return V(e,t)}function P(e,t,i,n,o){var r={};Object.keys(n).forEach(function(e){r[e]=n[e]});r.enumerable=!!r.enumerable;r.configurable=!!r.configurable;if("value"in r||r.initializer){r.writable=true}r=i.slice().reverse().reduce(function(i,n){return n(e,t,i)||i},r);if(o&&r.initializer!==void 0){r.value=r.initializer?r.initializer.call(o):void 0;r.initializer=undefined}if(r.initializer===void 0){Object.defineProperty(e,t,r);r=null}return r}function D(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let T=(s=L("sap.fe.macros.controls.CustomFilterFieldContentWrapper"),u=A("sap.ui.core.IFormContent"),c=M({type:"sap.ui.core.CSSSize",defaultValue:null}),d=M({type:"boolean",defaultValue:false}),p=M({type:"object[]",defaultValue:[]}),f=S({type:"sap.ui.core.Control",multiple:false,isDefault:true}),h=I(),s(g=(b=(O=function(e){z(n,e);function n(){var t;for(var i=arguments.length,n=new Array(i),o=0;o<i;o++){n[o]=arguments[o]}t=e.call(this,...n)||this;E(t,"__implements__sap_ui_core_IFormContent",v,j(t));E(t,"width",y,j(t));E(t,"formDoNotAdjustWidth",_,j(t));E(t,"conditions",C,j(t));E(t,"content",m,j(t));E(t,"conditionsChange",w,j(t));return t}F=n;n.render=function e(t,i){t.openStart("div",i);t.style("min-height","1rem");t.style("width",i.width);t.openEnd();t.renderControl(i.getContent());t.close("div")};n._filterValuesToConditions=function e(i,n){let a={operators:[]},s=[];if(n){a={operators:[n]}}if(i===""){i=[]}else if(typeof i==="object"&&i.hasOwnProperty("operator")&&i.hasOwnProperty("values")){a={operators:[i.operator]};i=i.values}else if(i!==undefined&&typeof i!=="object"&&typeof i!=="string"){throw new Error(`FilterUtils.js#_filterValuesToConditions: Unexpected type of input parameter vValues: ${typeof i}`)}const u=new l(a);const c=Array.isArray(i)?i:[i];if(typeof n==="string"&&(c.length===0||t.getSemanticDateOperations().includes(n))){s=[o.createCondition(n,c,null,null,r.NotValidated)]}else{s=c.map(e=>{const t=e===null||e===void 0?void 0:e.toString(),i=u.parseValue(t,"any");return i===null||i===void 0?void 0:i[0]}).filter(e=>e!==undefined)}return s};n._conditionsToFilterModelString=function e(t,i){const n=new l(i);return t.map(e=>n.formatValue([e],"any")||"").filter(e=>e!=="").join(",")};var s=n.prototype;s._handleFilterModelChange=function e(t){var i;const n=(i=this.getObjectBinding("filterValues"))===null||i===void 0?void 0:i.getPath(),o=t.getSource().getProperty(n);this.updateConditionsByFilterValues(o,"")};s._handleConditionsChange=function e(t){this.updateFilterModelByConditions(t)};s.init=function t(){e.prototype.init.call(this);this._conditionsObserver=new i(this._observeChanges.bind(this));this._conditionsObserver.observe(this,{properties:["conditions"]});this._filterModel=new a;this._filterModel.attachPropertyChange(this._handleFilterModelChange,this);this.setModel(this._filterModel,n.FILTER_MODEL_ALIAS)};s.clone=function t(i,o){const t=e.prototype.clone.call(this,i,o);t.setModel(t._filterModel,n.FILTER_MODEL_ALIAS);return t};s._observeChanges=function e(t){if(t.name==="conditions"){this._handleConditionsChange(t.current)}};s.getContent=function e(){return this.getAggregation("content")};s.getConditions=function e(){return this.getProperty("conditions")};s.setConditions=function e(t){this.setProperty("conditions",t||[]);return this};s.getFilterModelAlias=function e(){return n.FILTER_MODEL_ALIAS};s.updateConditionsByFilterValues=function e(t,i){const o=n._filterValuesToConditions(t,i);this.setConditions(o)};s.updateFilterModelByConditions=function e(t){var i;const o=((i=t[0])===null||i===void 0?void 0:i.operator)||"";const r=o!==""?{operators:[o]}:{operators:[]};if(this.getBindingContext(n.FILTER_MODEL_ALIAS)){var l;const e=n._conditionsToFilterModelString(t,r);this._filterModel.setProperty((l=this.getBindingContext(n.FILTER_MODEL_ALIAS))===null||l===void 0?void 0:l.getPath(),e)}};s.getAccessibilityInfo=function e(){var t;const i=this.getContent();return(i===null||i===void 0?void 0:(t=i.getAccessibilityInfo)===null||t===void 0?void 0:t.call(i))||{}};s.getIdForLabel=function e(){const t=this.getContent();return t===null||t===void 0?void 0:t.getIdForLabel()};return n}(n),O.FILTER_MODEL_ALIAS="filterValues",O),v=P(b.prototype,"__implements__sap_ui_core_IFormContent",[u],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),y=P(b.prototype,"width",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),_=P(b.prototype,"formDoNotAdjustWidth",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),C=P(b.prototype,"conditions",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),m=P(b.prototype,"content",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),w=P(b.prototype,"conditionsChange",[h],{configurable:true,enumerable:true,writable:true,initializer:null}),b))||g);F=T;return F},false);