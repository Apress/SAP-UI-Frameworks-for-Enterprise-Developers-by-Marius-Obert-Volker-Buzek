/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log"],function(e){"use strict";const n=30,t={},u={getId:function(){return"BusyLocker.ReferenceDummy"},setBusy:function(n){e.info(`setBusy(${n}) triggered on dummy reference`)}};function o(e,n){return e.getId()+(n||"/busy")}function r(e,n){return o(e,n)in t}function c(n,r){if(!n||!n.getId){e.warning("No reference for BusyLocker, using dummy reference");n=u}r=r||"/busy";const c=o(n,r);if(!(c in t)){t[c]={id:c,path:r,reference:n,count:0}}return t[c]}function i(e){delete t[e.id]}function s(t){const u=t.reference.isA&&t.reference.isA("sap.ui.model.Model"),o=t.count!==0;if(u){t.reference.setProperty(t.path,o,undefined,true)}else if(t.reference.setBusy){t.reference.setBusy(o)}clearTimeout(t.timeout);if(o){t.timeout=setTimeout(function(){e.error(`busy lock for ${t.id} with value ${t.count} timed out after ${n} seconds!`)},n*1e3)}else{i(t)}return o}function f(n,t){if(t===0){n.count=0;e.info(`busy lock count '${n.id}' was reset to 0`)}else{n.count+=t;e.info(`busy lock count '${n.id}' is ${n.count}`)}}const d={lock:function(e,n){return this._updateLock(e,n,1)},unlock:function(e,n){return this._updateLock(e,n,-1)},isLocked:function(e,n){return r(e,n)},_updateLock:function(e,n,t){const u=c(e,n);f(u,t);return s(u)}};return d},false);