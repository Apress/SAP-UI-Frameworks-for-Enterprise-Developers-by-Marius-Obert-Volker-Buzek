/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./ItemBaseFlex","./Util"],function(e,t){"use strict";var n=Object.assign({},e);n.findItem=function(e,t,n){return t.find(function(t){return e.getId(t)===n})};n.determineAggregation=function(e,t){return e.getAggregation(t,"actions").then(function(e){return{name:"actions",items:e}})};n._applyMove=function(e,n,i,r){var a=r===t.REVERT?true:false;var g=i.modifier;if(g.getParent(n)){var o=g.getParent(n);if(g.getControlType(o)==="sap.ui.mdc.Chart"){n=o}else if(g.getParent(o)&&g.getControlType(g.getParent(o))==="sap.ui.mdc.Table"){n=g.getParent(o)}}this.beforeApply(e.getChangeType(),n,a);if(this._bSupressFlickering){this._delayInvalidate(n)}var s=a?e.getRevertData():e.getContent();var u;var f;var h;var c;var m=this.determineAggregation(g,n).then(function(e){f=e;return this._getExistingAggregationItem(s,i,n)}.bind(this)).then(function(e){u=e}).then(function(){if(!u){throw new Error("No corresponding item in "+f.name+" found. Change to move item cannot be "+this._getOperationText(a)+"at this moment")}c=g.getId(u);return g.findIndexInParentAggregation(u)}.bind(this)).then(function(e){h=e;return g.removeAggregation(n,f.name,u).then(function(){return g.insertAggregation(n,f.name,u,s.index)})}).then(function(){if(a){e.resetRevertData()}else{e.setRevertData({name:s.name,index:h,item:c})}this.afterApply(e.getChangeType(),n,a)}.bind(this));return m};return{moveAction:n.createMoveChangeHandler()}});