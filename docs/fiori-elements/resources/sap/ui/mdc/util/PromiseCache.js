/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object"],function(e){"use strict";var t=function(e){if(!e){throw new Error("PromiseCache: Please provide an identifier!")}if(this._oCache&&this._oCache[e]){this.remove.call(this,e)}};var i=function(e){if(typeof e==="object"&&this._oCache){for(var t in this._oCache){if(this._oCache[t].promise===e){return t}}}};var r=function(e,t){var r=typeof e==="string"?e:i.call(this,e);var n=r&&this._oCache&&this._oCache[r];if(t&&!n){throw new Error("PromiseCache: Promise not found!")}return n};var n=e.extend("sap.ui.mdc.util.PromiseCache",{constructor:function(){this._oCache={}},add:function(e,i){t.call(this,e);var r={};this._oCache[e]=r;r.promise=new Promise(function(e,t){r.resolve=function(t){if(!r._isCanceled){r._isSettled=true;e(t)}};r.reject=function(e){if(!r._isCanceled){r._isSettled=true;t(e)}}});r.promise.isSettled=function(){return!!r._isSettled};r.promise.isPending=function(){return!r._isSettled&&!r._isCanceled};r.promise.isCanceled=function(){return!!r._isCanceled};r.promise.getInternalPromise=function(){return r._promise};if(i){var n=typeof i==="function";var o=!n&&typeof i.then==="function";if(!n&&!o){throw new Error("PromiseCache: fnCreate must be a promise or function")}var s=n?i():i;var c=s&&typeof s.then==="function";if(c){r._promise=s;r._promise.then(function(e){if(!r._isCanceled){r._isSettled=true;r.resolve(e)}return e},function(e){if(!r._isCanceled){r._isSettled=true;r.reject(e)}})}else{r.resolve(s)}}return this._oCache[e].promise},cancel:function(e){var t=r.call(this,e,true);if(!t._isSettled){t._isCanceled=true}return t.promise},retrieve:function(e,t){var i=this._oCache&&this._oCache[e];if(!i&&t){return this.add.apply(this,[e,t])}return i&&i.promise},retrieveMany:function(){var e=[];var t=arguments.length?[].slice.call(arguments):Object.keys(this._oCache);for(var i=0;i<t.length;i++){e.push(this.retrieve(t[i].toString()))}return e},remove:function(e){var t=typeof e==="string"?e:i.call(this,e);var r=t&&this._oCache&&this._oCache[t];if(r){r._isCanceled=true;delete this._oCache[t]}},resolve:function(e,t){var i=r.call(this,e,true);i.resolve(t);return i.promise},reject:function(e,t){var i=r.call(this,e,true);i.reject(t);return i.promise},clear:function(){Object.keys(this._oCache).forEach(function(e){this.remove(e)}.bind(this))},destroy:function(){this.clear();this._oCache=null}});return n});