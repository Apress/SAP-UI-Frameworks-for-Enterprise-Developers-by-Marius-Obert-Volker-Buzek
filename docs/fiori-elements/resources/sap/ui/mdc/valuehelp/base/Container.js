/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/mdc/mixin/PromiseMixin","sap/ui/model/BindingMode","sap/ui/base/ManagedObjectObserver"],function(t,e,n,o){"use strict";var i=t.extend("sap.ui.mdc.valuehelp.base.Container",{metadata:{library:"sap.ui.mdc",properties:{title:{type:"string",group:"Appearance",defaultValue:""},localFilterValue:{type:"string"}},aggregations:{_container:{type:"sap.ui.core.Element",multiple:false,visibility:"hidden"},content:{type:"sap.ui.mdc.valuehelp.base.Content",multiple:true}},events:{select:{parameters:{type:{type:"sap.ui.mdc.enum.SelectType"},conditions:{type:"object[]"}}},confirm:{parameters:{close:{type:"boolean"}}},opened:{},closed:{},cancel:{},requestDelegateContent:{parameters:{contentId:{type:"string"}}},requestSwitchToDialog:{},navigated:{parameters:{leaveFocus:{type:"boolean"},condition:{type:"object"},itemId:{type:"string"}}}}}});i.prototype.init=function(){this._oObserver=new o(this._observeChanges.bind(this));this._oObserver.observe(this,{aggregations:["content"]})};i.prototype._observeChanges=function(t){if(t.name==="content"){var e=t.child;if(t.mutation==="remove"){this._unbindContent(e)}}};i.prototype._bindContent=function(t){if(t&&!t._bContentBound){t.bindProperty("filterValue",{path:"/filterValue",model:"$valueHelp",mode:n.OneWay});var e={path:"/conditions",model:"$valueHelp",mode:n.OneWay};if(t._formatConditions){e.formatter=t._formatConditions.bind(t)}t.bindProperty("config",{path:"/_config",model:"$valueHelp",mode:n.OneWay});t.bindProperty("conditions",e);t.attachConfirm(this._handleConfirmed,this);t.attachCancel(this._handleCanceled,this);t.attachSelect(this._handleSelect,this);if(t.attachNavigated){t.attachNavigated(this._handleNavigated,this)}if(t.attachRequestSwitchToDialog){t.attachRequestSwitchToDialog(this._handleRequestSwitchToDialog,this)}t._bContentBound=true}};i.prototype._unbindContent=function(t){if(t._bContentBound){t.unbindProperty("filterValue",true);t.unbindProperty("config",true);t.unbindProperty("conditions",true);t.detachConfirm(this._handleConfirmed,this);t.detachCancel(this._handleCanceled,this);t.detachSelect(this._handleSelect,this);if(t.detachNavigated){t.detachNavigated(this._handleNavigated,this)}if(t.detachRequestSwitchToDialog){t.detachRequestSwitchToDialog(this._handleRequestSwitchToDialog,this)}t._bContentBound=false}};i.prototype._handleNavigated=function(t){this.fireNavigated(t.mParameters)};i.prototype._handleRequestSwitchToDialog=function(t){this.fireRequestSwitchToDialog({container:this})};i.prototype._getContainer=function(){};i.prototype.getControl=function(){var t=this.getParent();return t&&t.getControl()};i.prototype.getMaxConditions=function(){var t=this.getModel("$valueHelp");return t&&t.getObject("/_config/maxConditions")};i.prototype._isSingleSelect=function(){return this.getMaxConditions()===1};i.prototype.getDomRef=function(){var t=this.getAggregation("_container");return t&&t.getDomRef()};i.prototype.getUIArea=function(){return null};i.prototype._getUIAreaForContent=function(){return this.getUIArea()};i.prototype.open=function(t,e){if(!this.isOpening()){var n=this._addPromise("open");return Promise.all([this._getContainer(),t]).then(function(t){return this._placeContent(t[0])}.bind(this)).then(function(t){if(!n.isCanceled()){this._open(t,e)}return n}.bind(this))}return this._retrievePromise("open")};i.prototype.close=function(){var t=this._retrievePromise("open");if(t){if(t.isSettled()){this._close()}else{this._cancelPromise(t)}}};i.prototype._placeContent=function(t){return t};i.prototype._open=function(t,e){var n=this.getContent();for(var o=0;o<n.length;o++){this._bindContent(n[o])}};i.prototype._close=function(){};i.prototype._handleOpened=function(){this._resolvePromise("open");this.fireOpened()};i.prototype._handleClosed=function(t){this._removePromise("open");var e=this.getContent();for(var n=0;n<e.length;n++){this._unbindContent(e[n])}this.fireClosed()};i.prototype._handleConfirmed=function(t){this.fireConfirm()};i.prototype._handleCanceled=function(t){this.fireCancel()};i.prototype._handleSelect=function(t){this.fireSelect({type:t.getParameter("type"),conditions:t.getParameter("conditions")})};i.prototype.isOpen=function(){var t=this._retrievePromise("open");return t&&t.isSettled()};i.prototype.isOpening=function(){var t=this._retrievePromise("open");return t&&!t.isCanceled()&&!t.isSettled()};i.prototype.getItemForValue=function(t){return undefined};i.prototype.isValidationSupported=function(){return false};i.prototype.navigate=function(t){return Promise.all([this._getContainer()]).then(function(t){return this._placeContent(t[0])}.bind(this)).then(function(e){this._navigate(t)}.bind(this))};i.prototype._navigate=function(t){};i.prototype.removeFocus=function(){};i.prototype.isTypeahead=function(){var t=this.getParent();return t&&t.getTypeahead()===this};i.prototype.isTypeaheadSupported=function(){return false};i.prototype.isDialog=function(){var t=this.getParent();return t&&(t.getDialog()===this||this.isTypeahead()&&!t.getDialog()&&this.getUseAsValueHelp())};i.prototype.hasDialog=function(){var t=this.getParent();return!!(t&&t.getDialog())};i.prototype.providesScrolling=function(){return false};i.prototype.getValueHelpDelegate=function(){var t=this.getParent();return t&&t.getControlDelegate()};i.prototype.getValueHelpDelegatePayload=function(){var t=this.getParent();return t&&t.getPayload()};i.prototype.awaitValueHelpDelegate=function(){var t=this.getParent();return t&&t.awaitControlDelegate()};i.prototype.isValueHelpDelegateInitialized=function(){var t=this.getParent();return t&&t.bDelegateInitialized};i.prototype.getUseAsValueHelp=function(){return false};i.prototype.getValueHelpIcon=function(){};i.prototype.getAriaAttributes=function(t){return{contentId:null,ariaHasPopup:"listbox",role:"combobox",roleDescription:null}};i.prototype.getScrollDelegate=function(t){var e=this.getAggregation("_container");return e&&e.getScrollDelegate&&e.getScrollDelegate()};i.prototype.shouldOpenOnFocus=function(){return false};i.prototype.shouldOpenOnClick=function(){return false};i.prototype.shouldOpenOnNavigate=function(){return false};i.prototype.isNavigationEnabled=function(t){return false};i.prototype.isFocusInHelp=function(){return!this.isTypeahead()};i.prototype.isMultiSelect=function(){return false};i.prototype._getContainerConfig=function(t){var e=t&&t.getContainerConfig();var n=e&&e[this.getMetadata().getName()];if(!n&&e){var o=Object.keys(e);var i=o.find(function(t){return this.isA(t)}.bind(this));if(i){n=e[i]}}return n};i.prototype._getRetrieveDelegateContentPromise=function(){var t=this.getParent();return t&&t._retrievePromise("delegateContent")};i.prototype.getSelectedContent=function(){var t=this.getContent();return t&&t[0]};i.prototype.onConnectionChange=function(){var t=this.getContent();for(var e=0;e<t.length;e++){this._unbindContent(t[e]);t[e].onConnectionChange()}};i.prototype.exit=function(){this._oObserver.disconnect();this._oObserver=undefined};e.call(i.prototype);return i});