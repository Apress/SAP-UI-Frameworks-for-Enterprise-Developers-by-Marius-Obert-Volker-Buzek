/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/p13n/SelectionPanel","sap/ui/model/Sorter"],function(t,e){"use strict";var o=t.extend("sap.ui.mdc.p13n.panels.ActionToolbarPanel",{metadata:{library:"sap.ui.mdc"},renderer:{apiVersion:2}});o.prototype._bindListItems=function(t){var o=this.getAggregation("_template");if(o){var i=function(t){return t.getProperty("alignment")};var s=new e({path:"alignment",descending:false,group:i});this._oListControl.bindItems(Object.assign({path:this.P13N_MODEL+">/items",sorter:s,key:"name",templateShareable:false,template:this.getAggregation("_template").clone()},t))}};o.prototype._removeFactoryControl=function(){this._oListControl.getItems().filter(function(t){return!t._bGroupHeader}).forEach(function(t){var e=t.getCells()[0];if(e.getItems().length>1){e.removeItem(e.getItems()[1])}});this.removeStyleClass("sapUiMDCAFLabelMarkingList");return this._aInitializedFields};o.prototype._moveTableItem=function(t,e){var o=this._oListControl.getItems();var i=this._getP13nModel().getProperty("/items");var s=i.indexOf(this._getModelEntry(t));e=e<=0?0:Math.min(e,o.length-1);var r=i.indexOf(o[e].getBindingContext(this.P13N_MODEL).getObject());if(r==s){return}i.splice(r,0,i.splice(s,1)[0]);this._getP13nModel().setProperty("/items",i);this._oSelectedItem=this._oListControl.getItems()[e];this._updateEnableOfMoveButtons(this._oSelectedItem,true);this._handleActivated(this._oSelectedItem);this.fireChange({reason:"Move",item:this._getModelEntry(this._oSelectedItem)})};o.prototype._onPressButtonMoveToTop=function(){var t=this._oListControl.getItems().indexOf(this._oHoveredItem);while(!this._oListControl.getItems()[t-1]._bGroupHeader){t--}this._moveSelectedItem(t)};o.prototype._onPressButtonMoveToBottom=function(){var t=this._oListControl.getItems().indexOf(this._oHoveredItem);while(t<this._oListControl.getItems().length-1&&!this._oListControl.getItems()[t+1]._bGroupHeader){t++}this._moveSelectedItem(t)};o.prototype._onItemPressed=function(t){var e=t.getParameter("srcControl");if(!this._isControlPartOfMoveButtons(e)){var o=t.getParameter("listItem");this._oSelectedItem=o;var i=o.getBindingContext(this.P13N_MODEL);if(this.getEnableReorder()&&i&&i.getProperty(this.PRESENCE_ATTRIBUTE)){this._handleActivated(o);this._updateEnableOfMoveButtons(o,true)}}};o.prototype._isControlPartOfMoveButtons=function(t){var e=this._oSelectedItem?this._oSelectedItem.getCells()[1].getItems():[];var o=false;if(e.length>2){for(var i=2;i<e.length;i++){if(e[i]==t||e[i]==t.getParent()){o=true}}}return o};o.prototype._updateEnableOfMoveButtons=function(t,e){var o=this._oListControl.getItems().indexOf(t);var i=this._oListControl.getItems().length-1;var s=true,r=true;if(o==0){s=false}if(o==i){r=false}var n=this._oListControl.getItems().some(function(t){return t._bGroupHeader});if(n){if(o>0&&this._oListControl.getItems()[o-1]._bGroupHeader){s=false}if(o<i&&this._oListControl.getItems()[o+1]._bGroupHeader){r=false}}this._getMoveTopButton().setEnabled(s);this._getMoveUpButton().setEnabled(s);this._getMoveDownButton().setEnabled(r);this._getMoveBottomButton().setEnabled(r);if(e){t.focus()}};return o});