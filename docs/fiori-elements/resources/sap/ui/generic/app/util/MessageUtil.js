/*
 * ! SAPUI5

(c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/ValueState","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/core/syncStyleClass","sap/ui/core/Fragment"],function(e,t,r,s,a,n,o){"use strict";var i={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var u={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var g;function l(e){var t=[],r;var s=sap.ui.getCore().getMessageManager();var a=s.getMessageModel().getData();var n=[];for(var o=0;o<a.length;o++){r=a[o];var i=r.technicalDetails&&r.technicalDetails.statusCode==="404"&&r.type==="Error";if(r.persistent){if(i){n.push(r)}else{t.push(r)}}}return e?t.concat(n):t}function c(e,t){var r;r=function(r,s){var a;var i={onMessageDialogClose:function(){s.onMessageDialogClose();a.destroy()},onActionButtonPressed:function(){s.onActionButtonPressed();a.destroy()}};return o.load({name:r,controller:i}).then(function(r){if(t){n(t,e,r)}e.addDependent(e);return r})};return r}function p(t,r,n){var o=l();var i=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");if(o.length===0){return Promise.resolve()}f();var u=e.None;for(var g=0;g<o.length&&u!==e.Error;g++){var p=o[g];switch(p.type){case sap.ui.core.MessageType.Error:u=e.Error;break;case sap.ui.core.MessageType.Warning:u=e.Warning;break;case sap.ui.core.MessageType.Success:if(u===sap.ui.core.ValueState.None){u=e.Success}break;default:break}}if(o.length===1&&(u===e.Success||u===e.None)){a.show(o[0].message);return Promise.resolve()}var d=typeof t==="function"?t:c(t.owner,t.contentDensityClass);var v,y,m;var T=function(){v.close();m.setProperty("/backButtonVisible",false);m.setProperty("/messages",[]);m.setProperty("/messageToGroupName",Object.create(null));y.navigateBack();m.getProperty("/resolve")()};var E={onMessageDialogClose:function(){T(m)},onActionButtonPressed:function(){m.getProperty("/actionButtonCallback")();T(m)},onBackButtonPress:function(){m.setProperty("/backButtonVisible",false);y.navigateBack()},onMessageSelect:function(){m.setProperty("/backButtonVisible",true)}};return d("sap.ui.generic.app.fragments.MessageDialog",E).then(function(e){v=e;y=v.getContent()[0];var t=v.getModel();var a=t&&t.getMetaModel();var g=false;var l=!!(n&&n.action);var c=Object.create(null);if(a){o.forEach(function(e){var r=e.getTarget();if(!r){return}if(r.lastIndexOf("/")>0){r=r.substring(0,r.lastIndexOf("/"))}var s=r.substring(1,r.indexOf("("));var n=s&&a.getODataEntitySet(s);var o=n&&a.getODataEntityType(n.entityType);var i=o&&o["com.sap.vocabularies.UI.v1.HeaderInfo"];var u=i&&i.Title&&i.Title.Value&&i.Title.Value.Path;var l=t.getProperty(r);var p=l&&l[u];if(p){c[e.getId()]=p;g=true}})}m=v.getModel("settings");if(!m){m=new s({genericGroupName:i.getText("GENERAL_TITLE"),backButtonVisible:false,cancelButtonText:i.getText("DIALOG_CANCEL"),closeButtonText:i.getText("DIALOG_CLOSE")});v.setModel(m,"settings")}m.setProperty("/showActionButton",l);if(l){m.setProperty("/actionButtonText",n.actionLabel);m.setProperty("/actionButtonCallback",n.action)}m.setProperty("/title",r||i.getText("DIALOG_TITLE"));m.setProperty("/messages",o);m.setProperty("/grouping",g);m.setProperty("/state",u);m.setProperty("/resolve",function(){return Promise.resolve()});m.setProperty("/messageToGroupName",c);v.open();return null})}function f(){var e=sap.ui.getCore().getMessageManager();var t=l(true);if(t.length>0){e.removeMessages(t)}}function d(e,t,r){var s=new sap.ui.core.message.Message({message:e,description:t,type:sap.ui.core.MessageType.Error,processor:r,target:"",persistent:true});sap.ui.getCore().getMessageManager().addMessages(s)}function v(e){var t;g=e&&e.url;if(g){g="/"+g.substring(0,g.indexOf(")")+1)}var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var s;if(e instanceof Error){if(e.message){r=e.message}}else if(e.response){if(e.response.message){r=e.response.message}var a=e.response.statusCode;s=!Number.isInteger(a)?Number(a):a;if(e.response.headers){for(var n in e.response.headers){if(n.toLowerCase()==="content-type"){var o=e.response.headers[n];if(o.toLowerCase().indexOf("application/json")===0){if(e.response.responseText){var i=JSON.parse(e.response.responseText);if(i&&i.error&&i.error.message&&i.error.message.value){r=i.error.message.value}}}else if(e.message){r=e.message}break}}}}var u=l();t={httpStatusCode:s,messageText:r,description:null,containsTransientMessage:u.length===0?false:true};return t}return{operations:u,httpStatusCodes:i,handleTransientMessages:p,removeTransientMessages:f,addTransientErrorMessage:d,parseErrorResponse:v,getTransientMessages:l}},true);