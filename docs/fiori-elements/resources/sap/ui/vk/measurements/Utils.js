/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/base/Log","../getResourceBundle"],function(t,n){"use strict";var r=1e-6;var e=1e-6;var o=1e-6;var i=1e-8;var a=1e-5;var u=new Float64Array(9);var s=2*Math.PI;var c={};c.compareNormal=function(t,n,e){if(c.computePointToPointDistance2(t,n)<r){return true}if(e){var o=c.pointPlusPoint(t,n);if(c.magnitude2(o)<r){return true}}return false};c.computeEdgeDirection=function(t,n,r){var e=c.normalize(c.pointMinusPoint(n,t));if(r){r[0]=e[0];r[1]=e[1];r[2]=e[2];return null}return e};c.scalePoint=function(t,n){return[n*t[0],n*t[1],n*t[2]]};c.normalize=function(t){var n=c.magnitude2(t);n=n<r?1:1/Math.sqrt(n);return c.scalePoint(t,n)};c.magnitude2=function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]};c.dotProduct=function(t,n){return t[0]*n[0]+t[1]*n[1]+t[2]*n[2]};c.crossProduct=function(t,n){return[t[1]*n[2]-t[2]*n[1],t[2]*n[0]-t[0]*n[2],t[0]*n[1]-t[1]*n[0]]};c.equalPoints=function(t,n,r,e){return t[n]===r[e]&&t[n+1]===r[e+1]&&t[n+2]===r[e+2]};c.angleBetweenVectors2D=function(n,r,e,o){var a=n*e+r*o;var u=Math.sqrt((n*n+r*r)*(e*e+o*o));if(u<i){t.error("Degenerate angle: ax="+n+" ay="+r+" bx="+e+" by="+o);return 0}var s=a/u;if(s<-1){s=-1}else if(s>1){s=1}var c=Math.acos(s);return n*o<r*e?-c:c};c.isDegenerateTriangle=function(t,n,r){var e=c.pointMinusPoint(n,t);var i=c.pointMinusPoint(r,t);var a=c.dotProduct(e,e);var u=c.dotProduct(e,i);var s=c.dotProduct(i,i);var v=2*(a*s-u*u);return Math.abs(v)<=o};c.computeTriangleBoundingSphere=function(n,r,e,i,a){var u=c.pointMinusPoint(r,n);var s=c.pointMinusPoint(e,n);var v=c.dotProduct(u,u);var f=c.dotProduct(u,s);var l=c.dotProduct(s,s);var P=2*(v*l-f*f);var d=[n[0],n[1],n[2]];var g;if(Math.abs(P)<=o){t.error("Degenerate triangle detected! All 3 points on the same line: ("+n+") ("+r+") ("+e+")");g=[d[0],d[1],d[2]]}else{var p=(v*l-l*f)/P;var m=(l*v-v*f)/P;if(p<=0){g=[.5*(n[0]+e[0]),.5*(n[1]+e[1]),.5*(n[2]+e[2])]}else if(m<=0){g=[.5*(n[0]+r[0]),.5*(n[1]+r[1]),.5*(n[2]+r[2])]}else if(p+m>=1){g=[.5*(r[0]+e[0]),.5*(r[1]+e[1]),.5*(r[2]+e[2])];d=[r[0],r[1],r[2]]}else{g=[n[0]+p*u[0]+m*s[0],n[1]+p*u[1]+m*s[1],n[2]+p*u[2]+m*s[2]]}}i[a]=g[0];i[a+1]=g[1];i[a+2]=g[2];i[a+3]=c.computePointToPointDistance(g,d)};c.getNearestPointOnTriangle=function(t,n){var r=c.normalize(c.crossProduct(c.pointMinusPoint(t,t,3),c.pointMinusPoint(t,t,6)));var e=c.pointMinusPoint(n,t);var o=c.dotProduct(e,r);var i=c.scalePoint(r,-o);var a=c.pointPlusPoint(n,i);for(var u=0;u<3;++u){var s=u*3;var v=[t[s],t[s+1],t[s+2]];s=(u+1)%3*3;var f=[t[s],t[s+1],t[s+2]];s=(u+2)%3*3;var l=[t[s],t[s+1],t[s+2]];var P=c.normalize(c.pointMinusPoint(f,v));var d=c.normalize(c.pointMinusPoint(l,v));var g=c.normalize(c.pointMinusPoint(l,f));var p=c.scalePoint(c.pointPlusPoint(P,d),-1);var m=c.pointMinusPoint(P,g);var h=c.dotProduct(c.crossProduct(p,c.pointMinusPoint(a,v)),r);var T=c.dotProduct(c.crossProduct(m,c.pointMinusPoint(a,f)),r);if(h>=0&&T<=0){var M=c.pointMinusPoint(v,a);var D=c.pointMinusPoint(f,a);if(c.dotProduct(c.crossProduct(M,D),r)<0){return c.projectPointToEdge(v,f,a)}}}return a};c.pointOnLine=function(t,n){return[t[0]+(t[3]-t[0])*n,t[1]+(t[4]-t[1])*n,t[2]+(t[5]-t[2])*n]};c.projectPointToLine=function(t,n){var e=[t[0],t[1],t[2]];var o=[t[3],t[4],t[5]];var i=c.pointMinusPoint(o,e);var a=c.magnitude2(i);if(a<r){return 0}return c.dotProduct(i,c.pointMinusPoint(n,e))/a};c.projectPointToEdge=function(t,n,e){var o=c.pointMinusPoint(n,t);var i=c.magnitude2(o);if(i<r){return t}var a=c.dotProduct(o,c.pointMinusPoint(e,t))/i;if(a<=0){return t}if(a>=1){return n}return[t[0]+o[0]*a,t[1]+o[1]*a,t[2]+o[2]*a]};c.computeEdgeToPointDistance2=function(t,n,r){return c.computePointToPointDistance2(c.projectPointToEdge(t,n,r),r)};c.computePointToPointDistance=function(t,n,r){return Math.sqrt(c.computePointToPointDistance2(t,n,r))};c.computePointToPointDistance2D=function(t,n,r){return c.computePointToPointDistance([t[0],t[1],0],[n[0],n[1],0])};c.computePointToPointDistance2=function(t,n,r){var e=c.pointMinusPoint(t,n,r);return c.magnitude2(e)};c.pointMinusPoint=function(t,n,r){var e=r|0;return[t[e+0]-n[0],t[e+1]-n[1],t[e+2]-n[2]]};c.pointPlusPoint=function(t,n,r){var e=r|0;return[t[e+0]+n[0],t[e+1]+n[1],t[e+2]+n[2]]};c.bezierQuadric2D=function(t,n,r,e){var o=t*t;var i=1-t;var a=i*i;var u=2*i*t;var s=n[0]*a;var c=n[1]*a;s+=r[0]*u;c+=r[1]*u;s+=e[0]*o;c+=e[1]*o;return[s,c,0]};c.bezierCubic2D=function(t,n,r,e,o){var i=t*t;var a=i*t;var u=1-t;var s=u*u;var c=s*u;var v=3*s*t;var f=3*u*i;var l=n[0]*c;var P=n[1]*c;l+=r[0]*v;P+=r[1]*v;l+=e[0]*f;P+=e[1]*f;l+=o[0]*a;P+=o[1]*a;return[l,P,0]};c.findClosestPointEdgeToPoint=function(t,n){return c.projectPointToEdge([t[0],t[1],t[2]],[t[3],t[4],t[5]],n)};c.findClosestPointFaceToPoint=function(t,n){var r=t.vertices;var e=t.triangles;var o;var i;var a;var s;var v;var f;for(var l=0,P=e.length;l<P;l+=3){for(v=0;v<3;++v){f=e[l+v]*3;u[v*3]=r[f];u[v*3+1]=r[f+1];u[v*3+2]=r[f+2]}a=c.getNearestPointOnTriangle(u,n);s=c.computePointToPointDistance2(a,n);if(!l||s<o){o=s;i=a}}return i};c.computePlaneEquation=function(t,n,r,e){var o=[t[n],t[n+1],t[n+2]];var i=c.pointMinusPoint(t,o,r);var a=c.pointMinusPoint(t,o,e);var u=c.crossProduct(i,a);var s=c.dotProduct(u,u);if(s!==0){u=c.scalePoint(u,1/Math.sqrt(s));return[u[0],u[1],u[2],-c.dotProduct(o,u)]}return[1,0,0,0]};c.intersectPlanes=function(t,n){var e=c.crossProduct(t,n);var o=c.magnitude2(e);if(o<r){return null}var i=c.scalePoint(c.pointPlusPoint(c.scalePoint(c.crossProduct(e,n),t[3]),c.scalePoint(c.crossProduct(t,e),n[3])),1/o);var a=c.pointPlusPoint(i,e);return[i[0],i[1],i[2],a[0],a[1],a[2]]};c.intersectLines=function(t,n){return c.findClosestPointEdgeToEdge(t,n,true,true)};c.findClosestPointLineToLine=function(t,n){return c.findClosestPointEdgeToEdge(t,n,true,false)};c.findClosestPointEdgeToEdge=function(t,n,r,o){var u=c.pointMinusPoint(t,t,3);var s=c.pointMinusPoint(n,n,3);var v=c.pointMinusPoint(t,n,0);var f=c.dotProduct(u,u);var l=c.dotProduct(u,s);var P=c.dotProduct(s,s);var d=c.dotProduct(u,v);var g=c.dotProduct(s,v);var p=f*P-l*l;var m,h=p;var T,M=p;var D=p<a;if(D){m=.5;h=1;T=.5;M=1}else{m=l*g-P*d;T=f*g-l*d;if(!r){if(m<0){m=0;T=g;M=P}else if(m>h){m=h;T=g+l;M=P}}}if(!r){if(T<0){T=0;if(-d<0){m=0}else if(-d>f){m=h}else{m=-d;h=f}}else if(T>M){T=M;if(-d+l<0){m=0}else if(-d+l>f){m=h}else{m=-d+l;h=f}}}f=Math.abs(m)<i;l=Math.abs(T)<i;var b=f?0:m/h;var E=l?0:T/M;P=Math.abs(m-h)<i;d=Math.abs(T-M)<i;if(P){b=1}if(d){E=1}v=c.pointOnLine(t,b);u=c.pointOnLine(n,E);p=c.computePointToPointDistance2(v,u);if(o&&p>e){return null}if(r){return D?null:[b,E]}if(D||f||l||P||d){P=c.findClosestPointEdgeToPoint(t,u);f=c.computePointToPointDistance2(P,u);d=c.findClosestPointEdgeToPoint(n,v);l=c.computePointToPointDistance2(d,v);if(f<l){if(f+i<p){p=f;for(g=0;g<3;++g){v[g]=P[g]}}}else if(l+i<p){p=l;for(g=0;g<3;++g){u[g]=d[g]}}for(f=0;f<6;f+=3){l=[n[f],n[f+1],n[f+2]];P=c.findClosestPointEdgeToPoint(t,l);d=c.computePointToPointDistance2(P,l);if(d+i<p){p=d;for(g=0;g<3;++g){v[g]=P[g];u[g]=l[g]}}}for(f=0;f<6;f+=3){l=[t[f],t[f+1],t[f+2]];P=c.findClosestPointEdgeToPoint(n,l);d=c.computePointToPointDistance2(P,l);if(d+i<p){p=d;for(g=0;g<3;++g){v[g]=l[g];u[g]=P[g]}}}}return[v[0],v[1],v[2],u[0],u[1],u[2]]};c.findClosestPointFaceToEdge=function(n,r){var e=performance.now();var o=n.triangles;var i=n.vertices;var a=n.edges;var s=n.boundingSpheres;var v=Number.MAX_VALUE;var f;var l;var P;var d;var g;var p;var m;var h=[r[3],r[4],r[5]];for(d=0,m=a.length;d<m;d+=2){for(g=0;g<2;++g){p=a[d+g]*3;u[g*3]=i[p];u[g*3+1]=i[p+1];u[g*3+2]=i[p+2]}l=c.findClosestPointEdgeToEdge(u,r);P=c.computePointToPointDistance2(l,l,3);if(P<v){v=P;f=l}}v=Math.sqrt(v);var T=[(r[0]+r[3])/2,(r[1]+r[4])/2,(r[2]+r[5])/2];var M=c.computePointToPointDistance(r,r,3)/2;var D;var b=performance.now()-e;var E;for(d=0,m=o.length;d<m;d+=3){P=c.computePointToPointDistance(s,T,d*4);if(P<M+v+s[d*4+3]){for(g=0;g<3;++g){D=o[d+g]*3;u[g*3]=i[D];u[g*3+1]=i[D+1];u[g*3+2]=i[D+2]}E=r;for(g=0;g<2;++g){l=c.getNearestPointOnTriangle(u,E);P=c.computePointToPointDistance(l,E);if(P<v){v=P;f[0]=l[0];f[1]=l[1];f[2]=l[2];f[3]=E[0];f[4]=E[1];f[5]=E[2]}E=h}}}var C=performance.now()-e;if(C>10){t.info("Face[t"+n.triangles.length+"/e"+n.edges.length+"/v"+n.vertices.length+"] distance to Edge in "+C.toFixed(1)+"ms ("+b.toFixed(0)+" + "+(C-b).toFixed(0)+")")}return f};c.findClosestPointFaceToFace=function(n,r){var e=performance.now();var o=n.vertices;var i=r.vertices;var a=n.edges;var s=r.edges;var v;var f;var l;var P;var d;var g;var p;var m=Number.MAX_VALUE;var h;var T;var M=new Float64Array(6);var D;var b;for(l=0,d=a.length;l<d;l+=2){for(v=0;v<2;++v){f=a[l+v]*3;M[v*3]=o[f];M[v*3+1]=o[f+1];M[v*3+2]=o[f+2]}for(P=0,g=s.length;P<g;P+=2){for(v=0;v<2;++v){f=s[P+v]*3;u[v*3]=i[f];u[v*3+1]=i[f+1];u[v*3+2]=i[f+2]}h=c.findClosestPointEdgeToEdge(M,u);p=c.computePointToPointDistance2(h,h,3);if(p<m){m=p;T=h}}}m=Math.sqrt(m);var E;var C;var q;var F=n.edges;var A=n.vertices;var w=r.triangles;var L=r.vertices;var x=r.boundingSpheres;var I=performance.now()-e;for(var N=0;N<2;++N){for(l=0,d=F.length;l<d;l+=2){for(v=0;v<2;++v){f=F[l+v];f*=3;M[v*3]=A[f];M[v*3+1]=A[f+1];M[v*3+2]=A[f+2]}q=[M[3],M[4],M[5]];D=[(M[0]+M[3])/2,(M[1]+M[4])/2,(M[2]+M[5])/2];b=c.computePointToPointDistance(M,M,3)/2;for(E=0,g=w.length;E<g;E+=3){p=c.computePointToPointDistance(x,D,E*4);if(p<b+m+x[E*4+3]){for(v=0;v<3;++v){f=w[E+v]*3;u[v*3]=L[f];u[v*3+1]=L[f+1];u[v*3+2]=L[f+2]}C=M;for(v=0;v<2;++v){h=c.getNearestPointOnTriangle(u,C);p=c.computePointToPointDistance(h,C);if(p<m){m=p;if(N>0){T[0]=h[0];T[1]=h[1];T[2]=h[2];T[3]=C[0];T[4]=C[1];T[5]=C[2]}else{T[0]=C[0];T[1]=C[1];T[2]=C[2];T[3]=h[0];T[4]=h[1];T[5]=h[2]}}C=q}}}}F=r.edges;A=r.vertices;w=n.triangles;L=n.vertices;x=n.boundingSpheres}var z=performance.now()-e;if(z>20){t.info("Face[t"+n.triangles.length+"/e"+n.edges.length+"/v"+n.vertices.length+"] distance to Face[t"+r.triangles.length+"/e"+r.edges.length+"/v"+r.vertices.length+"] in "+z.toFixed(1)+"ms ("+I.toFixed(0)+" + "+(z-I).toFixed(0)+")")}return T};c.hasSelfIntersections=function(t,n){var r=t?t.length/3:0;if(r>2){var e=n?r-1:r;var o,a,u;var s=[0,0,0,0,0,0];var v=[0,0,0,0,0,0];for(var f=0;f<e;++f){u=f*3;s[0]=t[u];s[1]=t[u+1];s[2]=t[u+2];u=(f+1)%r*3;s[3]=t[u];s[4]=t[u+1];s[5]=t[u+2];for(o=f+2;o<e;++o){u=o*3;v[0]=t[u];v[1]=t[u+1];v[2]=t[u+2];u=(o+1)%r*3;v[3]=t[u];v[4]=t[u+1];v[5]=t[u+2];if(!c.equalPoints(s,0,v,0)&&!c.equalPoints(s,0,v,3)&&!c.equalPoints(s,3,v,0)&&!c.equalPoints(s,3,v,3)){a=c.intersectLines(s,v);if(a&&a[0]>i&&a[0]<1-i&&a[1]>i&&a[1]<1-i){return true}}}}}return false};c.hasSelfIntersectionsLastEdge=function(t){var n=t?t.length/3:0;if(n>2){var r,e;var o=t.slice(t.length-6,t.length);var a=[0,0,0,0,0,0];for(var u=0;u<n;++u){e=u*3;a[0]=t[e];a[1]=t[e+1];a[2]=t[e+2];e=(u+1)%n*3;a[3]=t[e];a[4]=t[e+1];a[5]=t[e+2];if(!c.equalPoints(o,0,a,0)&&!c.equalPoints(o,0,a,3)&&!c.equalPoints(o,3,a,0)&&!c.equalPoints(o,3,a,3)){r=c.intersectLines(o,a);if(r&&r[0]>i&&r[0]<1-i&&r[1]>i&&r[1]<1-i){return true}}}}return false};c.computeTriangleArea=function(t,n,r,e){var o=[t[n],t[n+1],t[n+2]];var i=[t[r],t[r+1],t[r+2]];var a=[t[e],t[e+1],t[e+2]];var u=c.computePointToPointDistance(o,i);var s=c.computePointToPointDistance(i,a);var v=c.computePointToPointDistance(a,o);var f=(u+s+v)/2;return Math.sqrt(f*((f-u)*(f-s)*(f-v)))};c.computeTriangleAverageCoordinate=function(t,n,r,e){return[(t[n]+t[r]+t[e])/3,(t[n+1]+t[r+1]+t[e+1])/3,(t[n+2]+t[r+2]+t[e+2])/3]};c.translateUnits=function(t,r){var e=null;switch(t){case"mm":e="MM";break;case"cm":e="CM";break;case"m":e="M";break;case"in":e="IN";break;case"ft":e="FT";break;default:return""}return n().getText("UNITS_SHORT_"+e+(r?r:""))};c.getUnitFactor=function(t){switch(t){case"mm":return 1;case"cm":return 1/10;case"m":return 1/1e3;case"in":return 1/25.4;case"ft":return 1/(25.4*12);default:return 1}};c.clampAngle2PI=function(t){while(t>=s){t-=s}while(t<0){t+=s}return t};c.clampAngle=function(t,n,r){var e=c.clampAngle2PI(t);var o=c.clampAngle2PI(r<0?n-r+s:n);var i=c.clampAngle2PI(r<0?n:n+r);if(i<o){if(e<o){o-=s}else{i+=s}}return Math.max(Math.min(e,i),o)};c.isClosedContour=function(t){return t&&t.length>9&&c.equalPoints(t,0,t,t.length-3)};c.findClosedContour=function(t,n,r){var e=Math.abs(n[0]);var o=Math.abs(n[r]);var i=Math.abs(n[n.length-1]);var a=i-e+1;var u=Array.apply(null,{length:a*2});var s,c;for(s=0;s<n.length;++s){var v=Math.abs(n[s])-e;if(u[v*2]===undefined){u[v*2]=s}u[v*2+1]=s}var f=(o-e)*2;var l=u[f];var P=u[f+1];var d=t.slice(l*2,P*2+2);var g=n.slice(l,P+1);r-=l;u[f]=null;u[f+1]=null;var p=false;var m=true;var h=true;var T,M;var D,b;while(p||m){h=!h;D=d[h?0:d.length-2];b=d[h?1:d.length-1];m=p;p=false;for(s=0;s<a;++s){f=s*2;l=u[f];P=u[f+1];if(u[f]!=null){if(D===t[l*2]&&b===t[l*2+1]){T=t.slice(l*2+2,P*2+2);M=n.slice(l+1,P+1);p=true}else if(D===t[P*2]&&b===t[P*2+1]){T=[];for(c=P*2-2;c>=l*2;c-=2){T.push(t[c],t[c+1])}M=n.slice(l,P).reverse();p=true}}if(p){u[f]=null;u[f+1]=null;if(h){r+=M.length;g=M.reverse().concat(g);var E=[];for(c=T.length-2;c>=0;c-=2){E.push(T[c],T[c+1])}d=E.concat(d)}else{g=g.concat(M);d=d.concat(T)}break}}}var C=g.length;for(s=r-1;s>=0;--s){if(g[s]>=0){D=d[s*2];b=d[s*2+1];for(c=r;c<C;++c){if(c-s>=3&&g[c]>=0&&D===d[c*2]&&b===d[c*2+1]){return d.slice(s*2,c*2+2)}}}}return null};return c});