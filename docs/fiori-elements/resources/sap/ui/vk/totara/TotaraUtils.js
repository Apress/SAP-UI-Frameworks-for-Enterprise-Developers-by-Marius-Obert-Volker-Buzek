/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Command","../IncludeUsageIdType"],function(e,r){"use strict";var n={};n.createCommand=function(e,r){var n=JSON.stringify(r);return e+("["+n.length+"]")+n};n.createRequestCommand=function(e,r,t){return{command:n.createCommand(e,r),method:e,isInitial:t===true}};n.createRequest=function(e,r,n){return{method:e,parameters:r,isInitial:n===true}};function t(r,t,a){if(!r||!t||!a){throw"ProgressLogger: invalid args"}this.context=t;this.loader=a;var i=new Set;this.logPerformance=function(r,a){if(!r||!a){return}i.add(a);var o={name:r,timestamp:Date.now(),token:a};var u={method:e.addClientLog,url:this.loader.getUrl(),token:t.token,command:n.createCommand(e.addClientLog,o)};this.loader.postMessage(u)};this.getTokens=function(){return i};this.logPerformanceTiming=function(r,a){var o=this;r.sort(function(e,r){return e.timestamp-r.timestamp});if(!r.length){return}i.add(t.token);var u=[];while(r.length){u.push(r.splice(0,10))}u.forEach(function(r){var i={records:[],timestamp:Date.now()};r.forEach(function(e){i.records.push({name:e.name,timestamp:e.timestamp,uuid:e.uuid,duration:e.duration,value:e.value,parent_uuid:a})});var u=n.createCommand(e.performanceTiming,i);o.loader.postPerformanceTiming({method:e.performanceTiming,url:o.loader.getUrl(),token:t.token,command:u})})}}n.mark=function(e){window.performance.mark(e)};n.measure=function(e,r,n){var t=window.performance;if(performance.getEntriesByName(r).length!==0){if(!n){t.measure(e,r)}else{t.measure(e,r,n)}}t.clearMarks(r);if(n){t.clearMarks(n)}t.clearMeasures(e)};n.perfObserve=function(e){if(!window.PerformanceObserver){return}var r=[];var t;var a=performance.timing.navigationStart;var i=new window.PerformanceObserver(function(i){i.getEntries().forEach(function(e){e.uuid=n.generateToken();e.timestamp=a+e.startTime;if(e.name==="sceneMeasure"){t=e.uuid}r.push(e)});if(r.find(function(e){return e.name==="sceneCompleted"})){n.measure("sceneMeasure","modelRequested","sceneCompleted")}if(t){r=r.filter(function(e){return e instanceof PerformanceMeasure});e.progressLogger.logPerformanceTiming(r,t);t=""}});i.observe({entryTypes:["mark","measure"]})};n.createLogger=function(e,r,a){if(!r){return null}r.progressLogger=new t(e,r,a);n.perfObserve(r);return r.progressLogger};n.base64ToUint8Array=function(e){var r=atob(e);var n=r.length;var t=new Uint8Array(n);for(var a=0;a<n;a++){t[a]=r.charCodeAt(a)}return t};n.arrayToColumnMajorMatrixArray16=function(e){if(e.length===16){return[e[0],e[4],e[8],e[12],e[1],e[5],e[9],e[13],e[2],e[6],e[10],e[14],e[3],e[7],e[11],e[15]]}if(e.length===12){return[e[0],e[3],e[6],e[9],e[1],e[4],e[7],e[10],e[2],e[5],e[8],e[11],0,0,0,1]}if(e.length===3){return[1,0,0,e[0],0,1,0,e[1],0,0,1,e[2],0,0,0,1]}return null};n.pushElementIntoMapArray=function(e,r,n){var t=e.get(r);if(!t){t=[];e.set(r,t)}else if(t.length>0&&t[t.length-1]===n){return}t.push(n)};n.generateToken=function(){return a()};function a(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var i=["annotationId","closed","contentType","entityId","highlightStyleId","materialId","meshId","name","opacity","renderOrder","renderStage","transform","visible","selectable"];var o=["annotation","bounds","meshes","box","highlight","nodes"];var u=["annotation","drawing","geometry","hotspot","reference","sectionplane","solid","symbol","unknown"];n.configureSceneViewQuery=function(e){var n=i.slice();var t=o.slice();var a=u.slice();if(e.includeAnimation){t.push("animation")}if(e.includeBackground){a.push("background")}if(e.includeParametric){t.push("parametric");a.push("parametric")}if(e.includeUsageId){t=t.concat(r.to$expandQueryParameter(e.includeUsageId))}if(e.pushPMI){a.push("pmi")}var s={$select:n.join(","),$expand:t.join(","),contentTypes:a.join(","),hidden:e.includeHidden};if(e.metadataFilter!=null){s.metadataFilter=e.metadataFilter}return s};return n});