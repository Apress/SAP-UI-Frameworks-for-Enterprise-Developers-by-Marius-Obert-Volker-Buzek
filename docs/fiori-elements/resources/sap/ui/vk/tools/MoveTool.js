/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Tool","./CoordinateSystem","./GizmoPlacementMode","./MoveToolHandler","./MoveToolGizmo","./Detector","./ToolNodeSet"],function(e,t,o,i,s,r,n){"use strict";var a=e.extend("sap.ui.vk.tools.MoveTool",{metadata:{library:"sap.ui.vk",properties:{coordinateSystem:{type:"sap.ui.vk.tools.CoordinateSystem",defaultValue:t.World},placementMode:{type:"sap.ui.vk.tools.GizmoPlacementMode",defaultValue:o.Default},enableStepping:{type:"boolean",defaultValue:false},enableSnapping:{type:"boolean",defaultValue:false},showEditingUI:{type:"boolean",defaultValue:false},autoResetValues:{type:"boolean",defaultValue:true},allowContextMenu:{type:"boolean",defaultValue:true},nodeSet:{type:"sap.ui.vk.tools.ToolNodeSet",defaultValue:n.Highlight}},events:{moving:{parameters:{x:"float",y:"float",z:"float",nodesProperties:"any[]"}},moved:{parameters:{x:"float",y:"float",z:"float",nodesProperties:"any[]"}},coordinateSystemChanged:{parameters:{coordinateSystem:"sap.ui.vk.tools.CoordinateSystem"}},placementModeChanged:{parameters:{placementMode:"sap.ui.vk.tools.GizmoPlacementMode"}}}},constructor:function(t,o){e.apply(this,arguments);this._viewport=null;this._handler=new i(this);this._gizmo=null;this._detector=new r}});a.prototype.init=function(){if(e.prototype.init){e.prototype.init.call(this)}this.setFootprint(["sap.ui.vk.threejs.Viewport"]);this.setAggregation("gizmo",new s)};a.prototype.setActive=function(t,o,i){e.prototype.setActive.call(this,t,o,i);if(this._viewport){if(t){this._gizmo=this.getGizmo();this._gizmo.setCoordinateSystem(this.getCoordinateSystem());this._gizmo.setPlacementMode(this.getPlacementMode());this._gizmo.show(this._viewport,this);this._addLocoHandler()}else{this._removeLocoHandler();if(this._gizmo){this._gizmo.hide();this._gizmo=null}}}return this};a.prototype.queueCommand=function(e){if(this._addLocoHandler()){if(this.isViewportType("sap.ui.vk.threejs.Viewport")){e()}}return this};a.prototype.setPlacementMode=function(e){var t=this.getPlacementMode();if(t!==e){this.setProperty("placementMode",e,true);this.getGizmo().setPlacementMode(e);if(this._viewport){this._viewport.setShouldRenderFrame()}this.firePlacementModeChanged({placementMode:e})}return this};a.prototype.setCoordinateSystem=function(e){var t=this.getCoordinateSystem();if(t!==e){this.setProperty("coordinateSystem",e,true);this.getGizmo().setCoordinateSystem(e);if(this._viewport){this._viewport.setShouldRenderFrame()}this.fireCoordinateSystemChanged({coordinateSystem:e})}return this};a.prototype.setShowEditingUI=function(e){this.setProperty("showEditingUI",e,true);if(this._viewport){this._viewport.setShouldRenderFrame()}return this};a.prototype.setEnableSnapping=function(e){this.setProperty("enableSnapping",e,true);if(this._viewport){this._viewport.setShouldRenderFrame()}return this};a.prototype.resetValues=function(){this.getGizmo().resetValues();if(this._viewport){this._viewport.setShouldRenderFrame()}return this};a.prototype.setNodeSet=function(e){this.setProperty("nodeSet",e,true);if(this._gizmo){this._gizmo.handleSelectionChanged()}};a.prototype.getDetector=function(){return this._detector};a.prototype.move=function(e,t,o,i){var s;if(i&&i!==this.getCoordinateSystem()){s=this.getCoordinateSystem();this.setCoordinateSystem(i)}if(this._gizmo){this._gizmo.move(e,t,o)}if(s){this.setCoordinateSystem(s)}if(this._gizmo){this._gizmo.endGesture()}if(this._viewport){this._viewport.setShouldRenderFrame()}return this};a.prototype.prepareForCreatingTranslateKey=function(e){if(this._gizmo){this._gizmo._prepareForCreatingKey(e);return this._gizmo._getNodesProperties()}return null};return a});