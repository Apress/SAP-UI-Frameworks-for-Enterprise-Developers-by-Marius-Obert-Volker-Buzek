/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Tool","../thirdparty/three","./RotatableAxis","./CoordinateSystem","./RotateToolHandler","./RotateToolGizmo","./GizmoPlacementMode","./Detector","./ToolNodeSet"],function(t,e,o,i,s,r,a,n,h){"use strict";var p=t.extend("sap.ui.vk.tools.RotateTool",{metadata:{library:"sap.ui.vk",properties:{coordinateSystem:{type:"sap.ui.vk.tools.CoordinateSystem",defaultValue:i.World},axis:{type:"sap.ui.vk.tools.RotatableAxis",defaultValue:o.All},enableStepping:{type:"boolean",defaultValue:false},enableSnapping:{type:"boolean",defaultValue:false},showEditingUI:{type:"boolean",defaultValue:false},autoResetValues:{type:"boolean",defaultValue:true},allowContextMenu:{type:"boolean",defaultValue:true},nodeSet:{type:"sap.ui.vk.tools.ToolNodeSet",defaultValue:h.Highlight},placementMode:{type:"sap.ui.vk.tools.GizmoPlacementMode",defaultValue:a.Default}},events:{rotating:{parameters:{x:"float",y:"float",z:"float",nodesProperties:"any[]"}},rotated:{parameters:{x:"float",y:"float",z:"float",nodesProperties:"any[]"}},axisChanged:{parameters:{axis:"sap.ui.vk.tools.RotatableAxis"}},coordinateSystemChanged:{parameters:{coordinateSystem:"sap.ui.vk.tools.CoordinateSystem"}},placementModeChanged:{parameters:{placementMode:"sap.ui.vk.tools.GizmoPlacementMode"}}}},constructor:function(e,o){t.apply(this,arguments);this._viewport=null;this._handler=new s(this);this._gizmo=null;this._detector=new n}});p.prototype.init=function(){if(t.prototype.init){t.prototype.init.call(this)}this.setFootprint(["sap.ui.vk.threejs.Viewport"]);this.setAggregation("gizmo",new r)};p.prototype.setActive=function(e,o,i){t.prototype.setActive.call(this,e,o,i);if(this._viewport){if(e){this._gizmo=this.getGizmo();this._gizmo.setAxis(this.getAxis());this._gizmo.setCoordinateSystem(this.getCoordinateSystem());this._gizmo.show(this._viewport,this);this._addLocoHandler()}else{this._removeLocoHandler();if(this._gizmo){this._gizmo.hide();this._gizmo=null}}}return this};p.prototype.setPlacementMode=function(t){var e=this.getPlacementMode();if(e!==t){this.setProperty("placementMode",t,true);this.getGizmo().setPlacementMode(t);if(this._viewport){this._viewport.setShouldRenderFrame()}this.firePlacementModeChanged({placementMode:t})}return this};p.prototype.queueCommand=function(t){if(this._addLocoHandler()){if(this.isViewportType("sap.ui.vk.threejs.Viewport")){t()}}return this};p.prototype.setAxis=function(t){var e=this.getAxis();if(e!==t){this.setProperty("axis",t,true);this.getGizmo().setAxis(t);if(this._viewport){this._viewport.setShouldRenderFrame()}this.fireAxisChanged({axis:t})}return this};p.prototype.setCoordinateSystem=function(t){var e=this.getCoordinateSystem();if(e!==t){this.setProperty("coordinateSystem",t,true);this.getGizmo().setCoordinateSystem(t);if(this._viewport){this._viewport.setShouldRenderFrame()}this.fireCoordinateSystemChanged({coordinateSystem:t})}return this};p.prototype.setShowEditingUI=function(t){this.setProperty("showEditingUI",t,true);if(this._viewport){this._viewport.setShouldRenderFrame()}return this};p.prototype.setEnableSnapping=function(t){this.setProperty("enableSnapping",t,true);if(this._viewport){this._viewport.setShouldRenderFrame()}return this};p.prototype.resetValues=function(){this.getGizmo().resetValues();if(this._viewport){this._viewport.setShouldRenderFrame()}return this};p.prototype.getDetector=function(){return this._detector};p.prototype.setNodeSet=function(t){this.setProperty("nodeSet",t,true);if(this._gizmo){this._gizmo.handleSelectionChanged()}};p.prototype.rotate=function(t,e,o,i){var s;if(i&&i!==this.getCoordinateSystem()){s=this.getCoordinateSystem();this.setCoordinateSystem(i)}if(this._gizmo){this._gizmo.rotate(t,e,o)}if(s){this.setCoordinateSystem(s)}if(this._gizmo){this._gizmo.endGesture()}if(this._viewport){this._viewport.setShouldRenderFrame()}return this};p.prototype.prepareForCreatingRotationKey=function(t,e,o){if(this._gizmo){this._gizmo._prepareForCreatingRotationKey(t,e,o);return this._gizmo._getNodesProperties()}return null};p.prototype.rotateRestPosition=function(t,e,o){if(this._gizmo){this._gizmo.rotateRestPosition(t,e,o)}if(this._viewport){this._viewport.setShouldRenderFrame()}return this};p.prototype.rotateFromRestPosition=function(t,e,o){if(this._gizmo){this._gizmo.rotateFromRestPosition(t,e,o)}if(this._viewport){this._viewport.setShouldRenderFrame()}return this};return p});