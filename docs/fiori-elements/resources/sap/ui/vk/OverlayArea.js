/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/unified/Menu","sap/ui/unified/MenuItem","./getResourceBundle"],function(e,t,i,n){"use strict";var a=e.extend("sap.ui.vk.OverlayArea",{metadata:{library:"sap.ui.vk",properties:{key:{type:"string",group:"Misc",defaultValue:null},position:{type:"string",group:"Misc",defaultValue:null},color:{type:"sap.ui.core.CSSColor",group:"Misc",defaultValue:"rgba(200, 50, 50, 0.3)"},colorBorder:{type:"sap.ui.core.CSSColor",group:"Misc",defaultValue:"rgba(200, 50, 50, 1.0)"},colorSelect:{type:"string",group:"Misc",defaultValue:null},colorNonSelect:{type:"string",group:"Misc",defaultValue:null},deltaColorHot:{type:"string",group:"Misc",defaultValue:"RHLSA(0;1.3;1.0;1.0)"},select:{type:"boolean",group:"Misc",defaultValue:false},changeable:{type:"boolean",group:"Misc",defaultValue:false}},events:{click:{clientX:{type:"int"},clientY:{type:"int"}},contextMenu:{parameters:{menu:{type:"sap.ui.unified.Menu"}}},edgeClick:{parameters:{index:{type:"int"}}},edgeContextMenu:{parameters:{index:{type:"int"},menu:{type:"sap.ui.unified.Menu"}}},handleMoved:{},handleContextMenu:{parameters:{index:{type:"int"},menu:{type:"sap.ui.unified.Menu"}}},handleClick:{index:{type:"int"}}}}});a.prototype.openContextMenu=function(e){this.getParent().openContextMenu("OverlayArea",this,e)};a.prototype.getDataElement=function(){var e={};var t=this.getParent().AreaBindInfo;e.K=this.getId();if(t.C){e.C=this.getColor()}if(t.CB){e.CB=this.getColorBorder()}if(t.DCH){e.DCH=this.getDeltaColorHot()}if(t.CS){e.CS=this.getColorSelect()}if(t.CNS){e.CNS=this.getColorNonSelect()}if(t.TT){e.TT=this.getTooltip()}e["VB:s"]=this.getSelect();e.P=this.getPosition();if(t.M){e["VB:c"]=this.getChangeable()}return e};a.prototype.handleChangedData=function(e){if(e.P){this.setPosition(e.P)}};a.prototype.handleEvent=function(e){var a=e.Action.name;var o="fire"+a[0].toUpperCase()+a.slice(1);if(a==="contextMenu"||a==="edgeContextMenu"||a==="handleContextMenu"){var r=this.getParent();this.mClickPos=[e.Action.Params.Param[0]["#"],e.Action.Params.Param[1]["#"]];if(r.mVBIContext.m_Menus){r.mVBIContext.m_Menus.deleteMenu("DynContextMenu")}var s=new t;s["vbi_data"]={};s["vbi_data"].menuRef="CTM";s["vbi_data"].VBIName="DynContextMenu";if(this.getChangeable()){if(a==="edgeContextMenu"){var l=e.Action.Params.Param[2]["#"];r.mAddMenuItems.push(new i({text:n().getText("OVL_AREA_EDGE_SPLIT"),select:this._handleCtxFunction.bind(this,"SPLIT",l)}))}else if(a==="handleContextMenu"){var u=e.Action.Params.Param[2]["#"];r.mAddMenuItems.push(new i({text:n().getText("OVL_AREA_HANDLE_REMOVE"),select:this._handleCtxFunction.bind(this,"REMOVE",u)}))}}if(this.hasListeners(a)){if(a==="contextMenu"){this.firecontextMenu({menu:s})}else{this[o]({index:e.Action.Params.Param[2]["#"],menu:s})}}else{r._openContextMenu(e.Action.object,this,s)}}else if(a=="click"){this.mClickPos=e.Action.AddActionProperties.AddActionProperty[0]["#"];this.fireClick({clientX:e.Action.Params.Param[0]["#"],clientY:e.Action.Params.Param[1]["#"]})}else if(a.indexOf("Click")>-1){this[o]({index:e.Action.Params.Param[2]["#"]})}else{this[o]()}};a.prototype.getKey=function(){var e=this.getProperty("key");if(!e){e=this.getId()}return e};a.prototype._handleCtxFunction=function(e,t){var i=this.getPosition().split(";");var n=t*3;if(e==="REMOVE"){i.splice(n,3)}else if(e==="SPLIT"){var a=[i[n],i[n+1]];var o=n+3<i.length?[i[n+3],i[n+4]]:[i[0],i[1]];var r=[parseFloat(a[0])+(o[0]-a[0])/2,parseFloat(a[1])+(o[1]-a[1])/2];i.splice(n+3,0,r[0].toString(),r[1].toString(),"0")}this.setPosition(i.toString().replace(/,/g,";"))};return a});