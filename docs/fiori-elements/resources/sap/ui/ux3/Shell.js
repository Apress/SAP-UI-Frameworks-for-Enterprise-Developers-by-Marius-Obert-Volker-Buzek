/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/commons/Menu","sap/ui/core/Control","sap/ui/core/theming/Parameters","./library","./ShellRenderer","./ShellPersonalization","./NavigationBar","sap/ui/core/delegate/ItemNavigation","sap/ui/core/RenderManager","sap/ui/core/Popup","./ToolPopup","sap/ui/commons/SearchField","sap/ui/commons/Label","./Feeder","sap/ui/commons/library","sap/ui/commons/Button","sap/ui/commons/MenuItem","./NotificationBar","sap/ui/base/Object","sap/ui/Device","sap/base/Log","sap/base/assert","sap/ui/core/Configuration","sap/ui/dom/jquery/Focusable"],function(e,t,s,i,o,a,r,n,l,h,p,d,c,u,f,g,_,y,m,v,I,S,T,P){"use strict";var B=o.NotificationBarStatus;var x=o.FeederType;var R=p.Dock;var O=o.ShellDesignType;var H=o.ShellHeaderType;var E=s.extend("sap.ui.ux3.Shell",{metadata:{deprecated:true,library:"sap.ui.ux3",properties:{appTitle:{type:"string",group:"Misc",defaultValue:null},appIcon:{type:"sap.ui.core.URI",group:"Misc",defaultValue:null},appIconTooltip:{type:"string",group:"Misc",defaultValue:null},showLogoutButton:{type:"boolean",group:"Misc",defaultValue:true},logoutButtonTooltip:{type:"string",group:"Accessibility",defaultValue:null},showSearchTool:{type:"boolean",group:"Misc",defaultValue:true},showInspectorTool:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},showFeederTool:{type:"boolean",group:"Misc",defaultValue:true},showTools:{type:"boolean",group:"Misc",defaultValue:true},showPane:{type:"boolean",group:"Misc",defaultValue:true},headerType:{type:"sap.ui.ux3.ShellHeaderType",group:"Misc",defaultValue:H.Standard},designType:{type:"sap.ui.ux3.ShellDesignType",group:"Misc",defaultValue:O.Standard},paneWidth:{type:"int",group:"Misc",defaultValue:250},applyContentPadding:{type:"boolean",group:"Appearance",defaultValue:true},fullHeightContent:{type:"boolean",group:"Appearance",defaultValue:false},allowOverlayHeaderAccess:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"content",aggregations:{worksetItems:{type:"sap.ui.ux3.NavigationItem",multiple:true,singularName:"worksetItem"},paneBarItems:{type:"sap.ui.core.Item",multiple:true,singularName:"paneBarItem"},paneContent:{type:"sap.ui.core.Control",multiple:true,singularName:"paneContent"},content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},toolPopups:{type:"sap.ui.ux3.ToolPopup",multiple:true,singularName:"toolPopup"},headerItems:{type:"sap.ui.core.Control",multiple:true,singularName:"headerItem"},notificationBar:{type:"sap.ui.ux3.NotificationBar",multiple:false},_paneOverflowMenu:{type:"sap.ui.commons.Menu",multiple:false,visibility:"hidden"}},associations:{selectedWorksetItem:{type:"sap.ui.ux3.NavigationItem",multiple:false}},events:{worksetItemSelected:{allowPreventDefault:true,parameters:{id:{type:"string"},item:{type:"sap.ui.ux3.NavigationItem"},key:{type:"string"}}},paneBarItemSelected:{parameters:{id:{type:"string"},item:{type:"sap.ui.core.Item"},key:{type:"string"}}},logout:{},search:{},feedSubmit:{},paneClosed:{parameters:{id:{type:"string"}}}}}});E.WSI_MENU_DELAY=200;E.WSI_OVERFLOW_SCROLL_STEP=250;E.TOOL_PREFIX="-tool-";E.FIRST_RENDERING=true;E.SIDE_BAR_BASE_WIDTH=null;E.PANE_OVERFLOW_BUTTON_HEIGHT=null;E.prototype.init=function(){this._iOpenPaneIndex=-1;this._sOpenWsiId=null;this._bPreviousScrollRight=false;this._bPreviousScrollLeft=false;this._sSelectedWorksetId=null;this._sSelectedFacetId=null;this._aSyncRefStack=[];this._mSyncRefs={};this._oWorksetBar=new n(this.getId()+"-wsBar",{toplevelVariant:true,select:[this._handleWorksetBarSelect,this]}).setParent(this);this._oFacetBar=new n(this.getId()+"-facetBar",{select:[this._handleFacetBarSelect,this]}).setParent(this);this.setAggregation("_paneOverflowMenu",new t);var e=this;this._checkResizeClosure=function(){e._checkResize()};this.currentToolPaletteWidth=0;this._updateThemeVariables()};E.prototype.exit=function(){if(this._oWorksetBar){this._oWorksetBar.destroy();delete this._oWorksetBar}if(this._oFacetBar){this._oFacetBar.destroy();delete this._oFacetBar}this._oSearchField=null;e(window).off("resize",this._checkResizeClosure);clearTimeout(this._checkPaneBarOverflowDelayId);this._checkPaneBarOverflowDelayId=null};E.prototype.onBeforeRendering=function(){this._beforeRenderingToolPalette();this.$("focusDummyPane").off("focusin");if(window.FileReader){var t=this.$("hdr");t.off("dragover",this._handleDragover).off("dragend",this._handleDragend).off("drop",this._handleDrop);var s=this.$("bgImg");s.off("dragover",e.proxy(this._handleDragover)).off("dragend",this._handleDragend).off("drop",this._handleDrop)}};E.prototype.onAfterRendering=function(){this._afterRenderingToolPalette();if(this._topSyncRefId&&this._mSyncRefs[this._topSyncRefId].focusLast){this.$("focusDummyPane").on("focusin",this._mSyncRefs[this._topSyncRefId].focusLast)}if(window.FileReader){var t=this.$("hdr");t.on("dragover",e.proxy(this._handleDragover,this)).on("dragend",e.proxy(this._handleDragend,this)).on("drop",e.proxy(this._handleDrop,this));var s=this.$("bgImg");s.on("dragover",e.proxy(this._handleDragover,this)).on("dragend",e.proxy(this._handleDragend,this)).on("drop",e.proxy(this._handleDrop,this))}var i=this._oFacetBar.getAssociatedItems().length>0;var o=this.$("facetBar");o.css("display",i?"block":"none");this._adaptContentHeight();this._bRtl=P.getRTL();if(this._getPersonalization().hasChanges()){this._getPersonalization().applySettings(this._getPersonalization().oSettings)}if(!this._oPaneItemNavigation){this._oPaneItemNavigation=(new l).setCycling(false);this.addDelegate(this._oPaneItemNavigation)}var a=this.$("paneBarEntries");this._updatePaneBarItemNavigation(a);this._setNotifyVisibility();if(E.FIRST_RENDERING){e(window).on("resize",this._checkResizeClosure)}this._checkResize();E.FIRST_RENDERING=false;if(I.browser.firefox&&I.browser.version==17){setTimeout(this._checkResize.bind(this),500)}};E.prototype._updateThemeVariables=function(){var e=Object.assign({sapUiUx3ShellSideBarBaseWidth:"40px",sapUiUx3ShellPaneOverflowButtonHeight:"40px"},i.get({name:["sapUiUx3ShellSideBarBaseWidth","sapUiUx3ShellPaneOverflowButtonHeight"],callback:function(e){E.SIDE_BAR_BASE_WIDTH=parseInt(e["sapUiUx3ShellSideBarBaseWidth"]);E.PANE_OVERFLOW_BUTTON_HEIGHT=parseInt(e["sapUiUx3ShellPaneOverflowButtonHeight"])}}));E.SIDE_BAR_BASE_WIDTH=parseInt(e["sapUiUx3ShellSideBarBaseWidth"]);E.PANE_OVERFLOW_BUTTON_HEIGHT=parseInt(e["sapUiUx3ShellPaneOverflowButtonHeight"]);E.PANE_OVERFLOW_BUTTON_MAX_HEIGHT=E.PANE_OVERFLOW_BUTTON_HEIGHT};E.prototype._checkResize=function(){if(!this.getDomRef()){return}clearTimeout(this._checkResizeDelayId);this._checkResizeDelayId=setTimeout(function(){this._rerenderPaneBarItems();this._checkToolPaletteSize()}.bind(this),100)};E.prototype._checkToolPaletteSize=function(e){if(!this.getDomRef()){return}if(e===undefined){e=!this.getShowTools()}var t=this.$("tp");var s=1;var i=9999999;var o=0;var a=true;if(e){s=0;a=false}do{var r=s*E.SIDE_BAR_BASE_WIDTH;var n=Math.floor(r/2);var l=Math.floor(r/4);var p=this._bRtl?"right":"left";this.$("canvas").css(p,r+"px");this.$("canvasBackground").css(p,r+"px");this.$("wBar").css("margin-"+p,r+"px");var d={};d[p]=r+"px";this.$("notify").css(d);t.css("width",r+"px");var d={};d["width"]=n+"px";d["margin-"+p]=l+"px";this.$("tp-separator").css(d);if(!a){break}h.forceRepaint(t[0]);o=t.children().last()[0].offsetTop;if(o>=i){s--;a=false;continue}i=o;s++;if(s>10){S.error("The ToolPalette is growing too much, this must be a bug.");break}}while(o>t.height());this.currentToolPaletteWidth=this.getShowTools()?r:0;this._updateOverlaysOnToolPaletteChange()};E.prototype._updateOverlaysOnToolPaletteChange=function(){var e=this._getSyncRefs();if(this._bRtl){e.css("right",this.currentToolPaletteWidth+"px")}else{e.css("left",this.currentToolPaletteWidth+"px")}};E.prototype._updatePaneBarItemNavigation=function(e){this._oPaneItemNavigation.setRootDomRef(e[0]);var t=e.children().toArray();this._oPaneItemNavigation.setItemDomRefs(t);if(this._oPaneItemNavigation.getFocusedIndex()>t.length){this._oPaneItemNavigation.setFocusedIndex(-1)}this._checkPaneBarOverflow(e)};E.prototype._checkPaneBarOverflow=function(e){clearTimeout(this._checkPaneBarOverflowDelayId);this._checkPaneBarOverflowDelayId=setTimeout(function(){this._delayedCheckPaneBarOverflow(e)}.bind(this),200)};E.prototype._delayedCheckPaneBarOverflow=function(t){if(!t){t=this.$("paneBarEntries")}if(t.length==0){this._checkPaneBarOverflow();return}var s=t.parent().height()-(this._bRtl?t.innerHeight():0);var i=0;var o=t.children();o.css("display","inline-block");var a=false;var r=o.length;for(var n=r-1;n>=0;--n){var l=o[n];if(this._bRtl){i=0-l.offsetLeft}else{i=l.offsetLeft+l.offsetWidth}var p=i<s;e(l).css("display",p?"inline-block":"none");var d=sap.ui.getCore().byId(l.id+"-overflow");d&&d.setVisible(!p);if(p){continue}else{a=true}}var c=this.$("paneBarOverflowButton");if(a){c.css("display","block")}else{c.css("display","none");if(I.browser.firefox&&I.browser.version==17){h.forceRepaint(document.getElementsByTagName("body")[0])}}var u=this._changeOverflowButton();if(u){this._checkPaneBarOverflow()}};E.prototype._adaptOverflowButtonHeight=function(){var e=this.$("paneBarOverflowButton");var t=this.$("paneBarOverflowWrapper");var s=this.$("paneBarOverflowText");var i=this.$("paneBarRight");s.css("width","");var o=E.PANE_OVERFLOW_BUTTON_HEIGHT;var a=s[0].scrollWidth+5;if(a>E.PANE_OVERFLOW_BUTTON_MAX_HEIGHT){E.PANE_OVERFLOW_BUTTON_HEIGHT=E.PANE_OVERFLOW_BUTTON_MAX_HEIGHT}else{E.PANE_OVERFLOW_BUTTON_HEIGHT=a}e.css("height",E.PANE_OVERFLOW_BUTTON_HEIGHT);t.css("width",E.PANE_OVERFLOW_BUTTON_HEIGHT);s.css("width","100%");i.css("padding-bottom",E.PANE_OVERFLOW_BUTTON_HEIGHT+"px");return o!=E.PANE_OVERFLOW_BUTTON_HEIGHT};E.prototype._changeOverflowButton=function(){var e=null;if(this._sOpenPaneId){e=sap.ui.getCore().byId(this._sOpenPaneId+"-overflow")}var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3").getText("SHELL_MORE_BUTTON");var s=false;if(e&&e.getVisible()){t=e.getText();s=true}t=t.toUpperCase();var i=this.$("paneBarOverflowText");i.text(t);i.attr("title",t);i.toggleClass("sapUiUx3ShellPaneEntrySelected",s);return this._adaptOverflowButtonHeight()};E.prototype._getPaneOverflowMenu=function(){return this.getAggregation("_paneOverflowMenu")};E.prototype.getFocusInfo=function(){try{var e=document.activeElement;return e?{sFocusId:e.id,oFocusedElement:e}:{}}catch(e){return{}}};E.prototype.applyFocusInfo=function(e){var t=(e.sFocusId?window.document.getElementById(e.sFocusId):null)||e.oFocusedElement;if(t){t.focus()}};E._updateToolIcon=function(t){if(t&&t.firstChild){var s=e(t);var i=t.id.substr(t.id.indexOf(E.TOOL_PREFIX)+6);var o=sap.ui.getCore().byId(i);var a;if(s.is(".sapUiUx3ShellToolSelected")){a=o.getIconSelected()}else if(s.is(".sapUiUx3ShellToolHover")){a=o.getIconHover()}else{a=o.getIcon()}t.firstChild.src=a}};E.prototype.onclick=function(e){this.onUserActivation(e)};E.prototype.onsapspace=function(e){this.onUserActivation(e)};E.prototype.onsapenter=function(e){this.onUserActivation(e)};E.prototype.onUserActivation=function(e){var t=e.target.id;var s=e.target.parentNode;var i=this.getId();if(e.target.className&&e.target.className.indexOf&&e.target.className.indexOf("sapUiUx3ShellHeader-logout")>-1){this.fireLogout()}else if(s&&s.parentNode&&s.parentNode.className&&s.parentNode.className.indexOf&&s.parentNode.className.indexOf("sapUiUx3ShellToolPaletteArea")>-1){this._handleToolItemClick(t)}else if(s&&s.parentNode&&s.parentNode.parentNode&&s.parentNode.parentNode.className&&s.parentNode.parentNode.className.indexOf&&s.parentNode.parentNode.className.indexOf("sapUiUx3ShellToolPaletteArea")>-1){this._handleToolItemClick(s.id)}else if(t===i+"-paneBarOverflowText"){var o=this.$("paneBarOverflowButton")[0];this._getPaneOverflowMenu().open(true,o,(this._bRtl?"left":"right")+" bottom","center center",o)}else if(t){if(s&&s.className&&s.className.indexOf&&s.className.indexOf("sapUiUx3ShellPaneEntries")>-1){this._handlePaneBarItemClick(t)}}};E.prototype._handleWorksetBarSelect=function(e){var t=this._handleWorksetItemClick(e.getParameter("item"));if(!t){e.preventDefault()}};E.prototype._handleFacetBarSelect=function(e){var t=this._handleWorksetItemClick(e.getParameter("item"));if(!t){e.preventDefault()}};E.prototype._handleWorksetItemClick=function(e){var t=e.getParent(),s=e.getId(),i=s,o=true;if(t instanceof E){if(s!=this._sSelectedWorksetId){var a=e.getSubItems();if(a.length>0){i=a[0].getId()}o=this._fireWorksetItemSelected(i);if(o){this._sSelectedWorksetId=s;if(a.length>0){this._sSelectedFacetId=a[0].getId();s=this._sSelectedFacetId}else{this._sSelectedFacetId=null}var a=e.getSubItems();this._oFacetBar.setAssociatedItems(a,true);var r=this.$("facetBar");var n=this._calcFacetBarHeight(r);if(a.length>0){if(!this._oFacetBar.isSelectedItemValid()){this._oFacetBar.setSelectedItem(a[0]);this._sSelectedFacetId=a[0].getId()}r.slideDown();this._adaptContentHeight(null,true,n)}else{this._oFacetBar.setSelectedItem(null);r.slideUp();this._adaptContentHeight(null,true,n)}}}}else{if(s!=this._sSelectedFacetId){o=this._fireWorksetItemSelected(i);if(o){this._sSelectedFacetId=s}}}return o};E.prototype._fireWorksetItemSelected=function(e){var t=sap.ui.getCore().byId(e);var s=t?t.getKey():null;var i=this.fireWorksetItemSelected({id:e,item:t,key:s});if(i){this.setAssociation("selectedWorksetItem",e,true)}return i};E.prototype._closeCurrentToolPopup=function(){var t;if(this._oOpenToolPopup){t=this._oOpenToolPopup.getId();e(document.getElementById(this.getId()+E.TOOL_PREFIX+this._oOpenToolPopup.getId())).removeClass("sapUiUx3ShellToolSelected").attr("aria-pressed","false");if(t===this.getId()+"-feederTool"){var s=sap.ui.getCore().byId(this.getId()+"-feeder");s.setText("");s.rerender()}this._oOpenToolPopup.close();this._oOpenToolPopup=null}return t};E.prototype._handleToolItemClick=function(t){var s=this._closeCurrentToolPopup();var i;var o=t.substr(t.indexOf(E.TOOL_PREFIX)+6);if(o==this.getId()+"-searchTool"){i=this._getSearchTool()}else if(o==this.getId()+"-feederTool"){i=this._getFeederTool()}else{i=sap.ui.getCore().byId(o)}if(i&&i.getId()!=s){this._oOpenToolPopup=i;i.setPosition(R.BeginTop,R.EndTop,document.getElementById(t),"13 -6","fit");i.open();e(document.getElementById(t)).addClass("sapUiUx3ShellToolSelected").attr("aria-pressed","true");E._updateToolIcon(document.getElementById(t));var a=this;var r=function(s){i.detachClosed(r);if(a._oOpenToolPopup&&a._oOpenToolPopup.getId()===s.getParameter("id")){a._closeCurrentToolPopup()}e(document.getElementById(t)).removeClass("sapUiUx3ShellToolSelected");E._updateToolIcon(document.getElementById(t))};i.attachClosed(r)}else if(i.getId()==s){E._updateToolIcon(document.getElementById(t))}};E.prototype._hasDarkDesign=function(){return this.getDesignType()!==O.Light&&this.getDesignType()!==O.Crystal};E.prototype._getSearchTool=function(){if(!this._oSearchPopup){var e=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._oSearchPopup=new d(this.getId()+"-searchTool",{tooltip:e.getText("SHELL_SEARCH")}).addStyleClass("sapUiUx3TP-search");var t=this._hasDarkDesign();this._oSearchPopup.setInverted(t);var s=this;var i=new c(this.getId()+"-searchField",{enableListSuggest:false,search:function(e){s.fireSearch({text:e.getParameter("query")})}});var o=new u({text:e.getText("SHELL_SEARCH_LABEL")+":"}).setLabelFor(i);this._oSearchPopup.addContent(o).addContent(i);this._oSearchPopup.attachOpen(function(){window.setTimeout(function(){i.focus()},100)});this._oSearchField=i}return this._oSearchPopup};E.prototype.getSearchField=function(){if(!this._oSearchField){this._getSearchTool()}return this._oSearchField};E.prototype._getFeederTool=function(){if(!this._oFeederPopup){var e=this;var t=sap.ui.getCore().getLibraryResourceBundle("sap.ui.ux3");this._oFeederPopup=new d(this.getId()+"-feederTool",{tooltip:t.getText("SHELL_FEEDER")}).addStyleClass("sapUiUx3TP-feeder");var s=this._hasDarkDesign();this._oFeederPopup.setInverted(s);var i=new f(this.getId()+"-feeder",{type:x.Medium,submit:function(t){e.fireFeedSubmit({text:t.getParameter("text")});i.setText("");i.rerender();e._oFeederPopup.close()}});this._oFeederPopup.setInitialFocus(this.getId()+"-feeder");this._oFeederPopup.attachClose(function(){i.setText("")});this._oFeederPopup.addContent(i)}return this._oFeederPopup};E.prototype.openPane=function(t){var s=this;T(typeof t==="string","sPaneId must be given as string");var i=sap.ui.getCore().byId(t);if(i&&t!=this._sOpenPaneId&&this.getShowPane()){var o;if(i){if(i.getKey()==""){o=null}else{o=i.getKey()}}else{o=null}this.firePaneBarItemSelected({id:t,item:i,key:o});var a=e(document.getElementById(t));a.siblings().removeClass("sapUiUx3ShellPaneEntrySelected");a.addClass("sapUiUx3ShellPaneEntrySelected");if(!this._sOpenPaneId){this._openPane(function(){s.focusPaneStart()})}else{e(document.getElementById(this.getId()+"-pb_"+this._sOpenPaneId)).removeClass("sapUiUx3ShellPaneEntrySelected")}this._sOpenPaneId=t}return this};E.prototype.closePane=function(){this._closePane();return this};E.prototype.isPaneOpen=function(){return this._sOpenPaneId!=null};E.prototype._handlePaneBarItemClick=function(e){if(e===this._sOpenPaneId){this.closePane()}else{this.openPane(e)}this._checkPaneBarOverflow()};E._SHELL_OFFSET_RIGHT=0;E.prototype._closePane=function(t){if(!this._sOpenPaneId){if(t){t()}return}var s=this._sOpenPaneId;var i=this;var o=this.getShowPane()?this.$("paneBarRight").outerWidth()+E._SHELL_OFFSET_RIGHT:E._SHELL_OFFSET_RIGHT;var a={};a[this._bRtl?"left":"right"]=o+"px";var r={};r[this._bRtl?"marginLeft":"marginRight"]=o-E._SHELL_OFFSET_RIGHT+"px";this.$("content").css("overflow-x","hidden");this.$("canvas").stop().animate(a);this.$("notify").stop().animate(a);this._getSyncRefs().stop(false,true).animate(a);this.$("wBar").stop().animate(r);this.$("paneBar").removeClass("sapUiUx3ShellPaneBarOpened").addClass("sapUiUx3ShellPaneBarClose");this.$("canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundOpen").addClass("sapUiUx3ShellCanvasBackgroundClosed").stop().animate(a,function(){i.$("paneBar").removeClass("sapUiUx3ShellPaneBarOpen");i.$("content").css("overflow-x","");if(t){t()}i.firePaneClosed({id:s})});e(document.getElementById(this._sOpenPaneId)).removeClass("sapUiUx3ShellPaneEntrySelected");this._sOpenPaneId=null};E.prototype._openPane=function(e){var t=this;var s=this.getPaneWidth();var i=this.$("paneBarRight").outerWidth();this.$("content").css("overflow-x","hidden");if(this._bRtl){this.$("paneBar").removeClass("sapUiUx3ShellPaneBarClose").addClass("sapUiUx3ShellPaneBarOpen");this.$("wBar").stop().animate({marginLeft:s+i+"px"});this.$("canvas").stop().animate({left:s+i+E._SHELL_OFFSET_RIGHT+"px"});this.$("notify").stop().animate({left:s+i+E._SHELL_OFFSET_RIGHT+"px"});this._getSyncRefs().stop(false,true).animate({left:s+i+E._SHELL_OFFSET_RIGHT+"px"});this.$("canvasBackground").stop().animate({left:s+i+E._SHELL_OFFSET_RIGHT+"px"},function(){t.$("content").css("overflow-x","");t.$("canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundClosed").addClass("sapUiUx3ShellCanvasBackgroundOpen");t.$("paneBar").addClass("sapUiUx3ShellPaneBarOpened");if(e){e()}})}else{this.$("paneBar").removeClass("sapUiUx3ShellPaneBarClose").addClass("sapUiUx3ShellPaneBarOpen");this.$("wBar").stop().animate({marginRight:s+i+"px"});this.$("canvas").stop().animate({right:s+i+E._SHELL_OFFSET_RIGHT+"px"});this.$("notify").stop().animate({right:s+i+E._SHELL_OFFSET_RIGHT+"px"});this._getSyncRefs().stop(false,true).animate({right:s+i+E._SHELL_OFFSET_RIGHT+"px"});this.$("canvasBackground").stop().animate({right:s+i+E._SHELL_OFFSET_RIGHT+"px"},function(){t.$("content").css("overflow-x","");t.$("canvasBackground").removeClass("sapUiUx3ShellCanvasBackgroundClosed").addClass("sapUiUx3ShellCanvasBackgroundOpen");t.$("paneBar").addClass("sapUiUx3ShellPaneBarOpened");if(e){e()}})}};E.prototype.setPaneWidth=function(e){if(typeof e=="number"&&e>0){e=Math.max(e,50);if(this.getDomRef()){this.$("paneContent").css("width",e+"px");this.$("paneBar").css("width",e+E.SIDE_BAR_BASE_WIDTH+"px");if(this._sOpenPaneId){if(this._bRtl){this.$("wBar").css("marginLeft",e+E.SIDE_BAR_BASE_WIDTH+"px");this.$("canvas").css("left",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this.$("notify").css("left",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this._getSyncRefs().css("left",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this.$("canvasBackground").css("left",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px")}else{this.$("wBar").css("marginRight",e+E.SIDE_BAR_BASE_WIDTH+"px");this.$("canvas").css("right",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this.$("notify").css("right",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this._getSyncRefs().css("right",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px");this.$("canvasBackground").css("right",e+E.SIDE_BAR_BASE_WIDTH+E._SHELL_OFFSET_RIGHT+"px")}}}this.setProperty("paneWidth",e,true)}return this};E.prototype.setOffsetRight=function(t,s,i){if(t<0){t=0}if(t>600){t=600}E._SHELL_OFFSET_RIGHT=t;var o=t+"px";var a=this._bRtl?{left:o}:{right:o};this.$("hdr").stop().animate(a);this.$("hdrImg").stop().animate(a);this.$("bg").stop().animate(a,function(){if(s){s()}});this.$("bgImg").stop().animate(a);this.$("wBar").stop().animate(a);this.$("paneBar").stop().animate(a);e(document.getElementById(i)).stop().animate({width:o});if(!this.$().hasClass("sapUiUx3ShellNoPane")){o=t+(this._sOpenPaneId?this.getPaneWidth():0)+E.SIDE_BAR_BASE_WIDTH+"px"}a=this._bRtl?{left:o}:{right:o};this.$("notify").stop().animate(a);this._getSyncRefs().stop(false,true).animate(a);this.$("canvas").stop().animate(a);this.$("canvasBackground").stop().animate(a)};E.prototype._refreshCanvasOffsetRight=function(e){var t=this._bRtl?"left":"right";var s=E._SHELL_OFFSET_RIGHT;if(e){var i=this.$("paneBarRight").outerWidth();s=s+(this._sOpenPaneId?this.getPaneWidth():0)+i}s=s+"px";this.$("notify").css(t,s);this.$("canvas").css(t,s);this.$("canvasBackground").css(t,s);this._getSyncRefs().css(t,s)};E.prototype._setNotifyVisibility=function(t){var s=this.getNotificationBar();if(!s){return}if(!t){t=s.getVisibleStatus()}var i=this.$("notify");var o=this._topSyncRefId?e(document.getElementById(this._topSyncRefId)):e(null);var a=o.hasClass("sapUiUx3TI");var r=0;var n=0;if(t===B.Min){r=10}else if(t===B.Max||t===B.Default){if(this.getHeaderType()===H.BrandOnly&&a){r=parseInt(s.getHeightOfStatus(B.Default))}else{r=10}n=r}i.removeClass("sapUiUx3ShellNotifyTI").removeClass("sapUiUx3ShellNotifyOverlay");if(this._topSyncRefId){this._getSyncRefs().animate({bottom:n+"px"},"fast");if(n>0){i.addClass(a?"sapUiUx3ShellNotifyTI":"sapUiUx3ShellNotifyOverlay")}}if(t===B.Min){i.css("height",r+"px").css("z-index",1)}else{i.css("height",r+"px").css("z-index",1e5)}if(r>0&&!this.$().hasClass("sapUiUx3ShellNotifyVisible")){this.$().addClass("sapUiUx3ShellNotifyVisible")}else if(r==0&&this.$().hasClass("sapUiUx3ShellNotifyVisible")){this.$().removeClass("sapUiUx3ShellNotifyVisible")}this._adaptContentHeight(t)};E.prototype.syncWithCanvasSize=function(t,s,i,o,a){var r=this._aSyncRefStack.indexOf(t);if(s){var n={id:t,focusFirst:i,focusLast:o,applyChanges:a};if(r<0){this._aSyncRefStack.push(t)}this._mSyncRefs[t]=n;n.applyChanges({showOverlay:this.getHeaderType()!==H.BrandOnly})}else{if(r>=0){delete this._mSyncRefs[t];this._aSyncRefStack.splice(r,1)}}this.$("canvas").removeAttr("aria-hidden");this.$("focusDummyTPStart").removeAttr("tabindex").off("focusin");this.$("focusDummyTPEnd").removeAttr("tabindex").off("focusin");this.$("focusDummyHdrStart").removeAttr("tabindex").off("focusin");this.$("focusDummyHdrEnd").removeAttr("tabindex").off("focusin");this.$("focusDummyPane").removeAttr("tabindex").off("focusin");this.$().toggleClass("sapUiUx3ShellBlockHeaderAccess",false);delete this._topSyncRefId;if(this._aSyncRefStack.length>0){var n=this._mSyncRefs[this._aSyncRefStack[this._aSyncRefStack.length-1]];var l=this._getSyncRefs();var h=this.getDomRef("canvas");l.css(this._bRtl?"right":"left",(this.getShowTools()?this.currentToolPaletteWidth:0)+"px");var p=E._SHELL_OFFSET_RIGHT;if(this.getShowPane()){p+=E.SIDE_BAR_BASE_WIDTH;if(this._sOpenPaneId){p+=this.getPaneWidth()}}l.css(this._bRtl?"left":"right",p+"px");l.css("top",this.getDomRef(this.getAllowOverlayHeaderAccess()?"hdr":"hdrLine").offsetHeight+"px");l.css("bottom","0");e(h).attr("aria-hidden","true");this.$("focusDummyTPEnd").attr("tabindex","0").on("focusin",n.focusFirst);this.$("focusDummyHdrStart").attr("tabindex","0").on("focusin",e.proxy(this.focusPaneEnd,this));this.$("focusDummyHdrEnd").attr("tabindex","0").on("focusin",e.proxy(this.focusFirstTool,this));this.$("focusDummyTPStart").attr("tabindex","0").on("focusin",e.proxy(this.focusLastHdr,this));this.$("focusDummyPane").attr("tabindex","0").on("focusin",n.focusLast);this.$().toggleClass("sapUiUx3ShellBlockHeaderAccess",!this.getAllowOverlayHeaderAccess());this._topSyncRefId=n.id}if(this._sUpdateNotificationZIndex){clearTimeout(this._sUpdateNotificationZIndex);delete this._sUpdateNotificationZIndex}this._sUpdateNotificationZIndex=setTimeout(function(){delete this._sUpdateNotificationZIndex;this._setNotifyVisibility();if(this._oOpenToolPopup&&this._topSyncRefId){var t=e(document.getElementById(this._topSyncRefId));this._oOpenToolPopup.$().css("z-index",parseInt(t.css("z-index"))+1)}}.bind(this),0)};E.prototype._getSyncRefs=function(){var t=[];var s;for(var i=0;i<this._aSyncRefStack.length;i++){s=this._aSyncRefStack[i]?window.document.getElementById(this._aSyncRefStack[i]):null;if(s){t.push(s)}}return e(t)};E.prototype.focusFirstHdr=function(){var e=this.$("hdr-items").firstFocusableDomRef();if(e&&this.getAllowOverlayHeaderAccess()&&this.getHeaderType()!=H.BrandOnly){if(e){e.focus()}}else{this.focusFirstTool()}};E.prototype.focusLastHdr=function(){var e=this.$("hdr-items").lastFocusableDomRef();if(e&&this.getAllowOverlayHeaderAccess()&&this.getHeaderType()!=H.BrandOnly){if(e){e.focus()}}else{this.focusPaneEnd()}};E.prototype.focusFirstTool=function(){var e=this.$("tp").find(".sapUiUx3ShellTool").first();if(e.length&&this.getShowTools()){e[0].focus()}else{this._mSyncRefs[this._topSyncRefId].focusFirst()}};E.prototype.focusLastTool=function(){var e=this.$("tp").find(".sapUiUx3ShellTool").last();if(e.length&&this.getShowTools()){e[0].focus()}else{this.focusPaneEnd()}};E.prototype.focusPaneStart=function(){var e=this.$("paneBar").firstFocusableDomRef();if(e){e.focus()}else{this.focusFirstTool()}};E.prototype.focusPaneEnd=function(){var e=this.$("paneBar").lastFocusableDomRef();if(e){e.focus()}else{this._mSyncRefs[this._topSyncRefId].focusLast()}};E.prototype.setAppTitle=function(e){this.setProperty("appTitle",e,true);this._rerenderHeader();return this};E.prototype.setAppIcon=function(e){this.setProperty("appIcon",e,true);this._rerenderHeader();return this};E.prototype.setShowLogoutButton=function(e){this.setProperty("showLogoutButton",e,true);this._rerenderHeader();return this};E.prototype.setLogoutButtonTooltip=function(e){this.setProperty("logoutButtonTooltip",e,true);this._rerenderHeader();return this};E.prototype.insertHeaderItem=function(e,t){if(v.isA(e,"sap.ui.commons.Button")){e.setStyled(false)}this.insertAggregation("headerItems",e,t,true);this._rerenderHeader();return this};E.prototype.addHeaderItem=function(e){if(v.isA(e,"sap.ui.commons.Button")){e.setStyled(false)}this.addAggregation("headerItems",e,true);this._rerenderHeader();return this};E.prototype.removeHeaderItem=function(e){var t=this.removeAggregation("headerItems",e,true);this._rerenderHeader();return t};E.prototype.removeAllHeaderItems=function(){var e=this.removeAllAggregation("headerItems",true);this._rerenderHeader();return e};E.prototype.destroyHeaderItems=function(){this.destroyAggregation("headerItems",true);this._rerenderHeader();return this};E.prototype.setShowSearchTool=function(e){this.setProperty("showSearchTool",e,true);this._rerenderToolPalette();return this};E.prototype.setShowFeederTool=function(e){this.setProperty("showFeederTool",e,true);this._rerenderToolPalette();return this};E.prototype.setHeaderType=function(t){var s=this.getHeaderType();this.setProperty("headerType",t,true);this.$().removeClass("sapUiUx3ShellHead"+s).addClass("sapUiUx3ShellHead"+this.getHeaderType());var i=this._getSyncRefs();if(i.length){i.css("top",this.getDomRef(this.getAllowOverlayHeaderAccess()?"hdr":"hdrLine").offsetHeight+"px")}var o={showOverlay:t!==H.BrandOnly};e.each(this._mSyncRefs,function(e,t){t.applyChanges(o)});return this};E.prototype.setAllowOverlayHeaderAccess=function(e){this.setProperty("allowOverlayHeaderAccess",e,true);var t=this._getSyncRefs();if(t.length){this.$().toggleClass("sapUiUx3ShellBlockHeaderAccess",!this.getAllowOverlayHeaderAccess());t.css("top",this.getDomRef(this.getAllowOverlayHeaderAccess()?"hdr":"hdrLine").offsetHeight+"px")}return this};E.prototype.setDesignType=function(e){var t=this.getDesignType();this.setProperty("designType",e,true);var s=this._hasDarkDesign();if(this._oSearchPopup){this._oSearchPopup.setInverted(s)}if(this._oFeederPopup){this._oFeederPopup.setInverted(s)}var i=this.getToolPopups();for(var o=0;o<i.length;++o){i[o].setInverted(s)}this.$().removeClass("sapUiUx3ShellDesign"+t).addClass("sapUiUx3ShellDesign"+e).toggleClass("sapUiUx3ShellDesignLight",!s);return this};E.prototype.setShowTools=function(e){this.setProperty("showTools",e,true);if(e){this.$().removeClass("sapUiUx3ShellNoTools");this._checkResize()}else{this.$().addClass("sapUiUx3ShellNoTools");this._closeCurrentToolPopup();this.$("tp").attr("style","")}this._checkToolPaletteSize(true);return this};E.prototype.setShowPane=function(e){this.setProperty("showPane",e,true);if(e){this.$().removeClass("sapUiUx3ShellNoPane");this._refreshCanvasOffsetRight(true);this._checkPaneBarOverflow()}else{var t=this;this._closePane(function(){t._refreshCanvasOffsetRight(false);t.$().addClass("sapUiUx3ShellNoPane")})}return this};E.prototype.insertToolPopup=function(e,t){this.insertAggregation("toolPopups",e,t,true);e.attachIconChanged(this._rerenderToolPalette,this);this._rerenderToolPalette();return this};E.prototype.addToolPopup=function(e){var t=this._hasDarkDesign();e.setInverted(t);this.addAggregation("toolPopups",e,true);e.attachIconChanged(this._rerenderToolPalette,this);this._rerenderToolPalette();return this};E.prototype.removeToolPopup=function(e){var t=this.removeAggregation("toolPopups",e,true);if(t===this._oOpenToolPopup){this._closeCurrentToolPopup()}this._rerenderToolPalette();return t};E.prototype.removeAllToolPopups=function(){var e=this.removeAllAggregation("toolPopups",true);this._rerenderToolPalette();return e};E.prototype.destroyToolPopups=function(){this.destroyAggregation("toolPopups",true);this._rerenderToolPalette();return this};E.prototype.insertContent=function(e,t){this.insertAggregation("content",e,t,true);this._rerenderContent();return this};E.prototype.addContent=function(e){this.addAggregation("content",e,true);this._rerenderContent();return this};E.prototype.removeContent=function(e){var t=this.removeAggregation("content",e,true);this._rerenderContent();return t};E.prototype.removeAllContent=function(){var e=this.removeAllAggregation("content",true);this._rerenderContent();return e};E.prototype.destroyContent=function(){this.destroyAggregation("content",true);this._rerenderContent();return this};E.prototype.addPaneBarItem=function(e){this.addAggregation("paneBarItems",e,true);this._rerenderPaneBarItems();return this};E.prototype.insertPaneBarItem=function(e,t){this.insertAggregation("paneBarItems",e,t,true);this._rerenderPaneBarItems();return this};E.prototype.removePaneBarItem=function(e){var t=this.removeAggregation("paneBarItems",e,true);if(t){var s=sap.ui.getCore().byId(t.getId()+"-overflow");if(s){s.destroy()}}this._rerenderPaneBarItems();return t};E.prototype.removeAllPaneBarItems=function(){var e=this.removeAllAggregation("paneBarItems",true);this._getPaneOverflowMenu().destroyItems();this._rerenderPaneBarItems();return e};E.prototype.destroyPaneBarItems=function(){this.destroyAggregation("paneBarItems",true);this._getPaneOverflowMenu().destroyItems();this._rerenderPaneBarItems();return this};E.prototype.addWorksetItem=function(e){this.addAggregation("worksetItems",e,true);this._rerenderWorksetItems();return this};E.prototype.insertWorksetItem=function(e,t){this.insertAggregation("worksetItems",e,t,true);this._rerenderWorksetItems();return this};E.prototype.removeWorksetItem=function(e){var t=this.removeAggregation("worksetItems",e,true);this._rerenderWorksetItems();return t};E.prototype.removeAllWorksetItems=function(){var e=this.removeAllAggregation("worksetItems",true);this._rerenderWorksetItems();return e};E.prototype.destroyWorksetItems=function(){this.destroyAggregation("worksetItems",true);this._rerenderWorksetItems();return this};function C(e){var t=e.getNotificationBar();if(t){e._setNotifyVisibility(B.None);t.setVisibleStatus=t.__orig_setVisibleStatus;t.detachDisplay(t.__fHandleNotifyDisplay);delete t.__orig_setVisibleStatus;delete t.__fHandleNotifyDisplay}}E.prototype.setNotificationBar=function(e){C(this);if(e){var t=this;e.__orig_setVisibleStatus=e.setVisibleStatus;e.setVisibleStatus=function(e){this.__orig_setVisibleStatus.apply(this,arguments);t._setNotifyVisibility()}}this.setAggregation("notificationBar",e,true);this._rerenderNotificationArea();if(e){e.__fHandleNotifyDisplay=function(t){var s=t?t.getParameter("show"):e.hasItems();e.setVisibleStatus(s?B.Default:B.None)};e.attachDisplay(e.__fHandleNotifyDisplay);e.__fHandleNotifyDisplay()}return this};E.prototype.destroyNotificationBar=function(){C(this);this.destroyAggregation("notificationBar",true);this._rerenderNotificationArea();return this};E.prototype._rerenderNotificationArea=function(){var e=this.$("notify");if(e.length>0){var t=sap.ui.getCore().createRenderManager();a.renderNotificationArea(t,this);t.flush(e[0],true);t.destroy()}};E.prototype._rerenderHeader=function(){var e=this.$("hdr");if(e.length>0){var t=sap.ui.getCore().createRenderManager();a.renderHeader(t,this);t.flush(e[0],true);t.destroy()}};E.prototype._rerenderToolPalette=function(){var e=this.$("tp");if(e.length>0){var t=sap.ui.getCore().createRenderManager();this._beforeRenderingToolPalette();a.renderToolPalette(t,this);t.flush(e[0],true);this._afterRenderingToolPalette();t.destroy();this._checkResize()}};E.prototype._beforeRenderingToolPalette=function(){this.$("tp").find(".sapUiUx3ShellTool").off("mouseenter mouseleave");this.$("focusDummyTPEnd").off("focusin");this.$("focusDummyTPStart").off("focusin")};E.prototype._afterRenderingToolPalette=function(){var t=this.getId()+E.TOOL_PREFIX;var s=this.getToolPopups();var i=false;if(this._oOpenToolPopup&&this._oOpenToolPopup.isOpen()&&(this.indexOfToolPopup(this._oOpenToolPopup)>=0||this._oOpenToolPopup===this._oSearchPopup||this._oOpenToolPopup===this._oFeederPopup)){this._oOpenToolPopup.setPosition(R.BeginTop,R.EndTop,t+this._oOpenToolPopup.getId()?window.document.getElementById(t+this._oOpenToolPopup.getId()):null,"13 -6","fit");var o=document.getElementById(t+this._oOpenToolPopup.getId());e(o).toggleClass("sapUiUx3ShellToolSelected",true);E._updateToolIcon(o);i=true}if(!i&&this._oOpenToolPopup){this._closeCurrentToolPopup()}for(var a=0;a<s.length;a++){var r=s[a];if(r instanceof d){e(document.getElementById(t+r.getId())).hover(function(t){e(this).toggleClass("sapUiUx3ShellToolHover",t.type==="mouseenter");E._updateToolIcon(this)})}}if(this._topSyncRefId&&this._mSyncRefs[this._topSyncRefId].focusFirst){this.$("focusDummyTPEnd").attr("tabindex","0").on("focusin",this._mSyncRefs[this._topSyncRefId].focusFirst)}if(this._aSyncRefStack.length>0){this.$("focusDummyTPStart").attr("tabindex","0").on("focusin",e.proxy(this.focusLastHdr,this))}};E.prototype._rerenderContent=function(e){var t=this.$("content");if(t.length>0){var s=this.getContent(),i=sap.ui.getCore().createRenderManager();for(var o=0;o<s.length;o++){i.renderControl(s[o])}i.flush(t[0],e);i.destroy()}};E.prototype._rerenderPane=function(e){var t=this.$("paneContent");if(t.length>0){var s=this.getPaneContent(),i=sap.ui.getCore().createRenderManager();for(var o=0;o<s.length;o++){i.renderControl(s[o])}i.flush(t[0],e);i.destroy()}};E.prototype._rerenderPaneBarItems=function(){var e=this.$("paneBar").find(".sapUiUx3ShellPaneEntries");if(e.length>0){var t=sap.ui.getCore().createRenderManager();a.renderPaneBarItems(t,this);t.flush(e[0]);t.destroy();this._updatePaneBarItemNavigation(e)}var s=this;var i=this._getPaneOverflowMenu();var o=this.getPaneBarItems();var r=function(e){var t={overflowItem:e.getParameter("item"),target:{id:e.getParameter("id").replace(/-overflow$/,""),parentNode:{className:"sapUiUx3ShellPaneEntries"}}};s.onUserActivation(t)};for(var n=0;n<o.length;++n){var l=o[n].getId()+"-overflow";var h=sap.ui.getCore().byId(l);if(!h){var p=new y(l,{text:o[n].getText(),visible:false,select:r});i.addItem(p)}}this._checkPaneBarOverflow(e)};E.prototype._rerenderWorksetItems=function(){if(this.$("wBar").length>0){a.renderWorksetItems(null,this);a.renderFacetBar(null,this);var e=this._oFacetBar.getAssociatedItems();this._oFacetBar.$().css("display",e&&e.length>0?"block":"none");this._adaptContentHeight()}};E.prototype.forceInvalidation=s.prototype.invalidate;E.prototype.invalidate=function(e){if(!e){this.forceInvalidation()}else if(e instanceof sap.ui.ux3.NavigationItem){if(this._oWorksetBar&&this._oFacetBar){this._oWorksetBar.setAssociatedItems(this.getWorksetItems());var t=this.getSelectedWorksetItem();if(t){var s;var i=sap.ui.getCore().byId(t);if(i&&i.getParent()instanceof sap.ui.ux3.NavigationItem){this._oFacetBar.setAssociatedItems(i.getParent().getSubItems())}else if(i&&(s=i.getSubItems())){if(s&&s.length>0){this._oFacetBar.setAssociatedItems(s)}}s=this._oFacetBar.getAssociatedItems();this._oFacetBar.$().css("display",s&&s.length>0?"block":"none");this._adaptContentHeight()}}}else if(e instanceof sap.ui.core.Item&&e.getParent()==this){this.forceInvalidation()}else if(e instanceof d){this._rerenderToolPalette()}else if(this.indexOfHeaderItem(e)>=0){this._rerenderHeader()}};E.prototype._setParent=s.prototype.setParent;E.prototype.setParent=function(e,t,s){this._setParent(e,t,s);this.forceInvalidation()};E.prototype.setContent=function(e,t){T(e===null||e instanceof s||Array.isArray(e)&&(e.length>0?e[0]instanceof s:true),"vContent must be a control or array of controls or null");T(t===undefined||t===true||t===false,"bDestruct must be true, false, or undefined");var i=[];var o=this.$("content");var a=false;if(!t){i=this.removeAllAggregation("content",true);if(o.length>0){h.preserveContent(o[0]);a=true;o.empty()}}else{this.destroyAggregation("content",true)}if(e instanceof s){this.addAggregation("content",e,true)}else if(e&&typeof e=="object"&&e.length){for(var r=0;r<e.length;r++){this.addAggregation("content",e[r],true)}}this._rerenderContent(a);return i};E.prototype.setPaneContent=function(e,t){T(e instanceof s||Array.isArray(e)&&(e.length>0?e[0]instanceof s:true),"vContent must be a control or array of controls");T(t===undefined||t===true||t===false,"bDestruct must be true, false, or undefined");var i=[];var o=this.$("paneContent");var a=false;if(!t){i=this.removeAllAggregation("paneContent",true);if(o.length>0){h.preserveContent(o[0]);a=true;o.empty()}}else{this.destroyAggregation("paneContent",true)}if(e instanceof s){this.addAggregation("paneContent",e,true)}else if(e&&typeof e=="object"&&e.length){for(var r=0;r<e.length;r++){this.addAggregation("paneContent",e[r],true)}}this._rerenderPane(a);return i};E.prototype.getSelectedWorksetItem=function(){return this.getAssociation("selectedWorksetItem")};E.prototype.setSelectedWorksetItem=function(e){var t=this.getSelectedWorksetItem();this.setAssociation("selectedWorksetItem",e,true);var s=this.getSelectedWorksetItem();if(t!=s){var i=sap.ui.getCore().byId(s);if(i){this._sSelectedWorksetId=s;this._sSelectedFacetId=null;var o=i.getSubItems();if(o.length>0){i=o[0]}if(i&&i.getParent()instanceof sap.ui.ux3.NavigationItem){var a=i.getParent();this._sSelectedWorksetId=a.getId();this._sSelectedFacetId=i.getId();this._oWorksetBar.setSelectedItem(a);this._oFacetBar.setAssociatedItems(a.getSubItems());this._oFacetBar.setSelectedItem(i);if(this.getDomRef()){var r=this.$("facetBar");var n=this._calcFacetBarHeight(r);r.slideDown();this._adaptContentHeight(null,true,n)}}else if(i){this._oWorksetBar.setSelectedItem(i);this._oFacetBar.setAssociatedItems([]);this._oFacetBar.setSelectedItem(null);if(this.getDomRef()){var r=this.$("facetBar");var n=this._calcFacetBarHeight(r);r.slideUp();this._adaptContentHeight(null,true,n)}}}else{throw new Error("WorksetItem with ID "+s+" cannot be found.")}}return this};E.prototype.setApplyContentPadding=function(e){this.setProperty("applyContentPadding",e,true);this.$().toggleClass("sapUiUx3ShellNoContentPadding",!e);this._adaptContentHeight();return this};E.prototype.setFullHeightContent=function(e){this.setProperty("fullHeightContent",e,true);this.$().toggleClass("sapUiUx3ShellFullHeightContent",e);this._adaptContentHeight();return this};E.prototype._calcFacetBarHeight=function(e){if(this._iFacetBarHeight===undefined){this._iFacetBarHeight=0}if(!e){e=this.$("facetBar")}if(e.length>0){var t=this.$("facetBar").outerHeight(true);this._iFacetBarHeight=Math.max(this._iFacetBarHeight,t)}return this._iFacetBarHeight};E.prototype._adaptContentHeight=function(e,t,s){if(!this.getDomRef()){return}var i=this.$("content");var o=this.$("canvas");if(this.getFullHeightContent()){var a=this.getApplyContentPadding();var r=!a?0:parseInt(o.css("paddingTop"));var n=!a?0:parseInt(o.css("paddingLeft"));var l=!a?0:parseInt(o.css("paddingRight"));var p=s?s:this._calcFacetBarHeight();var d=r+(this._oFacetBar.getAssociatedItems().length>0?p:0)+"px";if(t){i.stop().animate({top:d})}else{i.stop().css("top",d)}var c=this.getNotificationBar();if(c&&!e){e=c.getVisibleStatus()}if(e===B.Default||e===B.Max){i.css("bottom",c.getHeightOfStatus(B.Default))}else{var u=!a?0:parseInt(o.css("paddingBottom"));if(c&&e===B.Min){u+=m.HOVER_ITEM_HEIGHT}i.css("bottom",u+"px")}i.css(this._bRtl?"right":"left",n+"px");i.css(this._bRtl?"left":"right",l+"px")}else{i.removeAttr("style")}if(I.browser.webkit){h.forceRepaint(this.getId()+"-canvas")}};E.prototype._handleDragover=function(t){var s=t.target.id;if(!this._dragOverBlinking){var i=e(document.getElementById(s));i.css("opacity","0.5");this._dragOverBlinking=true;var o=this;window.setTimeout(function(){i.css("opacity","1");window.setTimeout(function(){o._dragOverBlinking=null},300)},300)}return false};E.prototype._handleDragend=function(e){return false};E.prototype._handleDrop=function(t){var s=t.target.id;t.preventDefault();var i=t.originalEvent;var o=i.dataTransfer.files[0];if(o){var a=new window.FileReader;a.onload=e.proxy(function(e){var t=e.target.result;if(s==this.getId()+"-bgImg"){this._getPersonalization()._handleBackgroundImageChange(t,true)}else if(s==this.getId()+"-hdr"){this._getPersonalization()._handleHeaderImageChange(t,true)}else if(s==this.getId()+"-logoImg"){this._getPersonalization()._handleLogoImageChange(t,true)}a=null},this);a.readAsDataURL(o)}};E.prototype._getPersonalization=function(){if(!this.oPersonalization){this.oPersonalization=new r(this)}return this.oPersonalization};E.prototype.openPersonalizationDialog=function(){this._getPersonalization().openDialog()};E.prototype.initializePersonalization=function(e){this._getPersonalization().initializeSettings(e)};E.prototype.onThemeChanged=function(e){this._iFacetBarHeight=undefined;if(!this.getDomRef()){return}var t="";if(!this.getAppIcon()){t=i._getThemeImage("sapUiUx3ShellApplicationImageURL",true);this.$("logoImg").attr("src",t)}t=i._getThemeImage("sapUiUx3ShellHeaderImageURL",true);this.$("hdrImg").attr("src",t);t=i._getThemeImage("sapUiUx3ShellBackgroundImageURL",true);this.$("bgImg").attr("src",t);this.$("facetBar").stop(true,true);this._adaptContentHeight();this._updateThemeVariables();this._checkResize()};return E});