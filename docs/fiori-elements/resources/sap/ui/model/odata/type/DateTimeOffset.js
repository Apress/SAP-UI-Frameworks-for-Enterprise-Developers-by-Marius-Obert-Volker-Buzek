/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/core/CalendarType","sap/ui/core/date/UI5Date","sap/ui/core/format/DateFormat","sap/ui/model/FormatException","sap/ui/model/odata/type/DateTimeBase"],function(t,e,i,o,r,a){"use strict";var n=a.extend("sap.ui.model.odata.type.DateTimeOffset",{constructor:function(e,i){var o;a.call(this,e,{nullable:i?i.nullable:undefined,precision:i?i.precision:undefined});this.rDateTimeOffset=undefined;this.oModelFormat=undefined;this.bV4=false;if(i){o=i.V4;if(o===true){this.bV4=true}else if(o!==undefined&&o!==false){t.warning("Illegal V4: "+o,null,this.getName())}}}});function s(t){var i="yyyy-MM-dd'T'HH:mm:ss",r;if(!t.oModelFormat){r=t.oConstraints&&t.oConstraints.precision;if(r){i+="."+"".padEnd(r,"S")}t.oModelFormat=o.getDateInstance({calendarType:e.Gregorian,pattern:i+"XXX",strictParsing:true,UTC:t.oFormatOptions&&t.oFormatOptions.UTC})}return t.oModelFormat}n.prototype._resetModelFormatter=function(){this.oModelFormat=undefined};n.prototype.formatValue=function(t,e){var o;if(t===undefined||t===null){return null}if(this.getPrimitiveType(e)==="object"){if(t instanceof Date){return i.getInstance(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds())}return s(this).parse(t)}if(typeof t==="string"&&this.getPrimitiveType(e)==="string"){o=s(this).parse(t);if(!o){throw new r("Illegal "+this.getName()+" value: "+t)}t=o}return a.prototype.formatValue.call(this,t,e)};n.prototype.getConstraints=function(){var t=a.prototype.getConstraints.call(this);if(this.bV4){t.V4=true}return t};n.prototype.getModelFormat=function(){if(this.bV4){return s(this)}return a.prototype.getModelFormat.call(this)};n.prototype.getModelValue=function(t){var e=this._getModelValue(t);if(this.bV4&&e!==null){e=this.getModelFormat().format(e)}this.validateValue(e);return e};n.prototype.getName=function(){return"sap.ui.model.odata.type.DateTimeOffset"};n.prototype.parseValue=function(t,e){var i=a.prototype.parseValue.call(this,t,e);return this.bV4&&i!==null?s(this).format(i):i};n.prototype.setV4=function(){this.bV4=true;return this};n.prototype.validateValue=function(t){var e;if(this.bV4){if(typeof t==="string"){if(!this.rDateTimeOffset){e=this.oConstraints&&this.oConstraints.precision;this.rDateTimeOffset=new RegExp("^"+"\\d{4}-(?:0[1-9]|1[0-2])-(?:0[1-9]|[12]\\d|3[01])"+"T"+"(?:[01]\\d|2[0-3]):[0-5]\\d(?::[0-5]\\d"+(e?"(\\.\\d{1,"+e+"})?":"")+")?"+"(?:Z|[-+](?:0\\d|1[0-3]):[0-5]\\d|[-+]14:00)$","i")}if(this.rDateTimeOffset.test(t)){return}}else if(t){t=t.toString()}}a.prototype.validateValue.call(this,t)};return n});