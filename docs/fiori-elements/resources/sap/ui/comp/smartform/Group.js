/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/form/FormContainer","sap/base/Log"],function(t,e,i,r){"use strict";var o;var a=i.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/Group.designtime",properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.IFormGroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_bVisibleElements:false}});a.prototype.init=function(){i.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","label"]})};function s(t){var e=this.getGroupElements();for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartform.SemanticGroupElement")){r.error("useHorizontalLayout can't be used for SemanticGroupElement",this)}else if(e[i].getUseHorizontalLayout()!=t){e[i].setUseHorizontalLayout(t)}}this._updateLayoutData()}a.prototype._updateLayoutData=function(){if(this.getUseHorizontalLayout()){var t=this.getParent();while(t&&!t.addGroup&&t.getParent){t=t.getParent()}if(t){var e=t.getLayout();if(!e||!e.getGridDataSpan()){if(!this.getLayoutData()){if(!o&&!this._bResponsiveFlowLayoutDataRequested){o=sap.ui.require("sap/ui/layout/ResponsiveFlowLayoutData");if(!o){sap.ui.require(["sap/ui/layout/ResponsiveFlowLayoutData"],n.bind(this));this._bResponsiveFlowLayoutDataRequested=true}}if(o&&!this._bResponsiveFlowLayoutDataRequested){var i=new o({linebreak:true,linebreakable:true});i._bCreatedByGroup=true;this.setLayoutData(i)}}}else{this._updateLineBreaks()}}}else{var r=this.getLayoutData();if(r&&r._bCreatedByGroup){this.destroyLayoutData()}}};function n(t){o=t;this._bResponsiveFlowLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._updateLayoutData()}}function l(t){r.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroupElements();for(var i=0;i<e.length;i++){e[i].setHorizontalLayoutGroupElementMinWidth(t)}}a.prototype.setEditMode=function(t){this._setEditable(t);return this};a.prototype._updateLineBreaks=function(){if(!this.getUseHorizontalLayout()){return}var t=this.getParent();if(!t){return}while(t&&!t._getGridDataSpanNumbers&&t.getParent){t=t.getParent()}if(!t._getGridDataSpanNumbers){return}var e=t._getGridDataSpanNumbers();if(!e){return}var i=this.getGroupElements();i=i.filter(function(t){return t.isVisible()});var r=0;var o=0;var a=0;var s=0;var n=false;var l=false;var u=false;var p=false;for(var h=0;h<i.length;h++){var m=i[h];r++;o++;a++;s++;if(e.XL*r>12){n=true;r=1}else{n=false}if(e.L*o>12){l=true;o=1}else{l=false}if(e.M*a>12){u=true;a=1}else{u=false}if(e.S*s>12){p=true;s=1}else{p=false}m._setLinebreak(n,l,u,p)}};a.prototype._updateGridDataSpan=function(){if(!this.getUseHorizontalLayout()){return}var t=this.getGroupElements();for(var e=0;e<t.length;e++){t[e]._updateGridDataSpan()}};a.prototype._updateFormContainerVisibility=function(){var t=this.getGroupElements();var e=false;e=t.some(function(t){return t.isVisible()});if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){this.fireEvent("_visibleChanged")}}};function u(t){var e=this.getTitle();if(e&&typeof e!=="string"){r.error("Title already set, Label can not be set",this)}else{this.setTitle(t)}}a.prototype.setVisible=function(t){var e=this.getVisible();i.prototype.setVisible.apply(this,arguments);if(t!=e||t!=this._bVisibleElements){this.fireEvent("_visibleChanged")}return this};a.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};a.prototype.addGroupElement=function(t){return this.addFormElement(t)};a.prototype.insertGroupElement=function(t,e){return this.insertFormElement(t,e)};a.prototype.getGroupElements=function(){return this.getFormElements()};a.prototype.indexOfGroupElement=function(t){return this.indexOfFormElement(t)};a.prototype.removeGroupElement=function(t){return this.removeFormElement(t)};a.prototype.removeAllGroupElements=function(){return this.removeAllFormElements()};a.prototype.destroyGroupElements=function(){return this.destroyFormElements()};a.prototype.addFormElement=function(t){if(!t){return this}t=this.validateAggregation("groupElements",t,true);p.call(this,t);i.prototype.addFormElement.apply(this,arguments);h.call(this,t);return this};a.prototype.insertFormElement=function(t,e){if(!t){return this}t=this.validateAggregation("groupElements",t,true);p.call(this,t);i.prototype.insertFormElement.apply(this,arguments);h.call(this,t);return this};a.prototype.removeFormElement=function(t){var e=i.prototype.removeFormElement.apply(this,arguments);if(e){e.detachVisibleChanged(this._updateFormContainerVisibility,this);f.call(this,e);this._updateFormContainerVisibility();this._updateLineBreaks()}return e};a.prototype.removeAllFormElements=function(){var t=i.prototype.removeAllFormElements.apply(this,arguments);for(var e=0;e<t.length;e++){var r=t[e];r.detachVisibleChanged(this._updateFormContainerVisibility,this);f.call(this,r)}this._updateFormContainerVisibility();this._updateLineBreaks();return t};a.prototype.destroyFormElements=function(){i.prototype.destroyFormElements.apply(this,arguments);this._updateFormContainerVisibility();this._updateLineBreaks();return this};function p(t){var e,i;if(!t.isA("sap.ui.comp.smartform.SemanticGroupElement")){e=this.getUseHorizontalLayout();i=this.getHorizontalLayoutGroupElementMinWidth();if(i!=t.getHorizontalLayoutGroupElementMinWidth){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}}t.attachVisibleChanged(this._updateFormContainerVisibility,this);m.call(this,t)}function h(t){this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()){t._updateGridDataSpan();this._updateLineBreaks()}}a.prototype.setLayout=function(t){t=this.validateAggregation("layout",t,false);return this.setLayoutData(t)};a.prototype.getLayout=function(){return this.getLayoutData()};a.prototype.destroyLayout=function(t){return this.destroyLayoutData()};a.prototype.addCustomData=function(t){if(!t){return this}i.prototype.addCustomData.apply(this,arguments);var e=this.getGroupElements();for(var r=0;r<e.length;r++){y.call(this,e[r],t)}return this};a.prototype.insertCustomData=function(t,e){if(!t){return this}i.prototype.insertCustomData.apply(this,arguments);var r=this.getGroupElements();for(var o=0;o<r.length;o++){y.call(this,r[o],t)}return this};a.prototype.removeCustomData=function(t){var e=i.prototype.removeCustomData.apply(this,arguments);if(e){var r=this.getGroupElements();for(var o=0;o<r.length;o++){f.call(this,r[o],e.getId())}}return e};a.prototype.removeAllCustomData=function(){var t=i.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){var e=this.getGroupElements();for(var r=0;r<e.length;r++){f.call(this,e[r])}}return t};a.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);var t=this.getGroupElements();for(var e=0;e<t.length;e++){f.call(this,t[e])}return this};function m(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){y.call(this,t,e[i])}}function y(e,i){if(t.smartform.inheritCostomDataToFields(i)){var r=i.clone();r._bFromGroup=true;r._sOriginalId=i.getId();e.addCustomData(r)}}function f(t,e){var i=t.getCustomData();for(var r=0;r<i.length;r++){var o=i[r];if(o._bFromGroup&&(!e||e==o._sOriginalId)){t.removeCustomData(o)}}}a.prototype.clone=function(t,e){var r=this.removeAllGroupElements();var o=i.prototype.clone.apply(this,arguments);for(var a=0;a<r.length;a++){var s=r[a];var n=s.clone(t,e);this.addGroupElement(s);o.addGroupElement(n)}return o};a.prototype._observeChanges=function(t){i.prototype._observeChanges.apply(this,arguments);if(t.name=="label"){u.call(this,t.current)}else if(t.name=="useHorizontalLayout"){s.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){l.call(this,t.current)}};return a});