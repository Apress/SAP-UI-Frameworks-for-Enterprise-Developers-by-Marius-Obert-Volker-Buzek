/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/ColumnMicroChartData","sap/suite/ui/microchart/ColumnMicroChartLabel","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,a,i,e,o,r,n,s,h,l,c,p){"use strict";var u=c.extend("sap.ui.comp.smartmicrochart.SmartColumnMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartColumnMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Column"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Column",true);this.setAggregation("_chart",new s,true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var a;if(this.getShowLabel()!==t){a=this.getAggregation("_chart");this.setProperty("showLabel",t,true);a.setProperty("showTopLabels",t,true);a.setProperty("showBottomLabels",t,true);a.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}var t=this.getAggregation("_chart"),a=new h({value:{path:this._aDataPointAnnotations[0].Value.Path,type:"sap.ui.model.odata.type.Decimal"}});if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){a.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){a.bindProperty("label",this._aDataPointAnnotations[0].Title.Path)}var i=this._getPropertyAnnotation.call(this,this._aDataPointAnnotations[0].Value.Path);var e=i["com.sap.vocabularies.Common.v1.Text"];if(e&&e.Path){t.setAllowColumnLabels(true);a.bindProperty("displayValue",e.Path)}t.bindAggregation("columns",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}});this._createChartLabels()};u.prototype._createChartLabels=function(){var t,a=this._getLabelsMap();for(var i in a){t=new l;this.getAggregation("_chart").setAggregation(a[i],t,true)}};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("columns");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,a){var i=this.getAggregation("_chart").getAggregation(t);if(i!==null){i.setProperty("label",a.text,true);if(a.color){i.setProperty("color",a.color,true)}}};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});