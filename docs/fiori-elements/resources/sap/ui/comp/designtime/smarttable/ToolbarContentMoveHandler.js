/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/comp/smarttable/flexibility/Utils","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Core"],function(e,t,r){"use strict";var o={};function a(e){var t=e.getMetadata().getName();var r=t.slice(t.lastIndexOf(".")+1)+" - ";if(e.getText&&e.getText()){r=r+e.getText()}else if(e.getTooltip_AsString&&e.getTooltip_AsString()){r=r+e.getTooltip_AsString()}else{r=r+e.getId()}return r}function n(e,t){var r=[];for(var o=0;o<e.length;o++){if(!e[o].hasStyleClass("sapUiCompSmartTableToolbarContent")&&e[o]!=t._oSeparator){r.push(e[o])}}return r}o.isEnabled=function(e){var t=e.getCustomToolbar();if(t&&!t.hasStyleClass("sapUiCompSmartTableToolbar")){var r=n(t.getContent(),e);return r.length>2}return false};o.handleToolbarSettings=function(t,o){return new Promise(function(s,l){sap.ui.require(["sap/m/p13n/Popup","sap/m/p13n/SelectionPanel"],function(i,u){var p=[];var T=[];var c=t.getCustomToolbar();var g=n(c.getContent(),t);var f=e.getAppComponentForControl(t)||null;for(var C=0;C<g.length;C++){var v=e.getSelectorForControl(g[C],f);p.push({visible:true,name:v.id,label:a(g[C]),selector:v});T.push(v)}var d=new u({title:r.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RTA_REARRANGE_TOOLBAR_CONTENT_TABLE_TITLE"),enableCount:false,showHeader:false});var m=new i({title:r.getLibraryResourceBundle("sap.ui.comp").getText("SMARTTABLE_RTA_REARRANGE_TOOLBAR_CONTENT_TITLE"),close:function(e){var r=e.getParameter("reason");if(r==="Cancel"){m.destroy();l();return}p=d.getP13nData();m.destroy();var o=false;var a=[];for(var n=0;n<p.length;n++){a.push(p[n].selector);if(T[n].id!=a[n].id){o=true}}if(o){s([{selectorControl:t,changeSpecificData:{changeType:"ToolbarContentMove",content:{order:a}}}])}else{l()}},panels:[d]});d.getSelectedFields=function(){var e=[];this._loopItems(this._oListControl,function(t,r){e.push(r)});return e};d._oListControl.setMode("None");d.setP13nData(p);m.open(c);m.addStyleClass(o.styleClass)})})};return o});