/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
sap.ui.define(["./VoBase","./library"],function(t,e){"use strict";var r=t.extend("sap.ui.vbm.Route",{metadata:{library:"sap.ui.vbm",properties:{position:{type:"string",group:"Misc",defaultValue:null},color:{type:"string",group:"Misc",defaultValue:"RGB(0;0;0)"},start:{type:"string",group:"Misc",defaultValue:"0"},end:{type:"string",group:"Misc",defaultValue:"0"},linewidth:{type:"string",group:"Misc",defaultValue:"3"},dotcolor:{type:"string",group:"Misc",defaultValue:"RGB(0;0;0)"},dotbordercolor:{type:"string",group:"Misc",defaultValue:"RGB(0;0;0)"},colorBorder:{type:"string",group:"Misc"},lineDash:{type:"string",group:"Misc"},dotwidth:{type:"string",group:"Misc",defaultValue:"0"},routetype:{type:"sap.ui.vbm.RouteType",group:"Misc",defaultValue:"Straight"},directionIndicator:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{dragSource:{type:"sap.ui.vbm.DragSource",multiple:true,singularName:"dragSource"},dropTarget:{type:"sap.ui.vbm.DropTarget",multiple:true,singularName:"dropTarget"}},events:{}}});r.prototype.openContextMenu=function(t){this.oParent.openContextMenu("Route",this,t)};r.prototype.getDataElement=function(){var e=t.prototype.getDataElement.apply(this,arguments);var r=this.oParent.mBindInfo;if(r.P){if(this.getRoutetype()=="Geodesic"){var i=this.getPosition().split(";");var a=i.length;var s=i.slice(0,3);var o=i.slice(a-3,a);var n=this.calcGeodesicRoute(s,o);e.P=s[0]+";"+s[1]+";0.0;"+n+o[0]+";"+o[1]+";0.0"}else{e.P=this.getPosition()}}if(r.C){e.C=this.getColor()}if(r.ST){e.ST=this.getStart()}if(r.ED){e.ED=this.getEnd()}if(r.LW){e.LW=this.getLinewidth()}if(r.DC){e.DC=this.getDotcolor()}if(r.DBC){e.DBC=this.getDotbordercolor()}if(r.CB){var u=this.getColorBorder();if(u!=undefined&&u!=""){e.CB=u}}if(r.LD){var h=this.getLineDash();if(h!=undefined&&h!=""){e.LD=h}}if(r.DW){e.DW=this.getDotwidth()}if(r.DS||r.DT){e.N=this.getDragDropDefs()}if(r.DI){e.DI=this.getDirectionIndicator()}return e};r.prototype.handleChangedData=function(t){if(t.P){this.setPosition(t.P)}};r.prototype.dot=function(t,e){var r=0;r=t[1]*e[1]+t[2]*e[2]+t[3]*e[3];return r};r.prototype.cross=function(t,e){var r=new Array(4);r[1]=t[2]*e[3]-t[3]*e[2];r[2]=t[3]*e[1]-t[1]*e[3];r[3]=t[1]*e[2]-t[2]*e[1];return r};r.prototype.radians=function(t){return t*Math.PI/180};r.prototype.degrees=function(t){return t*180/Math.PI};r.prototype.calcGeodesicRoute=function(t,e){var r=new Array(4);var i=new Array(4);var a=new Array(4);var s=new Array(4);var o=new Array(4);r[1]=Math.cos(this.radians(t[1]))*Math.cos(this.radians(t[0]));r[2]=Math.cos(this.radians(t[1]))*Math.sin(this.radians(t[0]));r[3]=Math.sin(this.radians(t[1]));i[1]=Math.cos(this.radians(e[1]))*Math.cos(this.radians(e[0]));i[2]=Math.cos(this.radians(e[1]))*Math.sin(this.radians(e[0]));i[3]=Math.sin(this.radians(e[1]));a=this.cross(r,i);var n=Math.sqrt(this.dot(a,a));s[1]=a[1]/n;s[2]=a[2]/n;s[3]=a[3]/n;o=this.cross(s,r);var u=new Array(101);var h=new Array(201);var p;for(p=0;p<=100;p++){u[p]=new Array(4);h[p]=new Array(4)}var d=Math.acos(this.dot(r,i));var c="";for(p=0;p<=100;p++){var g=p/100*d;u[p][0]=0;u[p][1]=Math.cos(g)*r[1]+Math.sin(g)*o[1];u[p][2]=Math.cos(g)*r[2]+Math.sin(g)*o[2];u[p][3]=Math.cos(g)*r[3]+Math.sin(g)*o[3];h[p][0]=0;h[p][1]=this.degrees(Math.atan2(u[p][2],u[p][1]));h[p][2]=this.degrees(Math.asin(u[p][3]));c+=h[p][1]+";"+h[p][2]+"; 0 "+";"}return c};return r});