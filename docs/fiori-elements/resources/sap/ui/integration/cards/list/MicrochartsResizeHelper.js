/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/core/ResizeHandler","sap/ui/base/ManagedObjectObserver"],function(e,i,t){"use strict";var s=e.extend("sap.ui.integration.cards.list.MicrochartsResizeHelper",{constructor:function(i){e.call(this);this._oItemDelegate={onAfterRendering:this._onAfterItemRendering};this._oList=i;this._oItemsObserver=new t(this._onItemChange.bind(this));this._oItemsObserver.observe(i,{aggregations:["items"]})}});s.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._iMicrochartsResizeHandler){i.deregister(this._iMicrochartsResizeHandler);this._iMicrochartsResizeHandler=undefined}if(this._iResizeMicrochartsTimeout){clearTimeout(this._iResizeMicrochartsTimeout);this._iResizeMicrochartsTimeout=null}this._oItemsObserver=null;this._oItemDelegate=null};s.prototype._onItemChange=function(e){if(e.name!=="items"||!e.child||!e.child.getMicrochart()){return}if(e.mutation==="insert"){e.child.getMicrochart().addEventDelegate(this._oItemDelegate,this)}else if(e.mutation==="remove"){e.child.getMicrochart().removeEventDelegate(this._oItemDelegate,this)}};s.prototype._onAfterItemRendering=function(){this._scheduleResizeMicrocharts()};s.prototype._scheduleResizeMicrocharts=function(){if(this._iResizeMicrochartsTimeout){clearTimeout(this._iResizeMicrochartsTimeout);this._iResizeMicrochartsTimeout=null}this._iResizeMicrochartsTimeout=setTimeout(function(){this._resizeMicrocharts()}.bind(this),0)};s.prototype._resizeMicrocharts=function(){var e=this._oList.$().find(".sapUiIntMicrochartChart"),t=Number.MAX_VALUE;if(e.length===0){return}e.each(function(e,i){t=Math.min(t,i.offsetWidth)});e.find(".sapUiIntMicrochartChartInner").css("max-width",t+"px");if(!this._iMicrochartsResizeHandler){this._iMicrochartsResizeHandler=i.register(this._oList,this._resizeMicrocharts.bind(this))}};return s});