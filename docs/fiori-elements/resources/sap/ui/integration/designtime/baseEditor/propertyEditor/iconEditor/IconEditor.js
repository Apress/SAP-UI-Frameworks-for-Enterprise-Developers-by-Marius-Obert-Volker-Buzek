/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/core/ListItem","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/IconPool","sap/ui/base/BindingParser","./IsInIconPool.validator"],function(t,e,o,i,a,n,r,s,l){"use strict";var d=null;var g=t.extend("sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditor",{xmlFragment:"sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditor",metadata:{library:"sap.ui.integration"},renderer:t.getMetadata().getRenderer().render});g.configMetadata=Object.assign({},t.configMetadata,{typeLabel:{defaultValue:"BASE_EDITOR.TYPES.SIMPLEICON"}});g.prototype.onFragmentReady=function(){var t=this.getContent();this._oIconModel=this._getIconModel();t.setModel(this._oIconModel,"icons");t.bindAggregation("suggestionItems","icons>/",new e({text:"{icons>path}",additionalText:"{icons>name}"}))};g.prototype._getIconModel=function(){if(!d){d=new i(r.getIconNames().map(function(t){return{name:t,path:"sap-icon://"+t}}))}return d};g.prototype._onChange=function(t){var e=t.getParameter("value");this.setValue(e)};g.prototype._onSuggestionItemSelected=function(t){this.setValue(t.getParameter("selectedItem").getText())};g.prototype._getDefaultSearchValue=function(t){try{var e=s.complexParser(t);return e?"":t}catch(e){return t}};g.prototype._handleValueHelp=function(t){var e=t.getSource().getValue();if(!this._oDialog){return o.load({name:"sap.ui.integration.designtime.baseEditor.propertyEditor.iconEditor.IconEditorDialog",controller:this}).then(function(t){this._oDialog=t;this.addDependent(this._oDialog);this._oDialog.setModel(this._oIconModel);this._filter(e);this._oDialog.open(this._getDefaultSearchValue(e));return this._oDialog}.bind(this))}else{this._filter(e);this._oDialog.open(this._getDefaultSearchValue(e));return Promise.resolve(this._oDialog)}};g.prototype.handleSearch=function(t){var e=t.getParameter("value");this._filter(e)};g.prototype._filter=function(t){var e=new a("path",n.Contains,t);var o=this._oDialog.getBinding("items");o.filter([e])};g.prototype.handleClose=function(t){var e=t.getParameter("selectedItem");if(e){this.setValue(e.getIcon())}t.getSource().getBinding("items").filter([])};g.prototype.getDefaultValidators=function(){return Object.assign({},t.prototype.getDefaultValidators.call(this),{isValidBinding:{type:"isValidBinding"},isInIconPool:{type:"isInIconPool"}})};g.prototype.getDefaultValidatorModules=function(){return Object.assign({},t.prototype.getDefaultValidatorModules.apply(this,arguments),{isInIconPool:l})};return g});