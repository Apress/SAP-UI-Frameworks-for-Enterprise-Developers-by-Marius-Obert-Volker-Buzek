/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/integration/designtime/baseEditor/propertyEditor/mapEditor/MapEditor","sap/base/util/restricted/_merge","sap/base/util/deepEqual"],function(e,t,a,r){"use strict";var i=t.extend("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersEditor",{metadata:{library:"sap.ui.integration"},renderer:e.getMetadata().getRenderer().render});i.configMetadata=Object.assign({},t.configMetadata,{allowLabelChange:{defaultValue:true,mergeStrategy:"mostRestrictiveWins"}});i.prototype.getBoolenValue=function(e,t,a){if(typeof e==="boolean"){return e}if(typeof t==="boolean"){return t}return a};i.prototype.formatItemConfig=function(e){var a=t.prototype.formatItemConfig.apply(this,arguments);var r=e.key;var i=e.value.type;var l=this.getNestedDesigntimeMetadataValue(r);var o=this.getBoolenValue(e.value.visible,l.visible,true);var n=this.getBoolenValue(e.value.visibleToUser,l.visibleToUser,true);var s=this.getBoolenValue(e.value.editable,l.editable,true);var p=this.getBoolenValue(e.value.editableToUser,l.editableToUser,true);var u=this.getBoolenValue(e.value.required,l.required,false);var E=this.getBoolenValue(e.value.expanded,l.expanded,true);var g=e.value.level||l.level||"0";var R=e.value.manifestpath||l.manifestpath||"";var v=e.value.description||l.description||"";var y=this.getBoolenValue(e.value.translatable,l.translatable,false);var d=this.getBoolenValue(e.value.allowSettings,l.allowSettings,true);var A=this.getBoolenValue(e.value.allowDynamicValues,l.allowDynamicValues,false);var b=e.value.visualization||l.visualization;var h=e.value.values||l.values;var I=e.value.properties||l.properties;var T=e.value.label||l.label;var D=e.value.placeholder||l.placeholder||"";var P=e.value.validations||l.validations;var m=e.value.hint||l.hint||"";var c=e.value.formatter||l.formatter;var O=e.value.layout||l.layout;a[2].visible=!(i==="group"||i==="array"||i==="separator");a.push({label:this.getI18nProperty("CARD_EDITOR.LABEL"),path:"label",value:T,placeholder:T?undefined:r,visible:i!=="separator",type:"string",enabled:this.getConfig().allowLabelChange,itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.LEVEL"),path:"level",value:g,type:"select",items:[{key:"0",title:"0"},{key:"1",title:"1"}],visible:i==="group",itemKey:r,allowBindings:true},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.DESCRIPTION"),path:"description",value:v,allowBindings:true,visible:i!=="group"&&i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.HINT"),path:"hint",value:m,allowBindings:true,enabled:true,visible:i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.FORMATTER"),path:"formatter",value:c,allowBindings:true,enabled:true,visible:i==="date"||i==="datetime"||i==="number"||i==="integer",type:"code",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.PLACEHOLDER"),path:"placeholder",value:D,allowBindings:true,visible:i==="string",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.MANIFESTPATH"),path:"manifestpath",value:R,allowBindings:true,visible:i!=="group"&&i!=="separator",type:"string",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISIBLE"),path:"visible",value:o,allowBindings:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISIBLETOUSER"),path:"visibleToUser",value:n,allowBindings:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EDITABLE"),path:"editable",allowBindings:true,value:s,enabled:true,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EDITABLETOUSER"),path:"editableToUser",allowBindings:true,value:p,enabled:true,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.REQUIRED"),path:"required",allowBindings:true,value:u,visible:i==="string"||i==="number"||i==="integer",enabled:true,type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.EXPANDED"),path:"expanded",allowBindings:true,value:E,enabled:true,visible:i==="group",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.TRANSLATABLE"),path:"translatable",value:y,enabled:true,visible:i==="string",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWDYNAMICVALUES"),path:"allowDynamicValues",allowBindings:true,enabled:true,value:A,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.ALLOWSETTINGS"),path:"allowSettings",allowBindings:true,value:d,visible:i!=="group"&&i!=="separator",type:"boolean",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION"),path:"visualization",allowBindings:true,value:b,visible:i!=="separator"&&i!=="object"&&i!=="objectArray",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VISUALIZATION.PLACEHOLDER"),type:"code",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS"),path:"validations",allowBindings:true,value:P,visible:i==="string"||i==="number"||i==="integer"||i==="boolean",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALIDATIONS.PLACEHOLDER"),type:"code",codeType:"javascript",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES"),path:"values",allowBindings:true,value:h,visible:i==="string"||i==="array"||i==="object"||i==="objectArray",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.VALUES.PLACEHOLDER"),type:"code",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.PROPERTIES"),path:"properties",allowBindings:true,value:I,visible:i==="object"||i==="objectArray",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.PROPERTIES.PLACEHOLDER"),type:"code",itemKey:r},{label:this.getI18nProperty("CARD_EDITOR.PARAMETERS.LAYOUT"),path:"layout",allowBindings:true,value:O,visible:i!=="group"&&i!=="separator",placeholder:this.getI18nProperty("CARD_EDITOR.PARAMETERS.LAYOUT.PLACEHOLDER"),type:"code",itemKey:r});return a};i.prototype.processInputValue=function(e){return e};i.prototype.processOutputValue=function(e){return e};i.prototype._configItemsFormatter=function(e){return Array.isArray(e)?e.map(function(e){var t=this.getNestedDesigntimeMetadataValue(e.key);var r=a({},e.value,t);if(!r.label){r.label=e.key}r.itemKey=e.key;r.path="value";r.designtime=this.getNestedDesigntimeMetadata(e.key);return r}.bind(this)):[]};i.prototype.getItemChangeHandlers=function(){return Object.assign({},t.prototype.getItemChangeHandlers.apply(this,arguments),{label:this._onDesigntimeChange})};i.prototype.onBeforeConfigChange=function(e){if(!e.allowTypeChange&&!e.allowKeyChange){this.setFragment("sap.ui.integration.designtime.cardEditor.propertyEditor.parametersEditor.ParametersConfigurationEditor",function(){return 1})}return e};i.prototype._isValidItem=function(e,t){var a=t.type;var r=t.value;var i=this._getAllowedTypes();return a&&i.includes(a)||typeof r==="string"&&i.includes("string")};return i});