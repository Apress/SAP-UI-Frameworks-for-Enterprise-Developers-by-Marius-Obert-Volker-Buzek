/*!
	* OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
	*/
sap.ui.define(["sap/ui/fl/changeHandler/MoveControls","sap/ui/core/Core","sap/base/util/merge","sap/ui/thirdparty/jquery"],function(e,r,n,t){"use strict";var a=t.extend({},e);a.applyChange=function(r,n,t){var a=t.modifier.targets==="jsControlTree";if(a){n._suppressScroll()}var o=e.applyChange.call(this,r,n,t);if(a){n.attachEventOnce("onAfterRenderingDOMReady",function(){n._resumeScroll(false)})}return o};a.revertChange=function(r,n,t){var a=t.modifier.targets==="jsControlTree";if(a){n._suppressScroll()}var o=e.revertChange.call(this,r,n,t);if(a){n.attachEventOnce("onAfterRenderingDOMReady",function(){n._resumeScroll(false)})}return o};a.completeChangeContent=function(n,t,a){var o=r.byId(t.source.id),i=r.byId(t.target.id);var s=Promise.resolve();if(o.isA("sap.uxap.AnchorBar")&&i.isA("sap.uxap.AnchorBar")){s=s.then(this._mapAnchorsToSections.bind(this,t,a))}return s.then(function(){return e.completeChangeContent.apply(this,arguments[0])}.bind(this,arguments))};a._mapAnchorsToSections=function(e,t){return Promise.resolve().then(function(){var a,o;var i=t.modifier;var s=i.bySelector(e.selector,t.appComponent,t.view);var c=s._getVisibleSections();function u(e){var n=r.byId(e),t=n.data("sectionId");return r.byId(t)}var l=[];e.movedElements.forEach(function(e){var r=c[e.targetIndex];var n=Promise.resolve().then(function(){return i.findIndexInParentAggregation(r)}).then(function(r){e.targetIndex=r;a=u(e.id);if(!a||!a.getParent()){throw new Error("Cannot map anchor to section")}o={id:a.getParent().getId(),aggregation:a.sParentAggregationName};e.id=a.getId()});l.push(n)});return Promise.all(l).then(function(){n(e.source,o);n(e.target,o)})})};return a},true);