/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../i18n","sap/m/Toolbar","sap/m/library","sap/m/Button","sap/m/Link","sap/m/ToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/ActionSheet","sap/ui/core/InvisibleText","sap/ui/core/IconPool","sap/ui/core/delegate/ItemNavigation","sap/ui/core/Control"],function(e,t,a,r,o,i,n,s,l,c,u,g){function d(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function h(e,t){var a=typeof Symbol!=="undefined"&&e[Symbol.iterator]||e["@@iterator"];if(!a){if(Array.isArray(e)||(a=f(e))||t&&e&&typeof e.length==="number"){if(a)e=a;var r=0;var o=function(){};return{s:o,n:function(){if(r>=e.length)return{done:true};return{done:false,value:e[r++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,n=false,s;return{s:function(){a=a.call(e)},n:function(){var e=a.next();i=e.done;return e},e:function(e){n=true;s=e},f:function(){try{if(!i&&a.return!=null)a.return()}finally{if(n)throw s}}}}function f(e,t){if(!e)return;if(typeof e==="string")return v(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);if(a==="Object"&&e.constructor)a=e.constructor.name;if(a==="Map"||a==="Set")return Array.from(e);if(a==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return v(e,t)}function v(e,t){if(t==null||t>e.length)t=e.length;for(var a=0,r=new Array(t);a<t;a++){r[a]=e[a]}return r}var p=d(e);var b=a["ToolbarDesign"];var m=a["ButtonType"];var y=a["PlacementType"];var _=g.extend("sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",{renderer:{apiVersion:2,render:function e(t,a){t.openStart("div",a);t["class"]("sapUshellSearchResultListItem-RelatedObjectsToolbar");var r=a.getModel();if(r.config.optimizeForValueHelp){t["class"]("sapUshellSearchResultListItem-RelatedObjectsToolbarValueHelp")}t.openEnd();t.renderControl(a.getAggregation("_ariaDescriptionForLinks"));a._renderToolbar(t,a);t.close("div")}},metadata:{properties:{itemId:"string",navigationObjects:{type:"object",multiple:true},positionInList:"int"},aggregations:{_relatedObjectActionsToolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"},_ariaDescriptionForLinks:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_overFlowSheet:{type:"sap.m.ActionSheet",multiple:false,visibility:"hidden"}}},constructor:function e(a,o){g.prototype.constructor.call(this,a,o);_._allOfMyCurrentInstances.push(this);var i=new t("".concat(this.getId(),"--toolbar"),{design:b.Solid});i.data("sap-ui-fastnavgroup","false",true);i.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Toolbar");this.setAggregation("_relatedObjectActionsToolbar",i);var n=new r("".concat(this.getId(),"--overflowButton"),{icon:c.getIconURI("overflow")});var u=new s("".concat(this.getId(),"--actionSheet"),{placement:y.Top});this.setAggregation("_overFlowSheet",u);n.attachPress(function(){u.openBy(n)});this._overFlowButton=n;i.addContent(n);this.setAggregation("_ariaDescriptionForLinks",new l({text:p.getText("result_list_item_aria_has_more_links")}));$(window).on("resize",function(){for(var e=0;e<_._allOfMyCurrentInstances.length;e++){_._allOfMyCurrentInstances[e].layoutToolbarElements()}})},exit:function e(){if(sap.ui.core.Control.prototype.exit){for(var t=arguments.length,a=new Array(t),r=0;r<t;r++){a[r]=arguments[r]}sap.ui.core.Control.prototype.exit.apply(this,a)}var o=_._allOfMyCurrentInstances;for(var i=0;i<o.length;i++){if(o[i]===this){o.splice(i,1);break}}if(this._searchLayoutChangedIsSubscribed){this._searchLayoutChangedIsSubscribed=false;this.getModel().unsubscribe("ESHSearchLayoutChanged",this.layoutToolbarElements,this)}},_renderToolbar:function e(t,a){var r=a.getModel();var s=a.getAggregation("_relatedObjectActionsToolbar");var l=h(s.getContent()),c;try{for(l.s();!(c=l.n()).done;){var u=c.value;if(u!==this._overFlowButton){u.destroy()}}}catch(e){l.e(e)}finally{l.f()}if(r.config.optimizeForValueHelp){s.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-ToolbarValueHelp")}var g=function e(t){return function(e){a._performNavigation(t,{trackingOnly:true,event:e})}};var d=a.getProperty("navigationObjects");if(d.length>0){var f=[];for(var v=0;v<d.length;v++){var p=d[v];var b=new o("".concat(a.getId(),"--link_").concat(v),{text:p.getText(),href:p.getHref(),layoutData:new i({shrinkable:false}),press:g(p)});var y=p.getTarget();if(y){b.setTarget(y)}b.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");f.push(b)}var _=new n;_.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Spacer");s.addContent(_);for(var T=0;T<f.length;T++){s.addContent(f[T])}if(r.config.optimizeForValueHelp){this._overFlowButton.addStyleClass("sapUiSmallMarginBegin");this._overFlowButton.addStyleClass("sapUiTinyMarginEnd");this._overFlowButton.setType(m.Transparent)}t.renderControl(s)}},onAfterRendering:function e(){if((new Date).getMilliseconds()-this._lastAfterRenderingTime<100){return}if(this.getAggregation("_relatedObjectActionsToolbar")){this.layoutToolbarElements();this._addAriaInformation()}if(!this._searchLayoutChangedIsSubscribed){this.getModel().subscribe("ESHSearchLayoutChanged",this.layoutToolbarElements,this);this._searchLayoutChangedIsSubscribed=true}this._lastAfterRenderingTime=(new Date).getMilliseconds()},layoutToolbarElements:function e(){var t=this;var a=this.getAggregation("_relatedObjectActionsToolbar");if(!(this.getDomRef()&&a.getDomRef())){return}var o=$(a.getDomRef());var i=o.width();if($(this.getDomRef()).css("display")==="none"||o.css("display")==="none"){return}this.toolbarWidth=i;var n=$(this._overFlowButton.getDomRef());n.css("display","none");var s=0;var l=function e(a,r){t._performNavigation(r,{event:a})};var c=o.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");for(var u=0;u<c.length;u++){var g=$(c[u]);g.css("display","");var d=s+g.outerWidth(true);if(d>i){if(u<c.length){n.css("display","");var h=n.outerWidth(true);for(;u>=0;u--){g=$(c[u]);d-=g.outerWidth(true);if(d+h<=i){break}}}var f=this.getProperty("navigationObjects");var v=this.getAggregation("_overFlowSheet");v.destroyButtons();u=u>=0?u:0;for(;u<c.length;u++){g=$(c[u]);g.css("display","none");var p=f[u];var b=new r({text:p.getText()});b.attachPress(p,l);v.addButton(b)}break}s=d}this._setupItemNavigation()},_setupItemNavigation:function e(){if(!this._theItemNavigation){this._theItemNavigation=new u(null,[]);this["addDelegate"](this._theItemNavigation)}this._theItemNavigation.setCycling(false);this._theItemNavigation.setRootDomRef(this.getDomRef());var t=[];var a=this.getAggregation("_relatedObjectActionsToolbar");var r=a.getContent();for(var o=0;o<r.length;o++){if(!r[o].hasStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element")){continue}if(!$(r[o].getDomRef()).attr("tabindex")){var i="-1";if(r[o]["getPressed"]&&r[o]["getPressed"]()){i="0"}$(r[o].getDomRef()).attr("tabindex",i)}t.push(r[o].getDomRef())}var n=this._overFlowButton.getDomRef();t.push(n);$(n).attr("tabindex","-1");this._theItemNavigation.setItemDomRefs(t)},_addAriaInformation:function e(){var t=$(this.getAggregation("_relatedObjectActionsToolbar").getDomRef());var a=t.find(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");var r=$(this._overFlowButton.getDomRef());if(a.length>0||r.is(":visible")){var o=this.getAggregation("_ariaDescriptionForLinks").getId();a.each(function(){var e=$(this);var t=e.attr("aria-describedby")||"";t+=" "+o;e.attr("aria-describedby",t)});if(r.is(":visible")){var i=r.attr("aria-describedby")||"";i+=" "+o;r.attr("aria-describedby",i)}}},_performNavigation:function e(t,a){var r=(a===null||a===void 0?void 0:a.trackingOnly)||false;var o=a===null||a===void 0?void 0:a.event;t.performNavigation({trackingOnly:r,event:o})}});_._allOfMyCurrentInstances=[];return _})})();