/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../../core/core","./Configurator"],function(e,t){function n(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function i(e,t,n){if(t)r(e.prototype,t);if(n)r(e,n);Object.defineProperty(e,"prototype",{writable:false});return e}function o(e,t){if(typeof t!=="function"&&t!==null){throw new TypeError("Super expression must either be null or a function")}e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:true,configurable:true}});Object.defineProperty(e,"prototype",{writable:false});if(t)u(e,t)}function u(e,t){u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return u(e,t)}function c(e){var t=s();return function n(){var r=l(e),i;if(t){var o=l(this).constructor;i=Reflect.construct(r,arguments,o)}else{i=r.apply(this,arguments)}return f(this,i)}}function f(e,t){if(t&&(typeof t==="object"||typeof t==="function")){return t}else if(t!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return a(e)}function a(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function s(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(e){return false}}function l(e){l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function e(t){return t.__proto__||Object.getPrototypeOf(t)};return l(e)}var h=t["Configurator"];var p=function(t){o(u,t);var r=c(u);function u(){n(this,u);return r.apply(this,arguments)}i(u,[{key:"initAsync",value:function e(){this.elements=[];this.cache={};var t=[];for(var n=0;n<this.configuration.length;++n){var r=this.configuration[n];t.push(this.createElementConfiguratorAsync(this.type,r,n))}return Promise.all(t)}},{key:"isSuitable",value:function t(n){if(n.typeContext&&n.typeContext.multiple&&e.isList(n.configuration)){return true}}},{key:"createElementConfiguratorAsync",value:function e(t,n,r){return this.createConfiguratorAsync({type:t,configuration:n}).then(function(e){this.elements.push({configuration:n,configurator:e,id:r})}.bind(this))}},{key:"getElement",value:function e(t){var n=this.typeContext.getElementId(t);var r=this.cache[n];if(r){return r}for(var i=0;i<this.elements.length;++i){r=this.elements[i];if(this.matchId(t,r)){this.cache[n]=r;return r}}}},{key:"matchId",value:function t(n,r){var i=this.typeContext.getElementId(n);var o=this.typeContext.getElementId(r.configuration);var u;if(e.isObject(o)&&Object.prototype.hasOwnProperty.call(o,"regExp")){if(!o.regExpObj){o.regExpObj=new RegExp(o.regExp,o.regExpFlags)}u=o.regExpObj.test(i)}else{u=i===o}return u}},{key:"createEmptyUsedElements",value:function e(){var t=[];for(var n=0;n<this.elements.length;++n){t.push(false)}return t}},{key:"configure",value:function e(t,n){if(!t){t=[]}n=this.createContext(n,t);var r=this.createEmptyUsedElements();var i,o,u;for(var c=0;c<t.length;++c){o=t[c];i=this.getElement(o);if(!i){continue}var f=i.configurator.configure(o,n);if(f!==o){t[c]=f}r[i.id]={index:c}}var a;var s=0;if(this.typeContext.createElement){for(var l=0;l<r.length;++l){var h=r[l];i=this.elements[l];if(h){a=h;continue}var p=this.typeContext.createElement(i.configuration,n);u=i.configurator.configure(p,n);var y=(a?a.index:-1)+s+1;t.splice(y,0,u);s++;if(this.typeContext.postProcessCreatedElement){this.typeContext.postProcessCreatedElement(u,n)}}}return t}},{key:"configureAsync",value:function e(t,n){if(!t){t=[]}n=this.createContext(n,t);var r=this.createEmptyUsedElements();var i;var o=0;var u=function(e){if(e>=t.length){return null}var i=t[e];var o=this.getElement(i);if(!o){return u(e+1)}r[o.id]={index:e};return Promise.resolve().then(function(){return o.configurator.configureAsync(i,n)}).then(function(n){if(n!==i){t[e]=n}return u(e+1)})}.bind(this);var c=function(e){if(e>=this.elements.length){return null}var u=this.elements[e];var f=r[e];if(f){i=f;return c(e+1)}var a=this.typeContext.createElement(u.configuration,n);return Promise.resolve().then(function(){return u.configurator.configureAsync(a,n)}).then(function(r){var u=(i?i.index:-1)+o+1;t.splice(u,0,r);o++;if(this.typeContext.postProcessCreatedElement){this.typeContext.postProcessCreatedElement(r,n)}return c(e+1)}.bind(this))}.bind(this);return Promise.resolve().then(function(){return u(0)}).then(function(){if(!this.typeContext.createElement){return null}return c(0)}.bind(this)).then(function(){return t})}}]);return u}(h);var y={__esModule:true};y.ListConfigurator=p;return y})})();