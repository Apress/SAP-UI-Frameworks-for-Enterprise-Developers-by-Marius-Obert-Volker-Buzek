/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){function t(t,e,r){if(r){return e?e(t):t}if(!t||!t.then){t=Promise.resolve(t)}return e?t.then(e):t}sap.ui.define(["../../sina/SinaObject","../../sina/AttributeType","../abap_odata/Provider"],function(e,r,n){function a(t,e){var r=typeof Symbol!=="undefined"&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=o(t))||e&&t&&typeof t.length==="number"){if(r)t=r;var n=0;var a=function(){};return{s:a,n:function(){if(n>=t.length)return{done:true};return{done:false,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,u=false,s;return{s:function(){r=r.call(t)},n:function(){var t=r.next();i=t.done;return t},e:function(t){u=true;s=t},f:function(){try{if(!i&&r.return!=null)r.return()}finally{if(u)throw s}}}}function i(t){return l(t)||s(t)||o(t)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(t,e){if(!t)return;if(typeof t==="string")return c(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);if(r==="Object"&&t.constructor)r=t.constructor.name;if(r==="Map"||r==="Set")return Array.from(t);if(r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return c(t,e)}function s(t){if(typeof Symbol!=="undefined"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function l(t){if(Array.isArray(t))return c(t)}function c(t,e){if(e==null||e>t.length)e=t.length;for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function f(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function p(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||false;n.configurable=true;if("value"in n)n.writable=true;Object.defineProperty(t,n.key,n)}}function d(t,e,r){if(e)p(t.prototype,e);if(r)p(t,r);Object.defineProperty(t,"prototype",{writable:false});return t}function v(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});if(e)h(t,e)}function h(t,e){h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,r){e.__proto__=r;return e};return h(t,e)}function b(t){var e=g();return function r(){var n=_(t),a;if(e){var i=_(this).constructor;a=Reflect.construct(n,arguments,i)}else{a=n.apply(this,arguments)}return y(this,a)}}function y(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}else if(e!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return m(t)}function m(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function g(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(t){return false}}function _(t){_=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(e){return e.__proto__||Object.getPrototypeOf(e)};return _(t)}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var S=e["SinaObject"];var I=r["AttributeType"];var A=n["Provider"];var R=function(e){v(n,e);var r=b(n);function n(t){var e;f(this,n);e=r.call(this,t);e._searchResultSetItem=t.searchResultSetItem;e._dataSource=t.searchResultSetItem.dataSource;e._allAttributesMap=t.searchResultSetItem._private.allAttributesMap;e._intentsResolver=e.sina._createFioriIntentsResolver({sina:t.sina});return e}d(n,[{key:"postParseResultSetItem",value:function e(){try{const e=this;var r=e.enhanceResultSetItemWithNavigationTargets();e.enhanceResultSetItemWithGroups();return t(r)}catch(t){return Promise.reject(t)}}},{key:"enhanceResultSetItemWithNavigationTargets",value:function e(){try{const e=this;var r,n,a,u;var o=e;var s=o._dataSource._private.semanticObjectType;var l=o._searchResultSetItem._private.semanticObjectTypeAttributes;var c=(r=o._dataSource.system)===null||r===void 0?void 0:(n=r.id)===null||n===void 0?void 0:n.split(".")[0];var f=(a=o._dataSource.system)===null||a===void 0?void 0:(u=a.id)===null||u===void 0?void 0:u.split(".")[1];return t(o._intentsResolver.resolveIntents({semanticObjectType:s,semanticObjectTypeAttributes:l,systemId:c,client:f,fallbackDefaultNavigationTarget:o._searchResultSetItem.defaultNavigationTarget}),function(t){var r=t&&t.defaultNavigationTarget;var n=t&&t.navigationTargets;var a=[];if(r){a.push(r);o._searchResultSetItem.defaultNavigationTarget=r;r.parent=o._searchResultSetItem}if(n){o._searchResultSetItem.navigationTargets=n;a=[].concat(i(a),i(n));for(var u=0;u<n.length;u++){n[u].parent=o._searchResultSetItem}}e.enhanceNavigationTargetsWithContentProviderId(a);return o._searchResultSetItem})}catch(t){return Promise.reject(t)}}},{key:"enhanceNavigationTargetsWithContentProviderId",value:function t(e){if(!(this.sina.provider instanceof A)){return}if(!this.sina.provider.contentProviderId){return}var r=a(e),n;try{for(r.s();!(n=r.n()).done;){var i=n.value;i.targetUrl+="&sap-app-origin-hint="+this.sina.provider.contentProviderId}}catch(t){r.e(t)}finally{r.f()}}},{key:"enhanceResultSetItemWithGroups",value:function t(){var e=this._searchResultSetItem.dataSource.attributesMetadata;for(var r=0;r<e.length;r++){var n=e[r];if(n.type===I.Group){var a=this._addAttributeGroup(n);if(n.usage.Detail){this._searchResultSetItem.detailAttributes.push(a)}if(n.usage.Title){this._searchResultSetItem.titleAttributes.push(a)}if(n.usage.TitleDescription){this._searchResultSetItem.titleDescriptionAttributes.push(a)}}}this.sortAttributes()}},{key:"sortAttributes",value:function t(){var e=function t(e){return function(t,r){var n=t.metadata.usage&&t.metadata.usage[e]?t.metadata.usage[e].displayOrder:undefined;var a=r.metadata.usage&&r.metadata.usage[e]?r.metadata.usage[e].displayOrder:undefined;if(n===undefined||a===undefined){if(a!==undefined){return 1}return-1}return n-a}};this._searchResultSetItem.titleAttributes.sort(e("Title"));this._searchResultSetItem.titleDescriptionAttributes.sort(e("TitleDescription"));this._searchResultSetItem.detailAttributes.sort(e("Detail"))}},{key:"_addAttributeGroup",value:function t(e){var r=this.sina._createSearchResultSetItemAttributeGroup({id:e.id,metadata:e,label:e.label,template:e.template,attributes:[],groups:[],displayAttributes:e.displayAttributes||[]});var n,a;if(e._private){n=e._private.parentAttribute;a=e._private.childAttribute}for(var i=0;i<e.attributes.length;i++){var u=e.attributes[i];var o=u.attribute;var s=void 0;if(o.type===I.Group){s=this._addAttributeGroup(o)}else{s=this._allAttributesMap[o.id]}if(s){var l=this.sina._createSearchResultSetItemAttributeGroupMembership({group:r,attribute:s,metadata:u});r.attributes.push(l);s.groups.push(l)}if(o==n){r._private.parentAttribute=s}else if(o==a){r._private.childAttribute=s}}return r}}]);return n}(S);var O={__esModule:true};O.ItemPostParser=R;return O})})();