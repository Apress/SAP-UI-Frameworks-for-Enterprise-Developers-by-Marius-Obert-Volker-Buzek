/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/layout/Grid","sap/ui/layout/form/SimpleForm","sap/viz/library","./common/BaseControl","./chartpopover/ChartPopover","sap/ui/thirdparty/jquery","./PopoverRenderer"],function(t,o,e,i,r,s){"use strict";var n=i.extend("sap.viz.ui5.controls.Popover",{metadata:{library:"sap.viz",properties:{customDataControl:{type:"any",defaultValue:null},actionItems:{type:"object[]",defaultValue:null},formatString:{type:"any",defaultValue:null},showLine:{type:"boolean",defaultValue:true}}}});n.prototype.init=function(){i.prototype.init.apply(this,arguments);this._Popover=undefined;this._uid=undefined};n.prototype.exit=function(){i.prototype.exit.apply(this,arguments);var t=sap.ui.getCore().byId(this._uid);if(t){if(t._vizFrame){t._vizFrame.off("showTooltip");t._vizFrame.off("hideTooltip");var o=t._onConnectPopover()||{};if(o.ref===this){t._onConnectPopover(undefined)}}else{t._onConnectPopover(s.proxy(function(o){if(!t._vizFrame){return}t._vizFrame.off("showTooltip");t._vizFrame.off("hideTooltip")},this))}}if(this._Popover){this._Popover.destroy()}this._Popover=undefined;this._uid=undefined};n.prototype.connect=function(t){this._uid=t;if(!this._Popover){this._createPopover()}var o=sap.ui.getCore().byId(this._uid);var e=o.getUiConfig();if(!e||e.applicationSet!=="fiori"){return}var i=this._Popover;function r(){if(!o._vizFrame){return}o._vizFrame.off("showInstantTooltip");o._vizFrame.off("hideInstantTooltip");o._vizFrame.on("showTooltip",function(t){if(t.data.target){i.setOptions(t.data).openBy(t.data.target)}});o._vizFrame.on("hideTooltip",function(){i.close()});i.setChartType(o._vizFrame.type());i._oPopover.setOffsetX(0);i._oPopover.setOffsetY(0)}r.ref=this;if(o._vizFrame){r()}o._onConnectPopover(r)};n.prototype.close=function(){if(this._Popover){this._Popover.close()}};n.prototype.setFormatString=function(t){this.setProperty("formatString",t);if(this._Popover){this._Popover.setFormatString(t)}else{this._createPopover()}return this};n.prototype.setCustomDataControl=function(t){this.setProperty("customDataControl",t);if(this._Popover){this._Popover.setCustomDataControl(t)}else{this._createPopover()}return this};n.prototype.setActionItems=function(t){this.setProperty("actionItems",t);if(this._Popover){this._Popover.setActionItems(t)}else{this._createPopover()}return this};n.prototype.setShowLine=function(t){this.setProperty("showLine",t);if(this._Popover){this._Popover.setShowLine(t)}else{this._createPopover()}return this};n.prototype._createPopover=function(){this._Popover=new r({actionItems:this.getActionItems(),customDataControl:this.getCustomDataControl(),formatString:this.getFormatString(),showLine:this.getShowLine()})};n.prototype.addStyleClass=function(){this._Popover.addStyleClass.apply(this._Popover,arguments)};n.prototype.removeStyleClass=function(){this._Popover.removeStyleClass.apply(this._Popover,arguments)};return n});