/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/collaboration/library","sap/ui/core/UIComponent","sap/ui/model/odata/ODataModel","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,i,o,a,s,r){"use strict";var n=i.FeedType;var p=r.mvc.ViewType;var d=i.AppType;var l=o.extend("sap.collaboration.components.fiori.feed.Component",{metadata:{properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:""},height:{type:"sap.ui.core.CSSSize",defaultValue:""},oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_SRV"},feedType:{type:"string"},groupIds:{type:"string"},object:{type:"object"}},aggregations:{},events:{}},init:function(){this.CollaborationFeedConstants={defaultWidth:"100%",defaultHeight:"100%"};this.setWidth(this.CollaborationFeedConstants.defaultWidth);this.setHeight(this.CollaborationFeedConstants.defaultHeight);this.mode=d.widget;this.oCommonUtil=new t;this.oLangBundle=this.oCommonUtil.getLanguageBundle();o.prototype.init.apply(this)},setSettings:function(e){this.setODataServiceUrl(e.oDataServiceUrl);this.setFeedType(e.feedType);this.setGroupIds(e.groupIds);this.setObject(e.object)},onBeforeRendering:function(){var t=true;try{this.bStopRendering=false;this.validateInputParameters();this.sODataServiceUrl=this.getODataServiceUrl();if(!this.oOdataModel){this.oOdataModel=new a(this.sODataServiceUrl,t)}}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.Component.onBeforeRendering()");this.bStopRendering=true;this.oCommonUtil.displayError(t)}if(sap.ui.getCore().byId(this.getId()+"_oAppView")){sap.ui.getCore().byId(this.getId()+"_oAppView").destroy()}if(sap.ui.getCore().byId(this.getId()+"_oSplitAppView")){sap.ui.getCore().byId(this.getId()+"_oSplitAppView").destroy()}},onAfterRendering:function(){if(!this.bStopRendering){e.debug("Feed Component properties:","","sap.collaboration.components.fiori.feed.Component.onAfterRendering()");e.debug("width: "+this.getWidth());e.debug("height: "+this.getHeight());e.debug("oDataServiceUrl: "+this.getODataServiceUrl());e.debug("feedType: "+this.getFeedType());e.debug("groupIds: "+this.getGroupIds());e.debug("object: "+JSON.stringify(this.getObject()));try{if(this.getMode()===d.widget){var t=sap.ui.view({id:this.getId()+"_oAppView",viewData:{controlId:this.getId(),odataModel:this.oOdataModel,appType:this.getMode(),feedType:this.getFeedType(),groupIds:this.getGroupIds(),object:this.getObject(),langBundle:this.oLangBundle},type:p.JS,viewName:"sap.collaboration.components.fiori.feed.app.App"});t.placeAt(this.getId())}else if(this.getMode()===d.split){var i=sap.ui.view({id:this.getId()+"_oSplitAppView",viewData:{controlId:this.getId(),odataModel:this.oOdataModel,appType:this.getMode(),object:this.getObject(),langBundle:this.oLangBundle},type:p.JS,viewName:"sap.collaboration.components.fiori.feed.splitApp.SplitApp"});i.placeAt(this.getId())}}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.Component.onAfterRendering()");this.oCommonUtil.displayError(t)}}},render:function(e){e.openStart("div",this.getId());e.style("width",this.getWidth());e.style("height",this.getHeight());e.openEnd();e.close("div")},getMode:function(){return this.mode},validateInputParameters:function(){var t;if(this.getFeedType()==n.object||this.getFeedType()==n.objectGroup){if(!this.getObject()){t=new Error("Object is undefined or null");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}else if(!this.getObject().id){t=new Error("Missing Object ID");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}}if(this.getFeedType()==n.object){if(!this.getObject().type){t=new Error("Missing Object Type");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}}}});return l});