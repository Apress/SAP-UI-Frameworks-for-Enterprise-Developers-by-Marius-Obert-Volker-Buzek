/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/StandardListItem","sap/m/library","sap/collaboration/components/utils/OdataUtil","sap/collaboration/components/utils/JamUtil","sap/collaboration/library","sap/ui/model/json/JSONModel"],function(t,e,i,a,s,o,n){"use strict";var r=o.FeedType;var g=i.ListType;sap.ui.controller("sap.collaboration.components.fiori.feed.splitApp.GroupMaster",{onInit:function(){this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.sFeedType=this.getView().getViewData().feedType;this.sPageTitle=this.getView().getViewData().pageTitle;this.sJamToken=this.getView().getViewData().jamToken;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId},onBeforeRendering:function(){var t=this;this.getView().groupMasterPage.setTitle(this.sPageTitle);this.initializeUtils();this.setViewModel();var i=new e;i.bindProperty("title","Name");i.setType(g.Active);i.attachPress(function(){var e=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Id;var i=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Name;var a=t.oJamUtil.prepareWidgetData(t.sJamToken,t.sFeedType,e);t.oJamUtil.createJamWidget(t.sPrefixId+"widgetContainer",a);sap.ui.getCore().byId(t.sPrefixId+"feedDetailsPage").setTitle(i)});sap.ui.getCore().byId(this.sPrefixId+"groupsList").bindItems("/groupsData",i);var a=new e({title:this.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS")});a.setType(g.Active);a.attachPress(function(){var e=t.oODataUtil.getGroupIds(t.aGroupData);var i=t.oJamUtil.prepareWidgetData(t.sJamToken,t.sFeedType,e);t.oJamUtil.createJamWidget(t.sPrefixId+"widgetContainer",i);sap.ui.getCore().byId(t.sPrefixId+"feedDetailsPage").setTitle(t.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS"))});sap.ui.getCore().byId(this.sPrefixId+"groupsList").insertItem(a,0)},onAfterRendering:function(){},initializeUtils:function(){this.oODataUtil=new a;this.oJamUtil=new s},setViewModel:function(){this.aGroupData;this.sFeedType===r.group?this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/Groups"):this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");this.oViewData={groupsData:this.aGroupData};this.oViewModel=new n(this.oViewData);this.getView().setModel(this.oViewModel)},onNavButtonTap:function(){sap.ui.getCore().getEventBus().publish("nav","back")}})});