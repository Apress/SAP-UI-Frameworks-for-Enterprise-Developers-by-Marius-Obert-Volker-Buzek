/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/core/mvc/Controller","sap/collaboration/components/utils/OdataUtil","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,i,a,s){"use strict";var o=s.mvc.ViewType;sap.ui.controller("sap.collaboration.components.fiori.feed.splitApp.SplitApp",{onInit:function(){this.oSplitApp=this.getView().oSplitApp;this.sAppType=this.getView().getViewData().appType;this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.oEventBus=sap.ui.getCore().getEventBus();this.oEventBus.subscribe("nav","to",this.navToHandler,this);this.oEventBus.subscribe("nav","back",this.navBackHandler,this)},onBeforeRendering:function(){this.createMasterDetail()},createMasterDetail:function(){var e=new i;var t=e.getJamUrl(this.oOdataModel);this.sJamToken=e.getJamToken(this.oOdataModel);var a=sap.ui.view({id:this.sPrefixId+"masterView",viewData:{controlId:this.sPrefixId,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},type:o.JS,viewName:"sap.collaboration.components.fiori.feed.splitApp.FeedTypeMaster"});var s=sap.ui.view({id:this.sPrefixId+"detailView",viewData:{controlId:this.sPrefixId,appType:this.sAppType,jamURL:t,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},type:o.JS,viewName:"sap.collaboration.components.fiori.feed.commons.Detail"});this.oSplitApp.addDetailPage(s);this.oSplitApp.addMasterPage(a);this.oSplitApp.setInitialDetail(s);this.oSplitApp.setInitialMaster(a)},navToHandler:function(t,i,a){if(a&&a.viewId===this.sPrefixId+"groupMasterView"){if(!sap.ui.getCore().byId(a.viewId)){var s=sap.ui.view({id:a.viewId,viewData:{controlId:this.sPrefixId,odataModel:this.oOdataModel,object:this.oBusinessObject,feedType:a.data.feedType,pageTitle:a.data.groupMasterPageTitle,jamToken:this.sJamToken,langBundle:this.oLangBundle},type:o.JS,viewName:a.viewName});this.oSplitApp.addMasterPage(s)}else{sap.ui.getCore().byId(a.viewId).getController().sFeedType=a.data.feedType;sap.ui.getCore().byId(a.viewId).getController().sPageTitle=a.data.groupMasterPageTitle;sap.ui.getCore().byId(a.viewId).rerender()}this.oSplitApp.to(a.viewId)}else{e.error("nav-to event cannot be processed. Invalid data: "+a)}},navBackHandler:function(){this.oSplitApp.backMaster()}})});