// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ushell/resources","sap/ui/thirdparty/hasher","sap/ui/core/library"],function(e,t,o,r){"use strict";var i=r.ValueState;return e.extend("sap.ushell.ui.bookmark.SaveOnPage",{onInit:function(){var e=this.getView();e.setModel(t.i18nModel,"i18n");this.byId("bookmarkTitleInput").attachLiveChange(function(){if(this.getValue()===""){this.setValueStateText(t.i18n.getText("bookmarkTitleInputError"));this.setValueState(i.Error)}else{this.setValueState(i.None)}});this.oContentNodeSelector=this.byId("SelectedNodesComboBox");this.oContentNodeSelector.attachSelectionChanged(function(){var e=this.getSelectedContentNodes();if(Array.isArray(e)&&e.length<1){this.setValueStateText(t.i18n.getText("bookmarkPageSelectError"));this.setValueState(i.Error)}else{this.setValueState(i.None)}})},removeFocusFromTile:function(){this.getView().getDomRef().querySelector(".sapMGT").removeAttribute("tabindex")},getBookmarkTileData:function(){var e=this.getView();var t=e.getModel();var r=e.getViewData();var i;if(r.customUrl){if(typeof r.customUrl==="function"){i=r.customUrl()}else{i=r.customUrl}}else{i=o.getHash()?"#"+o.getHash():window.location.href}var n={title:t.getProperty("/title"),subtitle:t.getProperty("/subtitle"),url:i,icon:t.getProperty("/icon"),info:t.getProperty("/info"),numberUnit:t.getProperty("/numberUnit"),serviceUrl:typeof r.serviceUrl==="function"?r.serviceUrl():r.serviceUrl,dataSource:t.getProperty("/dataSource"),serviceRefreshInterval:t.getProperty("/serviceRefreshInterval"),contentNodes:this.oContentNodeSelector.getSelectedContentNodes(),keywords:t.getProperty("/keywords")};var s=["title","subtitle","info"];s.forEach(function(e){n[e]=(n[e]||"").substring(0,256).trim()});return n},onValueHelpEndButtonPressed:function(){if(this.oContentNodeSelector&&this.oContentNodeSelector.fireSelectionChanged){this.oContentNodeSelector.fireSelectionChanged()}}})});