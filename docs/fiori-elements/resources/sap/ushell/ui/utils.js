// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/EventHub","sap/ui/thirdparty/jquery"],function(e,n){"use strict";function r(r){var t=new n.Deferred,s,i,u=0,f=0,a=0,o=[],p=[],c,l={refresh:false};function h(e){if(e&&e.refresh===true){l.refresh=true}a++;t.notify()}function d(e){p.push({entry:c,message:e});f++;t.notify()}var v=e.last("UserSettingsOpened")||{};Object.keys(v).forEach(function(e){var n=parseInt(e,10);i=r[n].onSave();i.done(h);c=r[n].title;i.fail(d);o.push(i);u++});s=n.when.apply(null,o);s.done(function(){e.emit("UserSettingsOpened",null);t.resolve(l)});t.progress(function(){if(f>0&&f+a===u){t.reject(p)}});return t.promise()}return{saveUserPreferenceEntries:r}});