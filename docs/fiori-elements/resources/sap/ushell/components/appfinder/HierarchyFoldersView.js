// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/View","sap/m/Button","sap/m/Label","sap/m/Bar","sap/m/Page","sap/m/library","sap/m/List","sap/m/StandardListItem","sap/m/Text","sap/ushell/resources"],function(e,t,s,a,n,i,o,r,l,c){"use strict";var h=i.ButtonType;var d=i.ListSeparators;return e.extend("sap.ushell.components.appfinder.HierarchyFoldersView",{createContent:function(e){var i=this;this.translationBundle=c.i18n;this.treePath="";this.lastFocusID=document.URL.substring(document.URL.lastIndexOf("&/")+2)+"-button";this.systemSelectorText=new l({text:{path:"easyAccessSystemsModel>/systemSelected",formatter:e.systemSelectorTextFormatter.bind(e)}});this.oItemTemplate=new r({title:"{easyAccess>text}",type:"Navigation",press:function(){var e=i.pageMenu.$().find(".sapMBarLeft button");if(!e.length){i.lastFocusID=document.activeElement.getAttribute("id")}var t=this.getBindingContextPath();i.getViewData().navigateHierarchy(t,true)}});this.oList=new o({showSeparators:d.None,items:{path:"easyAccess>"+this.treePath+"/folders",template:this.oItemTemplate},updateFinished:function(){var e=this.getItems();i.finishEasyAccessAnimation(true);e.forEach(function(e){e.onsapspace=e.onsapenter})},noDataText:{path:"easyAccessSystemsModel>/systemSelected",formatter:function(e){if(e){return i.translationBundle.getText("easyAccessFolderWithNoItems")}}}});this._navBackButton=new t({tooltip:sap.ui.getCore().getLibraryResourceBundle("sap.m").getText("PAGE_NAVBUTTON_TEXT"),type:h.Back,visible:false,press:function(){var e=this.treePath.split("/");var t=e.slice(0,e.length-2);this.getViewData().navigateHierarchy(t.join("/"),false)}.bind(this)});this.pageMenu=new n({enableScrolling:true,headerContent:new a({contentLeft:[this._navBackButton,new s({text:{parts:["easyAccessSystemsModel>/systemSelected"],formatter:e.systemSelectorTextFormatter.bind(e)}})],contentRight:[new t({text:this.translationBundle.getText("easyAccessSelectSystemDialogTitle"),type:h.Transparent,visible:{path:"easyAccessSystemsModel>/systemsList",formatter:function(e){return e.length>1}},press:[e.onSystemSelectionPress,e]})]}).addStyleClass("sapUshellEasyAccessMasterPageHeader"),content:this.oList});return this.pageMenu},getControllerName:function(){return"sap.ushell.components.appfinder.HierarchyFolders"},finishEasyAccessAnimation:function(){if(!this.jqFolderClone){return}if(this.forwardAnimation){this.pageMenu.$().addClass("forwardToViewAnimation");this.jqFolderClone.addClass("forwardOutOfViewAnimation")}else{this.pageMenu.$().addClass("backToViewAnimation");this.jqFolderClone.addClass("backOutOfViewAnimation")}this.jqFolderClone.on("animationend",function(){this.pageMenu.$().removeClass("forwardToViewAnimation backToViewAnimation");var e=this.pageMenu.$().find(".sapMBarLeft button");if(e.length){e.focus()}else{setTimeout(function(){document.querySelector("#"+this.lastFocusID).focus()}.bind(this))}if(this.jqFolderClone){this.jqFolderClone.remove()}}.bind(this))},prepareEasyAccessAnimation:function(e){this.forwardAnimation=e;this.jqFolderClone=this.pageMenu.$().clone().removeAttr("data-sap-ui").css("z-index","1");this.jqFolderClone.find("*").removeAttr("id");this.pageMenu.$().parent().append(this.jqFolderClone)},updatePageBindings:function(e,t){var s=e.split("/").length>2;this.treePath=e;this._navBackButton.setVisible(s);this.pageMenu.setShowSubHeader(!s);this.prepareEasyAccessAnimation(t);this.oList.bindItems("easyAccess>"+e+"/folders",this.oItemTemplate)}})},true);