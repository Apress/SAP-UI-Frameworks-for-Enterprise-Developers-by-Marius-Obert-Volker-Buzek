// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/AppConfiguration","sap/base/Log","sap/ui/thirdparty/jquery"],function(e,a,i){"use strict";var t=["deleteTile","actionModeActive","catalogTileClick","dashboardTileClick","dashboardTileLinkClick"],n=sap.ui.getCore().getEventBus(),o=this,l={};function r(e,a,i){sap.ushell.Container.getServiceAsync("UsageAnalytics").then(function(t){t.logCustomEvent(e,a,i)})}function c(a){var i=e.getMetadata();l[a]={};l[a].startTime=new Date;l[a].title=i.title}function s(e){try{var i=(new Date-l[e].startTime)/1e3;var t=l[e].title;r("FLP: Time in Application (sec)",i,[t])}catch(i){a.warning("Duration in application "+e+" could not be calculated",null,"sap.ushell.components.homepage.FLPAnalytics")}}function p(e,a,i){var t=hasher.getHash(),o;window.swa.custom1={ref:t};switch(a){case"appOpened":c(t);r("FLP: Application Opened","Direct Launch",[l[t].title]);n.unsubscribe("sap.ushell","appOpened",p);break;case"bookmarkTileAdded":o=window.document.title;r("FLP: Personalization","Save as Tile",[o,i&&i.group&&i.group.title?i.group.title:"",i&&i.group&&i.group.id?i.group.id:"",i&&i.tile&&i.tile.title?i.tile.title:o]);break;case"actionModeActive":r("FLP: Personalization","Enter Action Mode",[i.source]);break;case"catalogTileClick":r("FLP: Application Launch point","Catalog",[]);break;case"dashboardTileClick":r("FLP: Application Launch point","Homepage",[]);break;case"dashboardTileLinkClick":r("FLP: Application Launch point","Tile Group Link",[]);break;default:break}}function u(e){var a,i,t;if(e.getParameter("from")&&e.getParameter("to")){a=e.getParameter("from").getId().replace("application-","").replace("applicationShellPage-","");window.swa.custom1={ref:a};s(a);t=e.getParameter("to");i=t.getId().replace("application-","").replace("applicationShellPage-","");c(i);window.swa.custom1={ref:i};r("FLP: Application Opened","Fiori Navigation",[l[i].title])}}i(window).on("unload",function(e){var a=window.location.hash.substr(1);s(a)});try{sap.ui.getCore().byId("viewPortContainer").attachAfterNavigate(u,o)}catch(e){a.warning("Failure when subscribing to viewPortContainer 'AfterNavigate' event",null,"sap.ushell.components.homepage.FLPAnalytics")}n.subscribe("sap.ushell.services.Bookmark","bookmarkTileAdded",p,o);t.forEach(function(e){n.subscribe("launchpad",e,p,o)});n.subscribe("sap.ushell","appOpened",p,o)});