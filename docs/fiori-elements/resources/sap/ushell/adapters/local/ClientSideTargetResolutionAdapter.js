// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/base/Log"],function(e,i){"use strict";var n=function(e,n,t){this._oConfig=t&&t.config;this._aInbounds=[];if(!this._oConfig){this._oSystemAliases={};i.warning("No configuration supplied!","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter")}else{if(this._oConfig.inbounds){this._aInbounds=this._transformInboundsObjectToInboundsArray(this._oConfig.inbounds)}if(this._oConfig.applications){Array.prototype.push.apply(this._aInbounds,this._transformApplicationsToInbounds(this._oConfig.applications))}if(this._aInbounds.length===0){i.warning("Adapter got no inbounds via configuration!","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter")}this._oSystemAliases=this._oConfig.systemAliases||{};i.debug("Adapter got no system aliases via configuration","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter")}var o=sap.ushell.Container,s="";if(o){s=o.getLogonSystem().getProductName()||""}this._oLocalSystemAlias={http:{host:"",port:0,pathPrefix:"/sap/bc/"},https:{host:"",port:0,pathPrefix:"/sap/bc/"},rfc:{systemId:"",host:"",service:0,loginGroup:"",sncNameR3:"",sncQoPR3:""},id:"",label:"local",client:"",language:"",properties:{productName:s}}};n.prototype.getInbounds=function(){var i=new e.Deferred,n=this;setTimeout(function(){i.resolve(n._aInbounds)},0);return i.promise()};n.prototype.resolveSystemAlias=function(i){var n=new e.Deferred;setTimeout(function(){if(this._oSystemAliases.hasOwnProperty(i)){n.resolve(this._oSystemAliases[i])}else if(i===""){n.resolve(this._oLocalSystemAlias)}else{n.reject("No system alias value available")}}.bind(this),0);return n.promise()};n.prototype._transformApplicationsToInbounds=function(e){var n,t=[],o,s,a;function r(e,i){if(e==="NWBC"&&i){if(i.indexOf("/~canvas;window=app/wda")>=0){return"WDA"}return"TR"}return e}for(n in e){if(e.hasOwnProperty(n)&&n.indexOf("_")!==0){s={};if(n.indexOf("-")>-1){a=n.split("-",2);s.semanticObject=a[0];s.action=a[1]}else if(n===""){s.semanticObject="";s.action=""}else{i.warning("Excluded syntactically incorrect intent '"+n+"' from inbounds array","","sap.ushell.adapters.local.ClientSideTargetResolutionAdapter");continue}o=e[n];s.title=o.description||"";s.signature={parameters:{}};s.signature.additionalParameters="allowed";s.resolutionResult={};s.resolutionResult.applicationType=r(o.applicationType,o.url);s.resolutionResult.additionalInformation=o.additionalInformation||"";if(s.resolutionResult.additionalInformation&&s.resolutionResult.additionalInformation.indexOf("SAPUI5.Component=")!==-1){s.resolutionResult.applicationType="SAPUI5";s.resolutionResult.ui5ComponentName=s.resolutionResult.additionalInformation.split("SAPUI5.Component=",2)[1];if(o.applicationDependencies){s.resolutionResult.applicationDependencies=o.applicationDependencies}else{s.resolutionResult.applicationDependencies={self:{name:s.resolutionResult.ui5ComponentName},asyncHints:{libs:[{name:"sap.ui.core"},{name:"sap.ui.unified"}]}}}}s.resolutionResult.url=o.url;t.push(s)}}return t};n.prototype._transformInboundsObjectToInboundsArray=function(e){var i,n=[],t;for(i in e){if(e.hasOwnProperty(i)){t=e[i];if(t.resolutionResult.additionalInformation&&t.resolutionResult.additionalInformation.indexOf("SAPUI5.Component=")!==-1){t.resolutionResult.ui5ComponentName=t.resolutionResult.additionalInformation.split("SAPUI5.Component=",2)[1];if(!t.resolutionResult.hasOwnProperty("applicationDependencies")){t.resolutionResult.applicationDependencies={self:{name:t.resolutionResult.ui5ComponentName},asyncHints:{libs:[{name:"sap.ui.core"},{name:"sap.ui.unified"}]}}}}n.push(e[i])}}return n};return n},false);