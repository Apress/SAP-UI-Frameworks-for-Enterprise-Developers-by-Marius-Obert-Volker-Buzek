// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Component","sap/ushell/appRuntime/ui5/plugins/baseRta/AppLifeCycleUtils","sap/ushell/appRuntime/ui5/plugins/baseRta/CheckConditions","sap/ushell/appRuntime/ui5/plugins/baseRta/Trigger"],function(i,t,e,n){"use strict";var s=i.extend("sap.ushell.plugins.BaseRTAPlugin",{sType:null,init:function(i){this.mConfig=i;this.mConfig.i18n=this.getModel("i18n").getResourceBundle();this.mConfig.loadPlugins=this._loadPlugins.bind(this);this.mConfig.onStartHandler=this._onStartHandler.bind(this);this.mConfig.onErrorHandler=this._onErrorHandler.bind(this);this.mConfig.onStopHandler=this._onStopHandler.bind(this);this.oTrigger=new n(this.mConfig);this._oPluginPromise=this.oTrigger.getInitPromise().then(e.checkUI5App.bind(e)).then(function(i){if(this.mConfig.checkRestartRTA&&i&&e.checkRestartRTA(this.mConfig.layer)){return this.oTrigger.triggerStartRta(this)}return undefined}.bind(this)).then(function(){return t.getAppLifeCycleService()}).then(function(i){i.attachAppLoaded(this._onAppLoaded,this)}.bind(this))},getPluginPromise:function(){return this._oPluginPromise},exit:function(){this._oPluginPromise=this._oPluginPromise.then(t.getAppLifeCycleService).then(function(i){i.detachAppLoaded(this._onAppLoaded,this);if(this._onRendererCreated){var e=t.getContainer();e.detachRendererCreatedEvent(this._onRendererCreated,this)}}.bind(this))},_onAppLoaded:function(){return e.checkUI5App().then(function(i){if(i){if(e.checkRestartRTA(this.mConfig.layer)){this.oTrigger.triggerStartRta(this)}this._adaptButtonVisibility(this.mConfig.id,true)}else{this._adaptButtonVisibility(this.mConfig.id,false)}}.bind(this))},_onAdapt:function(){return this.oTrigger.triggerStartRta(this)},_adaptButtonVisibility:function(i,t){if(typeof i==="string"){i=sap.ui.getCore().byId(i)}if(!i){return}i.setVisible(t)},_exitAdaptation:function(){if(this._switchToDefaultMode){this._switchToDefaultMode()}this.oTrigger.exitRta()},_onStartHandler:function(){},_onErrorHandler:function(){this._exitAdaptation()},_onStopHandler:function(){this._exitAdaptation()},_loadPlugins:function(){return Promise.resolve()}});return s},true);