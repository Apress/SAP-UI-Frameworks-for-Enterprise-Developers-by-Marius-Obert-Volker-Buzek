/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){function e(){}function t(t,a){if(!a){return t&&t.then?t.then(e):Promise.resolve()}}function a(e,t,a){if(a){return t?t(e):e}if(!e||!e.then){e=Promise.resolve(e)}return t?e.then(t):e}sap.ui.define(["../i18n","sap/m/IconTabFilter","sap/m/Button","sap/m/VBox","sap/m/GroupHeaderListItem","./../error/errors","sap/esh/search/ui/controls/SearchFacetQuickSelectDataSource","sap/esh/search/ui/controls/SearchFacetHierarchyDynamic","sap/esh/search/ui/controls/SearchFacetHierarchyStatic","sap/esh/search/ui/controls/SearchFacet","sap/esh/search/ui/controls/SearchFacetBarChart","sap/esh/search/ui/controls/SearchFacetPieChart","sap/ui/core/Control","./SearchFacetTabBarRoles","../sinaNexTS/providers/abap_odata/UserEventLogger","./OpenShowMoreDialog","sap/m/Toolbar","sap/m/List","sap/m/library","sap/m/Title","sap/m/ToolbarSpacer"],function(e,r,n,o,i,s,c,l,h,u,d,f,p,S,g,v,y,F,b,w,T){function B(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}var C=B(e);var m=B(s);var x=B(S);var A=g["UserEventType"];var _=v["openShowMoreDialog"];var k=b["ButtonType"];var D=b["ListSeparators"];var H=p.extend("sap.esh.search.ui.controls.SearchFacetFilter",{renderer:{apiVersion:2,render:function e(t,a){var r;var n=a.getModel();t.openStart("div",a);t["class"]("sapUshellSearchFacetFilter");t.openEnd();var o=true;for(var i=0,s=a.getAggregation("facets").length;i<s;i++){var c=a.getAggregation("facets")[i];var l=c.getBindingContext().getObject();switch(l.facetType){case"attribute":c.setEshRole("attribute");c.attachSelectionChange(null,function(){var e=a._getShowAllButton();var t=e.getDomRef();if(t){jQuery(t).hide()}else{}});if(l.position>999){if(o){c.setHeaderText(C.getText("filterBy"));o=false}}else{c.setHeaderText(l.title);c.addStyleClass("sapUshellSearchFacetSearchInAttribute")}t.renderControl(c);break;case"datasource":c.setEshRole("datasource");c.addStyleClass("sapUshellSearchFacetDataSource");t.renderControl(c);break;case"quickSelectDataSource":if(typeof c.setHeaderText==="function"){c.setHeaderText(C.getText("quickSelectDataSourcesHeader"))}c.addStyleClass("sapUshellSearchFacetQuickSelectDataSource");t.renderControl(c);break;case"hierarchy":if(l.position>999){if(o){c.setHeaderToolbar(a._headToolBar4FirstFacet(n));o=false}}else{c.setHeaderText(l.title);c.addStyleClass("sapUshellSearchFacetSearchInAttribute")}t.renderControl(c);break;case"hierarchyStatic":t.renderControl(c);break;default:throw"program error: unknown facet type :"+l.facetType}}if(((r=n.getDataSource())===null||r===void 0?void 0:r.type)==="BusinessObject"){var h=n.oFacetFormatter.hasDialogFacetsFromMetaData(n);var u=a.getModel().getProperty("/boCount")>0;if(h&&u){var d=a._getShowAllButton();if(d!==null){t.openStart("div",a.getId()+"-showAllFilters");t.openEnd();d.setModel(a.getModel("i18n"));d.addStyleClass("sapUshellSearchFacetFilterShowAllFilterBtn");t.renderControl(d);t.close("div")}}}t.close("div")}},metadata:{aggregations:{facets:{singularName:"facet",bindable:"bindable",multiple:true},_showAllBtn:{type:"sap.m.Button",multiple:false,visibility:"hidden"}}},constructor:function e(t,a){p.prototype.constructor.call(this,t,a);this.data("sap-ui-fastnavgroup","true",true);this._bindMyFacets()},onAfterRendering:function e(){var t=$(".searchFacetFilter .searchFacet").first().find("ul");var a=t.find("li");t.attr("role","tree");a.attr("role","treeitem")},_bindMyFacets:function e(){if(!this.getBindingInfo("facets")){this.bindAggregation("facets",{path:"/facets",factory:function e(t,a){var n=a.getObject();var s=a.getModel();var p=s.config;switch(n.facetType){case"attribute":{var S="".concat(t,"-attribute_facet");if(typeof(p===null||p===void 0?void 0:p.getSpaceFacetId)==="function"){S=p.getSpaceFacetId(n.dimension,S)}var g=new x(S,{items:[new r({text:C.getText("facetList"),icon:"sap-icon://list",key:"list".concat(t),content:new u("list".concat(t),{})}),new r({text:C.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:"barChart".concat(t),content:new d("barChart".concat(t))}),new r({text:C.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:"pieChart".concat(t),content:new f("pieChart".concat(t))})]});g.addStyleClass("sapUshellSearchFacetIconTabBar");return g}case"datasource":return new u((p!==null&&p!==void 0&&p.id?p.id+"-":"")+"dataSourceFacet");case"quickSelectDataSource":{var v=new c((p!==null&&p!==void 0&&p.id?p.id+"-":"")+"sapUshellSearchFacetQuickSelectDataSource",{});var y=new i("".concat(t,"-quickSelectDataSource_facetGroupHeader"),{title:C.getText("quickSelectDataSourcesHeader")});y.addStyleClass("sapUshellSearchFacetTabBarHeader");y.addStyleClass("sapElisaSearchFacetTabBarHeaderUl");return new o("".concat(t,"-quickSelectDataSource_container"),{items:[y,v]});return v}case"hierarchy":{var F="".concat(t,"-hierarchy_facet");var b=new l(F,{openShowMoreDialogFunction:_});return b}case"hierarchyStatic":{var w="".concat(t,"-hierarchyStatic_facet");return new h(w,{})}default:{var T=new Error("Program error: Unknown facet type: '".concat(n.facetType,"'"));throw new m.UnknownFacetType(T)}}}})}},_getShowAllButton:function e(){var r=this;if(this.getAggregation("_showAllBtn")===null){var o=function e(){try{var n=r.getModel();return a(t(_(n)))}catch(e){return Promise.reject(e)}};var i=new n("".concat(this.getId(),"-ShowMoreAll"),{text:"{showAllFilters}",press:o,visible:true});this.setAggregation("_showAllBtn",i)}return this.getAggregation("_showAllBtn")},_headToolBar4FirstFacet:function e(t){var a=this;var r=new F("",{});r.setShowNoData(false);r.setShowSeparators(D.None);r.data("sap-ui-fastnavgroup","false",true);var o=new n("",{icon:"sap-icon://clear-filter",tooltip:C.getText("resetFilterButton_tooltip"),type:k.Transparent,enabled:{parts:[{path:"/uiFilter/rootCondition"}],formatter:function e(a){var r=false;if(a.hasFilters()){r=true;if(t.filterWithoutFilterByConditions()){r=false}if(typeof t.config.hasSpaceFiltersOnly==="function"){if(t.config.hasSpaceFiltersOnly(a)===true){r=false}}}else{r=false}return r}},press:function e(){var a=t;a.eventLogger.logEvent({type:A.CLEAR_ALL_FILTERS});t.resetFilterByFilterConditions(true)}});o.addStyleClass("sapUshellSearchFilterByResetButton");o.onAfterRendering=function(){$(a.getDomRef()).attr("aria-label",C.getText("resetFilterButton_tooltip"))};var i=new w("",{text:C.getText("filterBy")});var s=new T;var c=new y("",{content:[i,s,o]});c.data("sap-ui-fastnavgroup","false",true);c.addStyleClass("sapUshellSearchFilterByHeaderListToolbarinToolbar");r.setHeaderToolbar(c);r.addStyleClass("sapUshellSearchFilterByHeaderList");r.onAfterRendering=function(){$(".sapUshellSearchFilterByHeaderList").find("ul").attr("tabindex","-1");$(".sapUshellSearchFilterByHeaderList").find("div").attr("tabindex","-1")};var l=new y("",{content:r});l.addStyleClass("sapUshellSearchFilterByHeaderListToolbar");return l}});return H})})();