/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["../i18n","sap/m/Text","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/library","sap/ui/core/Icon","../sinaNexTS/providers/abap_odata/UserEventLogger","../sinaNexTS/sina/HierarchyDisplayType"],function(t,e,r,i,a,n,o,s){function l(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}var u=l(t);var c=a["ToolbarDesign"];var h=o["UserEventType"];var d=s["HierarchyDisplayType"];var f=r.extend("sap.esh.search.ui.controls.SearchFilterBar",{renderer:{apiVersion:2},constructor:function t(a,o){r.prototype.constructor.call(this,a,o);this.setProperty("design",c.Info);this.addStyleClass("sapUshellSearchFilterContextualBar");this.filterFormatter=this.filterFormatter.bind(this);this.filterText=new e(this.getId()+"-resetFilterText",{text:{parts:[{path:"/uiFilter/rootCondition"},{path:"/facets"}],formatter:this.filterFormatter},tooltip:{parts:[{path:"/uiFilter/rootCondition"},{path:"/facets"}],formatter:this.filterFormatter}}).addStyleClass("sapUshellSearchFilterText");this.filterText.setMaxLines(1);this.filterText.clampText();this.addContent(this.filterText);this.addContent(new i);this.resetButton=new n(this.getId()+"-resetFilterButton",{src:"sap-icon://clear-filter",tooltip:u.getText("resetFilterButton_tooltip")}).addStyleClass("sapUshellSearchFilterResetButton");this.addContent(this.resetButton)},filterFormatter:function t(e,r){if(!e||!e.hasFilters()){return""}e=this.sortConditions(e,r);var i=[];for(var a=0;a<e.conditions.length;++a){var n,o;var s=e.conditions[a];var l=[];var c=this.getModel();var h=s.getFirstAttribute();var f=(n=c.getProperty("/uiFilter"))===null||n===void 0?void 0:n.dataSource.attributeMetadataMap[h];if(f&&f.isHierarchy===true&&f.hierarchyDisplayType===d.StaticHierarchyFacet){continue}if(s.containsAttribute((o=c.config)===null||o===void 0?void 0:o.dimensionNameSpace_Description)){continue}for(var p=0;p<s.conditions.length;++p){var v=s.conditions[p];if(p===0){l.push(v.attributeLabel," (")}else{l.push(", ")}l.push(this._formatLabel(v.valueLabel||v.value,v.operator))}l.push(")");i.push(l.join(""))}return u.getText("filtered_by",[i.join(", ")])},_formatLabel:function t(e,r){var i;switch(r){case this.getModel().sinaNext.ComparisonOperator.Bw:i=e+"*";break;case this.getModel().sinaNext.ComparisonOperator.Ew:i="*"+e;break;case this.getModel().sinaNext.ComparisonOperator.Co:i="*"+e+"*";break;default:i=e;break}return i},sortConditions:function t(e,r){if(r.length===0){return e}var i=function t(e){var r=e.conditions[0];if(r.attribute){return r.attribute}return r.conditions[0].attribute};var a=function t(e,r,i){for(var a=0;a<e.length;++a){var n=e[a];if(n[r]===i){return a}}};e=e.clone();e.conditions.sort(function(t,e){var n=i(t);var o=a(r,"dimension",n);var s=i(e);var l=a(r,"dimension",s);return o-l});var n=function t(e){var n=i(e);var o=a(r,"dimension",n);if(!o){return}var s=r[o];if(s.facetType==="hierarchy"){return}var l=function t(e,r){return a(s.items,"label",e.valueLabel)-a(s.items,"label",r.valueLabel)};e.conditions.sort(l)};for(var o=0;o<e.conditions.length;++o){var s=e.conditions[o];n(s)}return e},onAfterRendering:function t(){var e=this;this.resetButton.attachPress(function(){var t=e.getModel();t.eventLogger.logEvent({type:h.CLEAR_ALL_FILTERS});t.resetFilterByFilterConditions(true)});var r=jQuery(".sapUshellSearchFilterText");r.attr("aria-label",u.getText("filtered_by_aria_label"))}});return f})})();