/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["./SinaObject","./SimpleCondition","./ComplexCondition","./LogicalOperator","../core/errors","./HierarchyDisplayType"],function(t,e,r,o,i,n){function a(t,e){if(!(t instanceof e)){throw new TypeError("Cannot call a class as a function")}}function u(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||false;o.configurable=true;if("value"in o)o.writable=true;Object.defineProperty(t,o.key,o)}}function c(t,e,r){if(e)u(t.prototype,e);if(r)u(t,r);Object.defineProperty(t,"prototype",{writable:false});return t}function s(t,e){if(typeof e!=="function"&&e!==null){throw new TypeError("Super expression must either be null or a function")}t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:true,configurable:true}});Object.defineProperty(t,"prototype",{writable:false});if(e)f(t,e)}function f(t,e){f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function t(e,r){e.__proto__=r;return e};return f(t,e)}function l(t){var e=y();return function r(){var o=v(t),i;if(e){var n=v(this).constructor;i=Reflect.construct(o,arguments,n)}else{i=o.apply(this,arguments)}return h(this,i)}}function h(t,e){if(e&&(typeof e==="object"||typeof e==="function")){return e}else if(e!==void 0){throw new TypeError("Derived constructors may only return object or undefined")}return d(t)}function d(t){if(t===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return t}function y(){if(typeof Reflect==="undefined"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy==="function")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true}catch(t){return false}}function v(t){v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function t(e){return e.__proto__||Object.getPrototypeOf(e)};return v(t)}function p(t,e,r){if(e in t){Object.defineProperty(t,e,{value:r,enumerable:true,configurable:true,writable:true})}else{t[e]=r}return t}
/*!
   * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	
   */var b=t["SinaObject"];var C=e["SimpleCondition"];var m=r["ComplexCondition"];var g=o["LogicalOperator"];var S=i["CanOnlyAutoInsertComplexConditionError"];var T=i["SinaProgramError"];var O=n["HierarchyDisplayType"];var w=function(t){s(r,t);var e=l(r);function r(t){var o,i,n;var u;a(this,r);u=e.call(this,t);p(d(u),"searchTerm","");u.dataSource=(o=t.dataSource)!==null&&o!==void 0?o:u.sina.getAllDataSource();u.searchTerm=(i=t.searchTerm)!==null&&i!==void 0?i:u.searchTerm;u.rootCondition=(n=t.rootCondition)!==null&&n!==void 0?n:new m({sina:u.sina});return u}c(r,[{key:"setSearchTerm",value:function t(e){this.searchTerm=e}},{key:"setRootCondition",value:function t(e){this.rootCondition=e}},{key:"clone",value:function t(){return new r({sina:this.sina,dataSource:this.dataSource,searchTerm:this.searchTerm,rootCondition:this.rootCondition.clone()})}},{key:"equals",value:function t(e){return e instanceof r&&this.dataSource===e.dataSource&&this.searchTerm===e.searchTerm&&this.rootCondition.equals(e.rootCondition)}},{key:"_getAttribute",value:function t(e){if(e instanceof C){return e.attribute}for(var r=0;r<e.conditions.length;++r){var o=this._getAttribute(e.conditions[r]);if(o){return o}}}},{key:"setDataSource",value:function t(e){if(this.dataSource===e){return}this.dataSource=e;this.resetConditions()}},{key:"resetConditions",value:function t(){this.rootCondition.resetConditions()}},{key:"autoInsertCondition",value:function t(e){if(!(this.rootCondition instanceof m)){throw new S("cannot auto insert condition - filter root condition is not a complex condition")}var r=this._getAttribute(e);var o,i;for(var n=0;n<this.rootCondition.conditions.length;++n){i=this.rootCondition.conditions[n];var a=this._getAttribute(i);if(a===r){o=i;break}}if(!o){o=this.sina.createComplexCondition({operator:g.Or});this.rootCondition.addCondition(o)}for(var u=0;u<o.conditions.length;++u){i=o.conditions[u];if(i.equals(e)){return}}o.addCondition(e)}},{key:"autoRemoveCondition",value:function t(e){var r=function t(e,r){for(var o=0;o<e.conditions.length;++o){var i=e.conditions[o];if(i.equals(r)){e.removeConditionAt(o);o--;continue}if(i instanceof m){t(i,r);if(i.conditions.length===0){e.removeConditionAt(o);o--;continue}}}};r(this.rootCondition,e)}},{key:"isFolderMode",value:function t(){var e;if(!((e=this.sina.configuration)!==null&&e!==void 0&&e.folderMode)){return false}var r=this.dataSource.attributesMetadata.filter(function(t){return t.isHierarchy&&t.hierarchyDisplayType===O.StaticHierarchyFacet});var o=r.length>0;var i=this.dataSource.isHierarchyDefinition&&this.dataSource.hierarchyDisplayType===O.HierarchyResultView;if(!o&&!i){return false}var n=this.getFolderAttribute();var a=this.rootCondition.getAttributes();var u=a.filter(function(t){return t!=n});var c=a.filter(function(t){return t===n});if(c.length===0){return false}if((this.searchTerm.length===0||this.searchTerm.trim()==="*")&&u.length===0){return true}return false}},{key:"getFolderAttribute",value:function t(){if(this.dataSource.isHierarchyDefinition&&this.dataSource.hierarchyDisplayType===O.HierarchyResultView){return this.dataSource.hierarchyAttribute}var e=this.dataSource.attributesMetadata.filter(function(t){return t.isHierarchy&&t.hierarchyDisplayType===O.StaticHierarchyFacet});if(e.length===0){throw new T}return e[0].id}},{key:"toJson",value:function t(){return{dataSource:this.dataSource.toJson(),searchTerm:this.searchTerm,rootCondition:this.rootCondition.toJson()}}}]);return r}(b);var j={__esModule:true};j.Filter=w;return j})})();