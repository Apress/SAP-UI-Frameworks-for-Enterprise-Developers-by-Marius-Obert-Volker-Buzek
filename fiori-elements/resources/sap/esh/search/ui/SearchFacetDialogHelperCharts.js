/*! 
 * SAPUI5

		(c) Copyright 2009-2021 SAP SE. All rights reserved
	 
 */
(function(){sap.ui.define(["./i18n","sap/esh/search/ui/controls/SearchFacetPieChart","sap/base/Log","sap/suite/ui/microchart/ComparisonMicroChart","sap/m/IconTabFilter","sap/m/Button","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/ResizeHandler","sap/suite/ui/microchart/ComparisonMicroChartData","sap/m/ActionSheet","sap/m/library"],function(e,t,a,r,i,n,s,l,o,c,h,u){function p(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function f(e,t){if(!(e instanceof t)){throw new TypeError("Cannot call a class as a function")}}function d(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||false;r.configurable=true;if("value"in r)r.writable=true;Object.defineProperty(e,r.key,r)}}function g(e,t,a){if(t)d(e.prototype,t);if(a)d(e,a);Object.defineProperty(e,"prototype",{writable:false});return e}var v=p(e);var y=u["ValueColor"];var m=u["PlacementType"];var C=function(){function e(t){f(this,e);e.dialog=t}g(e,[{key:"testWhetherPieWedgeOrLabelIsDummy",value:function e(t){var a=false;try{var r=JSON.stringify(t.getParameters().data[0].data).split('"')[3];var i=r.match(/\d+/g)[0];var n=r.match(/\d+/g)[1];if(r===v.getText("facetPieChartOverflowText2",[i,n])){a=true}else if(r===v.getText("facetPieChartOverflowText2",[n,i])){a=true}}catch(e){}return a}}],[{key:"getBarChartPlaceholder",value:function e(){var t=this;var a={height:"90%",width:"100%",colorPalette:"",tooltip:""};var i=new r(a);i.addStyleClass("largeChart1barchart");var n=new s({path:"value",operator:l.GT,value1:0});var o={path:"items",factory:function e(){var a=new c({title:{path:"label"},value:{path:"value"},color:{path:"selected",formatter:function e(t){var a=y.Good;if(!t){a=y.Neutral}return a}},tooltip:{parts:[{path:"label"},{path:"value"}],formatter:function e(t,a){return t+": "+a}},displayValue:{path:"valueLabel"},press:function e(a){t.dialog.onDetailPageSelectionChangeCharts(a)}});return a},filters:[n]};i.bindAggregation("data",o);i.setBusyIndicatorDelay(0);return i}},{key:"getPieChartPlaceholder",value:function e(){var a={oSearchFacetDialog:this.dialog};var r=new t("",a);r.addStyleClass("largeChart2piechart");o.register(r,function(e){var t=0;var a=0;if(e.target.firstChild){t=parseInt(window.getComputedStyle(e.target.firstChild,null).getPropertyValue("transform-origin").split(" ")[0],10);a=e.size.width/2-t;e.target.firstChild.style.marginLeft=a+"px"}});return r}},{key:"setDummyTabBarItems",value:function e(t){var a=[new i({text:v.getText("facetList"),icon:"sap-icon://list",key:"list"+(arguments.length<=1?undefined:arguments[1])}),new i({text:v.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:"barChart"+(arguments.length<=1?undefined:arguments[1])}),new i({text:v.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:"pieChart"+(arguments.length<=1?undefined:arguments[1])})];t.setProperty("tabBarItems",a);t.chartOnDisplayIndex=0}},{key:"getDropDownButton",value:function e(t){var r=[];var i;var s=t.getProperty("tabBarItems");var l=new n({icon:s[t.chartOnDisplayIndex].getIcon()});for(var o=0;o<s.length;o++){i=new n({text:s[o].getText(),icon:s[o].getIcon(),press:function e(a){var r;var i=a.getSource().sId;r=document.getElementById(i).dataset.facetViewIndex;r=parseInt(r,10);t.chartOnDisplayIndex=r;if(t.chartOnDisplayIndex===0){$(".sapUshellSearchFacetDialogSettingsContainer").css("display","block")}else{$(".sapUshellSearchFacetDialogSettingsContainer").css("display","none")}t.chartOnDisplayIndexByFilterArray[t.facetOnDisplayIndex]=r;var n=s[t.chartOnDisplayIndex].getIcon();l.setIcon(n);var o=s[t.chartOnDisplayIndex].getText();var c=v.getText("displayAs",[o]);l.setTooltip(c);var h=$(".sapUshellSearchFacetDialogFacetList")[0];if(h){var u=sap.ui.getCore().byId(h.id);if(!u.getSelectedItem()){u.setSelectedItem(u.getItems()[0])}u.fireSelectionChange({listItem:u.getSelectedItem()})}t.controlChartVisibility(t,r)}});i.data("facet-view-index",""+o,true);r.push(i)}var c=new h({showCancelButton:true,buttons:r,placement:m.Bottom,cancelButtonPress:function e(){a.info("sap.m.ActionSheet: cancelButton is pressed")}});l.addStyleClass("sapUshellSearchFacetDialogTabBarButton");var u=s[t.chartOnDisplayIndex].getText();var p=v.getText("displayAs",[u]);l.setTooltip(p);l.attachPress(function(){c.openBy(this)});return l}},{key:"getListContainersForDetailPage",value:function e(){var t,a,r;var i=[];var n=0;var s=440;var l=$(".searchFacetLargeChartContainer");for(var o=0;o<l.length;o++){if(l[o].clientHeight>0){s=l[o].offsetParent.offsetParent.offsetParent.clientHeight;n=o;break}}var c=$(".searchFacetLargeChartContainer")[n];if(c){var h=sap.ui.getCore().byId(c.id);var u=$(".sapUshellSearchFacetDialogSubheaderToolbar .sapMSF");var p=$(".sapUshellSearchFacetDialogSortButton");var f=c.firstChild["children"];for(var d=0;d<f.length;d++){if(f[d].className){if(f[d].className.match(/sapMList/)){t=f[d]}else if(f[d].className.match(/barchart/)){a=f[d]}else if(f[d].className.match(/piechart/)){r=f[d]}}}i.push(c);i.push(h);i.push(s);i.push(t);i.push(a);i.push(r);i.push(p);i.push(u)}return i}}]);return e}();return C})})();