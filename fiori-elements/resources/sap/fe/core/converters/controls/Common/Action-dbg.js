/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/converters/helpers/BindingHelper","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/ManifestSettings","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/StableIdHelper"],function(e,n,t,i,o,a,r,l){"use strict";var s={};var u=l.replaceSpecialChars;var c=r.resolveBindingString;var d=r.pathInModel;var v=r.or;var f=r.isConstant;var p=r.ifElse;var b=r.greaterOrEqual;var m=r.getExpressionFromAnnotation;var y=r.formatResult;var g=r.equal;var h=r.constant;var A=r.compileExpression;var S=r.and;var C=o.ActionType;var E=i.getCustomActionID;var k=t.Placement;var x=n.bindingContextPathVisitor;let F;(function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up"})(F||(F={}));s.ButtonType=F;function I(e,n,t,i){const o=n.find(e=>e.key===i);const a=e[i];const r={...o??a};if(o){r.enabled=(a===null||a===void 0?void 0:a.enabled)??o.enabled;r.visible=(a===null||a===void 0?void 0:a.visible)??o.visible;for(const e in a||{}){const n=e;if(!o[n]&&n!=="menu"){r[n]=a[n]}}}const l=((r===null||r===void 0?void 0:r.visible)||(r===null||r===void 0?void 0:r.type)===C.DataFieldForAction||(r===null||r===void 0?void 0:r.type)===C.DataFieldForIntentBasedNavigation)&&!t.find(e=>e.key===(r===null||r===void 0?void 0:r.key));return{action:r,canBeMenuItem:l}}function M(e,n,t,i,o){const{action:a,canBeMenuItem:r}=I(n,t,o,e.defaultAction);if(r){e.defaultAction=a}if(a.command){i[a.key]=a}}function O(e,n,t,i,o){const a=[];for(const r of e.menu??[]){const{action:e,canBeMenuItem:l}=I(n,t,o,r);if(l){a.push(e)}if(e.command){i[r]=e}}e.menu=a;const r=a.map(e=>c(e.visible,"boolean"));e.visible=A(S(c(e.visible,"boolean"),v(...r)))}function P(e,n,t){const i={};const o=[];const a={};for(const l in e){const s=e[l];if(s.defaultAction!==undefined){M(s,e,n,a,t)}if(s.type===C.Menu){var r;o.push(...s.menu);O(s,e,n,a,t);if(!((r=s.menu)!==null&&r!==void 0&&r.length)){o.push(s.key)}}if(s.command){a[l]=s}i[l]=s}o.forEach(e=>delete i[e]);return{actions:i,commandActions:a}}const B=function(e,n,t){if(n&&e.enabled===undefined){return undefined}const i=q(e.enabled,t);return A(p(e.requiresSelection===true,S(b(d("numberOfSelectedContexts","internal"),1),i),i))};const N=function(e,n,t){if(n&&e.visible===undefined){return undefined}const i=q(e.visible,t);return A(i)};function D(e,n){if(!n){return}e.type=n.type;e.annotationPath=n.annotationPath;e.press=n.press;e.enabled=e.enabled??n.enabled;e.visible=e.visible??n.visible}function T(e,n){if(n!==null&&n!==void 0&&n.find(n=>n.key===e.key)){e.visible="false"}}function j(e,n,t,i,o,a,r){const l={};for(const d in e){var s,c;const v=e[d];const f=((s=v.press)===null||s===void 0?void 0:s.lastIndexOf("."))||-1;const p=t===null||t===void 0?void 0:t.find(e=>e.key===d);const b=!!p;if(v.facetName){r=v.facetName}l[d]={id:p?d:E(d),type:v.menu?C.Menu:C.Default,visible:N(v,b,n),enabled:B(v,b,n),handlerModule:v.press&&v.press.substring(0,f).replace(/\./gi,"/"),handlerMethod:v.press&&v.press.substring(f+1),press:v.press,text:v.text,noWrap:v.__noWrap,key:u(d),enableOnSelect:v.enableOnSelect,defaultValuesExtensionFunction:v.defaultValuesFunction,position:{anchor:(c=v.position)===null||c===void 0?void 0:c.anchor,placement:v.position===undefined?k.After:v.position.placement},isNavigable:V(v,i,o),command:v.command,requiresSelection:v.requiresSelection===undefined?false:v.requiresSelection,enableAutoScroll:$(v),menu:v.menu??[],facetName:v.inline?r:undefined,defaultAction:v.defaultAction};D(l[d],p);T(l[d],a)}return P(l,t??[],a??[])}s.getActionsFromManifest=j;function q(e,n){const t=c(e,"boolean");let i;if(f(t)&&t.value===undefined){i=h(true)}else if(f(t)&&typeof t.value==="string"){var o;const e=t.value;i=y([d("/","$view"),e,d("selectedContexts","internal")],a.customBooleanPropertyCheck,((o=n.getDataModelObjectPath().contextLocation)===null||o===void 0?void 0:o.targetEntityType)||n.getEntityType())}else{i=t}return i}const U=e=>{let n={};e.forEach(e=>{var t;if(e!==null&&e!==void 0&&(t=e.menu)!==null&&t!==void 0&&t.length){const t=e.menu;n=t.reduce((e,n)=>{let{key:t}=n;if(t&&!e[t]){e[t]=true}return e},n)}});return e.filter(e=>!n[e.key])};s.removeDuplicateActions=U;function L(e,n){var t,i,o;const a=n!==null&&n!==void 0&&n.isBound?n===null||n===void 0?void 0:(t=n.parameters[0])===null||t===void 0?void 0:t.fullyQualifiedName:undefined;const r=m(n===null||n===void 0?void 0:(i=n.annotations.Core)===null||i===void 0?void 0:i.OperationAvailable,[],undefined,n=>x(n,e,a));if((n===null||n===void 0?void 0:(o=n.annotations.Core)===null||o===void 0?void 0:o.OperationAvailable)!==undefined){return A(g(r,true))}return"true"}s.getEnabledForAnnotationAction=L;function R(e){return e?e.map(e=>({LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty})):[]}s.getSemanticObjectMapping=R;function V(e,n,t){var i,o;let a=true;if(t){const e=n&&(n.detail||n.display);a=e!==null&&e!==void 0&&e.route?true:false}if(e&&e.afterExecution&&(((i=e.afterExecution)===null||i===void 0?void 0:i.navigateToInstance)===false||((o=e.afterExecution)===null||o===void 0?void 0:o.enableAutoScroll)===true)||!a){return false}return true}s.isActionNavigable=V;function $(e){var n;return(e===null||e===void 0?void 0:(n=e.afterExecution)===null||n===void 0?void 0:n.enableAutoScroll)===true}s.enableAutoScroll=$;function w(e){var n,t,i;return((n=e.annotations)===null||n===void 0?void 0:(t=n.UI)===null||t===void 0?void 0:(i=t.IsCopyAction)===null||i===void 0?void 0:i.valueOf())===true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}s.dataFieldIsCopyAction=w;function z(n){if(n.length===1){return n[0]}if(n.length>1){e.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.")}return undefined}s.getCopyAction=z;return s},false);