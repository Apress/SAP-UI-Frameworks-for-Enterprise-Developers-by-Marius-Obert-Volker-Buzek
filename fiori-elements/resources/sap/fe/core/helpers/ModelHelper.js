/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/UriParameters","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/TypeGuards"],function(t,e,n){"use strict";var o=n.isEntitySet;var i=e.getInvolvedDataModelObjects;const r={isStickySessionSupported:function(t){const e=t.getObject("/");for(const n in e){if(e[n].$kind==="EntitySet"&&t.getObject(`/${n}@com.sap.vocabularies.Session.v1.StickySessionSupported`)){return true}}return false},isDraftSupported:function(t,e){const n=t.getMetaContext(e);const o=i(n);return this.isObjectPathDraftSupported(o)},isObjectPathDraftSupported:function(t){var e,n,o,i,a,s,d;const u=t.targetEntitySet;const l=r.isDraftRoot(u);const c=r.isDraftNode(u);const g=(e=t.targetObject)!==null&&e!==void 0&&e.containsTarget&&((n=t.startingEntitySet)!==null&&n!==void 0&&(o=n.annotations)!==null&&o!==void 0&&(i=o.Common)!==null&&i!==void 0&&i.DraftRoot||(a=t.startingEntitySet)!==null&&a!==void 0&&(s=a.annotations)!==null&&s!==void 0&&(d=s.Common)!==null&&d!==void 0&&d.DraftNode)?true:false;return l||c||!u&&g},isCollaborationDraftSupported:function(e,n){if(t.fromQuery(window.location.search).get("sap-fe-xx-enableCollaborationDraft")==="true"){var o;const t=(n===null||n===void 0?void 0:(o=n.context)===null||o===void 0?void 0:o.getModel())||e;const i=t.getObject("/");for(const e in i){if(i[e].$kind==="EntitySet"&&t.getObject(`/${e}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`)){return true}}}return false},getDraftRootPath:function(t){const n=t.getModel().getMetaModel();const o=function(t,i){var r;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const s=a?t:(r=new RegExp(/.*(?=\/)/).exec(t))===null||r===void 0?void 0:r[0];if(s&&s!=="/"){var d,u;const t=n.getMetaPath(s);const r=e.getInvolvedDataModelObjects(n.getContext(t));if((d=r.targetEntitySet)!==null&&d!==void 0&&(u=d.annotations.Common)!==null&&u!==void 0&&u.DraftRoot){return s}return o(s,i,false)}return undefined};return o(t.getPath(),t.getModel())},getStickyRootPath:function(t){const n=t.getModel().getMetaModel();const o=function(t,i){var r;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const s=a?t:(r=new RegExp(/.*(?=\/)/).exec(t))===null||r===void 0?void 0:r[0];if(s&&s!=="/"){var d,u,l;const t=n.getMetaPath(s);const r=e.getInvolvedDataModelObjects(n.getContext(t));if((d=r.targetEntitySet)!==null&&d!==void 0&&(u=d.annotations)!==null&&u!==void 0&&(l=u.Session)!==null&&l!==void 0&&l.StickySessionSupported){return s}return o(s,i,false)}return undefined};return o(t.getPath(),t.getModel())},getTargetEntitySet:function(t){const e=t.getPath();if(t.getObject("$kind")==="EntitySet"||t.getObject("$kind")==="Action"||t.getObject("0/$kind")==="Action"){return e}const n=r.getEntitySetPath(e);return`/${t.getObject(n)}`},getEntitySetPath:function(t,e){let n="";if(!e){n=`/${t.split("/").filter(r.filterOutNavPropBinding).join("/$NavigationPropertyBinding/")}`}else{const o=t.split("/").filter(r.filterOutNavPropBinding);if(o.length>1){const t={growingPath:"/",pendingNavPropBinding:""};const i=o.reduce((t,n,o)=>{const i=!!o&&"/$NavigationPropertyBinding/"||"";let{growingPath:r,pendingNavPropBinding:a}=t;const s=r+i;const d=e.getObject(s);const u=a?`${a}/${n}`:n;if(d&&Object.keys(d).length>0&&d.hasOwnProperty(u)){r=s+u.replace("/","%2F");a=""}else{a+=a?`/${n}`:n}return{growingPath:r,pendingNavPropBinding:a}},t);n=i.growingPath}else{n=`/${o[0]}`}}return n},getActionParameterItemsModelPath:function(t){return t&&t.$Name?`{path: 'mvfview>/${t.$Name}'}`:undefined},filterOutNavPropBinding:function(t){return t!==""&&t!=="$NavigationPropertyBinding"},enhanceInternalJSONModel:function(t){const e=t.bindContext;t.bindContext=function(t,n,o){for(var i=arguments.length,r=new Array(i>3?i-3:0),a=3;a<i;a++){r[a-3]=arguments[a]}n=e.apply(this,[t,n,o,...r]);const s=n.getBoundContext;n.getBoundContext=function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++){e[n]=arguments[n]}const o=s.apply(this,...e);if(o&&!o.setProperty){o.setProperty=function(t,e){if(this.getObject()===undefined){this.getModel().setProperty(this.getPath(),{})}this.getModel().setProperty(t,e,this)}}return o};return n}},enhanceUiJSONModel:function(t,e){const n=t.setProperty;t.setProperty=function(){for(var o=arguments.length,i=new Array(o),r=0;r<o;r++){i[r]=arguments[r]}const a=i[1];if(i[0]==="/isEditable"){t.setProperty("/editMode",a?e.EditMode.Editable:e.EditMode.Display,i[2],i[3])}return n.apply(this,[...i])}},isFilteringCaseSensitive:function(t){if(!t){return undefined}const e=t.getObject("/@Org.OData.Capabilities.V1.FilterFunctions");return e?e.indexOf("tolower")===-1:true},getMetaPathForContext:function(t){const e=t.getModel(),n=e.getMetaModel(),o=t.getPath();return n&&o&&n.getMetaPath(o)},getRootEntitySetPath:function(t){let e="";const n=t?t.split("/"):[];if(n.length>1){e=n[1]}return e},getAbsoluteMetaPathForListBinding:function(t,e){const n=t.getModel().getMetaModel();let o;if(typeof e==="string"){if(e.startsWith("/")){o=n.getMetaPath(e)}else{const i=t.getBindingContext();const r=i.getPath();o=n.getMetaPath(`${r}/${e}`)}}else{const t=e;const i=t.getRootBinding();if(t===i){o=n.getMetaPath(t.getPath())}else{const e=i.getPath();const r=t.getPath();o=n.getMetaPath(`${e}/${r}`)}}return o},isDraftRoot:function(t){return this.getDraftRoot(t)!==undefined},isDraftNode:function(t){return this.getDraftNode(t)!==undefined},isSticky:function(t){return this.getStickySession(t)!==undefined},isUpdateHidden:function(t,e){if(o(t)){var n,i;return((n=t.annotations.UI)===null||n===void 0?void 0:n.UpdateHidden)??(e===null||e===void 0?void 0:(i=e.annotations.UI)===null||i===void 0?void 0:i.UpdateHidden)??false}else{return false}},getDraftRoot:function(t){var e;return o(t)?(e=t.annotations.Common)===null||e===void 0?void 0:e.DraftRoot:undefined},getDraftNode:function(t){var e;return o(t)?(e=t.annotations.Common)===null||e===void 0?void 0:e.DraftNode:undefined},getStickySession:function(t){var e;return o(t)?(e=t.annotations.Session)===null||e===void 0?void 0:e.StickySessionSupported:undefined},getDeleteHidden:function(t,e){if(o(t)){var n,i;return((n=t.annotations.UI)===null||n===void 0?void 0:n.DeleteHidden)??((i=e.annotations.UI)===null||i===void 0?void 0:i.DeleteHidden)}else{return false}}};return r},false);