/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/ViewState","sap/fe/core/helpers/ClassSupport","sap/fe/core/helpers/KeepAliveHelper","sap/m/IllustratedMessage","sap/m/Page","./RootViewBaseController"],function(e,t,n,r,o,i,a,s){"use strict";var l,c,u,g,f;var p=r.usingExtension;var d=r.defineUI5Class;function h(e,t,n,r){if(!n)return;Object.defineProperty(e,t,{enumerable:n.enumerable,configurable:n.configurable,writable:n.writable,value:n.initializer?n.initializer.call(r):void 0})}function C(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function v(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;w(e,t)}function w(e,t){w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,n){t.__proto__=n;return t};return w(e,t)}function P(e,t,n,r,o){var i={};Object.keys(r).forEach(function(e){i[e]=r[e]});i.enumerable=!!i.enumerable;i.configurable=!!i.configurable;if("value"in i||i.initializer){i.writable=true}i=n.slice().reverse().reduce(function(n,r){return r(e,t,n)||n},i);if(o&&i.initializer!==void 0){i.value=i.initializer?i.initializer.call(o):void 0;i.initializer=undefined}if(i.initializer===void 0){Object.defineProperty(e,t,i);i=null}return i}function b(e,t){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let y=(l=d("sap.fe.core.rootView.NavContainer"),c=p(n.override({applyInitialStateOnly:function(){return false},adaptBindingRefreshControls:function(e){const t=this.getView(),n=t.getController();e.push(n._getCurrentPage(t))},adaptStateControls:function(e){const t=this.getView(),n=t.getController();e.push(n._getCurrentPage(t))},onRestore:function(){const e=this.getView(),t=e.getController(),n=t.getAppContentContainer();const r=n.getModel("internal");const o=r.getProperty("/pages");for(const e in o){r.setProperty(`/pages/${e}/restoreStatus`,"pending")}t.onContainerReady()},onSuspend:function(){const e=this.getView(),n=e.getController(),r=n.getAppContentContainer();const o=r.getPages();o.forEach(function(e){const n=t.getTargetView(e);const r=n&&n.getController();if(r&&r.viewState&&r.viewState.onSuspend){r.viewState.onSuspend()}})}})),l(u=(g=function(n){v(r,n);function r(){var e;for(var t=arguments.length,r=new Array(t),o=0;o<t;o++){r[o]=arguments[o]}e=n.call(this,...r)||this;h(e,"viewState",f,C(e));return e}var s=r.prototype;s.onContainerReady=function e(){const n=this.getView(),r=this._getCurrentPage(n);return r.then(function(e){const n=t.getTargetView(e);return o.restoreView(n)})};s._getCurrentPage=function e(n){const r=this.getAppContentContainer();return new Promise(function(e){const o=r.getCurrentPage();if(o&&o.getController&&o.getController().isPlaceholder&&o.getController().isPlaceholder()){o.getController().attachEventOnce("targetPageInsertedInContainer",function(r){const o=r.getParameter("targetpage");const i=t.getTargetView(o);e(i!==n&&i)})}else{const r=t.getTargetView(o);e(r!==n&&r)}})};s._getNavContainer=function e(){return this.getAppContentContainer()};s.getInstancedViews=function e(){return this._getNavContainer().getPages().map(e=>e.getComponentInstance().getRootControl())};s.isFclEnabled=function e(){return false};s._scrollTablesToLastNavigatedItems=function e(){};s.displayErrorPage=function n(r,o){return new Promise((n,s)=>{try{const e=this._getNavContainer();if(!this.oPage){this.oPage=new a({showHeader:false});this.oIllustratedMessage=new i({title:r,description:o.description||"",illustrationType:`sapIllus-${o.errorType}`});this.oPage.insertContent(this.oIllustratedMessage,0);e.addPage(this.oPage)}if(o.handleShellBack){const n=e.getCurrentPage(),r=t.getAppComponent(e.getCurrentPage());r.getShellServices().setBackNavigation(function(){e.to(n.getId());r.getShellServices().setBackNavigation()})}e.attachAfterNavigate(function(){n(true)});e.to(this.oPage.getId())}catch(t){s(false);e.info(t)}})};return r}(s),f=P(g.prototype,"viewState",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),g))||u);return y},false);