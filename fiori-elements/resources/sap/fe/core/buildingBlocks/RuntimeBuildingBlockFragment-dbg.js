/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/helpers/BindingToolkit","sap/fe/core/helpers/ClassSupport","sap/fe/core/jsx-runtime/jsx","sap/ui/base/ManagedObject","sap/ui/core/Component","sap/ui/core/Fragment"],function(e,n,t,i,r,o,a){"use strict";var l,s,c,u,d;var f={};var p=t.event;var g=t.defineUI5Class;var v=n.resolveBindingString;function b(e,n,t,i){if(!t)return;Object.defineProperty(e,n,{enumerable:t.enumerable,configurable:t.configurable,writable:t.writable,value:t.initializer?t.initializer.call(i):void 0})}function m(e){if(e===void 0){throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}return e}function h(e,n){e.prototype=Object.create(n.prototype);e.prototype.constructor=e;y(e,n)}function y(e,n){y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(n,t){n.__proto__=t;return n};return y(e,n)}function w(e,n,t,i,r){var o={};Object.keys(i).forEach(function(e){o[e]=i[e]});o.enumerable=!!o.enumerable;o.configurable=!!o.configurable;if("value"in o||o.initializer){o.writable=true}o=t.slice().reverse().reduce(function(t,i){return i(e,n,t)||t},o);if(r&&o.initializer!==void 0){o.value=o.initializer?o.initializer.call(r):void 0;o.initializer=undefined}if(o.initializer===void 0){Object.defineProperty(e,n,o);o=null}return o}function O(e,n){throw new Error("Decorating class property failed. Please ensure that "+"proposal-class-properties is enabled and runs after the decorators transform.")}let C=(l=g("sap.fe.core.buildingBlocks.RuntimeBuildingBlockFragment"),s=p(),l(c=(u=function(e){h(n,e);function n(){var n;for(var t=arguments.length,i=new Array(t),r=0;r<t;r++){i[r]=arguments[r]}n=e.call(this,...i)||this;b(n,"functionHolder",d,m(n));return n}f=n;return n}(a),d=w(u.prototype,"functionHolder",[s],{configurable:true,enumerable:true,writable:true,initializer:null}),u))||c);f=C;const j={};function k(e){j[`${e.metadata.namespace??e.metadata.publicNamespace}.${e.metadata.name}`]=e}f.storeRuntimeBlock=k;C.registerType("FE_COMPONENTS",{load:async function(e){return Promise.resolve(j[e.fragmentName])},init:function(n){var t,a,l,s,c,u,d,f,p,g;let b=n.fragmentContent;if(b===undefined){b=j[n.fragmentName]}if(b===undefined){throw new Error(`No building block class for runtime building block ${n.fragmentName} found`)}const m={};const h=((t=n.customData)===null||t===void 0?void 0:(a=t[0])===null||a===void 0?void 0:(l=a.mProperties)===null||l===void 0?void 0:(s=l.value)===null||s===void 0?void 0:s["sap.fe.core.buildingBlocks"])||{};delete n.customData;const y=n.functionHolder??[];delete n.functionHolder;const w=((c=(u=n.containingView).getController)===null||c===void 0?void 0:(d=(f=c.call(u)).getView)===null||d===void 0?void 0:d.call(f))??n.containingView;const O=o.getOwnerComponentFor(w);const C=e.getAppComponent(w);const k=C.getMetaModel();const _=O.getModel("_pageModel");const z=(p=h.functionStringInOrder)===null||p===void 0?void 0:p.split(",");const B=(g=h.propertiesAssignedToFunction)===null||g===void 0?void 0:g.split(",");for(const e in b.metadata.properties){const n=b.metadata.properties[e];const t=_.createBindingContext(h[e]);if(t===null){let t=h[e];if(typeof t==="string"){if(n.bindable!==true){switch(n.type){case"boolean":t=t==="true";break;case"number":t=Number(t);break}}else{t=v(t,n.type)}}else if(n.type==="function"){const n=B.indexOf(e);const i=z[n];const r=y===null||y===void 0?void 0:y.find(e=>{var n;return((n=e[0])===null||n===void 0?void 0:n._sapui_handlerName)===i});if(r&&r.length>1){t=r[0].bind(r[1])}}m[e]=t}else if(t.getObject()!==undefined){m[e]=t.getObject()}else{m[e]=k.createBindingContext(h[e])}}return r.runWithPreprocessors(()=>{const e=i.withContext({view:w,appComponent:C},()=>{var e,n;const t={models:{"sap.fe.i18n":w.getModel("sap.fe.i18n")}};return(e=(n=new b(m,{},t)).getContent)===null||e===void 0?void 0:e.call(n,w,C)});if(!this._bAsync){this._aContent=e}return e},{id:function(e){return w.createId(e)},settings:function(e){const t=this.getMetadata().getAssociations();for(const i of Object.keys(t)){if(e[i]!==undefined){const t=Array.isArray(e[i])?e[i]:[e[i]];e[i]=t.map(e=>typeof e==="string"?n.containingView.createId(e):e)}}return e}})}});return f},false);