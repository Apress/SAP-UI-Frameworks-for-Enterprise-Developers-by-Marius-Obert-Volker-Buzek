/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/macros/CommonHelper","sap/fe/macros/DelegateUtil","sap/ui/model/json/JSONModel","sap/ui/model/ListBinding"],function(e,t,o,n){"use strict";const a={createLayout:async function(n){var a;const i=n.modifier,r=(a=n.appComponent)===null||a===void 0?void 0:a.getMetaModel(),s=n.element;let l=await t.getCustomData(s,"entitySet",i);if(!l){l=await t.getCustomData(s,"navigationPath",i)}const d=l.startsWith("/")?`${l}`:`/${l}`;const c=n.parentSelector?n.modifier.bySelector(n.parentSelector,n.appComponent,n.view):undefined;const p=await t.getCustomData(c,"navigationPath",i);const m=p?`${d}/${p}`:d;const u=r===null||r===void 0?void 0:r.getMetaContext(m);const v=r===null||r===void 0?void 0:r.createBindingContext(`${m}/${n.bindingPath}`);const f=n.element.sId||n.element.id;const g={sPropertyName:n.bindingPath,sBindingPath:m,sValueHelpType:"FormVH",oControl:s,oMetaModel:r,oModifier:i};function h(e){var a;const s=new o({id:f,idPrefix:(a=n.fieldSelector)===null||a===void 0?void 0:a.id}),l={bindingContexts:{entitySet:u,contextPath:u,property:v,this:s.createBindingContext("/")},models:{this:s,entitySet:r,contextPath:r,metaModel:r,property:r}};return t.templateControlFragment(e,l,{},i)}async function C(a,l,d){var c;const p=await t.getCustomData(s,"onChange",i);const m=await t.getCustomData(s,"displayMode",i);const f=new o({_flexId:(c=n.fieldSelector)===null||c===void 0?void 0:c.id,onChange:e.removeEscapeCharacters(p),displayMode:e.removeEscapeCharacters(m),navigationPath:d});const g={bindingContexts:{entitySet:u,dataField:v,this:f.createBindingContext("/")},models:{this:f,entitySet:r,metaModel:r,dataField:r},appComponent:n.appComponent};return t.templateControlFragment(a,g,{view:l},i)}const y=await t.isValueHelpRequired(g);const b=await t.doesValueHelpExist(g);let F;if(y&&!b){F=await h("sap.fe.macros.form.ValueHelpWrapper")}const P=await C("sap.fe.macros.form.FormElementFlexibility",n.view,p);return{control:P,valueHelp:F}},getPropertyInfo:function(e){function t(e){if(e&&e.$Type){if(e.$Type.toLowerCase().indexOf("edm")!==0){return true}}return false}function o(e,t){return t.some(function(t){return e.startsWith(t)})}function a(e,a,i,r,s,l,d){const c={name:e,bindingPath:e,entityType:r};const p=i["@com.sap.vocabularies.UI.v1.DataFieldDefault"];const m=p&&p.Label||i["@com.sap.vocabularies.Common.v1.Label"];c.label=m||"[LABEL_MISSING: "+e+"]";const u=i["@com.sap.vocabularies.UI.v1.Hidden"];c.hideFromReveal=u;if(u&&u.$Path){var v;c.hideFromReveal=(v=s.getBindingContext())===null||v===void 0?void 0:v.getProperty(u.$Path)}if(!c.hideFromReveal){c.hideFromReveal=i["@com.sap.vocabularies.UI.v1.AdaptationHidden"]}let f;if(!c.hideFromReveal){f=i["@com.sap.vocabularies.Common.v1.FieldControl"];if(f){c.hideFromReveal=f.$EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}}f=i["@com.sap.vocabularies.Common.v1.FieldControl"];const g=f&&f.Path;if(g&&!c.hideFromReveal){const e=s.getBinding(l)instanceof n;if(!e){var h;const e=(h=s.getBindingContext())===null||h===void 0?void 0:h.getProperty(g);c.hideFromReveal=e===0}}if(p&&(p.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||p.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||p.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction"||p.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){c.unsupported=true}if(o(e,d)||t(a)){c.unsupported=true}return c}function i(e,t,o,n,i){const r=[];let s="";const l=[];let d;for(s in e){d=e[s];if(d.$kind==="NavigationProperty"){l.push(s)}}for(s in e){d=e[s];if(d.$kind==="Property"){const e=o.getObject("/"+t+"/"+s+"@");const c=a(s,d,e,t,n,i,l);r.push(c)}}return r}function r(e,t){if(t.path){return t.path}const o=e.getBindingContext();if(o){if(e.data("navigationPath")){return o.getPath()+"/"+e.data("navigationPath")}return o.getPath()}}function s(e,t,o){const n=e.getModel(o.modelName);if(n){if(n.isA("sap.ui.model.odata.v4.ODataModel")){const a=n.getMetaModel();const s=r(e,o);if(s){const o=a.getMetaContext(s);const n=o.getObject();const r=o.getObject(n.$Type);return i(r,n.$Type,a,e,t)}}}return Promise.resolve([])}return Promise.resolve().then(function(){return s(e.element,e.aggregationName,e.payload)})}};return a},false);