/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/ClassSupport","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/Operator","sap/ui/mdc/enum/FieldDisplay","sap/ui/model/SimpleType","sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(e,t,r,n,a,o,i,s,u,p,l){"use strict";var f,c,d;var y={};var m=t.defineUI5Class;function _(e,t){e.prototype=Object.create(t.prototype);e.prototype.constructor=e;T(e,t)}function T(e,t){T=Object.setPrototypeOf?Object.setPrototypeOf.bind():function e(t,r){t.__proto__=r;return t};return T(e,t)}let h=(f=m("sap.fe.macros.filter.type.Value"),f(c=(d=function(t){_(o,t);function o(e,n){var a;a=t.call(this,e,n)||this;const o=(e===null||e===void 0?void 0:e.operator)||a.getDefaultOperatorName();a.operator=r.getOperator(o);if(!a.operator&&o.includes(".")){a._registerCustomOperator(o)}return a}y=o;var f=o.prototype;f._registerCustomOperator=function e(t){const a=t.substring(0,t.lastIndexOf(".")).replace(/\./g,"/"),o=t.substring(t.lastIndexOf(".")+1);sap.ui.require([a],e=>{if(!e){return}this.operator=new n({filterOperator:"",tokenFormat:"",name:t,valueTypes:["self"],tokenParse:"^(.*)$",format:e=>this.formatConditionValues(e.values),parse:function(e,r,a,o){if(typeof e==="object"){if(e.operator!==t){throw Error("not matching operator")}return e.values}return n.prototype.parse.apply(this,[e,r,a,o])},getModelFilter:t=>e[o].call(e,this.formatConditionValues(t.values))});r.addOperator(this.operator)})};f._isMultiValueOperator=function e(t){return t.valueTypes.filter(function(e){return!!e&&e!==o.OPERATOR_VALUE_TYPE_STATIC}).length>1};f.hasCustomOperator=function e(){return this.operator.name.includes(".")};f._stringToExternal=function e(t,r){let n;const a=this._getTypeInstance(r);if(r&&o._isArrayType(r)){if(!Array.isArray(t)){t=[t]}n=t.map(e=>a?a.parseValue(e,o.INTERNAL_VALUE_TYPE):e)}else{n=a?a.parseValue(t,o.INTERNAL_VALUE_TYPE):t}return n};o._isArrayType=function e(t){if(!t){return false}return t==="array"||t.endsWith("[]")};f._externalToString=function e(t,r){let n;const a=this._getTypeInstance(r);if(r&&o._isArrayType(r)){if(!Array.isArray(t)){t=[t]}n=t.map(e=>a?a.formatValue(e,o.INTERNAL_VALUE_TYPE):e)}else{n=a?a.formatValue(t,o.INTERNAL_VALUE_TYPE):t}return n};f._getTypeInstance=function t(r){r=this.getElementTypeName(r)||r;switch(r){case"string":return new l;case"number":case"int":return new p;case"float":return new u;case"date":return new s;case"boolean":return new i;default:e.error("Unexpected filter type");throw new Error("Unexpected filter type")}};f.getDefaultOperatorName=function e(){return r.getEQOperator().name};f.formatConditionValues=function e(t){return Array.isArray(t)&&t.length?t[0]:t};f.getElementTypeName=function e(t){if(t!==null&&t!==void 0&&t.endsWith("[]")){return t.substring(0,t.length-2)}return undefined};f.formatValue=function e(t,r){if(!t){return undefined}const n=this._isMultiValueOperator(this.operator),i=this._getTypeInstance(o.INTERNAL_VALUE_TYPE);const s=this.operator.parse(t||"",i,a.Value,false);const u=!n&&Array.isArray(s)?s[0]:s;return this._stringToExternal(u,r)};f.parseValue=function e(t,r){if(!t){return undefined}const n=this._isMultiValueOperator(this.operator),a=this._getTypeInstance(r);const o=this._externalToString(t,r);const i=n?o:[o];if(this.hasCustomOperator()){return{operator:this.operator.name,values:[this.operator.format({values:i},a)],validated:undefined}}return this.operator.format({values:i},a)};f.validateValue=function e(t){};return o}(o),d.INTERNAL_VALUE_TYPE="string",d.OPERATOR_VALUE_TYPE_STATIC="static",d))||c);y=h;return y},false);