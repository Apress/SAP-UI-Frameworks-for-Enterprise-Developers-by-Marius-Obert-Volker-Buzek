/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/collaboration/ActivitySync","sap/fe/core/controllerextensions/collaboration/CollaborationCommon"],function(e,n,t){"use strict";var i=t.Activity;function o(n){const t=e.getTargetView(n);return t.findElements(true,function(e){return!!(e.getFieldHelp&&e.getDomRef()&&e.getFieldHelp()===n.getId())})[0]}function l(e){const t=e.getSource();const o=d.getRelatedFieldFromValueHelp(t);const l=n.isConnected(o);if(l&&o.getBinding("value")){var g,a,u,s,v;const e=(g=o.getBinding("value"))!==null&&g!==void 0&&g.isA("sap.ui.model.CompositeBinding")?`${(a=o.getBindingContext())===null||a===void 0?void 0:a.getPath()}/${(u=o.getBinding("value"))===null||u===void 0?void 0:u.getBindings()[0].getPath()}`:`${(s=o.getBindingContext())===null||s===void 0?void 0:s.getPath()}/${(v=o.getBinding("value"))===null||v===void 0?void 0:v.getPath()}`;n.send(o,i.LiveChange,e)}}function g(e){var t;const o=e.getSource();const l=d.getRelatedFieldFromValueHelp(o);const g=n.isConnected(l);const a=(t=l.getBinding("value"))===null||t===void 0?void 0:t.isA("sap.ui.model.CompositeBinding");const u=a?l.getValue()[1]:l.getValue();return new Promise(e=>{setTimeout(function(){var t;const d=a?o.getConditions()[0].values[0]:(t=l.getBinding("value"))===null||t===void 0?void 0:t.getValue();if(g&&u===d){var s,v,c;const e=a?`${(s=l.getBindingContext())===null||s===void 0?void 0:s.getPath()}/${l.getBinding("value").getBindings()[0].getPath()}`:`${(v=l.getBindingContext())===null||v===void 0?void 0:v.getPath()}/${(c=l.getBinding("value"))===null||c===void 0?void 0:c.getPath()}`;n.send(l,i.Undo,e)}e()},0)})}const d={getRelatedFieldFromValueHelp:o,onValueHelpOpenDialog:l,onValueHelpCloseDialog:g};return d},false);