/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2023 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/core/message/Message"],function(e,s){"use strict";var t={};let a=function(){function a(){const s=e.getMessageManager();this.customMessageInfo={messageManagerDataBinding:s.getMessageModel().bindList("/"),multiModeControlMessagesMap:{}}}t.LRMessageStrip=a;var n=a.prototype;n.getCustomMessageInfo=function e(){return this.customMessageInfo};n.destroy=function e(){this.customMessageInfo.messageManagerDataBinding.detachChange(this._eventHandlerCustomMessage,this)};n._getMessagesWithSameTargetThanCustomMessage=function s(){const t=e.getMessageManager();return t.getMessageModel().getData().filter(e=>{var s;return e.getTargets()[0]===((s=this.customMessageInfo.currentMessage)===null||s===void 0?void 0:s.getTargets()[0])&&e!==this.customMessageInfo.currentMessage})};n._eventHandlerCustomMessage=function s(){const t=e.getMessageManager();if(this.customMessageInfo.currentMessage){const e=this._getMessagesWithSameTargetThanCustomMessage();const s=!!t.getMessageModel().getData().find(e=>e===this.customMessageInfo.currentMessage);if(e.length>0&&s){var a;t.removeMessages([(a=this.customMessageInfo)===null||a===void 0?void 0:a.currentMessage])}else if(e.length===0&&!s){t.addMessages([this.customMessageInfo.currentMessage])}}};n.createCustomMessage=function t(a,n){var o,g;const i=n.message;const r=n.table;const c=n.skipMessageManagerUpdate;const M=(o=r.getRowBinding())===null||o===void 0?void 0:o.getPath();const l=e.getMessageManager();const u=this.customMessageInfo.multiModeControlMessagesMap;u[r.getId()]=i;if(!M){r.attachEventOnce("bindingUpdated",n,this.createCustomMessage,this);return}if((g=u[r.getId()])!==null&&g!==void 0&&g.onClose){var d;r.getDataStateIndicator().detachEvent("close",(d=u[r.getId()])===null||d===void 0?void 0:d.onClose,this)}const h=r.getModel();const m=i?new s({message:i.message,type:i.type,target:[M],persistent:true,processor:h}):null;this.customMessageInfo.messageManagerDataBinding.detachChange(this._eventHandlerCustomMessage,this);if(!c){if(this.customMessageInfo.currentMessage){l.removeMessages([this.customMessageInfo.currentMessage])}if(m){this.customMessageInfo.currentMessage=m}else{delete this.customMessageInfo.currentMessage}if(m&&this._getMessagesWithSameTargetThanCustomMessage().length===0){l.addMessages([m])}}this.customMessageInfo.messageManagerDataBinding.attachChange(this._eventHandlerCustomMessage,this);this.attachDataStateIndicatorCloseEvent(r,u,i===null||i===void 0?void 0:i.onClose)};n.attachDataStateIndicatorCloseEvent=function e(s,t,a){if(a){s.getDataStateIndicator().attachEventOnce("close",a,this)}s.getDataStateIndicator().attachEventOnce("close",()=>{delete t[s.getId()]})};n.onSelectMultipleModeControl=function e(s,t){const a=t._getTable();const n=this.customMessageInfo.multiModeControlMessagesMap[a.getId()];this.createCustomMessage(null,{message:n,table:a})};n.showCustomMessage=function e(s,t,a,n){const o=Array.isArray(a)?a:[a];const g=t._isMultiMode();let i;if(s){s.onClose=n}if(g){const e=t._getMultiModeControl();e.detachEvent("select",this.onSelectMultipleModeControl,this);e.attachEvent("select",t,this.onSelectMultipleModeControl,this);e.getAllInnerControls(true).forEach((t,n)=>{if(t.isA("sap.fe.macros.table.TableAPI")){if(!a||o.indexOf(n.toString())!==-1){i=t.getContent();this.createCustomMessage(null,{message:s,table:i,skipMessageManagerUpdate:e.getSelectedInnerControl()!==t})}}});return}i=t._getTable();this.createCustomMessage(null,{message:s,table:i})};return a}();t.LRMessageStrip=a;return t},false);