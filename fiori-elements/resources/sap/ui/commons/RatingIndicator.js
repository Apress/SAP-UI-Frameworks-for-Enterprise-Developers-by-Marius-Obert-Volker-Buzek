/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/thirdparty/jquery","./library","sap/ui/core/Control","./RatingIndicatorRenderer","sap/ui/events/checkMouseEnterOrLeave"],function(e,t,a,i,r){"use strict";var o=t.RatingIndicatorVisualMode;var u=a.extend("sap.ui.commons.RatingIndicator",{metadata:{library:"sap.ui.commons",deprecated:true,properties:{editable:{type:"boolean",group:"Behavior",defaultValue:true},maxValue:{type:"int",group:"Behavior",defaultValue:5},value:{type:"float",group:"Behavior",defaultValue:0,bindable:"bindable"},averageValue:{type:"float",group:"Behavior",defaultValue:0},iconSelected:{type:"sap.ui.core.URI",group:"Behavior",defaultValue:null},iconUnselected:{type:"sap.ui.core.URI",group:"Behavior",defaultValue:null},iconHovered:{type:"sap.ui.core.URI",group:"Behavior",defaultValue:null},visualMode:{type:"sap.ui.commons.RatingIndicatorVisualMode",group:"Behavior",defaultValue:o.Half}},associations:{ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{change:{parameters:{value:{type:"int"}}}}}});u.NoValue=-9999;u.prototype.init=function(){this.iHoveredRating=-1};u.prototype.exit=function(){};u.prototype.onThemeChanged=function(e){if(this.getDomRef()){this.invalidate()}};u.prototype.ondragstart=function(e){e.preventDefault()};u.prototype._getDisplayValue=function(){var e=this.getValue();if(e==u.NoValue){return this.getAverageValue()}else{return e}};u.prototype.onsapincrease=function(e){var t=this.iHoveredRating;if(t==-1){t=Math.round(this._getDisplayValue())-1;if(t==-1){t=0}}if(t<this.getMaxValue()){t=t+1}else{t=this.getMaxValue()}this.updateHoverState(e,t)};u.prototype.onsapdecrease=function(e){var t=this.iHoveredRating;if(t==-1&&Math.round(this._getDisplayValue())==0){return}if(t==-1){t=Math.round(this._getDisplayValue())+1}if(t>1){t=t-1}else{t=1}this.updateHoverState(e,t)};u.prototype.onsaphome=function(e){this.updateHoverState(e,1)};u.prototype.onsapend=function(e){this.updateHoverState(e,this.getMaxValue())};u.prototype.onsapselect=function(e){this.saveValue(e,true,this.iHoveredRating)};u.prototype.onsapescape=function(e){this.saveValue(e,true,-1)};u.prototype.onfocusout=function(e){this.saveValue(e,false,this.iHoveredRating)};u.prototype.onclick=function(e){this.saveValue(e,true,this.getSymbolValue(e))};u.prototype.onmouseover=function(e){e.preventDefault();e.stopPropagation();if(!this.getEditable()){return}this.iHoveredRating=-1;var t=this.getSymbolValue(e);if(t==-1){return}for(var a=1;a<=t;a++){i.hoverRatingSymbol(a,this)}for(var a=t+1;a<=this.getMaxValue();a++){i.hoverRatingSymbol(a,this,true)}};u.prototype.onmouseout=function(e){e.preventDefault();e.stopPropagation();if(!this.getEditable()){return}if(r(e,this.getDomRef())){this.iHoveredRating=-1;for(var t=1;t<=this.getMaxValue();t++){i.unhoverRatingSymbol(t,this)}}};u.prototype.getSymbolValue=function(t){var a=e(t.target);if(a.hasClass("sapUiRatingItmImg")||a.hasClass("sapUiRatingItmOvrflw")){a=e(t.target.parentNode)}else if(a.hasClass("sapUiRatingItmOvrflwImg")){a=e(t.target.parentNode.parentNode)}var i=a.attr("itemvalue");if(i){return parseInt(i)}return-1};u.prototype.updateKeyboardHoverState=function(e){for(var t=1;t<=this.getMaxValue();t++){i.unhoverRatingSymbol(t,this);if(t<=this.iHoveredRating){i.hoverRatingSymbol(t,this)}else if(!e){i.hoverRatingSymbol(t,this,true)}}this.setAriaState()};u.prototype.onAfterRendering=function(){this.setAriaState()};u.prototype.setAriaState=function(){var e=this.iHoveredRating==-1?this._getDisplayValue():this.iHoveredRating;this.$().attr("aria-valuenow",e).attr("aria-valuetext",this._getText("RATING_ARIA_VALUE",[e])).attr("aria-label",this._getText("RATING_ARIA_NAME"))};u.prototype._getText=function(e,t){var a=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");if(a){return a.getText(e,t)}return e};u.prototype.saveValue=function(e,t,a){if(t){e.preventDefault()}if(!this.getEditable()){return false}this.iHoveredRating=-1;if(a!=-1&&a!=this.getValue()){this.setValue(a);this.fireChange({value:a});return true}else{for(var r=1;r<=this.getMaxValue();r++){i.unhoverRatingSymbol(r,this)}this.setAriaState();return false}};u.prototype.updateHoverState=function(e,t){e.preventDefault();e.stopPropagation();if(!this.getEditable()){return}this.iHoveredRating=t;this.updateKeyboardHoverState()};u.prototype.setMaxValue=function(e){if(e<1){e=1}this.setProperty("maxValue",e);return this};u.prototype.getAccessibilityInfo=function(){var e=sap.ui.getCore().getLibraryResourceBundle("sap.ui.commons");return{role:"slider",type:e.getText("ACC_CTR_TYPE_RATING"),description:e.getText("ACC_CTR_STATE_RATING",[this._getDisplayValue(),this.getMaxValue()]),focusable:true,editable:this.getEditable()}};return u});