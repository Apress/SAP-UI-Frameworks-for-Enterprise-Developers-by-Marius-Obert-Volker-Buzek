/* Tiny Comments plugin
*
* Copyright 2010-2020 Tiny Technologies Inc. All rights reserved.
*
* Version: 2.1.3-99
*/
!function(h){"use strict";var p=function(n){var e=n,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return p(t())}}},s=function(){},g=function(n){return function(){return n}},n=function(n){return n};var e,t,o,r,i,u,c,a=g(!1),f=g(!0),d=function(){return m},m=(e=function(n){return n.isNone()},r={fold:function(n,e){return n()},is:a,isSome:a,isNone:f,getOr:o=function(n){return n},getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},getOrNull:g(null),getOrUndefined:g(void 0),or:o,orThunk:t,map:d,each:s,bind:d,exists:a,forall:f,filter:d,equals:e,equals_:e,toArray:function(){return[]},toString:g("none()")},Object.freeze&&Object.freeze(r),r),l=function(t){var n=g(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},is:function(n){return t===n},isSome:f,isNone:a,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return l(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:m},toArray:function(){return[t]},toString:function(){return"some("+t+")"},equals:function(n){return n.is(t)},equals_:function(n,e){return n.fold(a,function(n){return e(t,n)})}};return r},_={some:l,none:d,from:function(n){return null==n?m:l(n)}},v=function(n){return parseInt(n,10)},y=function(n,e){var t=n-e;return 0===t?0:0<t?1:-1},w=function(n,e,t){return{major:n,minor:e,patch:t}},b=function(n){var e=/([0-9]+)\.([0-9]+)\.([0-9]+)(?:(\-.+)?)/.exec(n);return e?w(v(e[1]),v(e[2]),v(e[3])):w(0,0,0)},T=function(n,e){var t=y(n.major,e.major);if(0!==t)return t;var o=y(n.minor,e.minor);if(0!==o)return o;var r=y(n.patch,e.patch);return 0!==r?r:0},O=function(n){return b([(e=n).majorVersion,e.minorVersion].join(".").split(".").slice(0,3).join("."));var e},E=function(n,e){return!!n&&-1===T(O(n),b(e))},S=0,C=function(n){var e=(new Date).getTime();return n+"_"+Math.floor(1e9*Math.random())+ ++S+String(e)},x=function(e){return function(n){return function(n){if(null===n)return"null";var e=typeof n;return"object"===e&&(Array.prototype.isPrototypeOf(n)||n.constructor&&"Array"===n.constructor.name)?"array":"object"===e&&(String.prototype.isPrototypeOf(n)||n.constructor&&"String"===n.constructor.name)?"string":e}(n)===e}},D=x("string"),A=x("object"),N=x("boolean"),k=x("function"),M=x("number"),R=Array.prototype.slice,j=Array.prototype.indexOf,I=function(n,e){return t=n,o=e,-1<j.call(t,o);var t,o},L=function(n,e){for(var t=n.length,o=new Array(t),r=0;r<t;r++){var i=n[r];o[r]=e(i,r)}return o},U=function(n,e){for(var t=0,o=n.length;t<o;t++){e(n[t],t)}},F=function(n,e){for(var t=[],o=0,r=n.length;o<r;o++){var i=n[o];e(i,o)&&t.push(i)}return t},P=function(n,e){for(var t=0,o=n.length;t<o;t++){var r=n[t];if(e(r,t))return _.some(r)}return _.none()},B=(k(Array.from)&&Array.from,Object.keys),H=Object.hasOwnProperty,V=function(n,e){for(var t=B(n),o=0,r=t.length;o<r;o++){var i=t[o];e(n[i],i)}},Y=function(n,t){return q(n,function(n,e){return{k:e,v:t(n,e)}})},q=function(n,o){var r={};return V(n,function(n,e){var t=o(n,e);r[t.k]=t.v}),r},W=(h.Node.ATTRIBUTE_NODE,h.Node.CDATA_SECTION_NODE,h.Node.COMMENT_NODE),X=h.Node.DOCUMENT_NODE,z=(h.Node.DOCUMENT_TYPE_NODE,h.Node.DOCUMENT_FRAGMENT_NODE,h.Node.ELEMENT_NODE),G=(h.Node.TEXT_NODE,h.Node.PROCESSING_INSTRUCTION_NODE,h.Node.ENTITY_REFERENCE_NODE,h.Node.ENTITY_NODE,h.Node.NOTATION_NODE,void 0!==h.window?h.window:Function("return this;")(),function(n,e,t){if(!(D(t)||N(t)||M(t)))throw h.console.error("Invalid call to Attr.set. Key ",e,":: Value ",t,":: Element ",n),new Error("Attribute value was not simple");n.setAttribute(e,t+"")}),J=function(n,e,t){G(n.dom(),e,t)},$=function(n,e){n.dom().removeAttribute(e)},K=function(n){if(null==n)throw new Error("Node cannot be null or undefined");return{dom:g(n)}},Q={fromHtml:function(n,e){var t=(e||h.document).createElement("div");if(t.innerHTML=n,!t.hasChildNodes()||1<t.childNodes.length)throw h.console.error("HTML does not have a single root node",n),new Error("HTML must have a single root node");return K(t.childNodes[0])},fromTag:function(n,e){var t=(e||h.document).createElement(n);return K(t)},fromText:function(n,e){var t=(e||h.document).createTextNode(n);return K(t)},fromDom:K,fromPoint:function(n,e,t){var o=n.dom();return _.from(o.elementFromPoint(e,t)).map(K)}},Z=(c=!(i=function(){return nn(Q.fromDom(h.document))}),function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return c||(c=!0,u=i.apply(null,n)),u}),nn=function(n){var e=n.dom().body;if(null==e)throw new Error("Body is not available yet");return Q.fromDom(e)},en=function(n,e){return-1!==n.indexOf(e)},tn=function(n,e,t){if(!D(t))throw h.console.error("Invalid call to CSS.set. Property ",e,":: Value ",t,":: Element ",n),new Error("CSS value must be a string: "+t);var o;void 0!==(o=n).style&&k(o.style.getPropertyValue)&&n.style.setProperty(e,t)},on=function(n,e,t){return 0!=(n.compareDocumentPosition(e)&t)},rn=function(n,e){return on(n,e,h.Node.DOCUMENT_POSITION_CONTAINED_BY)},un=function(){return(un=Object.assign||function(n){for(var e,t=1,o=arguments.length;t<o;t++)for(var r in e=arguments[t])Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}).apply(this,arguments)};var cn,an,sn,fn=function(){return dn(0,0)},dn=function(n,e){return{major:n,minor:e}},mn={nu:dn,detect:function(n,e){var t=String(e).toLowerCase();return 0===n.length?fn():function(n,e){var t=function(n,e){for(var t=0;t<n.length;t++){var o=n[t];if(o.test(e))return o}}(n,e);if(!t)return{major:0,minor:0};var o=function(n){return Number(e.replace(t,"$"+n))};return dn(o(1),o(2))}(n,t)},unknown:fn},ln="Firefox",vn=function(n,e){return function(){return e===n}},hn=function(n){var e=n.current;return{current:e,version:n.version,isEdge:vn("Edge",e),isChrome:vn("Chrome",e),isIE:vn("IE",e),isOpera:vn("Opera",e),isFirefox:vn(ln,e),isSafari:vn("Safari",e)}},pn={unknown:function(){return hn({current:void 0,version:mn.unknown()})},nu:hn,edge:g("Edge"),chrome:g("Chrome"),ie:g("IE"),opera:g("Opera"),firefox:g(ln),safari:g("Safari")},_n="Windows",gn="Android",yn="Solaris",wn="FreeBSD",bn=function(n,e){return function(){return e===n}},Tn=function(n){var e=n.current;return{current:e,version:n.version,isWindows:bn(_n,e),isiOS:bn("iOS",e),isAndroid:bn(gn,e),isOSX:bn("OSX",e),isLinux:bn("Linux",e),isSolaris:bn(yn,e),isFreeBSD:bn(wn,e)}},On={unknown:function(){return Tn({current:void 0,version:mn.unknown()})},nu:Tn,windows:g(_n),ios:g("iOS"),android:g(gn),linux:g("Linux"),osx:g("OSX"),solaris:g(yn),freebsd:g(wn)},En=function(n,e){var t=String(e).toLowerCase();return P(n,function(n){return n.search(t)})},Sn=function(n,t){return En(n,t).map(function(n){var e=mn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},Cn=function(n,t){return En(n,t).map(function(n){var e=mn.detect(n.versionRegexes,t);return{current:n.name,version:e}})},xn=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Dn=function(e){return function(n){return en(n,e)}},An=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(n){return en(n,"edge/")&&en(n,"chrome")&&en(n,"safari")&&en(n,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,xn],search:function(n){return en(n,"chrome")&&!en(n,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(n){return en(n,"msie")||en(n,"trident")}},{name:"Opera",versionRegexes:[xn,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Dn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Dn("firefox")},{name:"Safari",versionRegexes:[xn,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(n){return(en(n,"safari")||en(n,"mobile/"))&&en(n,"applewebkit")}}],Nn=[{name:"Windows",search:Dn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(n){return en(n,"iphone")||en(n,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Dn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:Dn("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Dn("linux"),versionRegexes:[]},{name:"Solaris",search:Dn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Dn("freebsd"),versionRegexes:[]}],kn={browsers:g(An),oses:g(Nn)},Mn=p(function(n,e){var t,o,r,i,u,c,a,s,f,d,m,l,v=kn.browsers(),h=kn.oses(),p=Sn(v,n).fold(pn.unknown,pn.nu),_=Cn(h,n).fold(On.unknown,On.nu);return{browser:p,os:_,deviceType:(o=p,r=n,i=e,u=(t=_).isiOS()&&!0===/ipad/i.test(r),c=t.isiOS()&&!u,a=t.isiOS()||t.isAndroid(),s=a||i("(pointer:coarse)"),f=u||!c&&a&&i("(min-device-width:768px)"),d=c||a&&!f,m=o.isSafari()&&t.isiOS()&&!1===/safari/i.test(r),l=!d&&!f&&!m,{isiPad:g(u),isiPhone:g(c),isTablet:g(f),isPhone:g(d),isTouch:g(s),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:g(m),isDesktop:g(l)})}}(h.navigator.userAgent,function(n){return h.window.matchMedia(n).matches})),Rn=function(){return Mn.get()},jn=z,In=X,Ln=function(n){return n.nodeType!==jn&&n.nodeType!==In||0===n.childElementCount},Un=(Rn().browser.isIE(),function(n){return Q.fromDom(n.dom().ownerDocument)}),Fn=function(n){return L(n.dom().childNodes,Q.fromDom)},Pn=(function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e]}("element","offset"),function(e,t){var n;(n=e,_.from(n.dom().parentNode).map(Q.fromDom)).each(function(n){n.dom().insertBefore(t.dom(),e.dom())})}),Bn=function(n,e){n.dom().appendChild(e.dom())},Hn=function(n){n.dom().textContent="",U(Fn(n),function(n){Vn(n)})},Vn=function(n){var e=n.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},Yn=function(n){var e,t=Fn(n);0<t.length&&(e=n,U(t,function(n){Pn(e,n)})),Vn(n)},qn=function(n,e){var t,o,r,i=Un(n).dom(),u=Q.fromDom(i.createDocumentFragment()),c=(t=e,(o=(i||h.document).createElement("div")).innerHTML=t,Fn(Q.fromDom(o)));r=u,U(c,function(n){Bn(r,n)}),Hn(n),Bn(n,u)},Wn=function(n,e){return t=e,r=void 0===(o=n)?h.document:o.dom(),Ln(r)?_.none():_.from(r.querySelector(t)).map(Q.fromDom);var t,o,r},Xn=Rn().os.isOSX()?"âŒ˜":"Ctrl",zn=Y({tc_menu_name:"TinyComments",tc_announce_sidebar_available:"Comment. Sidebar available. Press "+Xn+" + Alt + M to switch to sidebar",tc_items_addcomment:"Add comment",tc_items_showcomments:"Show comments",tc_items_deleteall:"Delete all conversations",tc_edit_buttons_save:"Save",tc_edit_buttons_cancel:"Cancel",tc_reply_buttons_save:"Save",tc_reply_buttons_clear:"Clear",tc_reply_placeholders:"Say something ...",tc_kebab_deleteconversation:"Delete conversation",tc_kebab_delete:"Delete",tc_kebab_edit:"Edit",tc_edit_problem_comment:"An error occurred editing this comment. See the Console for details.",tc_edit_unauthorised_comment:"You are not allowed to edit this comment",tc_delete_buttons_cancel:"Cancel",tc_delete_buttons_proceed:"Delete",tc_create_problem:"An error occurred while creating a comment. See the Console for details",tc_reply_problem:"An error occurred while replying to a comment. See the Console for details",tc_delete_prompts_conversation:"Delete this conversation?",tc_delete_prompts_conversation_detail_sing:"1 comment will be deleted. You can't undo this action.",tc_delete_prompts_conversation_detail_pl:"{0} comments will be deleted. You can't undo this action.",tc_delete_prompts_all:"Delete all conversations in the content? This cannot be undone",tc_delete_prompts_comment:"Are you sure you want to delete this comment?",tc_delete_problem_all:"An error occurred deleting all the conversations. See the Console for details.",tc_delete_problem_conversation:"An error occurred deleting the conversation. See the Console for details.",tc_delete_problem_comment:"An error occurred deleting the comment. See the Console for details.",tc_delete_unauthorised_all:"You are not allowed to delete all the conversations",tc_delete_unauthorised_conversation:"You are not allowed to delete this conversation",tc_delete_unauthorised_comment:"You are not allowed to delete this comment",tc_date_less_than_a_minute_ago:"a moment ago",tc_date_1_minute_ago:"1 minute ago",tc_date_x_minutes_ago:"{0} minutes ago",tc_date_1_hour_ago:"1 hour ago",tc_date_x_hours_ago:"{0} hours ago",tc_date_1_day_ago:"1 day ago",tc_date_x_days_ago:"{0} days ago",tc_date_1_week_ago:"1 week ago",tc_date_x_weeks_ago:"{0} weeks ago",tc_date_1_month_ago:"1 month ago",tc_date_x_months_ago:"{0} months ago",tc_date_1_year_ago:"1 year ago",tc_date_x_years_ago:"{0} years ago",tc_date_comment_edited:" (edited)",tc_comment_buttons_showmore:"SHOW MORE",tc_comment_buttons_showless:"SHOW LESS"},n),Gn=C("aria-comment-description"),Jn=function(n){var e,t,o=Wn(Z(),"#"+Gn).getOrThunk(function(){var n,t,e=Q.fromTag("span");return J(e,"id",Gn),J(e,"aria-live","polite"),J(e,"aria-atomic","true"),J(e,"role","alert"),n={position:"absolute",left:"-10000px",top:"-1000px"},t=e.dom(),V(n,function(n,e){tn(t,e,n)}),Bn(Z(),e),e});return e=n,t=o,{onComment:function(){qn(t,e.translate(zn.tc_announce_sidebar_available))},notOnComment:function(){qn(t,"")},getMarker:function(){return t}}},$n=function(o,r){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=o.console;t&&r in t&&t[r].apply(t,arguments)}},Kn={log:$n(h.window,"log"),error:$n(h.window,"error"),warn:$n(h.window,"warm")},Qn={},Zn={exports:Qn};an=Qn,sn=Zn,cn=void 0,function(n){"object"==typeof an&&void 0!==sn?sn.exports=n():"function"==typeof cn&&cn.amd?cn([],n):("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).EphoxContactWrapper=n()}(function(){return function i(u,c,a){function s(e,n){if(!c[e]){if(!u[e]){var t=!1;if(!n&&t)return t(e,!0);if(f)return f(e,!0);var o=new Error("Cannot find module '"+e+"'");throw o.code="MODULE_NOT_FOUND",o}var r=c[e]={exports:{}};u[e][0].call(r.exports,function(n){return s(u[e][1][n]||n)},r,r.exports,i,u,c,a)}return c[e].exports}for(var f=!1,n=0;n<a.length;n++)s(a[n]);return s}({1:[function(n,e,t){var o,r,i=e.exports={};function u(){throw new Error("setTimeout has not been defined")}function c(){throw new Error("clearTimeout has not been defined")}function a(e){if(o===setTimeout)return setTimeout(e,0);if((o===u||!o)&&setTimeout)return o=setTimeout,setTimeout(e,0);try{return o(e,0)}catch(n){try{return o.call(null,e,0)}catch(n){return o.call(this,e,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:u}catch(n){o=u}try{r="function"==typeof clearTimeout?clearTimeout:c}catch(n){r=c}}();var s,f=[],d=!1,m=-1;function l(){d&&s&&(d=!1,s.length?f=s.concat(f):m=-1,f.length&&v())}function v(){if(!d){var n=a(l);d=!0;for(var e=f.length;e;){for(s=f,f=[];++m<e;)s&&s[m].run();m=-1,e=f.length}s=null,d=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===c||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(n){try{return r.call(null,e)}catch(n){return r.call(this,e)}}}(n)}}function h(n,e){this.fun=n,this.array=e}function p(){}i.nextTick=function(n){var e=new Array(arguments.length-1);if(1<arguments.length)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];f.push(new h(n,e)),1!==f.length||d||a(v)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(n){return[]},i.binding=function(n){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(n){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],2:[function(n,d,e){(function(t){!function(n){var e=setTimeout;function o(){}function i(n){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof n)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(n,this)}function r(t,o){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,i._immediateFn(function(){var n=1===t._state?o.onFulfilled:o.onRejected;if(null!==n){var e;try{e=n(t._value)}catch(n){return void c(o.promise,n)}u(o.promise,e)}else(1===t._state?u:c)(o.promise,t._value)})):t._deferreds.push(o)}function u(e,n){try{if(n===e)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if(n instanceof i)return e._state=3,e._value=n,void a(e);if("function"==typeof t)return void f((o=t,r=n,function(){o.apply(r,arguments)}),e)}e._state=1,e._value=n,a(e)}catch(n){c(e,n)}var o,r}function c(n,e){n._state=2,n._value=e,a(n)}function a(n){2===n._state&&0===n._deferreds.length&&i._immediateFn(function(){n._handled||i._unhandledRejectionFn(n._value)});for(var e=0,t=n._deferreds.length;e<t;e++)r(n,n._deferreds[e]);n._deferreds=null}function s(n,e,t){this.onFulfilled="function"==typeof n?n:null,this.onRejected="function"==typeof e?e:null,this.promise=t}function f(n,e){var t=!1;try{n(function(n){t||(t=!0,u(e,n))},function(n){t||(t=!0,c(e,n))})}catch(n){if(t)return;t=!0,c(e,n)}}i.prototype.catch=function(n){return this.then(null,n)},i.prototype.then=function(n,e){var t=new this.constructor(o);return r(this,new s(n,e,t)),t},i.all=function(n){var c=Array.prototype.slice.call(n);return new i(function(o,r){if(0===c.length)return o([]);var i=c.length;function u(e,n){try{if(n&&("object"==typeof n||"function"==typeof n)){var t=n.then;if("function"==typeof t)return void t.call(n,function(n){u(e,n)},r)}c[e]=n,0==--i&&o(c)}catch(n){r(n)}}for(var n=0;n<c.length;n++)u(n,c[n])})},i.resolve=function(e){return e&&"object"==typeof e&&e.constructor===i?e:new i(function(n){n(e)})},i.reject=function(t){return new i(function(n,e){e(t)})},i.race=function(r){return new i(function(n,e){for(var t=0,o=r.length;t<o;t++)r[t].then(n,e)})},i._immediateFn="function"==typeof t?function(n){t(n)}:function(n){e(n,0)},i._unhandledRejectionFn=function(n){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",n)},i._setImmediateFn=function(n){i._immediateFn=n},i._setUnhandledRejectionFn=function(n){i._unhandledRejectionFn=n},void 0!==d&&d.exports?d.exports=i:n.Promise||(n.Promise=i)}(this)}).call(this,n("timers").setImmediate)},{timers:3}],3:[function(a,n,s){(function(n,e){var o=a("process/browser.js").nextTick,t=Function.prototype.apply,r=Array.prototype.slice,i={},u=0;function c(n,e){this._id=n,this._clearFn=e}s.setTimeout=function(){return new c(t.call(setTimeout,window,arguments),clearTimeout)},s.setInterval=function(){return new c(t.call(setInterval,window,arguments),clearInterval)},s.clearTimeout=s.clearInterval=function(n){n.close()},c.prototype.unref=c.prototype.ref=function(){},c.prototype.close=function(){this._clearFn.call(window,this._id)},s.enroll=function(n,e){clearTimeout(n._idleTimeoutId),n._idleTimeout=e},s.unenroll=function(n){clearTimeout(n._idleTimeoutId),n._idleTimeout=-1},s._unrefActive=s.active=function(n){clearTimeout(n._idleTimeoutId);var e=n._idleTimeout;0<=e&&(n._idleTimeoutId=setTimeout(function(){n._onTimeout&&n._onTimeout()},e))},s.setImmediate="function"==typeof n?n:function(n){var e=u++,t=!(arguments.length<2)&&r.call(arguments,1);return i[e]=!0,o(function(){i[e]&&(t?n.apply(null,t):n.call(null),s.clearImmediate(e))}),e},s.clearImmediate="function"==typeof e?e:function(n){delete i[n]}}).call(this,a("timers").setImmediate,a("timers").clearImmediate)},{"process/browser.js":1,timers:3}],4:[function(n,e,t){var o=n("promise-polyfill"),r="undefined"!=typeof window?window:Function("return this;")();e.exports={boltExport:r.Promise||o}},{"promise-polyfill":2}]},{},[4])(4)});var ne,ee,te=Zn.exports.boltExport,oe=function(n){var t=_.none(),e=[],o=function(n){r()?u(n):e.push(n)},r=function(){return t.isSome()},i=function(n){U(n,u)},u=function(e){t.each(function(n){h.setTimeout(function(){e(n)},0)})};return n(function(n){t=_.some(n),i(e),e=[]}),{get:o,map:function(t){return oe(function(e){o(function(n){e(t(n))})})},isReady:r}},re={nu:oe,pure:function(e){return oe(function(n){n(e)})}},ie=function(n){h.setTimeout(function(){throw n},0)},ue=function(t){var n=function(n){t().then(n,ie)};return{map:function(n){return ue(function(){return t().then(n)})},bind:function(e){return ue(function(){return t().then(function(n){return e(n).toPromise()})})},anonBind:function(n){return ue(function(){return t().then(function(){return n.toPromise()})})},toLazy:function(){return re.nu(n)},toCached:function(){var n=null;return ue(function(){return null===n&&(n=t()),n})},toPromise:t,get:n}},ce=function(n){return ue(function(){return new te(n)})},ae=function(n){return ue(function(){return te.resolve(n)})},se=function(u,n){return n(function(o){var r=[],i=0;0===u.length?o([]):U(u,function(n,e){var t;n.get((t=e,function(n){r[t]=n,++i>=u.length&&o(r)}))})})},fe=function(n){return se(n,ce)},de=function(n){var t,o,e,r,i,u,c,a,s,f=Q.fromDom(n.target),d=function(){n.stopPropagation()},m=function(){n.preventDefault()},l=(t=m,o=d,function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t(o.apply(null,n))});return e=f,r=n.clientX,i=n.clientY,u=d,c=m,a=l,s=n,{target:g(e),x:g(r),y:g(i),stop:u,prevent:c,kill:a,raw:g(s)}},me=function(n,e,t,o,r){var i,u,c=(i=t,u=o,function(n){i(n)&&u(de(n))});return n.dom().addEventListener(e,c,r),{unbind:function(o){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];var t=r.concat(n);return o.apply(null,t)}}(le,n,e,c,r)}},le=function(n,e,t,o){n.dom().removeEventListener(e,t,o)},ve=g(!0),he=function(n,e,t){return me(n,e,ve,t,!1)},pe=p(_.none()),_e="_tinycomments_sidebar",ge=function(r){return ce(function(n){var e,t,o=Q.fromTag("link");e={rel:"stylesheet",href:r},t=o.dom(),V(e,function(n,e){G(t,e,n)}),he(o,"load",function(){n()}),Bn(Q.fromDom(h.document.head),o)})},ye=function(e){return pe.get().getOrThunk(function(){var n=ce(function(n){tinymce[_e]=n,fe(L(e,function(n){return("js"===n.type?function(t){return ce(function(n){var e=Q.fromTag("script");J(e,"src",t),he(e,"load",function(){n()}),Bn(Z(),e)})}:ge)(n.filename)})).get(s)}).toLazy();return pe.set(_.some(n)),n})};(ee=ne||(ne={}))[ee.Modern=0]="Modern",ee[ee.Silver=1]="Silver";var we,be=function(n,e){return t=e,r=void 0===(o=n)?h.document:o.dom(),Ln(r)?[]:L(r.querySelectorAll(t),Q.fromDom);var t,o,r},Te=g("tox-comment"),Oe=g("data-mce-annotation-uid"),Ee=g("data-mce-annotation"),Se=g("tinycomments"),Ce=g("tox-comments-visible"),xe=function(n,e,t,o){return qn(n,e),U(be(n,t),o),n.dom().innerHTML},De=function(o,r,i){for(var u=Q.fromTag("div"),n=function(t){o[t].content=xe(u,o[t].content,r,i),U(o[t].fragments||[],function(n,e){o[t].fragments[e]=xe(u,o[t].fragments[e],r,i)})},e=0;e<o.length;e++)n(e)},Ae=function(n,e){var t;De(n,(t=e,"["+Oe()+'="'+t+'"]'),Yn)},Ne=function(n){De(n,"["+Ee()+'="'+Se()+'"]',Yn)},ke="tc-open-comment",Me="tc-try-delete-all-conversations",Re="tc-delete-conversation-at-cursor",je=function(o,r,t){var i=Se();o.addCommand(Me,function(n,e){o.windowManager.confirm(zn.tc_delete_prompts_all,function(n){if(n)return t.deleteAllConversations({}).get(function(n){n.fold(function(n){return r.showError(zn.tc_delete_problem_all,n)},function(n){if(n.canDelete){var e=o.selection.getBookmark();o.focus();var t=o.annotator.getAll(i);V(t,function(n,e){var t;(t=n,0===t.length?_.none():_.some(t[0])).each(function(n){o.selection.select(n),o.annotator.remove(i)})}),o.selection.moveToBookmark(e),Ne(o.undoManager.data),r.refreshSidebar(_.none(),2),o.focus()}else r.showError(zn.tc_delete_unauthorised_all)})})})})},Ie=function(n,e,u,c){n.on("init",function(){var o,r,t,i;o=e,r=c,n.addCommand(ke,function(n,e){var t=r.get();o.refreshSidebar(t,e.grabFocus?1:0)}),i=e,(t=n).addCommand(Re,function(n,e){t.undoManager.transact(function(){return t.annotator.remove(Se())}),Ae(t.undoManager.data,e.conversationUid),i.refreshSidebar(_.none(),2),t.focus()}),je(n,e,u)})},Le=function(n,e){return n.execCommand(ke,null,{grabFocus:e})},Ue=function(n){n.execCommand(Me,null,{})},Fe=function(n,e){n.execCommand("ToggleSidebar",null,e)},Pe=function(t){return{is:function(n){return t===n},isValue:f,isError:a,getOr:g(t),getOrThunk:g(t),getOrDie:g(t),or:function(n){return Pe(t)},orThunk:function(n){return Pe(t)},fold:function(n,e){return e(t)},map:function(n){return Pe(n(t))},mapError:function(n){return Pe(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOption:function(){return _.some(t)}}},Be=function(t){return{is:a,isValue:a,isError:f,getOr:n,getOrThunk:function(n){return n()},getOrDie:function(){return n=String(t),function(){throw new Error(n)}();var n},or:function(n){return n},orThunk:function(n){return n()},fold:function(n,e){return n(t)},map:function(n){return Be(t)},mapError:function(n){return Be(n(t))},each:s,bind:function(n){return Be(t)},exists:a,forall:f,toOption:_.none}},He={value:Pe,error:Be,fromOption:function(n,e){return n.fold(function(){return Be(e)},Pe)}},Ve=function(i){return un(un({},i),{toCached:function(){return Ve(i.toCached())},bindFuture:function(e){return Ve(i.bind(function(n){return n.fold(function(n){return ae(He.error(n))},function(n){return e(n)})}))},bindResult:function(e){return Ve(i.map(function(n){return n.bind(e)}))},mapResult:function(e){return Ve(i.map(function(n){return n.map(e)}))},mapError:function(e){return Ve(i.map(function(n){return n.mapError(e)}))},foldResult:function(e,t){return i.map(function(n){return n.fold(e,t)})},withTimeout:function(n,r){return Ve(ce(function(e){var t=!1,o=h.setTimeout(function(){t=!0,e(He.error(r()))},n);i.get(function(n){t||(h.clearTimeout(o),e(n))})}))}})},Ye=function(n){return Ve(ce(n))},qe=function(n){return Ve(ae(He.value(n)))},We=Ye,Xe=qe,ze=function(n){return Ve(ae(He.error(n)))},Ge=function(t){return function(n){return We(function(e){return t(n,function(n){e(He.value(n))},function(n){e(He.error(n))})})}},Je=function(t){return function(n){var e=n.settings[t];if(k(e))return e;throw new Error(t+" has not been implemented.")}},$e=function(o,r){return function(n){return e=n.settings,t=o,H.call(e,t)?n.settings[o]:r(n);var e,t}},Ke=function(t,o){return function(n){var e=$e(t,function(){return o(it(n))})(n);return Ge(e)}},Qe=Je("tinycomments_create"),Ze=Je("tinycomments_reply"),nt=Je("tinycomments_delete"),et=Je("tinycomments_delete_all"),tt=Je("tinycomments_delete_comment"),ot=Je("tinycomments_edit_comment"),rt=Je("tinycomments_lookup"),it=$e("tinycomments_author",function(){return"Anon"}),ut=$e("tinycomments_author_name",it),ct=Ke("tinycomments_can_delete",function(o){return function(n,e,t){e({canDelete:0<n.comments.length&&n.comments[0].author===o&&!0})}}),at=Ke("tinycomments_can_delete_comment",function(o){return function(n,e,t){e({canDelete:n.comment.author===o&&!0})}}),st=Ke("tinycomments_can_edit_comment",function(o){return function(n,e,t){e({canEdit:n.comment.author===o&&!0})}}),ft=$e("tinycomments_mode",function(){return"callback"}),dt=Object.prototype.hasOwnProperty,mt=(we=function(n,e){return A(n)&&A(e)?mt(n,e):e},function(){for(var n=new Array(arguments.length),e=0;e<n.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var t={},o=0;o<n.length;o++){var r=n[o];for(var i in r)dt.call(r,i)&&(t[i]=we(t[i],r[i]))}return t}),lt=function(n){var o,e=Qe(n),t=Ze(n),r=rt(n),i=nt(n),u=et(n),c=tt(n),a=ot(n);return{create:Ge(e),reply:Ge(t),lookup:Ge((o=r,function(n,t,e){o(n,function(n){var e=L(n.conversation.comments,function(n){return un({authorName:n.author},n)});t(mt(n,{conversation:{comments:e}}))},e)})),deleteConversation:Ge(i),deleteAllConversations:Ge(u),editComment:Ge(a),deleteComment:Ge(c),lifecycleHooks:{onSetContent:s,onGetContent:_.none}}},vt=function(e){return function(n){return{uid:n.uid,comments:F(n.comments,function(n){return n.uid!==e})}}},ht=function(e,t,o){return function(n){return{uid:n.uid,comments:L(n.comments,function(n){return n.uid===e?un(un({},n),{content:t,modifiedAt:o}):n})}}};var pt,_t,gt,yt=(pt=function(n){return n.dom().nodeType===W||"#comment"===n.dom().nodeName.toLowerCase()},_t="comment",{get:function(n){if(!pt(n))throw new Error("Can only get "+_t+" value of a "+_t+" node");return gt(n).getOr("")},getOption:gt=function(n){return pt(n)?_.from(n.dom().nodeValue):_.none()},set:function(n,e){if(!pt(n))throw new Error("Can only set raw "+_t+" value of a "+_t+" node");n.dom().nodeValue=e}});var wt=function(n){return function(n){var e=n.split(","),t=/data:([^;]+)/.exec(e[0]);if(!t)return _.none();for(var o=t[1],r=e[1],i=h.atob(r),u=i.length,c=Math.ceil(u/1024),a=new Array(c),s=0;s<c;++s){for(var f=1024*s,d=Math.min(f+1024,u),m=new Array(d-f),l=f,v=0;l<d;++v,++l)m[v]=i[l].charCodeAt(0);a[s]=new Uint8Array(m)}return _.some(new h.Blob(a,{type:o}))}(n)};var bt={base64:{versions:["2.0","2.1"],encryptor:{encryptText:function(n){var e=new h.Blob([n],{type:"application/json"}),t=new h.FileReader;return We(function(n){t.addEventListener("loadend",function(){return n(He.value({encrypted:[t.result]}))}),t.addEventListener("error",function(){return n(He.error(t.error))}),t.readAsDataURL(e)})},decryptText:function(n){return wt(n[0]).fold(function(){return ze("Could not decode URI")},function(e){var t=new h.FileReader;return We(function(n){t.addEventListener("loadend",function(){return n(He.value({decrypted:t.result}))}),t.addEventListener("error",function(){return n(He.error(t.error.message))}),t.readAsText(e)})})}}}};bt.current=bt.base64;var Tt=function(e){return function(n,e){for(var t=B(n),o=0,r=t.length;o<r;o++){var i=t[o],u=n[i];if(e(u,i,n))return _.some(u)}return _.none()}(bt,function(n){return I(n.versions,e)}).map(function(n){return n.encryptor})},Ot=function(){return bt.current.encryptor},Et=function(n,e,t){if(e===n)return t;switch(n){case"2.0":return Et("2.1",e,un(un({},o=t),{authorName:o.author}));default:return t}var o},St="tinycomments",Ct=function(n){return(e=n,yt.getOption(e)).map(function(n){return e=n.replace(/^\s+/g,""),t=e,r=0,""===(o=St)||!(t.length<o.length)&&t.substr(r,r+o.length)===o;var e,t,o,r}).isSome();var e},xt=function(n){var e,t,o=(t=n,e=yt.get(t),e.replace(/^\s+|\s+$/g,"")).split("|");return 2<o.length?He.value({version:o[1],rest:o.slice(2)}):He.error("Embedded comments not in expected format.")},Dt=function(n){return function(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;var o=Array(n),r=0;for(e=0;e<t;e++)for(var i=arguments[e],u=0,c=i.length;u<c;u++,r++)o[r]=i[u];return o}([St,"2.1"],n.encrypted).join("|")},At=function(n){try{var e=JSON.parse(n);return He.value(e)}catch(n){return He.error("Could not JSON parse conversations.")}},Nt=function(n){return(e=n,t=Ct,P(e.dom().childNodes,function(n){return t(Q.fromDom(n))}).map(Q.fromDom)).fold(function(){return Xe({conversations:{},commentTag:_.none(),encrypted:{encrypted:[]}})},function(c){return xt(c).fold(ze,function(n){var e,t,i=n.version,u=n.rest;return(e=i,t=u,Tt(e).fold(function(){return ze("No Encryptor for version: "+e)},function(n){return n.decryptText(t)})).bindResult(function(n){var e,t,o,r=n.decrypted;return(e=i,t=r,o=At(t),"2.1"!==e?o.map(function(n){return Y(n,function(n){return un(un({},n),{comments:L(n.comments,function(n){return Et(e,"2.1",n)})})})}):o).map(function(n){return{commentTag:_.some(c),conversations:n,encrypted:{encrypted:u}}})})})});var e,t},kt=function(n){var e,t,o,r=Q.fromDom(h.document.createComment(Dt(n)));return e=r,t=Q.fromTag("div"),o=Q.fromDom(e.dom().cloneNode(!0)),Bn(t,o),t.dom().innerHTML},Mt=function(n){var r,t,e,o=it(n),i=ut(n),u=(r={},t=_.none(),{get:function(){return mt(r,{})},clear:function(){r={},t=_.none()},addData:function(n,e){r[n]=e},setData:function(n,e){r=n,t=_.some(e)},setEncryptedData:function(n){t=_.some(n)},getEncrypedData:function(){return t},lookupData:e=function(n){return Object.prototype.hasOwnProperty.call(r,n)?_.some(r[n]):_.none()},removeData:function(n){delete r[n]},updateData:function(t,o){return e(t).map(function(n){var e=o(n);return r[t]=e})}}),c=ct(n),a=at(n),s=st(n),f=Ot(),d=function(){return f.encryptText(JSON.stringify(u.get())).mapResult(function(n){return u.setEncryptedData(n)})},m=function(o,r,n,i){return(t=o,u.lookupData(t.conversationUid).fold(function(){return He.error("Could not find conversation with uid "+t.conversationUid)},function(e){return P(e.comments,function(n){return n.uid===t.commentUid}).fold(function(){return He.error("Could not find comment with uid "+t.commentUid+" in conversation "+t.conversationUid)},function(n){return He.value({conversationUid:e.uid,comment:n})})})).fold(function(n){return ze(n)},function(t){return n(t).bindFuture(function(n){var e;return!0!==n[r]?Xe(((e={})[r]=!1,e)):u.updateData(o.conversationUid,i(t)).fold(function(){return ze("Could not operate on comment ("+r+")")},function(n){return d().mapResult(function(){var n;return(n={})[r]=!0,n})})})});var t};return{create:function(n){var e=C("mce-conversation");return u.addData(e,{uid:e,comments:[{uid:e,author:o,authorName:i,content:n.content,createdAt:n.createdAt,modifiedAt:n.createdAt}]}),d().mapResult(function(){return{conversationUid:e}})},reply:function(n){var e=C("mce-reply"),t={uid:e,author:o,authorName:i,content:n.content,createdAt:n.createdAt,modifiedAt:n.createdAt};return u.updateData(n.conversationUid,function(n){return un(un({},n),{comments:n.comments.concat([t])})}).fold(function(){return ze("Could not reply to uid: "+n.conversationUid)},function(){return d().mapResult(function(){return{commentUid:e}})})},lookup:function(n){return u.lookupData(n.conversationUid).fold(function(){return ze("Could not find uid: "+n.conversationUid)},function(n){return Xe({conversation:n})})},deleteConversation:function(e){return u.lookupData(e.conversationUid).fold(function(){return ze("Could not find conversation to delete")},function(n){return c({conversationUid:n.uid,comments:n.comments}).bindFuture(function(n){return n.canDelete?(u.removeData(e.conversationUid),d().mapResult(function(){return{canDelete:!0}})):Xe({canDelete:!1})})})},deleteAllConversations:function(n){var e=B(u.get()),o=L(e,function(n){return u.lookupData(n).fold(function(){return ze("Could not find conversation")},function(n){return c({conversationUid:n.uid,comments:n.comments})})});return We(function(t){fe(o).get(function(n){var e=function(n,e){for(var t=0,o=n.length;t<o;++t)if(!0!==e(n[t],t))return!1;return!0}(n,function(n){return n.exists(function(n){return n.canDelete})});e&&u.clear(),t(He.value({canDelete:e}))})})},deleteComment:function(n){return m(n,"canDelete",a,function(n){return vt(n.comment.uid)})},editComment:function(e){return m(e,"canEdit",function(n){return s(un(un({},n),{edit:{modifiedAt:e.modifiedAt,content:e.content}}))},function(n){return ht(e.commentUid,e.content,e.modifiedAt)})},lifecycleHooks:{onSetContent:function(n){Nt(Q.fromDom(n.getBody())).get(function(n){return n.fold(function(n){return console.error("Error extracting embedded conversations: "+n)},function(e){e.commentTag.each(function(n){u.setData(e.conversations,e.encrypted),Vn(n)})})})},onGetContent:function(n,e){return u.getEncrypedData().map(function(n){return e+kt(n)})}}}},Rt=function(n,i,u){n.on("init",function(){n.annotator.register(Se(),{decorate:function(){return{classes:[Te()],attributes:{}}}}),n.annotator.annotationChanged(Se(),function(n,e,t){if(n){u.onComment();var o=t.uid,r=t.nodes;i.refreshView(_.some({uid:o,nodes:L(r,Q.fromDom)}))}else u.notOnComment(),i.refreshView(_.none())})})};var jt,It,Lt=function(n,e){var t,o,r=(t=e,null===(o=n.dom().getAttribute(t))?void 0:o);return void 0===r||""===r?[]:r.split(" ")},Ut=function(n){return void 0!==n.dom().classList},Ft=function(n,e){return r=e,i=Lt(t=n,o="class").concat([r]),J(t,o,i.join(" ")),!0;var t,o,r,i},Pt=function(n,e){return r=e,0<(i=F(Lt(t=n,o="class"),function(n){return n!==r})).length?J(t,o,i.join(" ")):$(t,o),!1;var t,o,r,i},Bt=function(n){0===(Ut(n)?n.dom().classList:Lt(n,"class")).length&&$(n,"class")},Ht=function(e){return(n=Un(e),t=void 0!==n?n.dom():h.document,_.from(t.activeElement).map(Q.fromDom)).filter(function(n){return e.dom().contains(n.dom())});var n,t},Vt=function(o,r){return function(n){var e,t;r.set(jt.Open),e=Q.fromDom(o.getBody()),t=Ce(),Ut(e)?e.dom().classList.add(t):Ft(e,t),o.fire("mce-tinycomments-update",{}),Le(o,!1)}},Yt=function(e,t){return function(n){Ht(Q.fromDom(n.element())).each(function(n){e.focus()}),t.set(jt.Closed),function(n,e){Ut(n)?n.dom().classList.remove(e):Pt(n,e);Bt(n)}(Q.fromDom(e.getBody()),Ce()),e.fire("mce-tinycomments-update",{})}},qt=function(n,e){n===ne.Modern?e.getContainer().querySelector(".mce-sidebar-toolbar .mce-i-conversation").click():Fe(e,"showcomments")},Wt=function(n,e,t){t.get()!==jt.Closed&&t.get()!==jt.Closing||qt(n,e),Le(e,!0)},Xt=function(t,e,o){var n,r;t.ui.registry.addButton("addcomment",{tooltip:zn.tc_items_addcomment,shortcut:"meta+Alt+M",icon:(n=tinymce,r="5.0.4",n&&1===T(O(n),b(r))?"comment-add":"comment"),onAction:function(){Wt(ne.Silver,t,o)}}),t.ui.registry.addMenuItem("addcomment",{text:zn.tc_items_addcomment,shortcut:"meta+Alt+M",onAction:function(){Wt(ne.Silver,t,o)}}),t.ui.registry.addMenuItem("deleteallconversations",{text:zn.tc_items_deleteall,onAction:function(){Ue(t)}}),t.ui.registry.addToggleMenuItem("showcomments",{text:zn.tc_items_showcomments,onAction:function(){qt(ne.Silver,t)},onSetup:function(n){var e=function(){n.setActive(o.get()===jt.Open)};return t.on("mce-tinycomments-update",e),e(),function(){t.off("mce-tinycomments-update",e)}}}),t.ui.registry.addSidebar("showcomments",{tooltip:zn.tc_items_showcomments,icon:"comment",onSetup:function(n){return e.rememberSidebar(Q.fromDom(n.element())),function(){}},onShow:Vt(t,o),onHide:Yt(t,o)})},zt=function(t,e,o){t.addButton("showcomments",{icon:"bubble",tooltip:zn.tc_items_showcomments,onclick:function(){qt(ne.Modern,t)},onPostRender:function(e){t.on("mce-tinycomments-update",function(n){e.control.active(o.get()===jt.Open)})}}),t.addButton("addcomment",{tooltip:zn.tc_items_addcomment,icon:"bubble",onclick:function(n){Wt(ne.Modern,t,o)}}),t.addMenuItem("showcomments",{text:zn.tc_items_showcomments,context:"view",selectable:!0,onclick:function(n){qt(ne.Modern,t)},onPostRender:function(e){t.on("mce-tinycomments-update",function(n){e.control.active(o.get()===jt.Open)})}}),t.addMenuItem("addcomment",{text:zn.tc_items_addcomment,context:"insert",onclick:function(n){Wt(ne.Modern,t,o)}}),t.addMenuItem("deleteallconversations",{text:zn.tc_items_deleteall,context:"file",onclick:function(n){Ue(t)}}),t.addSidebar("showcomments",{tooltip:zn.tc_items_showcomments,icon:"conversation",onrender:function(n){e.rememberSidebar(Q.fromDom(n.element()))},onshow:Vt(t,o),onhide:Yt(t,o)})};(It=jt||(jt={}))[It.Open=0]="Open",It[It.Closed=1]="Closed",It[It.Closing=2]="Closing";var Gt=function(n,e,t){var o=p(jt.Closed);e.shortcuts.add("meta+alt+m","TinyComments addComment",function(){Wt(n,e,o)}),(n===ne.Modern?zt:Xt)(e,t,o)},Jt=function(i,u){var n,o,t,e,r,c,a=p(!1),s=p(_.none()),f=E(tinymce,"5.0.0")?ne.Modern:ne.Silver,d=("embedded"===ft(n=i)?Mt:lt)(n),m=(o=p(_.none()),t=p(_.none()),{rememberSidebar:function(e){t.set(_.some(e)),o.get().fold(function(){var n=Q.fromHtml('<div aria-busy="true" class="tox-conversations" style="position: relative;">\n  <div class="tox-dialog__busy-spinner">\n  <div class="tox-loading-text">\n      <div>\n      <p>Comments are loading</p>\n      </div>\n  <div class="tox-spinner">\n      <div></div>\n      <div></div>\n      <div></div>\n  </div>\n</div></div>');Bn(e,n)},function(n){n.attachTo(e)})},setUi:function(e){o.set(_.some(e)),t.get().each(function(n){Hn(n),e.attachTo(n)})},refreshView:function(e){o.get().fold(function(){},function(n){n.controller.refreshView(e)})},refreshSidebar:function(e,t){o.get().fold(function(){},function(n){n.controller.refreshSidebar(e,t)})},setReadonly:function(e){o.get().each(function(n){return n.controller.setReadonly(e)})},showError:function(e,t){o.get().each(function(n){return n.controller.showError(e,t)})}}),l={translate:tinymce.translate};ye([{type:"js",filename:(e=i,r=u,c=e.settings.tinycomments_js_url,(c?c+"/":r+"/js/")+"tinycomments-sidebar.min.js")}]).get(function(n){return n(f,i,d,s,function(n){m.setUi(n),m.refreshSidebar(s.get(),5),a.set(!0)},l)});var v=Jn(l);return Ie(i,m,d,s),Rt(i,m,v),Gt(f,i,m),i.on("init",function(){var n,e,t,o,r;n=f,t=u,o=(e=i).settings.tinycomments_css_url,r=o?o+"/":t+"/css/",tinymce.DOM.styleSheetLoader.load(r+"tinycomments.css",function(){}),n===ne.Modern&&(tinymce.DOM.styleSheetLoader.load(r+"tinycomments-tinymce4.css",function(){}),tinymce.DOM.styleSheetLoader.load(r+"tinymce4-icons.css",function(){}),e.dom.loadCSS(r+"tinymce4-content.css")),m.refreshSidebar(_.none(),5)}),i.on("setContent",function(n){n.selection||(d.lifecycleHooks.onSetContent(i),m.refreshView(_.none()))}),i.on("SwitchMode",function(){m.setReadonly(i.readonly)}),i.on("getContent",function(n){var e=!0===n.source_view,t=!0===n.contextual,o=e||t?_.none():d.lifecycleHooks.onGetContent(i,n.content);n.content=o.getOr(n.content)}),{hasLoadedUi:function(){return a.get()}}},$t=function(n,e){return E(tinymce,"4.8.0")?(Kn.error("The tinycomments plugin requires at least 4.8.0 version of TinyMCE."),{}):Jt(n,e)};tinymce.PluginManager.add("tinycomments",$t)}(window);