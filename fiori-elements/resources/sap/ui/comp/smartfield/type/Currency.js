/*
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/model/type/Currency","sap/ui/model/odata/type/Currency","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,e,r,i,n){"use strict";var s=/^([-]?)(\d+)(?:\.(\d+))?$/;var o=r.extend("sap.ui.comp.smartfield.type.Currency",{constructor:function(t,e){r.apply(this,[t]);this.oConstraints=e;this.bParseWithValues=true;this.sName="Currency"}});o.prototype.parseValue=function(t,e,i){if(i[1]&&this.shouldConvertUnitToUpperCase(i[1])){arguments[2][1]=arguments[2][1].toUpperCase()}var n=r.prototype.parseValue.apply(this,arguments),s,o,u=Array.isArray(n)&&n[0]&&a(n[0]);if(Array.isArray(u)){s=u[1]+u[2];o=u[3];if(Number.parseInt(o)===0){n[0]=s}}if(n[1]===undefined){n[1]=i[1]}return n};o.prototype.validateValue=function(t){var e,r=t[0],s=t[1],o=r===null,h=0,m=this.oFormatOptions&&this.oFormatOptions.customCurrencies;if(s&&this.shouldConvertUnitToUpperCase(s)){s=s.toUpperCase()}if(this.oConstraints&&this.oConstraints.nullable&&(o||r===this.oFormatOptions.emptyString)){return}if(m&&s&&Object.keys(m).indexOf(s)===-1){throw new n(p("CURRENCY_VALIDATION_FAILS",[s]))}if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}e=a(r);if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}var c=parseInt(e[2]),l=c===0?0:e[2].length,f=(e[3]||"").length,C=this.oConstraints&&this.oConstraints.precision,y=typeof C==="number"?C:Infinity,d=s,U=this.oOutputFormat.oLocaleData.getCurrencyDigits(d),g=this.mCustomUnits&&this.mCustomUnits[d]&&this.mCustomUnits[d].decimals;if(g||g===0){U=g}if(this.oConstraints&&this.oConstraints.variableScale){h=Math.min(y,U)}else{h=Math.min(this.oConstraints&&this.oConstraints.scale||0,U)}if(h>y){h=y}if(f>h){if(h===0){throw new i(u("EnterInt"))}if(l+h>y){throw new i(u("EnterNumberIntegerFraction",[y-h,h]))}throw new i(u("EnterNumberFraction",[h]))}if(l>y-h){throw new i(u("EnterNumberInteger",[y-h]))}};function a(t){return s.exec(t)}function u(e,r){return t.getLibraryResourceBundle().getText(e,r)}function p(e,r){return t.getLibraryResourceBundle("sap.ui.comp").getText(e,r)}o.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Currency"};return o});