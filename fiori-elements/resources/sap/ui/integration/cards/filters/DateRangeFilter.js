/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/base/Log","sap/ui/core/library","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/ui/integration/util/BindingResolver"],function(t,e,a,r,n,i){"use strict";var o=a.ValueState;var s=new Date(-864e13);var u=new Date("1753-01-01");var T=new Date(864e13);var l=new Date("9999-12-31");var g={DATE:"date",TODAY:"today",YESTERDAY:"yesterday",TOMORROW:"tomorrow",DATERANGE:"dateRange",DATETIMERANGE:"dateTimeRange",FROM:"from",TO:"to",FROMDATETIME:"fromDateTime",TODATETIME:"toDateTime",YEARTODATE:"yearToDate",LASTDAYS:"lastDays",LASTWEEKS:"lastWeeks",LASTMONTHS:"lastMonths",LASTQUARTERS:"lastQuarters",LASTYEARS:"lastYears",NEXTDAYS:"nextDays",NEXTWEEKS:"nextWeeks",NEXTMONTHS:"nextMonths",NEXTQUARTERS:"nextQuarters",NEXTYEARS:"nextYears",TODAYFROMTO:"todayFromTo",THISWEEK:"thisWeek",LASTWEEK:"lastWeek",NEXTWEEK:"nextWeek",SPECIFICMONTH:"specificMonth",THISMONTH:"thisMonth",LASTMONTH:"lastMonth",NEXTMONTH:"nextMonth",THISQUARTER:"thisQuarter",LASTQUARTER:"lastQuarter",NEXTQUARTER:"nextQuarter",QUARTER1:"quarter1",QUARTER2:"quarter2",QUARTER3:"quarter3",QUARTER4:"quarter4",THISYEAR:"thisYear",LASTYEAR:"lastYear",NEXTYEAR:"nextYear",DATETIME:"dateTime"};function p(t){return g[t]}var E=t.extend("sap.ui.integration.cards.filters.DateRangeFilter",{metadata:{library:"sap.ui.integration",aggregations:{_ddr:{type:"sap.m.DynamicDateRange",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});E.prototype.getField=function(){return this._getDdr()};E.prototype.setValueFromOutside=function(t){e.error("Setting a filter value programatically on a DateRangeFilter is currently unsupported.",null,"sap.ui.integration.widgets.Card")};E.prototype.getValueForModel=function(){var t=this._getDdr().getValue();var e;var a;var r;if(t){e={option:p(t.operator),values:t.values.slice()};var i=n.toDates(t),o=i[0].getJSDate?i[0].getJSDate():i[0],g=t.operator==="TO"||t.operator==="TODATETIME",E=t.operator==="FROM"||t.operator==="FROMDATETIME",d=g||E?0:1,S=i[d]&&i[d].getJSDate?i[d].getJSDate():i[d];a={start:o.toISOString(),end:S.toISOString()};r={start:o.toISOString(),end:S.toISOString()};if(g){a.start=s.toISOString();r.start=u.toISOString()}if(E){a.end=T.toISOString();r.end=l.toISOString()}}return{value:e,range:a,rangeOData:r}};E.prototype._getDdr=function(){var t=this.getAggregation("_ddr");if(!t){t=this._createDdr();this.setAggregation("_ddr",t)}return t};E.prototype._createDdr=function(){var t=Object.assign({},this.getConfig());var e;if(t.value){t.value=i.resolveValue(t.value,this.getCardInstance());var a=t.value.option.toUpperCase();var s=n.getOption(a).getValueTypes();e={operator:a,values:t.value.values.map(function(t,e){if(s[e]==="date"||s[e]==="datetime"){return new Date(t)}return t})}}t.options=t.options||this._getDefaultOptions();t.options=t.options.map(function(t){return t.toUpperCase()});var u=new r({value:e,options:t.options}).addStyleClass("sapFCardDateRangeField");u.attachChange(function(t){if(t.getParameter("valid")){u.setValueState(o.None);this._syncValue()}else{u.setValueState(o.Error)}}.bind(this));var T=this.createLabel(t);if(T){u.addAriaLabelledBy(T)}return u};E.prototype._getDefaultOptions=function(){return["date","today","dateRange","from","to","lastDays","nextDays","lastWeeks","nextWeeks"]};E.prototype.getOptions=function(){return g};return E});