/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/enum/BaseType","sap/base/util/ObjectPath","sap/base/util/isEmptyObject","sap/base/util/merge","sap/ui/model/SimpleType","sap/ui/mdc/util/DateUtil"],function(e,t,a,r,n,s){"use strict";var i="yyyy-MM-dd";var u="HH:mm:ss";var o={getDataTypeClassName:function(e){var t={Boolean:"sap.ui.model.type.Boolean",Currency:"sap.ui.model.type.Currency",Date:"sap.ui.model.type.Date",DateTime:"sap.ui.model.type.DateTime",Float:"sap.ui.model.type.Float",Integer:"sap.ui.model.type.Integer",String:"sap.ui.model.type.String",Time:"sap.ui.model.type.Time",Unit:"sap.ui.model.type.Unit"};if(t[e]){e=t[e]}return e},getBaseType:function(t,a,r){switch(t){case"sap.ui.model.type.Date":return e.Date;case"sap.ui.model.type.DateTime":return e.DateTime;case"sap.ui.model.type.Time":return e.Time;case"sap.ui.model.type.Boolean":return e.Boolean;case"sap.ui.model.type.Unit":case"sap.ui.model.type.Currency":if(!a||(!a.hasOwnProperty("showMeasure")||a.showMeasure)&&(!a.hasOwnProperty("showNumber")||a.showNumber)){return e.Unit}else if(!a.hasOwnProperty("showNumber")||a.showNumber){return e.Numeric}else{return e.String}case"sap.ui.model.type.Integer":case"sap.ui.model.type.Float":return e.Numeric;default:return e.String}},getBaseTypeForType:function(e){return this.getBaseType(e.getMetadata&&e.getMetadata().getName(),e.getFormatOptions(),e.getConstraints())},getDataTypeClass:function(e){var a=t.get(this.getDataTypeClassName(e)||"");if(!a){throw new Error("DataType '"+e+"' cannot be determined")}return a},getDataTypeInstance:function(e,t,a){var r=this.getDataTypeClass(e);return new r(t,a)},getTypeConfig:function(e,t,a){var r=this._normalizeType(e,t,a);return{className:r.getMetadata().getName(),typeInstance:r,baseType:this.getBaseTypeForType(r)}},internalizeValue:function(t,a,r,n){var o=this._normalizeType(a,r,n);var p=this.getBaseTypeForType(o);switch(p){case e.DateTime:return s.ISOToType(t,o,p);case e.Date:if(t.indexOf("T")>=0){t=t.substr(0,t.indexOf("T"))}return s.stringToType(t,o,i);case e.Time:return s.stringToType(t,o,u);case e.Boolean:return t;case e.Numeric:return t;default:return o.parseValue(t,"string")}},externalizeValue:function(t,a,r,n){var o=this._normalizeType(a,r,n);var p=this.getBaseTypeForType(o);switch(p){case e.DateTime:return s.typeToISO(t,o,p);case e.Date:return s.typeToString(t,o,i);case e.Time:return s.typeToString(t,o,u);case e.Boolean:return t;case e.Numeric:return t;default:return o.formatValue(t,"string")}},_normalizeType:function(e,t,a){if(e instanceof n){return e}return this.getDataTypeInstance(e,t,a)},getUnitTypeInstance:function(e,n,s){var i=e.getMetadata().getName();var u=r({},e.getFormatOptions());var o=a(e.getConstraints())?undefined:r({},e.getConstraints());var p=t.get(i);this._adjustUnitFormatOptions(u,n,s);return new p(u,o)},_adjustUnitFormatOptions:function(e,t,a){e.showNumber=t;e.showMeasure=a;e.strictParsing=true}};return o});