/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/mdc/field/content/DefaultContent","sap/ui/mdc/enum/BaseType","sap/ui/mdc/util/DateUtil","sap/ui/mdc/condition/FilterOperatorUtil","sap/ui/mdc/condition/Operator","sap/ui/core/library"],function(e,t,a,r,i,n){"use strict";var l=n.CalendarType;var o;var d;var p;var s=Object.assign({},e,{getEditMultiLine:function(){return[null]},getEdit:function(){return["sap/m/DynamicDateRange","sap/ui/mdc/condition/OperatorDynamicDateOption","sap/ui/mdc/field/DynamicDateRangeConditionsType","sap/m/library","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat"]},getEditOperator:function(){return{EQ:{name:"sap/m/DatePicker",create:this._createDatePickerControl},BT:{name:"sap/m/DateRangeSelection",create:this._createDateRangePickerControl}}},getEditForHelp:function(){return e.getEdit.apply(this,arguments)},getUseDefaultFieldHelp:function(){return{name:"defineConditions",oneOperatorSingle:false,oneOperatorMulti:true,single:false,multi:true}},createEditMultiLine:function(){throw new Error("sap.ui.mdc.field.content.DateContent - createEditMultiLine not defined!")},_createDatePickerControl:function(e,t,a){var r=t[0];var i=e.getConditionsType();e.setHideOperator(true);this._adjustDataTypeForDate(e);var n=new r(a,{value:{path:"$field>/conditions",type:i},displayFormat:e.getDisplayFormat(),valueFormat:e.getValueFormat(),placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",liveChange:e.getHandleContentLiveChange(),change:e.getHandleContentChange()});if(n.setDisplayFormatType){n.setDisplayFormatType(e.getCalendarType())}if(n.setSecondaryCalendarType){n.setSecondaryCalendarType(e.getSecondaryCalendarType())}n._setPreferUserInteraction(true);e.setAriaLabelledBy(n);return[n]},_createDateRangePickerControl:function(e,t,a){var r=t[0];var i=e.getConditionsType();this._adjustDataTypeForDate(e);var n=new r(a,{value:{path:"$field>/conditions",type:i},displayFormat:e.getDisplayFormat(),valueFormat:e.getValueFormat(),delimiter:"...",displayFormatType:e.getCalendarType(),secondaryCalendarType:e.getSecondaryCalendarType(),placeholder:"{$field>/placeholder}",textAlign:"{$field>/textAlign}",textDirection:"{$field>/textDirection}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",liveChange:e.getHandleContentLiveChange(),change:e.getHandleContentChange()});n._setPreferUserInteraction(true);e.setAriaLabelledBy(n);return[n]},_adjustDataTypeForDate:function(e){var t=e.retrieveDataType();var r=t.getFormatOptions();this._getDatePattern(e,r);if(!r||r.style||!r.pattern||r.pattern!==e.getValueFormat()||!r.calendarType||r.calendarType!==l.Gregorian){e.setDateOriginalType(e.getDataType());e.setDataType(a.createInternalType(t,e.getValueFormat()));e.updateConditionType()}},_getDatePattern:function(e,a){var r=e.getField().getBaseType();switch(r){case t.Date:e.setValueFormat("yyyy-MM-dd");break;case t.DateTime:e.setValueFormat("yyyy-MM-dd'T'HH:mm:ss");break;case t.Time:e.setValueFormat("HH:mm:ss");break;default:return}e.setDisplayFormat("medium");if(a){if(a.style){e.setDisplayFormat(a.style)}else if(a.pattern){e.setDisplayFormat(a.pattern)}if(a.calendarType){e.setCalendarType(a.calendarType)}if(a.secondaryCalendarType){e.setSecondaryCalendarType(a.secondaryCalendarType)}}},createEdit:function(e,t,a){var r=t[0];var i=t[1];var n=t[2];var l=t[3];if(!o||!d||!p){o=l.StandardDynamicDateRangeKeys;d=t[4];p=t[5]}var s=e.getConditionsType(false,n);var u;if(e.getField().getMetadata().hasProperty("operators")){var g=function(t){return this._getDateRangeOptions(t,e,i)}.bind(this);u={path:"$field>/operators",formatter:g}}else{u=this._getDateRangeOptions(undefined,e,i)}var y=new r(a,{value:{path:"$field>/conditions",type:s},formatter:this._getDateRangeFormatter(e),placeholder:"{$field>/placeholder}",required:"{$field>/required}",editable:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEditable},enabled:{path:"$field>/editMode",formatter:e.getMetadata()._oClass._getEnabled},valueState:"{$field>/valueState}",valueStateText:"{$field>/valueStateText}",width:"100%",tooltip:"{$field>/tooltip}",options:u,change:e.getHandleContentChange()});e.setAriaLabelledBy(r);return[y]},createEditForHelp:function(t,a,r){return e.createEdit.apply(this,arguments)},_getDateRangeOptions:function(e,t,a){if(!e||e.length===0){e=t.getField()._getOperators()}var r=[];var i=t.getField().getBaseType();for(var n=0;n<e.length;n++){var l=e[n];var o=this._getDateRangeOption(l,t,a,i);if(o){r.push(o)}}return r},_getDateRangeOption:function(e,t,a,n){var l=r.getOperator(e);var p;if(l){p=r.getDynamicDateOptionForOperator(l,o,n);if(!p){p=r.getCustomDynamicDateOptionForOperator(l,n);if(!d.getOption(p)){var s=t.retrieveDataType();var u=[];for(var g=0;g<l.valueTypes.length;g++){if(l.valueTypes[g]&&l.valueTypes[g]!==i.ValueType.Static){u.push("custom")}}d.addOption(new a({key:p,operator:l,type:s,baseType:n,valueTypes:u}))}}}return p},_getDateRangeFormatter:function(e){var a=e.retrieveDataType();var r=e.getField().getBaseType();var i=a.getFormatOptions();var n={};var l={};if(i.style){n.style=i.style}else if(i.pattern){n.pattern=i.pattern}if(r===t.DateTime){l.datetime=n}l.date=n;return p.getInstance(l)}});return s});