/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./RedlineElement","./Redline","sap/base/Log"],function(t,e,i){"use strict";var r=t.extend("sap.ui.vk.RedlineElementEllipse",{metadata:{library:"sap.ui.vk",properties:{radiusX:{type:"float",defaultValue:1e-4},radiusY:{type:"float",defaultValue:1e-4},fillColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 0, 0)"}}}});r.prototype.edit=function(t,e,i){var r=this.getParent(),s=r._toVirtualSpace(t,e),a=Math.abs(s.x-this._initialX),o=Math.abs(s.y-this._initialY);if(i){a=o=Math.max(a,o)}this.setOriginX((s.x+this._initialX)/2);this.setOriginY((s.y+this._initialY)/2);this.setRadiusX(a*.5);this.setRadiusY(o*.5);return this};r.prototype.applyZoom=function(t){this.setProperty("radiusX",this.getRadiusX()*t,true);this.setProperty("radiusY",this.getRadiusY()*t,true);return this};r.prototype.setRadiusX=function(t){this.setProperty("radiusX",t,true);var e=this.getDomRef();if(e){e.setAttribute("rx",this.getParent()._toPixelSpace(t))}};r.prototype.setRadiusY=function(t){this.setProperty("radiusY",t,true);var e=this.getDomRef();if(e){e.setAttribute("ry",this.getParent()._toPixelSpace(t))}};r.prototype.setOriginX=function(t){this.setProperty("originX",t,true);var e=this.getDomRef();if(e){e.setAttribute("cx",this.getParent()._toPixelSpace(this.getOriginX(),this.getOriginY()).x)}};r.prototype.setOriginY=function(t){this.setProperty("originY",t,true);var e=this.getDomRef();if(e){e.setAttribute("cy",this.getParent()._toPixelSpace(this.getOriginX(),this.getOriginY()).y)}};r.prototype.renderElement=function(t,e){var i=this.getParent();this._initialX=this.getOriginX();this._initialY=this.getOriginY();t.openStart("ellipse",this);var r=i._toPixelSpace(this.getOriginX(),this.getOriginY());t.attr("cx",r.x);t.attr("cy",r.y);t.attr("rx",i._toPixelSpace(this.getRadiusX()));t.attr("ry",i._toPixelSpace(this.getRadiusY()));t.attr("fill",this.getFillColor());t.attr("stroke",this.getStrokeColor());t.attr("stroke-width",this.getStrokeWidth());if(this.getStrokeDashArray().length>0){t.attr("stroke-dasharray",this.getStrokeDashArray().toString())}t.attr("opacity",this.getOpacity());if(e){t.attr("filter",this._getHaloFilter())}t.openEnd();t.close("ellipse")};r.prototype.exportJSON=function(){return jQuery.extend(true,t.prototype.exportJSON.call(this),{type:e.ElementType.Ellipse,version:1,radiusX:this.getRadiusX(),radiusY:this.getRadiusY(),fillColor:this.getFillColor()})};r.prototype.importJSON=function(r){if(r.type===e.ElementType.Ellipse){if(r.version===1){t.prototype.importJSON.call(this,r);if(r.hasOwnProperty("radiusX")){this.setRadiusX(r.radiusX)}if(r.hasOwnProperty("radiusY")){this.setRadiusY(r.radiusY)}if(r.hasOwnProperty("fillColor")){this.setFillColor(r.fillColor)}}else{i.error("wrong version number")}}else{i.error("Redlining JSON import: Wrong element type")}return this};r.prototype.exportSVG=function(){var t=document.createElementNS(e.svgNamespace,"ellipse");t.setAttribute("x",this.getOriginX());t.setAttribute("y",this.getOriginY());t.setAttribute("rx",this.getRadiusX());t.setAttribute("ry",this.getRadiusY());t.setAttribute("fill",this.getFillColor());t.setAttribute("stroke",this.getStrokeColor());t.setAttribute("stroke-width",this.getStrokeWidth());if(this.getStrokeDashArray().length>0){t.setAttribute("stroke-dasharray",this.getStrokeDashArray().toString())}if(this.getOpacity()<1){t.setAttribute("opacity",this.getOpacity())}t.setAttribute("data-sap-element-id",this.getElementId());t.setAttribute("data-sap-halo",this.getHalo());return t};r.prototype.importSVG=function(e){if(e.tagName==="ellipse"){t.prototype.importSVG.call(this,e);if(e.getAttribute("rx")){this.setRadiusX(parseFloat(e.getAttribute("rx")))}if(e.getAttribute("ry")){this.setRadiusY(parseFloat(e.getAttribute("ry")))}if(e.getAttribute("fill")){this.setFillColor(e.getAttribute("fill"))}}else{i("Redlining SVG import: Wrong element type")}return this};return r});