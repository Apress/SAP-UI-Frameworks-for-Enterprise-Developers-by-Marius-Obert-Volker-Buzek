/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./RedlineElement","./Redline","sap/base/Log"],function(t,e,i){"use strict";var r=t.extend("sap.ui.vk.RedlineElementRectangle",{metadata:{library:"sap.ui.vk",properties:{width:{type:"float",defaultValue:.001},height:{type:"float",defaultValue:.001},fillColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 0, 0)"}}}});r.prototype.init=function(){t.prototype.init.apply(this);this._originX=0;this._originY=0};r.prototype.setOriginX=function(t){this.setProperty("originX",t,true);this._originX=t};r.prototype.setOriginY=function(t){this.setProperty("originY",t,true);this._originY=t};r.prototype.edit=function(t,e,i){var r=this.getParent(),o=r._toVirtualSpace(t,e),s=o.x-this._originX,h=o.y-this._originY;if(i){if(Math.abs(s)>Math.abs(h)){if(s<0&&h<0||s>0&&h>0){h=s}else{h=-s}o.y=h+this._originY}else{if(s<0&&h<0||s>0&&h>0){s=h}else{s=-h}o.x=s+this._originX}}this.setProperty("originX",s<0?o.x:this._originX,true);this.setProperty("originY",h<0?o.y:this._originY,true);this.setWidth(Math.abs(s));this.setHeight(Math.abs(h));this.rerender();return this};r.prototype.applyZoom=function(t){this.setProperty("width",this.getWidth()*t,true);this.setProperty("height",this.getHeight()*t,true);return this};r.prototype.setWidth=function(t){this.setProperty("width",t,true);var e=this.getDomRef();if(e){e.setAttribute("width",this.getParent()._toPixelSpace(t))}};r.prototype.setHeight=function(t){this.setProperty("height",t,true);var e=this.getDomRef();if(e){e.setAttribute("height",this.getParent()._toPixelSpace(t))}};r.prototype.renderElement=function(t,e){var i=this.getParent();t.openStart("rect",this);var r=i._toPixelSpace(this.getOriginX(),this.getOriginY());t.attr("x",r.x);t.attr("y",r.y);t.attr("width",i._toPixelSpace(this.getWidth()));t.attr("height",i._toPixelSpace(this.getHeight()));t.attr("fill",this.getFillColor());t.attr("stroke",this.getStrokeColor());t.attr("stroke-width",this.getStrokeWidth());if(this.getStrokeDashArray().length>0){t.attr("stroke-dasharray",this.getStrokeDashArray().toString())}t.attr("opacity",this.getOpacity());if(e){t.attr("filter",this._getHaloFilter())}t.openEnd();t.close("rect")};r.prototype.exportJSON=function(){return jQuery.extend(true,t.prototype.exportJSON.call(this),{type:e.ElementType.Rectangle,version:1,width:this.getWidth(),height:this.getHeight(),fillColor:this.getFillColor()})};r.prototype.importJSON=function(r){if(r.type===e.ElementType.Rectangle){if(r.version===1){t.prototype.importJSON.call(this,r);if(r.hasOwnProperty("width")){this.setWidth(r.width)}if(r.hasOwnProperty("height")){this.setHeight(r.height)}if(r.hasOwnProperty("fillColor")){this.setFillColor(r.fillColor)}}else{i("wrong version number")}}else{i("Redlining JSON import: Wrong element type")}return this};r.prototype.exportSVG=function(){var t=document.createElementNS(e.svgNamespace,"rect");t.setAttribute("x",this.getOriginX());t.setAttribute("y",this.getOriginY());t.setAttribute("height",this.getHeight());t.setAttribute("width",this.getWidth());t.setAttribute("fill",this.getFillColor());t.setAttribute("stroke",this.getStrokeColor());t.setAttribute("stroke-width",this.getStrokeWidth());if(this.getStrokeDashArray().length>0){t.setAttribute("stroke-dasharray",this.getStrokeDashArray().toString())}if(this.getOpacity()<1){t.setAttribute("opacity",this.getOpacity())}t.setAttribute("data-sap-element-id",this.getElementId());t.setAttribute("data-sap-halo",this.getHalo());return t};r.prototype.importSVG=function(e){if(e.tagName==="rect"){t.prototype.importSVG.call(this,e);if(e.getAttribute("width")){this.setWidth(parseFloat(e.getAttribute("width")))}if(e.getAttribute("height")){this.setHeight(parseFloat(e.getAttribute("height")))}if(e.getAttribute("fill")){this.setFillColor(e.getAttribute("fill"))}}else{i("Redlining SVG import: Wrong element type")}return this};return r});