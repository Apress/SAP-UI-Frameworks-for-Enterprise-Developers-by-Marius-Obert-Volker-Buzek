/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/write/_internal/appVariant/AppVariantFactory","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/apply/_internal/ChangesController","sap/ui/fl/write/_internal/SaveAs","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/ui/fl/registry/Settings"],function(e,r,t,n,i,a,p){"use strict";function s(e,r){return p.getInstance().then(function(t){if(t.isAtoEnabled()){r.skipIam=true;r.transport="ATO_NOTIFICATION"}return i[e](r)})}function o(e){if(!e.appId){return Promise.reject("App Variant ID must be provided")}e.selector={appId:e.appId};var r=n.getFlexControllerInstance(e.selector);e.id=r.getComponentName();e.isForSmartBusiness=true}var u={create:function(e){if(!e.layer){return Promise.reject("Layer must be provided")}if(!e.selector||!e.selector.appId){return Promise.reject("selector.appId must be provided")}if(!e.id){return Promise.reject("App variant ID must be provided")}var r=n.getFlexControllerInstance(e.selector);e.reference=r.getComponentName();e.isForSmartBusiness=true;return s("saveAs",e)},update:function(e){o(e);return s("updateAppVariant",e)},remove:function(e){o(e);return s("deleteAppVariant",e)},getDesignTimeVariant:function(r){if(!r.id){return Promise.reject("App Variant ID must be provided")}return e.load(r)},getRunTimeVariant:function(e){if(!e.appId){return Promise.reject("Reference App ID must be provided")}if(!e.id){return Promise.reject("App Variant ID must be provided")}var r="/sap/bc/lrep/content/apps/"+e.appId+"/appVariants/"+e.id+"/manifest.appdescr_variant";return a.appVariant.getManifest({appVarUrl:r})},createDescriptorInlineChanges:function(e){if(!e.appId){return Promise.reject("appId must be provided")}if(!e.changeSpecificData){return Promise.reject("changeSpecificData must be provided")}e.selector={appId:e.appId};return t.create(e)},add:function(e){if(!e.appId){return Promise.reject("appId must be provided")}if(!e.change){return Promise.reject("Change instance must be provided")}e.selector={appId:e.appId};return r.add(e)}};return u});