/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/base/ManagedObjectObserver","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/Utils"],function(e,t,n){"use strict";var r={};var i={};var o={};var a={};function g(e){var t=e.object.getId();o[t].forEach(function(e){a[e.view.getId()][e.name].bParentIsDestroyed=true})}function s(e){var t=e.object.getId();o[t].forEach(function(t){var r=t.aggregationName;if(r===e.name){var i=n.getAggregation(e.object,r);var o=[].concat(i||[]).map(function(e){return e.getId()});if(e.mutation==="insert"){if(o.indexOf(e.child.getId())<t.index){t.index++}}else if(t.aggregation.indexOf(e.child.getId())<t.index){t.index--}t.aggregation=o}})}function f(e){if(e.type==="destroy"){g(e)}else{s(e)}}function c(t,n){var r=t.getId();if(!i[r]){var o=new e(f.bind(this));o.observe(t,{aggregations:[n],destroy:true});i[r]={observer:o,aggregations:[n]}}else{var a=i[r].observer.isObserved(t,{aggregations:[n]});if(!a){i[r].aggregations.push(n);i[r].observer.observe(t,{aggregations:i[r].aggregations,destroy:true})}}}function u(e,t,r){var i=r.view.getId();var g=n.getAggregation(e,t);var s=[].concat(g||[]).map(function(e){return e.getId()});var f=e.getId();if(!o[f]){o[f]=[]}if(!a[i]){a[i]={}}r.aggregation=s;o[f].push(r);a[i][r.name]=r}r.registerExtensionPoint=function(e){var t=e.targetControl;var n=e.aggregationName;c(t,n);u(t,n,e)};r.getExtensionPointInfo=function(e,t){return a[t.getId()]&&a[t.getId()][e]};r.getExtensionPointInfoByViewId=function(e){return a[e]||{}};r.getExtensionPointInfoByParentId=function(e){return o[e]||[]};r.clear=function(){Object.keys(i).forEach(function(e){i[e].observer.disconnect();i[e].observer.destroy()});i={};o={};a={}};return r});