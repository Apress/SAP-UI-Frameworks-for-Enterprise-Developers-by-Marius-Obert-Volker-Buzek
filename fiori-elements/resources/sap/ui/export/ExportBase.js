/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,r,o){"use strict";var i=e.extend("sap.ui.export.ExportBase",{constructor:function(t,r){e.call(this,t);this._mCapabilities=r||{};this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this));if(this._mSettings.workbook){this._mSettings.workbook.hierarchyLevel=o.getHierarchyLevelProperty(t.dataSource);this._mSettings.workbook.drillState=o.getHierarchyDrillStateProperty(t.dataSource)}}});i.prototype.attachBeforeExport=function(t,e,r){return this.attachEvent("beforeExport",t,e,r)};i.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this._mSettings=null;this._mCapabilities=null;this.bIsDestroyed=true};i.prototype.cancel=function(){throw new Error("Abstract function not implemented")};i.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};i.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};i.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};i.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};i.prototype.build=function(){var t=this._mSettings;if(this.bIsDestroyed){var e=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";r.error(e);return Promise.reject(e)}return this.setDefaultExportSettings(t).then(function(){this.fireEvent("beforeExport",{exportSettings:t},false,false);o.validateSettings(t);return this.createBuildPromise(t)}.bind(this))};return i});