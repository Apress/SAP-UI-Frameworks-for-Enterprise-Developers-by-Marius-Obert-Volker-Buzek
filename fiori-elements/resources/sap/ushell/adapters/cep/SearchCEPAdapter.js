// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/core/Configuration","sap/ushell/Config"],function(e,t,a){"use strict";var r=function(e,t,a){this._oConfig=a&&a.config||{};this._oConfig.searchProvider=this._oConfig.searchProvider||"/navigation/search/api/v1/lookupTargets"};r.prototype.execSearch=function(r){var s=this._oConfig.searchProvider;var i=sap.ushell.Container.getFLPPlatform(true);var n=new URL(document.URL).searchParams;var o=a.last("/core/site/siteId");var c=t.getLanguageTag();if(typeof r==="string"&&r.length>0){s+="?query="+encodeURIComponent(r)}if(typeof o==="string"&&o.length>0){s+=s.indexOf("?")>0?"&":"?";s+="siteId="+encodeURIComponent(o)}if(i==="MYHOME"){s+=s.indexOf("?")>0?"&":"?";s+="genLink=true"}if(e.getLevel()>=e.Level.DEBUG){e.debug("Navigation service search triggered","url: "+s,"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch")}if(n.get("sap-statistics")==="true"||window.localStorage.getItem("sap-ui-statistics")==="X"){s+=s.indexOf("?")>0?"&":"?";s+="sap-statistics=true"}return fetch(s,{method:"GET",headers:{"Content-Type":"application/json; utf-8",Accept:"application/json","Accept-Language":c}}).then(function(t){if(t.ok===false){e.error("Navigation service search adapter failed","error: "+t.status+","+t.statusText+"\nurl: "+s,"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch");return Promise.reject(t.statusText)}return t.json()}).then(function(t){if(e.getLevel()>=e.Level.DEBUG){e.debug("Navigation service search adapter success","url: "+s+"\n\n"+JSON.stringify(t||{},null,2),"sap.ushell.adapters.cep.SearchCEPAdapter::execSearch")}return t})};return r},false);