// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/util/isCrossOriginURL","sap/ushell/utils","sap/base/util/UriParameters"],function(e,r,n,t){"use strict";var i={};i.hasInvalidProtocol=function(e){var r=document.createElement("a");r.setAttribute("href",e);if(r.protocol==="javascript:"){return true}return false};i.isCrossOriginUrl=function(e){return r(e)};i.openURL=function(r,n,t,i){var o=i===undefined?true:i,a=this.isCrossOriginUrl(r);t=t||"";if(o&&this.hasInvalidProtocol(r)){e.fatal("Tried to open a URL with an invalid protocol",null,"sap/ushell/utils/WindowUtils");throw new Error("Tried to open a URL with an invalid protocol")}if(a){if(t.toLowerCase().indexOf("noopener")===-1){if(t!==""){t+=","}t+="noopener"}if(t.toLowerCase().indexOf("noreferrer")===-1){t+=",noreferrer"}window.open(r,n,t);return true}return window.open(r,n,t)};i.getLeanURL=function(r,n){var t=r||n;if(this.hasInvalidProtocol(t)){e.fatal("Tried to construct a lean URL for input containing an invalid protocol",null,"sap/ushell/utils/WindowUtils");return""}if((t||"").charAt(0)!=="#"){return t}var i=window.location.search;if(!i){i="?appState=lean"}else if(i.indexOf("appState=")>=-1){i+="&appState=lean"}return window.location.origin+window.location.pathname+i+t};i._getAdjustedQueryString=function(e,r){if((!e||e.length===0)&&(!r||r.length===0)){return null}var i=t.fromQuery(window.location.search);var o=Array.from(i.keys()).reduce(function(e,r){e[r]=i.getAll(r);return e},{});if(e&&e.length>0){e.forEach(function(e){var r=Object.keys(e)[0];if(r){o[r]=e[r]}})}if(r&&r.length>0){r.forEach(function(e){delete o[e]})}return n.urlParametersToString(o)};i.refreshBrowser=function(e,r){var t=n.getLocationHref();var o=n.getLocationSearch();var a=i._getAdjustedQueryString(e,r);if(a){t=t.replace(o,"?"+a)}if(n.getLocationHref()===t){n.windowLocationReload()}else{n.windowLocationAssign(t)}};return i});