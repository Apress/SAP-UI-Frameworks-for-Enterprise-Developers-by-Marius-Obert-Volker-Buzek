// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/library","sap/ushell/resources","sap/ui/Device","sap/ui/model/json/JSONModel"],function(e,o,t,r,i){"use strict";var s=o.ListMode;return e.extend("sap.ushell.components.appfinder.GroupListPopover",{onExit:function(){var e=this.getView();if(e._oListContainer){e._oListContainer.destroy()}if(e._oNewGroupItem){e._oNewGroupItem.destroy()}if(e._oNewGroupNameInput){e._oNewGroupNameInput.destroy()}if(e._oNewGroupHeader){e._oNewGroupHeader.destroy()}},initializeData:function(e){this.oPopoverModel=new i({userGroupList:e.groupData});this.oPopoverModel.setSizeLimit(9999);this.getView().oPopover.setModel(this.oPopoverModel)},_cancelButtonPress:function(){this.getView().oPopover.close()},_groupListItemClickHandler:function(e){var o=e.getParameter("listItem");if(o.data("newGroupItem")){this._navigateToCreateNewGroupPane();return}var t=e.getSource();if(t.getMode()===s.SingleSelectMaster){var r=this.getView();r.oPopover.close()}else{o.setSelected(!o.getSelected())}},_okayCancelButtonPress:function(){var e=this.getView();var o=e._getNewGroupInput();var t=o.getValue();if(t.length>0){this.sNewGroupId=t}e.oPopover.close()},_navigateToCreateNewGroupPane:function(){var e=this.getView();var o=e._getNewGroupHeader();var r=e._getNewGroupInput();e.oPopover.removeAllContent();e.oPopover.addContent(r);e.oPopover.setCustomHeader(o);e.oPopover.setContentHeight("");var i=e.oPopover.getEndButton();if(i){i.setVisible(true)}else{i=e._getCancelButton();e.oPopover.setEndButton(i)}e.oPopover.getBeginButton().setText(t.i18n.getText("okDialogBtn"));i.setText(t.i18n.getText("cancelBtn"));if(e.getViewData().singleGroupSelection){this._setFooterVisibility(true)}setTimeout(function(){r.focus()},0)},_afterCloseHandler:function(){var e=this.oPopoverModel.getProperty("/userGroupList");var o={addToGroups:[],removeFromGroups:[],newGroups:this.sNewGroupId?[this.sNewGroupId]:[],allGroups:e};var t;for(var r=0,i=e.length;r<i;++r){t=e[r];if(t.selected===t.initiallySelected){continue}if(t.selected){o.addToGroups.push(t.oGroup)}else{o.removeFromGroups.push(t.oGroup)}}var s=this.getView();s.deferred.resolve(o);s.destroy()},_backButtonHandler:function(){var e=this.getView();e.oPopover.removeAllContent();if(e.getViewData().singleGroupSelection){this._setFooterVisibility(false)}if(!r.system.phone){e.oPopover.setContentHeight("192px")}else{e.oPopover.setContentHeight("100%")}e.oPopover.setVerticalScrolling(true);e.oPopover.setHorizontalScrolling(false);e.oPopover.addContent(e._getListContainer());e.oPopover.setTitle(t.i18n.getText("addTileToGroups_popoverTitle"));e.oPopover.setCustomHeader();e._getNewGroupInput().setValue("");e.oPopover.getEndButton().setVisible(false);e.oPopover.getBeginButton().setText(t.i18n.getText("close"))},_setFooterVisibility:function(e){var o=sap.ui.getCore().byId("groupsPopover-footer");if(o){o.setVisible(e)}}})});