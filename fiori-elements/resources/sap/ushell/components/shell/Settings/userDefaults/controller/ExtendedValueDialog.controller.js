// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/Token","sap/ui/comp/library","sap/ui/model/json/JSONModel","sap/ui/core/Fragment"],function(e,t,a,o){"use strict";var n=t.valuehelpdialog.ValueHelpRangeOperation;var r=function(){};r.prototype.openDialog=function(e,t){o.load({id:"ExtendedValueDialogFragment",name:"sap.ushell.components.shell.Settings.userDefaults.view.ExtendedValueDialog",controller:this}).then(function(o){var n="/"+e.parameterName+"/valueObject/extendedValue/Ranges",r=e.modelBind.extendedModel,i=r.getProperty(n)||[],l,p;if(e.modelBind.isOdata){p=this._getMetadataNameSpace(e.editorMetadata.editorInfo.odataURL);var d=e.modelBind.model.getMetaModel().getODataEntityType(p+"."+e.editorMetadata.editorInfo.entityName);if(d){l=e.modelBind.model.getMetaModel().getODataProperty(d,e.editorMetadata.editorInfo.propertyName)["sap:label"]}}var s={label:e.editorMetadata.displayText||l||e.parameterName,key:e.modelBind.sPropertyName,parameterName:e.parameterName};o.setModel(new a(s));o.setIncludeRangeOperations(this.getListOfSupportedRangeOperations());o.setTokens(this.getTokensToValueHelpDialog(i,e.parameterName));o.setRangeKeyFields([{label:s.label,key:e.parameterName}]);o.attachOk(function(e){t(e);e.getSource().close()});o.open()}.bind(this))};r.prototype.closeValueHelp=function(e){e.getSource().close(e)};r.prototype.afterCloseValueHelp=function(e){e.getSource().destroy()};r.prototype._getMetadataNameSpace=function(e){var t=e.split("/"),a;a=t[t.length-1];return a};r.prototype.getListOfSupportedRangeOperations=function(){var e=Object.keys(n);return e.filter(function(e){return e!=="StartsWith"&&e!=="EndsWith"&&e!=="Initial"})};r.prototype.getTokensToValueHelpDialog=function(t,a){var o=[],n;t.forEach(function(t){if(t){n={};n.exclude=t.Sign==="E";n.keyField=a;n.operation=t.Option!=="CP"?t.Option:"Contains";n.value1=t.Low;n.value2=t.High;o.push(new e({}).data("range",n))}});return o};return new r});