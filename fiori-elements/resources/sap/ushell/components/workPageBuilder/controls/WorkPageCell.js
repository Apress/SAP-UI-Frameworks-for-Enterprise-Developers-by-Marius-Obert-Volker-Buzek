/*!
 * Copyright (c) 2009-2023 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ui/core/Control","sap/m/Button","sap/ui/core/dnd/DragInfo","sap/f/dnd/GridDropInfo","sap/f/GridContainer","sap/f/GridContainerSettings","sap/ui/core/library","sap/ushell/ui/launchpad/ExtendedChangeDetection"],function(e,t,i,n,r,a,o,d){"use strict";var p=o.dnd.DropLayout;var g=o.dnd.DropPosition;var s=e.extend("sap.ushell.components.workPageBuilder.controls.WorkPageCell",{metadata:{library:"sap.ushell",properties:{deleteWidgetTooltip:{type:"string",defaultValue:"",bindable:true},addApplicationButtonText:{type:"string",defaultValue:"",bindable:true},editMode:{type:"boolean",defaultValue:false,bindable:true},tileEditMode:{type:"boolean",defaultValue:false,bindable:true},snapToRow:{type:"boolean",defaultValue:true,bindable:true},gridContainerGap:{type:"string",group:"Appearance",defaultValue:"0.5rem",bindable:true},gridContainerGapXS:{type:"string",group:"Appearance",defaultValue:"0.475rem",bindable:true},gridContainerGapS:{type:"string",group:"Appearance",defaultValue:"0.475rem",bindable:true},gridContainerGapM:{type:"string",group:"Appearance",defaultValue:"0.5rem",bindable:true},gridContainerGapL:{type:"string",group:"Appearance",defaultValue:"0.5rem",bindable:true},gridContainerGapXL:{type:"string",group:"Appearance",defaultValue:"0.5rem",bindable:true},gridContainerRowSize:{type:"string",group:"Appearance",defaultValue:"5.25rem",bindable:true},gridContainerRowSizeXS:{type:"string",group:"Appearance",defaultValue:"4.375rem",bindable:true},gridContainerRowSizeS:{type:"string",group:"Appearance",defaultValue:"5.25rem",bindable:true},gridContainerRowSizeM:{type:"string",group:"Appearance",defaultValue:"5.25rem",bindable:true},gridContainerRowSizeL:{type:"string",group:"Appearance",defaultValue:"5.25rem",bindable:true},gridContainerRowSizeXL:{type:"string",group:"Appearance",defaultValue:"5.25rem",bindable:true}},defaultAggregation:"widgets",aggregations:{widgets:{type:"sap.ui.core.Control",multiple:true,singularName:"widget",bindable:true,dnd:true,forwarding:{getter:"getGridContainer",aggregation:"items"}},_deleteButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_gridContainer:{type:"sap.f.GridContainer",multiple:false,visibility:"hidden"},_addVizInstanceButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"}},events:{deleteCell:{},addApplications:{},moveVisualization:{},gridColumnsChange:{}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapCepWorkPageCell");e.openEnd();if(t.getEditMode()){e.openStart("div");e.class("sapCepWidgetToolbar");e.openEnd();e.renderControl(t.getDeleteButton());e.close("div")}e.renderControl(t.getGridContainer());if(t.getTileEditMode()){e.openStart("div");e.class("sapCepColumnToolbar");e.openEnd();e.renderControl(t.getAddVizInstanceButton());e.close("div")}e.close("div")}}});s.prototype.init=function(){this._oWidgetsChangeDetection=new d("widgets",this);e.prototype.init.apply(this,arguments)};s.prototype.exit=function(){this._oWidgetsChangeDetection.destroy();e.prototype.exit.apply(this,arguments)};s.prototype.getGridContainer=function(){var e=this.getAggregation("_gridContainer");if(!e){e=this._createGridContainer().attachColumnsChange(function(e){this.fireEvent("gridColumnsChange",e.getParameters())}.bind(this));this.setAggregation("_gridContainer",e.addStyleClass("sapCepWorkPageGridContainer"))}if(!this.getTileEditMode()||e.getItems().length===0){e.removeAllDragDropConfig()}else if(e.getDragDropConfig().length===0){e.addDragDropConfig(new i({sourceAggregation:"items"})).addDragDropConfig(new n({targetAggregation:"items",dropPosition:g.Between,dropLayout:p.Horizontal,drop:this.onDrop.bind(this)}))}return e.setSnapToRow(this.getSnapToRow()).setLayoutXL(new a({columnSize:this.getGridContainerRowSizeXL(),rowSize:this.getGridContainerRowSizeXL(),gap:this.getGridContainerGapXL()})).setLayoutL(new a({columnSize:this.getGridContainerRowSizeL(),rowSize:this.getGridContainerRowSizeL(),gap:this.getGridContainerGapL()})).setLayoutM(new a({columnSize:this.getGridContainerRowSizeM(),rowSize:this.getGridContainerRowSizeM(),gap:this.getGridContainerGapM()})).setLayoutS(new a({columnSize:this.getGridContainerRowSizeS(),rowSize:this.getGridContainerRowSizeS(),gap:this.getGridContainerGapS()})).setLayout(new a({columnSize:this.getGridContainerRowSize(),rowSize:this.getGridContainerRowSize(),gap:this.getGridContainerGap()}))};s.prototype._createGridContainer=function(){return new r(this.getId()+"--sapCepWorkPageCellGridContainer",{containerQuery:false,minHeight:"11rem"})};s.prototype.onDrop=function(e){this.fireEvent("moveVisualization",e.getParameters())};s.prototype.getDeleteButton=function(){if(!this.getAggregation("_deleteButton")){this.setAggregation("_deleteButton",new t({icon:"sap-icon://delete",tooltip:this.getDeleteWidgetTooltip(),press:function(){this.fireEvent("deleteCell")}.bind(this)}))}return this.getAggregation("_deleteButton")};s.prototype.getAddVizInstanceButton=function(){if(!this.getAggregation("_addVizInstanceButton")){this.setAggregation("_addVizInstanceButton",this._createAddVizInstanceButton())}return this.getAggregation("_addVizInstanceButton")};s.prototype._createAddVizInstanceButton=function(){return new t({text:this.getAddApplicationButtonText(),visible:true,press:function(){this.fireEvent("addApplications")}.bind(this)})};return s});