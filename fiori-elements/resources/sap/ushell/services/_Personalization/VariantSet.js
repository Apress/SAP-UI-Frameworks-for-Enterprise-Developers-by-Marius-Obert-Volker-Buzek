// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/utils","sap/ushell/services/_Personalization/constants.private","sap/ushell/services/_Personalization/PersonalizationContainerVariant","sap/ushell/services/_Personalization/Variant"],function(t,a,e,r){"use strict";function n(r,n){var i,s,o=new t.Map,p=new t.Map,l,h;this._oContextContainer=n;this._sVariantSetKey=r;this._oVariantSetData=this._oContextContainer._getItemValueInternal(a.S_VARIANT_PREFIX,this._sVariantSetKey);if(!Object.prototype.hasOwnProperty.call(this._oVariantSetData,"currentVariant")){throw new t.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ")}if(Object.prototype.hasOwnProperty.call(this._oVariantSetData,"variants")){for(i in this._oVariantSetData.variants){if(Object.prototype.hasOwnProperty.call(this._oVariantSetData.variants,i)){s=this._oVariantSetData.variants[i].name;l=this._oVariantSetData.variants[i].variantData;if(o.containsKey(s)){throw new t.Error("Variant name already exists: sap.ushell.services.Personalization"," ")}else{o.put(s,i);h=new e(i,s,l);p.put(i,h)}}}}else{throw new t.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ")}return this}n.prototype._getVariantSet=function(){return this._oVariantSetData};n.prototype._serialize=function(){this._oContextContainer._setItemValueInternal(a.S_VARIANT_PREFIX,this._sVariantSetKey,this._oVariantSetData)};n.prototype.getCurrentVariantKey=function(){return this._getVariantSet().currentVariant};n.prototype.setCurrentVariantKey=function(t){this._getVariantSet().currentVariant=t;this._serialize()};n.prototype.getVariantKeys=function(){var a=new t.Map,e=this._getVariantSet(this._sVariantSetKey),r;if(Object.prototype.hasOwnProperty.call(e,"variants")){for(r in e.variants){if(Object.prototype.hasOwnProperty.call(e.variants,r)){a.put(r,"dummy")}}}else{throw new t.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ")}return a.keys()};n.prototype.getVariantNamesAndKeys=function(){var a=new t.Map,e=new t.Map,r=this._getVariantSet(this._sVariantSetKey),n,i;if(Object.prototype.hasOwnProperty.call(r,"variants")){for(n in r.variants){if(Object.prototype.hasOwnProperty.call(r.variants,n)){i=r.variants[n].name;if(a.containsKey(i)){throw new t.Error("Variant name already exists: sap.ushell.services.Personalization"," ")}else{a.put(i,n)}e.put(n,"dummy")}}}else{throw new t.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ")}return a.entries};n.prototype.getVariant=function(t){if(typeof t!=="string"){return undefined}var a=this._getVariantSet(this._sVariantSetKey),e,n,i;if(Object.prototype.hasOwnProperty.call(a,"variants")&&Object.prototype.hasOwnProperty.call(a.variants,t)){e=a.variants[t].name;i=a.variants[t].variantData;n=new r(this,t,e,i);return n}return undefined};n.prototype.getVariantKeyByName=function(a){if(typeof a!=="string"){return undefined}var e=this._getVariantSet(this._sVariantSetKey),r;if(Object.prototype.hasOwnProperty.call(e,"variants")){for(r in e.variants){if(Object.prototype.hasOwnProperty.call(e.variants,r)){if(a===e.variants[r].name){return r}}}}else{throw new t.Error("Corrupt variant set data: sap.ushell.services.Personalization"," ")}return undefined};n.prototype.containsVariant=function(t){var a=this._getVariantSet();if(typeof t!=="string"){return undefined}return Object.prototype.hasOwnProperty.call(a,"variants")&&Object.prototype.hasOwnProperty.call(a.variants,t)};n.prototype.addVariant=function(a){var e=[],n=0,i="",s={};e=this.getVariantKeys();n=parseInt(e.sort(function(t,a){return t-a}).reverse()[0],10);i=isNaN(n)?"0":(n+1).toString();if(e.indexOf(i)>=0){throw new t.Error("Variant key '"+i+"' already exists in variant set"+this._sVariantSetKey+"': sap.ushell.services.Personalization"," ")}if(typeof a!=="string"){throw new t.Error("Parameter value of sVariantName is not a string: sap.ushell.services.Personalization"," ")}if(this.getVariantKeyByName(a)!==undefined){throw new t.Error("Variant name '"+a+"' already exists in variant set '"+this._sVariantSetKey+"' (Old key: '"+this.getVariantKeyByName(a)+"' New key: '"+i+"') ': sap.ushell.services.Personalization"," ")}s=new r(this,i,a);this._getVariantSet(this._sVariantSetKey).variants[i]={name:a,variantData:{}};this._serialize();return s};n.prototype.delVariant=function(t){var a;if(typeof t!=="string"){return undefined}a=this._getVariantSet();if(a&&a.variants){delete this._oVariantSetData.variants[t]}this._serialize()};return n});