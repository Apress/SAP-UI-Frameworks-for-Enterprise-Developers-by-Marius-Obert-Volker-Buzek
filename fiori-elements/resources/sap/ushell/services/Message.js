// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/m/MessageBox","sap/ushell/Config","sap/ushell/resources","sap/m/Dialog","sap/m/Text","sap/m/Link","sap/m/Button","sap/m/VBox","sap/m/FormattedText","sap/m/library","sap/ui/core/library"],function(e,t,n,i,o,s,a,r,l,c,u,p){"use strict";var d=u.ButtonType;var f=u.DialogType;var h=p.ValueState;var g=u.FlexRendertype;function m(){var u;this.init=function(e){u=e;return this};this.show=function(t,n,i){if(!n){e.error("Message must not be empty.");return}if(u&&typeof u==="function"){u(t,n,i||{})}else{this.buildMessage(t,n,i||{})}};this.buildMessage=function(e,n,i){var o={title:i.title,actions:i.actions,details:i.details,onClose:i.callback,emphasizedAction:i.emphasizedAction},s;switch(e){case m.Type.ERROR:this._createAndOpenErrorDialog(n,o);return;case m.Type.CONFIRM:if(!i.actions){s="confirm"}else if(i.actions.indexOf("DELETE")>-1){s="warning";o.emphasizedAction=t.Action.DELETE}else{o.icon=t.Icon.QUESTION;s="show"}break;case m.Type.INFO:s="info";this.buildAndSendMessageToast(n,i.duration||3e3);return;default:o={duration:i.duration||3e3};s="show";break}this.sendMessageBox(n,s,o)};this._copyToClipboard=function(e,t,n){var o=t.details;if(typeof t.details==="object"){o=JSON.stringify(t.details,null,"\t")}var s=["Title: "+(n||"-"),"Message: "+(e||"-"),"Details: "+(o||"-")];var a=document.activeElement,r=document.createElement("textarea"),l;try{r.contentEditable=true;r.readonly=false;r.innerText=s.join("\n");document.documentElement.appendChild(r);if(navigator.userAgent.match(/ipad|iphone/i)){var c=document.createRange();c.selectNodeContents(r);window.getSelection().removeAllRanges();window.getSelection().addRange(c);r.setSelectionRange(0,999999)}else{r.select()}var u=document.execCommand("copy");l=u?"CopyWasSuccessful":"CopyWasNotSuccessful"}catch(e){l="CopyWasNotSuccessful"}finally{this.buildAndSendMessageToast(i.i18n.getText(l));document.documentElement.removeChild(r);window.getSelection().removeAllRanges();a.focus()}};this._createAndOpenErrorDialog=function(e,t){var o=t.details;var s;if(o){s=new c({htmlText:typeof o==="object"?o.info:o})}var a=this.errorWithDetails(e,s,t.title);if(sap.ushell.Container&&n.last("/core/extension/SupportTicket")&&e!==i.i18n.getText("supportTicketCreationFailed")){a.addButton(new r({text:i.i18n.getText("contactSupportBtn"),tooltip:i.i18n.getText("contactSupportBtn_tooltip"),press:function(){sap.ui.require(["sap/ushell/ui/footerbar/ContactSupportButton"],function(e){var t=new e;if(t){t.showContactSupportDialog();t.destroy()}});a.close()}}))}if(document.queryCommandSupported("copy")){a.addButton(new r({text:i.i18n.getText("CopyToClipboardBtn"),tooltip:i.i18n.getText("CopyToClipboardBtn_tooltip"),press:this._copyToClipboard.bind(this,e,t,a.getTitle())}))}a.addButton(new r({text:i.i18n.getText("closeBtn"),type:d.Emphasized,press:a.close.bind(a)}))};this.buildAndSendMessageToast=function(e,t){sap.ui.require(["sap/m/MessageToast"],function(n){n.show(e,{duration:t})})};this.sendMessageBox=function(n,i,o){if(typeof t[i]==="function"){t[i](n,o)}else{e.error("Unknown Message type: "+i,null,"Message Service")}};this.info=function(e,t){this.show(m.Type.INFO,e,{duration:t||3e3})};this.error=function(t,n){e.error(t);this.show(m.Type.ERROR,t,{title:n})};this.confirm=function(e,t,n,i){this.show(m.Type.CONFIRM,e,{title:n,callback:t,actions:i})};this.errorWithDetails=function(e,t,n,c){if(Array.isArray(t)){c=t;t=null}if(typeof t==="string"){c=n;n=t;t=null}var u=new s({text:e,visible:!!e});if(t){u.addStyleClass("sapUiSmallMarginBottom")}var p=new o({state:h.Error,type:f.Message,contentWidth:"30rem",title:n||i.i18n.getText("error"),content:[new l({renderType:g.Bare,items:[u,new a({text:i.i18n.getText("ViewDetails"),visible:!!t,press:function(){p.getContent()[0].addItem(t);this.destroy()}})]})],buttons:c,endButton:new r({text:i.i18n.getText("closeBtn"),type:d.Emphasized,press:function(){p.close()}}),afterClose:function(){this.destroy()}}).addStyleClass("sapContrastPlus");p.open();return p};this.Type=m.Type}m.Type={INFO:0,ERROR:1,CONFIRM:2};m.hasNoAdapter=true;return m});