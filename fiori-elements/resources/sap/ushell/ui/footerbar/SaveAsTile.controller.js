// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/base/Log","sap/ushell/resources","sap/ui/core/library","sap/ui/thirdparty/hasher"],function(e,t,r,i,o){"use strict";var n=i.ValueState;return e.extend("sap.ushell.ui.footerbar.SaveAsTile",{onInit:function(){var e=this.getView();e.getTitleInput().attachLiveChange(function(){if(this.getValue()===""){this.setValueStateText(r.i18n.getText("bookmarkTitleInputError"));this.setValueState(n.Error)}else{this.setValueState(n.None)}})},loadPersonalizedGroups:function(){return sap.ushell.Container.getServiceAsync("LaunchPage").then(function(e){return new Promise(function(t,r){e.getGroupsForBookmarks().done(t).fail(r)})}).then(function(e){var t=this.getView().getModel();t.setProperty("/groups",e);t.setProperty("/groups/length",e.length)}.bind(this)).catch(function(){t.error("SaveAsTile controller: Unable to determine targets for bookmark placement.")})},getLocalizedText:function(e,t){return t?r.i18n.getText(e,t):r.i18n.getText(e)},getBookmarkTileData:function(){var e=this.getView();var t=e.getModel();var r=e.getViewData();var i;if(e.oGroupsSelect&&e.oGroupsSelect.getSelectedItem()){i=e.oGroupsSelect.getSelectedItem().getBindingContext().getObject()}var n;if(r.customUrl){if(typeof r.customUrl==="function"){n=r.customUrl()}else{n=r.customUrl}}else{n=o.getHash()?"#"+o.getHash():window.location.href}var s={title:t.getProperty("/title")||"",subtitle:t.getProperty("/subtitle")||"",url:n,icon:t.getProperty("/icon")||"",info:t.getProperty("/info")||"",numberUnit:t.getProperty("/numberUnit")||"",serviceUrl:typeof r.serviceUrl==="function"?r.serviceUrl():r.serviceUrl,dataSource:t.getProperty("/dataSource"),serviceRefreshInterval:t.getProperty("/serviceRefreshInterval"),group:i,keywords:t.getProperty("/keywords")||""};s.title=s.title.substring(0,256).trim();s.subtitle=s.subtitle.substring(0,256).trim();s.info=s.info.substring(0,256).trim();if(s.serviceUrl===undefined){delete s["serviceUrl"];delete s["serviceRefreshInterval"]}return s},onExit:function(){var e=this.getView();var t=e.getTileView();t.destroy()}})});