// Copyright (c) 2009-2023 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/Button","sap/m/CheckBox","sap/m/library","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/events/KeyCodes","sap/ushell/library","sap/ushell/resources","sap/ushell/ui/contentFinder/AppBoxRenderer"],function(e,t,i,r,o,l,a,s,n){"use strict";var p=i.ButtonType;var u=a.AppBoxPreviewSize;var f=r.extend("sap.ushell.ui.contentFinder.AppBox",{metadata:{library:"sap.ushell",properties:{appId:{type:"string",group:"Misc",defaultValue:null},dataHelpId:{type:"string",group:"Behavior",defaultValue:null},disabled:{type:"boolean",group:"Behavior",defaultValue:false},disablePreview:{type:"boolean",group:"Behavior",defaultValue:false},gridGapSize:{type:"float",group:"Behavior",defaultValue:1.5},icon:{type:"string",group:"Appearance",defaultValue:null},info:{type:"string",group:"Misc",defaultValue:null},launchUrl:{type:"string",group:"Behavior",defaultValue:null},previewSize:{type:"sap.ushell.AppBoxPreviewSize",group:"Misc",defaultValue:u.Small},posinset:{type:"int",group:"Misc",defaultValue:0},selectable:{type:"boolean",group:"Behavior",defaultValue:false},selected:{type:"boolean",group:"Appearance",defaultValue:false},setsize:{type:"int",group:"Misc",defaultValue:0},showExtraInformation:{type:"boolean",group:"Behavior",defaultValue:false},showPreview:{type:"boolean",group:"Behavior",defaultValue:false},subtitle:{type:"string",group:"Appearance",defaultValue:null},systemInfo:{type:"string",group:"Misc",defaultValue:null},title:{type:"string",group:"Appearance",defaultValue:null},type:{type:"string",group:"Misc",defaultValue:null}},defaultAggregation:"preview",aggregations:{preview:{type:"sap.ui.core.Control",multiple:false},_icon:{type:"sap.ui.core.Icon",multiple:false,hidden:true},_launchButton:{type:"sap.m.Button",multiple:false,hidden:true},_previewButton:{type:"sap.m.Button",multiple:false,hidden:true},_selectCheckBox:{type:"sap.m.CheckBox",multiple:false,hidden:true}},events:{press:{},launch:{parameters:{url:{type:"string"}}},previewShown:{parameters:{showPreview:{type:"boolean"}}},select:{parameters:{selected:{type:"boolean"}}},visibilityChanged:{}}},renderer:n});f.prototype.init=function(){this.setAggregation("_icon",new o);this.setAggregation("_launchButton",new e({icon:"sap-icon://action",type:p.Transparent,tooltip:s.i18n.getText("ContentFinder.AppBox.Button.Tooltip.LaunchApplication"),press:this.launchAction.bind(this)}));this.setAggregation("_previewButton",new e({iconFirst:false,type:p.Transparent,press:this.togglePreview.bind(this)}));this.setAggregation("_selectCheckBox",new t)};f.prototype.onBeforeRendering=function(){var e=this.getDomRef("title");if(e){e.classList.remove("sapUshellContentFinderAppBoxTitleMoreLines");e.removeAttribute("title")}var t=this.getDomRef("subtitle");if(t){t.classList.remove("sapUshellContentFinderAppBoxSubtitleMoreLines");t.removeAttribute("title")}var i=this.getDomRef("info");if(i){var r=i.getElementsByTagName("span");for(var o=0;o<r.length;++o){r[o].removeAttribute("title")}}};f.prototype.onAfterRendering=function(){var e=this.getDomRef("title");var t=false;if(e){if(e.offsetHeight<e.scrollHeight){e.classList.add("sapUshellContentFinderAppBoxTitleMoreLines");if(e.offsetHeight<e.scrollHeight){e.setAttribute("title",this.getTitle())}t=true}}var i=this.getDomRef("subtitle");if(i){if(!t&&i.offsetHeight<i.scrollHeight){i.classList.add("sapUshellContentFinderAppBoxSubtitleMoreLines")}if(i.offsetHeight<i.scrollHeight){i.setAttribute("title",this.getSubtitle())}}var r=this.getDomRef("info");if(r){var o=r.getElementsByTagName("span");var l;for(var a=0;a<o.length;++a){l=o[a];if(l.offsetWidth<l.scrollWidth){l.setAttribute("title",l.innerText)}}}};f.prototype.setVisible=function(e,t){this.setProperty("visible",e,t);this.fireVisibilityChanged();return this};f.prototype.launchAction=function(e){var t=e.getSource().getParent();t.fireLaunch({url:t.getLaunchUrl()})};f.prototype.togglePreview=function(e){var t=e.getSource().getParent();var i=t.getShowPreview();t.setShowPreview(!i);t.firePreviewShown({showPreview:!i})};f.prototype.ontap=function(e){var t=window.getSelection();var i=t.toString().replace("\n","");if(i&&jQuery.contains(this.getDomRef(),t.focusNode)){return}var r=e.srcControl;if(!this.getDisabled()&&(r===this||r===this.getAggregation("_selectCheckBox")||e.target&&e.target.firstChild===this.getDomRef())){if(this.getSelectable()){var o=this.getSelected();this.setSelected(!o);this.fireSelect({selected:!o})}else{this.firePress()}}r.focus()};f.prototype.onkeyup=function(e){if(e&&(e.which===l.SPACE||e.which===l.ENTER)&&!e.shiftKey){this.ontap(e);e.preventDefault()}};f.prototype.onsapspace=function(e){e.preventDefault()};return f});