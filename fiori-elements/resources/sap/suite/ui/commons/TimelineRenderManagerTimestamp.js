/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define("sap/suite/ui/commons/TimelineRenderManagerTimestamp",["sap/ui/base/ManagedObject","sap/m/RadioButtonGroup","sap/m/RadioButton","sap/m/Panel","sap/m/DateTimePicker","sap/m/Label","sap/ui/core/library"],function(e,t,i,a,n,s,o){"use strict";var r=o.ValueState;var l={RANGE:0,START:1,END:2};var g=e.extend("sap.suite.ui.commons.TimelineRenderManagerTimestamp",{constructor:function(t,i,a,n,s){var o;var r;this.getText=n.getText.bind(n);this.oObject=s;this.getTimestampPanelPicker=function(){if(!o){o=this._createTimestampPanelPicker()}return o};this.getTimestampPanelRadio=function(){if(!r){r=this._createTimestampPanelRadio()}return r};e.call(this,t,i,a);this.setVisible(false)},metadata:{events:{dateChanged:{}}}});g.prototype._createTimestampPanelPicker=function(){var e=this.getId()+"-timestamp-panel-picker";var t;var i=new s({text:this.getText("TIMELINE_FROM")+":"});var o=new s({text:this.getText("TIMELINE_TO")+":"});var r=new a({id:e,content:[i,new s({text:this.getText("TIMELINE_NOW"),visible:false}),new n({width:"auto",ariaLabelledBy:[i],change:this._handlerTimePickerRange.bind(this)}),o,new s({text:this.getText("TIMELINE_NOW"),visible:false}),new n({width:"auto",ariaLabelledBy:[o],change:this._handlerTimePickerRange.bind(this)})]});r.addStyleClass("sapSuiteUiCommonsTimelineRangeFilterPanel");t=r.getContent();t[1].addStyleClass("sapSuiteUiCommonsTimelineRangeLabelNow");t[2].addStyleClass("sapSuiteUiCommonsTimelineRangeDatePicker");t[4].addStyleClass("sapSuiteUiCommonsTimelineRangeLabelNow");t[5].addStyleClass("sapSuiteUiCommonsTimelineRangeDatePicker");return r};g.prototype._createTimestampPanelRadio=function(){var e=this.getId()+"-timestamp-panel-radio";return new a({id:e,content:[new t({columns:3,select:this.handlerSelectRadioButton.bind(this),buttons:[new i({id:e+"-range-of-dates",text:this.getText("TIMELINE_TIMESTAMP_RANGE_OF_DATES")}),new i({id:e+"-starting-date",text:this.getText("TIMELINE_TIMESTAMP_STARTING_DATE")}),new i({id:e+"-ending-date",text:this.getText("TIMELINE_TIMESTAMP_ENDING_DATE")})]})]})};g.prototype.resizeDialog=function(e){e.getFilterContent()._getDialog().setContentWidth("50em")};g.prototype.setVisible=function(e){this.getTimestampPanelPicker().setVisible(e);this.getTimestampPanelRadio().setVisible(e)};g.prototype.setPickerView=function(e,t){t.getContent()[1].setVisible(e===l.END);t.getContent()[2].setVisible(e===l.START||e===l.RANGE);t.getContent()[4].setVisible(e===l.START);t.getContent()[5].setVisible(e===l.END||e===l.RANGE)};g.prototype.handlerSelectRadioButton=function(e){this.setPickerView(e.getParameter("selectedIndex"),this.getTimestampPanelPicker())};g.prototype.getVisible=function(){return this.getTimestampPanelPicker().getVisible()&&this.getTimestampPanelRadio().getVisible()};g.prototype.getStartDate=function(){var e;var t=this.getTimestampPanelPicker().getContent()[2];if(t.getVisible()){e=t.getDateValue()}else{e=function(){return new Date}}return e};g.prototype.clearDates=function(){var e=this.getTimestampPanelPicker().getContent()[2],t=this.getTimestampPanelPicker().getContent()[5];var i=this.oObject.getFilterContent()._getDialog();var a=i.getBeginButton();e.setValueState(r.None);t.setValueState(r.None);a.setEnabled(true);e.setDateValue();t.setDateValue()};g.prototype.getEndDate=function(){var e;var t=this.getTimestampPanelPicker().getContent()[5];if(t.getVisible()){e=t.getDateValue()}else{e=function(){return new Date}}return e};g.prototype.destroy=function(){this.getTimestampPanelPicker().destroy();this.getTimestampPanelRadio().destroy();e.prototype.destroy.call(this)};g.prototype._handlerTimePickerRange=function(e){var t=this.getTimestampPanelPicker().getContent()[2],i=this.getTimestampPanelPicker().getContent()[5];var a=e.getSource();var n=a.getDateValue();var s=e.getParameter("valid");var o=this.oObject.getFilterContent()._getDialog();var l=o.getBeginButton();var g=s?r.None:r.Error;if(a===t){if(i.getDateValue()<n){i.setInitialFocusedDateValue(n)}i.setMinDate(n)}else if(a===i){if(t.getDateValue()>n){t.setInitialFocusedDateValue(n)}t.setMaxDate(n)}if(e.oSource.sId===t.getId()){t.setValueState(g)}else if(e.oSource.sId===i.getId()){i.setValueState(g)}if(t.getValueState()===r.None&&i.getValueState()===r.None){l.setEnabled(true)}else{l.setEnabled(false)}};g.prototype._checkDatePickerStatus=function(){var e=this.getTimestampPanelPicker().getContent()[2],t=this.getTimestampPanelPicker().getContent()[5];var i=this.oObject.getFilterContent()._getDialog();var a=i.getBeginButton();if(e.getValueState()===r.None&&t.getValueState()===r.None){a.setEnabled(true)}else{a.setEnabled(false)}};return g});