/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/suite/ui/commons/library","./ElementBase","./ElementAttribute","sap/ui/core/IconPool","sap/ui/Device","sap/base/security/encodeXML","sap/base/security/sanitizeHTML","sap/m/CheckBox","sap/m/Text","./NodeRenderer"],function(t,e,i,s,o,r,n,a,h,l,p){"use strict";var d=e.networkgraph.NodeShape,u=e.networkgraph.ActionButtonPosition,c=e.networkgraph.HeaderCheckboxState;var g=32,_=5,f=160,C=4;var S={Circle:{WIDTH:96,HEIGHT:64},Box:{WIDTH:160,HEIGHT:32},Attributes:{LINE:16,OFFSET:8},ActionButtons:{RADIUS:13,MARGIN:8,OFFSET:4},Title:{LINESIZE:15,OFFSET:8,ICON_SIZE:16,INFO_BOX_SIZE:20,ICON_X_OFFSET:6,IMAGE_OFFSET_Y:6},Description:{LINESIZE:15},Image:{Box:16,Circle:32}};var m={EXPANDED:"Expanded",COLLAPSED:"Collapsed",PARTIAL:"Partial"};var y={EXPAND:"sys-add",COLLAPSE:"sys-minus",PARTIAL:"overlay"};var T=o.getIconInfo(y.EXPAND),v=o.getIconInfo(y.COLLAPSE),I=o.getIconInfo(y.PARTIAL);T=T&&T.content;v=v&&v.content;I=I&&I.content;var x=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons");var N=i.extend("sap.suite.ui.commons.networkgraph.Node",{metadata:{library:"sap.suite.ui.commons",properties:{headerCheckBoxState:{type:"sap.suite.ui.commons.networkgraph.HeaderCheckboxState",group:"Misc",defaultValue:c.Hidden},collapsed:{type:"boolean",group:"Misc",defaultValue:false},selected:{type:"boolean",group:"Misc",defaultValue:false},group:{type:"string",group:"Misc",defaultValue:null},key:{type:"string",group:"Misc",defaultValue:null},shape:{type:"sap.suite.ui.commons.networkgraph.NodeShape",groups:"Behavior",defaultValue:d.Circle},icon:{type:"string",group:"Appearance",defaultValue:null},statusIcon:{type:"string",group:"Appearance",defaultValue:null},width:{type:"int",group:"Misc",defaultValue:undefined},height:{type:"int",group:"Misc",defaultValue:undefined},maxWidth:{type:"int",group:"Misc",defaultValue:undefined},x:{type:"float",group:"Misc",defaultValue:0},y:{type:"float",group:"Misc",defaultValue:0},showExpandButton:{type:"boolean",defaultValue:true},showActionLinksButton:{type:"boolean",defaultValue:true},showDetailButton:{type:"boolean",defaultValue:true},titleLineSize:{type:"int",defaultValue:1},descriptionLineSize:{type:"int",defaultValue:-1},iconSize:{type:"int",group:"Appearance",defaultValue:undefined},coreNodeSize:{type:"int",group:"Appearance",defaultValue:0},visible:{type:"boolean",group:"Appearance",defaultValue:true},altText:{type:"string",group:"Appearance",defaultValue:null}},aggregations:{actionLinks:{type:"sap.ui.core.Control",multiple:true,singularName:"actionLink"},actionButtons:{type:"sap.suite.ui.commons.networkgraph.ActionButton",multiple:true,singularName:"actionButton"},image:{type:"sap.suite.ui.commons.networkgraph.NodeImage",multiple:false,singularName:"nodeImage"},content:{type:"sap.ui.core.Control",multiple:false},_checkBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"}},events:{headerCheckBoxPress:{parameters:{checked:"boolean"}},press:{},hover:{},collapseExpand:{}}},onAfterRendering:function(){this._afterRenderingBase()}});N.prototype.aProcessRequiredProperties=["key","group"];N.prototype.init=function(t){this._bThemeApplied=true;if(!sap.ui.getCore().isInitialized()){this._bThemeApplied=false;sap.ui.getCore().attachInit(this._handleCoreInitialized.bind(this))}else{this._handleCoreInitialized()}this._oExpandState=m.EXPANDED;this._oGroup=null;this._iWidth=0;this._iHeight=0;this._iLabelAttrWidth=0;this._iValueAttrWidth=0;this._aTitleLines=[[]];this._aDescriptionLines=[[]];this._bIsHidden=false;this._bActionButtonsRendered=false;this._iCircleSize=0;this._iGroupIndex=-1;this._clearChildren()};N.prototype._handleCoreInitialized=function(){this._bThemeApplied=sap.ui.getCore().isThemeApplied();sap.ui.getCore().attachThemeChanged(this._handleThemeApplied,this)};N.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate()};N.prototype._clearChildren=function(){this.aChildren=[];this.aParents=[];this.aLines=[];this.aParentLines=[]};N.prototype._afterRendering=function(){var t=this.$();if(this._isInCollapsedGroup()){return}this._correctTitle("sapSuiteUiCommonsNetworkNodeTitle");this._setupEvents();if(this._bIsHidden){t.hide()}if(!this.getVisible()||this._oGroup&&!this._oGroup.getVisible()){t.hide()}if(this._oExpandState===m.COLLAPSED){t.addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(this._oExpandState===m.PARTIAL){t.addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}this.$(this.getId()+"actionbuttons").detach();this._bActionButtonsRendered=false;this._removeFromInvalidatedControls();if(this._isHtml()&&!N.hasNativeLineClamp){this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeTitle"),this.getTitleLineSize());this._setTextHeight(t.find(".sapSuiteUiCommonsNetworkGraphDivNodeDescription"),this.getDescriptionLineSize())}if(this.getSelected()){this.showActionButtons(true)}if(this._isInteractiveNode()){this.addStyleClass("sapMPointer")}else{this.removeStyleClass("sapMPointer")}};N.prototype._isInteractiveNode=function(){var t=this.getShowExpandButton()&&this._hasVisibleChildren(),e=this.getShowDetailButton()&&(this._hasDetailData()||this.getTitle()),i=this.getShowActionLinksButton()&&this._hasActionLinks(),s=this.getActionButtons(),o=s&&s.length>0,r=this.mEventRegistry.press;return t||e||i||o||r};N.prototype._render=function(t){var e=this.getParent(),i=e&&e._isUseNodeHtml();if(this._isIgnored()){return""}t=t||{};if(t.mapRender){if(this._oGroup&&!this._oGroup.getVisible()||!this.getVisible()){return""}}return i?this._renderHtml(t):this._renderSvg(t)};N.prototype._renderHtmlInfoIcon=function(t,e){t=t||{};e=e||{};var i=this.getStatusIcon(),s=this._convertToStyle(t,undefined,true),o=e.renderManager;o.openStart("div");o.attr("id",this._getElementId(e.idSufix)+"-statusiconwrapper");o.attr("title",x.getText("NETWORK_GRAPH_COLLAPSED"));this.applyStyles(o,this.getStyleObject(s));o.class("sapSuiteUiCommonsNetworkNodeDivInfoWrapper").class("sapSuiteUiCommonsNetworkNodeInfoWrapper");o.openEnd();o.openStart("div").class("sapSuiteUiCommonsNetworkNodeDivInfoIcon").class("sapSuiteUiCommonsNetworkGraphDivNodeIcon").openEnd();this._renderHtmlIcon(i||"sap-icon://hint",null,null,null,null,o);o.close("div");o.close("div")};N.prototype._renderHtmlText=function(t,e,i,s,o){this._renderHtmlElement("div",{"-webkit-line-clamp":e===0?"":e,color:s},{class:"sapSuiteUiCommonsNetworkGraphDivNodeText "+(i||"")+(e===1?" sapSuiteUiCommonsNetworkGraphDivTextBreakAll ":"")},o);o.text(t);o.close("div")};N.prototype._renderHtmlTitle=function(t,e){var i=this.getTitle();var s=i?i:this.getAltText();if(s){this._renderHtmlText(s,this.getTitleLineSize(),"sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeTitle",t,e);e.openStart("div").style("clear","both").openEnd().close("div")}};N.prototype._renderHtmlDescription=function(t,e){var i=this.getDescriptionLineSize(),s=this.getDescription();if(s&&i!=-1){this._renderHtmlText(s,i,"sapSuiteUiCommonsNetworkGraphDivNodeDescription",t,e)}};N.prototype._renderHtmlTitleAndDescription=function(t){this._renderHtmlTitle(null,t);this._renderHtmlDescription(null,t)};N.prototype._renderHtmlAttributes=function(t){var e=this.getVisibleAttributes();if(!t.renderManager){return}if(e.length>0){t.renderManager.openStart("div").class("sapSuiteUiCommonsNetworkGraphDivNodeAttributes").openEnd();e.forEach(function(e){this._renderClonedControl(t,e)}.bind(this));t.renderManager.close("div")}};N.prototype._showDivActionButtons=function(t){var e=this,i=this.$("rightdivbuttons"),s=this.$("leftdivbuttons");if(t&&!this._bActionButtonsRendered){i.html("");s.html("");var o=0,r=0;if(this.getShowExpandButton()){this._appendActionButton({class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",icon:this._getExpandIcon(true),enable:this._hasVisibleChildren(),title:x.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)},i);o++}if(this.getShowDetailButton()){var n=this.getTitle();this._appendActionButton({icon:"sap-icon://menu",enable:this._hasDetailData()||(n?n:this.getAltText()),id:this._getDomId("actionDetail"),title:x.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(t){this._detailClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionDetail"))){document.getElementById(this._getDomId("actionDetail")).setAttribute("aria-haspopup","dialog")}o++}if(this.getShowActionLinksButton()){this._appendActionButton({icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:x.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(t){this._linksClick(t.target)}.bind(this)},i);if(document.getElementById(this._getDomId("actionLinks"))){document.getElementById(this._getDomId("actionLinks")).setAttribute("aria-haspopup","dialog")}o++}for(var a=0;o+r<C*2&&a<this.getActionButtons().length;a++){(function(t){var n=t.getPosition(),a=n===u.Right?o:r;if(a>=C){n=n===u.Left?u.Right:u.Left}var h=n===u.Right?i:s;e._appendActionButton({icon:t.getIcon(),enable:t.getEnabled(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:e.target})}},h)})(this.getActionButtons()[a])}this._bActionButtonsRendered=true}var h=t?"addClass":"removeClass";this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons")[h](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};N.prototype._getCorrectWidth=function(){var t=this._iWidth||this.getWidth()||"auto",e="";if(this.getMaxWidth()){e=this.getMaxWidth()+"px"}if(t!==""&&t!=="auto"){t+="px"}return{width:t,maxWidth:e}};N.prototype._renderHtml=function(t){var e=this._getElementId(t.idSufix),i=this._isCircle(),s=this._getCorrectWidth();this._renderHtmlElement("div",{width:i?s.width:"","max-width":i?s.maxWidth:"",top:!this._bMainRender&&this.getY()?this.getY()+"px":"",left:!this._bMainRender&&this.getX()?this.getX()+"px":"","min-width":f+"px"},{id:e,"data-sap-ui":e,class:this._getNodeClass()},t.renderManager);this.renderContent(t);t.renderManager.close("div")};N.prototype._renderHtmlContent=function(t){t=t||{};var e=this._getElementId(t.idSufix),s=this._iHeight||this.getHeight()||S.Circle.HEIGHT,o=this._isCircle();var r=function(){var e=this.getContent();if(e){t.renderManager.openStart("div",this.getId()+"-contentwrapper");t.renderManager.openEnd();this._renderClonedControl(t,e);t.renderManager.close("div")}else{this.renderItemContent(t)}}.bind(this);var n=this._getStatusStyle({"border-color":i.ColorType.Focus},false);if(o){this._iCircleSize=this._iCircleSize||s;var a=this._convertToStyle({width:this._iCircleSize+"px",height:this._iCircleSize+"px"},this._getStatusStyle({"border-color":i.ColorType.Border}),true);var h=this._getStatusStyle({"border-color":i.ColorType.Background},false);var l=this._getStatusStyle({"border-color":i.ColorType.Border,"background-color":this.getSelected()?i.ColorType.SelectedBackground:"","border-width":i.ColorType.BorderWidth,"border-style":i.ColorType.BorderStyle},false);t.renderManager.openStart("div",e+"-wrapperwithbuttons");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInnerWrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.openEnd();this.renderHtmlActionButtons(t);t.renderManager.openStart("div",e+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(l));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner");t.renderManager.openEnd();t.renderManager.openStart("div");t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleWrapper");t.renderManager.openEnd();this._renderHtmlInfoIcon({},t);t.renderManager.openStart("div",e+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus");t.renderManager.openEnd();t.renderManager.openStart("div",e+"-status");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkDivCircleStatus");t.renderManager.openEnd();this.renderItemContent(t);t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");t.renderManager.close("div");this._renderHtmlTitleAndDescription(t.renderManager)}else{var p=this._getCorrectWidth();var a=this._convertToStyle({width:p.width,"max-width":p.maxWidth?p.maxWidth:"inherit","min-width":f+"px"},this._getStatusStyle({"border-color":i.ColorType.Border,"background-color":this.getSelected()?i.ColorType.SelectedBackground:"","border-width":i.ColorType.BorderWidth,"border-style":i.ColorType.BorderStyle}),true);this.renderHtmlActionButtons(t);t.renderManager.openStart("div",e+"-wrapper");this.applyStyles(t.renderManager,this.getStyleObject(a));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivInner").openEnd();t.renderManager.openStart("div",e+"-focus");this.applyStyles(t.renderManager,this.getStyleObject(n));t.renderManager.class("sapSuiteUiCommonsNetworkDivFocus").openEnd();t.renderManager.close("div");var h=this._getStatusStyle({"background-color":i.ColorType.Background},false);var d=this._getColor(this.getSelected()?i.ColorType.Content:i.ColorType.HeaderContent);t.renderManager.openStart("div",e+"-header");this.applyStyles(t.renderManager,this.getStyleObject(h));t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeader");if(this._hasHeaderContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderColor")}if(!this._hasAdditionalContent()){t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivHeaderOnly")}t.renderManager.openEnd();if(this._showHeaderCheckBox()){this._renderClonedControl(t,this._getHeaderCheckbox())}this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeIconTitle",t.renderManager);this._renderHtmlTitle(d,t.renderManager);t.renderManager.close("div");r();t.renderManager.close("div");this._renderHtmlInfoIcon({},t)}};N.prototype._getHeaderCheckbox=function(){var t=this.getAggregation("_checkBox"),e=this;if(!t){t=new h(this.getId()+"-checkbox").addStyleClass("sapSuiteUiCommonsNetworkGraphHeaderCheckboxInner");t.addEventDelegate({onAfterRendering:function(){t.$().on("mousedown",function(i){var s=!t.getSelected();t.setSelected(s);e.fireHeaderCheckBoxPress({checked:s});i.stopPropagation()})}});this.setAggregation("_checkBox",t,true)}return t};N.prototype._renderHtmlTitleIcon=function(t,e){var s=this.getIcon(),o=this.getImage(),r=this.getIconSize()?'style="font-size:'+this.getIconSize()+'px"':"",n,a;t=(t||"")+" sapSuiteUiCommonsNetworkGraphDivNodeTitleText sapSuiteUiCommonsNetworkGraphDivNodeIcon";n=this._getStatusStyle({color:this._isBox()?i.ColorType.HeaderContent:i.ColorType.Content},false);if(o){a=this._getImageSize();this._renderHtmlElement("img",{width:a.width+"px",height:a.height+"px"},{src:o.getSrc(),class:"sapSuiteUiCommonsNetworkGraphDivNodeImage"},e)}else if(s){e.openStart("div");this.applyStyles(e,this.getStyleObject(n));t.split(" ").forEach(function(t){if(t){e.class(t)}});e.openEnd();this._renderHtmlIcon(s,null,null,r,null,e);e.close("div")}};N.prototype._renderHtmlBoxContent=function(t){var e=this._hasAdditionalContent(),s=this._getElementId(t.idSufix);if(e){t.renderManager.openStart("div",s+"-additionalwarpper");t.renderManager.class("sapSuiteUiCommonsNetworkGraphDivAdditionalContent").openEnd();var o=this._getColor(i.ColorType.Content);this._renderHtmlDescription(o,t.renderManager);this._renderHtmlAttributes(t);t.renderManager.close("div")}};N.prototype._renderHtmlCircleContent=function(t){this._renderHtmlTitleIcon("sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon",t.renderManager)};N.prototype._renderSvg=function(t){var e=this._getElementId(t.idSufix);var i=this._renderControl("g",{id:e,"data-sap-ui":e,nodeid:n(this.getKey()),class:this._getNodeClass()},false);i+=this._renderControl("g",{id:e+"-wrapper",class:"sapSuiteUiCommonsNetworkNodeShape"},false);i+=this._renderContent(t);i+="</g>";i+="</g>";return i};N.prototype._renderSvgContent=function(t){var e=this._isBox()?this._renderBox(t):this._renderCircle(t);var i=this.getParent()._bIsRtl,s,o;if(this._isCircle()){var r=this._iCircleSize/8,n=this._iCircleSize/5.3;s=i?this._getCirclePosition().x+this._iCircleSize-r:this._getCirclePosition().x+r;o=this.getY()+n}else{s=this.getX();o=this.getY()}e+=this.renderStatusIcon({x:s-this.getX(),y:o-this.getY()});return e};N.prototype._renderContent=function(t){return this.renderContent(t)};N.prototype._renderCircleContent=function(){var t=this._iCircleSize,e=this.getParent()._bIsRtl,s=this.getImage(),o,r=this.getX(),h=this.getY(),l="";if(this._displayImage(s)){o=this._getImageSize();l+=this._renderControl("image",{"xlink:href":n(s.getSrc()),x:r+this._iWidth/2-o.width/2,y:h+t/2-o.height/2,width:o.width,height:o.height})}else if(this.getIcon()){l+=this._renderIcon({attributes:{class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkCircleNodeIcon sapSuiteUiCommonsNetworkStatusText",style:(this.getIconSize()?"font-size:"+this.getIconSize()+"px;":"")+this._getStatusStyle({fill:i.ColorType.Content}),x:r+this._iWidth/2,y:h+t/2},icon:this.getIcon(),height:this.getIconSize()?this.getIconSize()-2:22})}var p=this.getTitle();var d=p?p:this.getAltText();if(d){if(!this._aTitleLines||this._aTitleLines.length===1){l+=this._renderClipPath({id:this.getId()+"-title-clip",x:r,y:h+t+S.Title.OFFSET-10,height:S.Title.LINESIZE*2});l+=this._renderTitle({class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText",x:r+this._iWidth/2,y:h+t+S.Title.OFFSET,title:a(d),maxWidth:this._iWidth-5})}else{l+=this._renderMultilineTitle({x:r+this._iWidth/2,y:h+t+S.Title.OFFSET*2})}}if(this._displayDescription()){l+=this._renderDescription({x:e?r+this._iWidth-S.Title.OFFSET:r+S.Title.OFFSET,y:h+this._getTitleHeight()+t+S.Title.OFFSET*2+S.Title.OFFSET/2})}return l};N.prototype._renderCircle=function(){var t="",e=this.getX(),s=this.getY(),o=6,r=2,n=this._iCircleSize;t+=this._renderControl("circle",{id:this.getId()+"-innerBox",cx:e+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:i.ColorType.Border}),r:n/2,class:"sapSuiteUiCommonsNetworkInnerCircle"});t+=this._renderControl("circle",{id:this.getId()+"-statusCircle",cx:e+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:i.ColorType.Background}),r:n/2-o,class:"sapSuiteUiCommonsNetworkInnerCircleStatus"});t+=this._renderControl("circle",{id:this.getId()+"-focusCircle",cx:e+this._iWidth/2,cy:s+n/2,style:this._getStatusStyle({stroke:i.ColorType.Focus}),r:n/2-r,class:"sapSuiteUiCommonsNetworkCircleFocus"});t+=this.renderItemContent();return t};N.prototype._renderBoxContent=function(t){var e=g/2,s=S.Title.ICON_X_OFFSET,o=this.getParent()._bIsRtl,r=this.getImage(),h=this.getY(),l=this.getX(),p,d=this._getImageSize(),u="";if(this._displayImage(r)){d=this._getImageSize();u+=this._renderControl("image",{"xlink:href":n(r.getSrc()),x:o?l+this._iWidth-S.Title.ICON_X_OFFSET-d.width:l+S.Title.ICON_X_OFFSET,y:h+S.Title.IMAGE_OFFSET_Y,width:d.width,height:d.height});s+=d.width+S.Title.ICON_X_OFFSET}else if(this.getIcon()){u+=this._renderIcon({attributes:{style:this._getStatusStyle({fill:i.ColorType.Content}),class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeTitleIcon sapSuiteUiCommonsNetworkStatusText",x:o?l+this._iWidth-S.Title.ICON_X_OFFSET:l+S.Title.ICON_X_OFFSET,y:h+e},icon:this.getIcon(),height:S.Title.LINESIZE});s+=S.Title.ICON_SIZE+S.Title.ICON_X_OFFSET}var c=this.getTitle();var f=c?c:this.getAltText();if(f){p=this._iWidth-s-_;if(p>0){if(!this._aTitleLines||this._aTitleLines.length===1){u+=this._renderClipPath({id:this.getId()+"-title-clip",x:l,y:h,height:g});u+=this._renderTitle({class:"sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeText sapSuiteUiCommonsNetworkStatusText",style:this._getStatusStyle({fill:i.ColorType.Content}),x:o?l+this._iWidth-s:l+s,y:h+e,maxWidth:p,title:a(f)})}else{u+=this._renderMultilineTitle({x:o?l+this._iWidth-s:l+s,y:h+S.Title.OFFSET*2})}}}if(this._displayDescription()){u+=this._renderDescription({x:o?l+this._iWidth-S.Title.OFFSET:l+S.Title.OFFSET-S.Title.OFFSET/3,y:h+this._getTitleHeight()+(this._hasMultiLineTitle()?S.Title.OFFSET*2+S.Title.OFFSET/2:S.Title.OFFSET*4)})}if(this._displayAttributes()){u+=t.sizeDetermination?this._renderAttributesForSize():this._renderAttributes({y:this.getY()+this._getDescriptionHeight()+this._getTitleHeight()+S.Title.OFFSET+(!this._hasMultiLineTitle()?S.Attributes.OFFSET:0)})}return u};N.prototype._renderBox=function(t){var e=6,s=4,o=(this._iTitleHeight||this._getTitleHeight())+e,r=3;var n=this.getY(),a=this.getX();var h=this._renderControl("rect",{id:this.getId()+"-innerBox",x:a,y:n,style:this._getStatusStyle({stroke:i.ColorType.Border}),class:"sapSuiteUiCommonsNetworkInnerRect",rx:r,ry:r,width:this._iWidth,height:this._iHeight,"pointer-events":"fill"});var l=this._iHeight===g;h+=this._renderRoundRect({id:this.getId()+"-innerStatusBox",x:a,y:n,style:this._getStatusStyle({fill:i.ColorType.Background}),class:"sapSuiteUiCommonsNetworkNodeBoxStatus",topRight:r,topLeft:r,bottomRight:l?r:0,bottomLeft:l?r:0,width:this._iWidth,height:Math.max(o,g),"pointer-events":"fill"});h+=this._renderControl("rect",{id:this.getId()+"-focusCircle",x:a+s,y:n+s,class:"sapSuiteUiCommonsNetworkBoxFocus",style:this._getStatusStyle({stroke:i.ColorType.Focus}),rx:5,ry:5,width:this._iWidth-s*2,height:this._iHeight-s*2});h+=this.renderItemContent(t);return h};N.prototype._renderInfoIcon=function(t,e,i,s){var o=this.getStatusIcon(),r=o?"sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon":"",n='<g id="'+this.getId()+"-statusiconwrapper"+'" class="sapSuiteUiCommonsNetworkNodeInfoWrapper '+r+'">';n+=this._renderControl("circle",{class:"sapSuiteUiCommonsNetworkNodeInfoBox",cx:t,cy:e,r:i||S.Title.INFO_BOX_SIZE/2},false);n+="<title>"+x.getText("NETWORK_GRAPH_COLLAPSED")+"</title>";n+="</circle>";n+=this._renderIcon({attributes:{id:this.getId()+"-statusicon",class:"sapSuiteUiCommonsNetworkNodeInfoIcon sapSuiteUiCommonsNetworkGraphIcon",x:t+S.Title.INFO_BOX_SIZE/2-10,y:e,style:s?"font-size:"+s:""},icon:o||"sap-icon://hint",height:S.Title.INFO_BOX_SIZE/2+2.5});n+="</g>";return n};N.prototype._getNodeClass=function(){var t=this.getSelected()?this.SELECT_CLASS:"",e=this._hasCustomStatus()?" sapSuiteUiCommonsNetworkNodeCustomStatus ":"",i="";if(this.aCustomStyleClasses){i=this.aCustomStyleClasses.join(" ")}return(this.getParent()._isUseNodeHtml()?"sapSuiteUiCommonsNetworkGraphDivNode ":"sapSuiteUiCommonsNetworkNode ")+t+e+(this._isBox()?" sapSuiteUiCommonsNetworkBox ":" sapSuiteUiCommonsNetworkNodeCircle ")+this._getStatusClass()+i};N.prototype._renderAttributesForSize=function(){var t="",e="";this.getVisibleAttributes().forEach(function(i){t+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:i.getLabel()});e+=this._renderText({attributes:{class:"sapSuiteUiCommonsNetworkGraphAttribute",x:this.getX(),y:this.getY()},text:i.getValue()})},this);t='<g id="'+this.getId()+'-attrLabel">'+t+"</g>";e='<g id="'+this.getId()+'-attrValue">'+e+"</g>";return t+e};N.prototype._getAttributeColor=function(t,e,i){var s=e+"Status",o=t["get"+s]()||this.getStatus();return this._getColor(i,o)};N.prototype._getAttributeColorString=function(t,e,i){var s=this._getAttributeColor(t,e,i);return s?"fill:"+s:""};N.prototype._renderAttributes=function(t){t=t||{};var e=2,o=6,r=12;var n=this.getParent()._bIsRtl,a=n?this.getX()+this._iWidth-o:this.getX()+o,h=this._iLabelAttrWidth?this._iLabelAttrWidth:this._iWidth/2-r,l=n?a-h-r:a+h+r,p=n?l-this.getX()-o:this.getX()+this._iWidth-l-o;var d=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-value)",id:this.getId()+"-attrValue"},false),u=this._renderControl("g",{"clip-path":"url(#"+this.getId()+"-clip-attr-label)",id:this.getId()+"-attrLabel"},false),c=t.y,g=this._renderClipPath({id:this.getId()+"-clip-attr-label",x:n?a-h-o+e:a-e,y:c,width:e*2+(n?h+o:h)});g+=this._renderClipPath({id:this.getId()+"-clip-attr-value",x:n?this.getX()+o+e:l-e,y:c,width:e*2+(n?p+o:p)});this.getVisibleAttributes().forEach(function(t,e){var o=c+S.Attributes.LINE*(e+1);u+=this._renderText({attributes:{style:this._getAttributeColorString(t,s.Type.Label,i.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkStatusText",x:a,id:t.getId()+"-label",y:o},text:t.getLabel()});d+=this._renderText({attributes:{style:this._getAttributeColorString(t,s.Type.Value,i.ColorType.Content),class:"sapSuiteUiCommonsNetworkGraphAttribute sapSuiteUiCommonsNetworkGraphAttributeValue sapSuiteUiCommonsNetworkStatusText",x:l,y:o,id:t.getId()+"-value"},text:t.getValue()})},this);d+="</g>";u+="</g>";return g+u+d};N.prototype._detailClick=function(t){t=t||this;t.useClientRect=true;this.getParent()._tooltip.openDetail({item:this,opener:t})};N.prototype._linksClick=function(t){t=t||this;this.getParent()._tooltip.openLink({item:this,opener:t})};N.prototype._expandClick=function(){var t=this.fireEvent("collapseExpand",{},true);if(t){this.setCollapsed(this._oExpandState!==m.COLLAPSED)}};N.prototype._setupMaxWidth=function(){var t=this.getMaxWidth();if(t){this._iWidth=t}};N.prototype._setTextHeight=function(t,e){if(t[0]&&e>0){var i=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeIcon.sapSuiteUiCommonsNetworkGraphDivNodeIconTitle");i.hide();var s=t.height();t.css("white-space","nowrap");var o=t.height();if(o!==0&&s!==0){t.height(Math.min(s,e*o))}t.css("white-space","");i.show()}};N.prototype._applyMaxWidth=function(){var t=30,e=10;var i,s,o,r=0,n=0,a=0,h,l=this.getMaxWidth();if(this._oGroup&&this._oGroup.getCollapsed()){return}if(!this.getWidth()&&this.getMaxWidth()){s=this.$("attrLabel");o=this.$("attrValue");if(s[0]){n=s[0].getBBox().width}if(o[0]){r=o[0].getBBox().width}a=r+n+t;i=Math.max(this.$()[0].getBBox().width+e,a);this._iWidth=Math.max(Math.min(i,l),80);if(r&&n){h=Math.max(n,r);if(h*2+t/2<this._iWidth){return}if(a>this._iWidth){if(r<l/2){this._iLabelAttrWidth=this._iWidth-r-t}if(n<this._iWidth/2){this._iLabelAttrWidth=n+t/4}}else{this._iLabelAttrWidth=this._iWidth-r-t}}}};N.prototype._resetDimensions=function(){this._iWidth=0;this._iHeight=0;this._iCircleSize=0;this._iTitleHeight=0};N.prototype._setupDivDimensions=function(){var t=this.$();this._iWidth=t.width();this._iHeight=t.height()};N.prototype._setupWidthAndHeight=function(t){var e=this._isBox()?"Box":"Circle",i=this._getTitleHeight(),s=this.getTitle()||this._hasDetailData()?S.Title.LINESIZE:0,o=this._getDescriptionHeight();o=o?o+5:0;var r=function(){var t=this._iHeight||this.getHeight();if(this._isBox()&&!t){t=o+(this._hasMultiLineTitle()?i+S.Title.OFFSET:Math.max(i+s,S.Box.HEIGHT));if(this._displayAttributes()){t+=this.getVisibleAttributes().length*S.Attributes.LINE+S.Attributes.OFFSET}}if(this._isCircle()&&!this._iHeight){t=t?t:S[e].HEIGHT;this._iCircleSize=t;t+=i+o}return Math.max(t,30)}.bind(this);var n=function(){var t=Math.max(this._iWidth||this.getWidth()||S[e].WIDTH,30);if(this._isCircle()&&t<this._iCircleSize){t=this._iCircleSize}return t}.bind(this);this._iHeight=r();this._iWidth=n()};N.prototype._getTitleHeight=function(){var t=0,e=this._getImageSize();if(this._hasMultiLineTitle()){t=(this.getTitleLineSize()>0?Math.min(this._aTitleLines.length,this.getTitleLineSize()):this._aTitleLines.length)*S.Title.LINESIZE}else{t=this._isBox()||this.getTitle()?S.Title.LINESIZE:0}return Math.max(e.height,t)};N.prototype._getDescriptionHeight=function(){var t=this.getDescriptionLineSize();if(t===-1||!this._aDescriptionLines||!this.getDescription()){return 0}return(t>0?Math.min(t,this._aDescriptionLines.length):this._aDescriptionLines.length)*S.Description.LINESIZE};N.prototype._setupEvents=function(){var t=this.$("wrapper");t.off("mouseover");t.off("mouseout");t.off("click");t.on("mouseover",function(t){this._mouseOver()}.bind(this));t.on("mouseout",function(t){this._mouseOut()}.bind(this));t.on("click",function(t){if(t.which===1){this._onClick(t.ctrlKey)}t.preventDefault()}.bind(this))};N.prototype._mouseOut=function(){this.$().removeClass(this.HIGHLIGHT_CLASS);if(!this.getSelected()){this._setStatusColors("")}};N.prototype._mouseOver=function(){var t=this.fireEvent("hover",{},true);if(t){if(!this.getSelected()){this._setStatusColors("Hover")}this.$().addClass(this.HIGHLIGHT_CLASS)}};N.prototype._onClick=function(t){var e=this.fireEvent("press",{},true);this.getParent()._selectNode({element:this,forceFocus:true,renderActionButtons:e&&!this.getSelected(),preventDeselect:t});if(!this.getSelected()){this.$().addClass(this.HIGHLIGHT_CLASS);this._setStatusColors("Hover")}};N.prototype._deselect=function(){var t=this.$("innerBox");t.css("stroke",this._getColor(i.ColorType.Border));t.css("fill",this._getColor(i.ColorType.Background))};N.prototype._getExpandIcon=function(t){switch(this._oExpandState){case m.PARTIAL:return t?y.PARTIAL:I;case m.EXPANDED:return t?y.COLLAPSE:v;case m.COLLAPSED:return t?y.EXPAND:T;default:return t?y.EXPAND:T}};N.prototype._createLineText=function(t,e,i,s){var o=[[]],r=0,n,a,h,l,p,d,u=this._createElement("tspan");if(!t||e<0){return o}l=t.split(/\s+/).reverse();i.appendChild(u);while(l.length>0){a=l.pop();if(a){h=o[r];h.push(a);u.textContent=o[r].join(" ");if(u.getComputedTextLength()>e){if(h.length>1&&s!==1){l.push(h.pop())}if(h.length===1){d=this._createText(i,{text:h[0],width:e,dots:false});if(d){p=u.textContent;h.pop();h.push(p);n=a.substring(p.length);l.push(n)}}r++;if(s>0&&r>=s){break}o[r]=[]}}}if(s>0&&l.length>0){o[o.length-1].push("...")}if(o.length>0){d=this._createText(i,{text:o[o.length-1].join(" "),width:e,dots:true});if(d){o[s-1]=[u.textContent]}}return o};N.prototype._createDescription=function(){var t,e=this._iWidth-S.Title.OFFSET,i=this.$();if(this._displayDescription()&&i[0]){t=this._createElement("text");t.setAttribute("class","sapSuiteUiCommonsNetworkNodeDescription");i[0].appendChild(t);this._aDescriptionLines=this._createLineText(this.getDescription(),e,t,this.getDescriptionLineSize())}};N.prototype._createMultilineTitle=function(){var t=function(){if(this._isBox()){if(this._displayImage()){return this._iWidth-this._getImageSize().width-S.Title.ICON_X_OFFSET*2}if(this.getIcon()){return this._iWidth-S.Title.ICON_SIZE-S.Title.ICON_X_OFFSET*2}return this._iWidth-S.Title.OFFSET*2}return this._iWidth}.bind(this);var e,i=t(),s=this.$();if(this.getTitleLineSize()!==1&&s[0]&&i>0){e=this._createElement("text");e.setAttribute("class","sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle");s[0].appendChild(e);this._aTitleLines=this._createLineText(this.getTitle(),i,e,this.getTitleLineSize())}};N.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};N.prototype._renderMultilineText=function(t){var e="",s=this._isBox()&&t.useCustomstyle;if(!t.lines){return""}for(var o=0;o<t.lines.length;o++){e+=this._renderText({attributes:{style:s?this._getStatusStyle({fill:i.ColorType.Content}):"",class:t.class+(s?" sapSuiteUiCommonsNetworkStatusText ":""),x:t.x,y:t.y+o*t.lineSize},close:false});e+=t.lines[o].join(" ");e+="</text>"}return e};N.prototype._renderDescription=function(t){t.class=" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle";return this._renderMultilineText({lines:this._aDescriptionLines,maxLineSize:this.getDescriptionLineSize(),lineSize:S.Description.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeDescription ",x:t.x,y:t.y})};N.prototype._sanitizeTitleLines=function(t){for(var e=0;e<t.length;e++){t[e]=[a(t[e])]}return t};N.prototype._renderMultilineTitle=function(t){var e=this._sanitizeTitleLines(this._aTitleLines);return this._renderMultilineText({useCustomStyle:true,lines:e,maxLineSize:this.getTitleLineSize(),lineSize:S.Title.LINESIZE,class:" sapSuiteUiCommonsNetworkNodeTitle sapSuiteUiCommonsNetworkNodeMultipleLineTitle",x:t.x,y:t.y,trim:this._aTitleLines.length>this.getTitleLineSize()&&this.getTitleLineSize()!==0})};N.prototype._processHideShowParents=function(t,e,i){var s=this._oGroup&&this._oGroup.getCollapsed();var o=function(t){if(t._bIsHidden){return}var i=false,s;if(t.getKey()!==e){if(t.aChildren.length>0){s=t.aChildren[0]._bIsHidden;t.aChildren.forEach(function(t){if(s!==t._bIsHidden){i=true}});t._oExpandState=i?m.PARTIAL:s?m.COLLAPSED:m.EXPANDED;if(t._oExpandState===m.COLLAPSED){t.$().addClass("sapSuiteUiCommonsNetworkNodeCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodeCollapsed")}if(t._oExpandState===m.PARTIAL){t.$().addClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}else{t.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed")}}}};o(this);this.aParents.forEach(function(t){if(!i[t.getKey()]){o(t)}});if(s){if(this._oGroup._bNeedParentProcessing){this._oGroup.aNodes.forEach(function(t){t.aParents.forEach(function(t){if(!i[t.getKey()]){o(t)}})});this._oGroup._bNeedParentProcessing=false}}};N.prototype._getAllChildren=function(t,e,i){var s=function(t){if(!i[t]){i[t]=this;return true}return false}.bind(this);if(e===this.getKey()){return}if(this._bIsHidden===t){return}if(!s(this.getKey())){return}if(this._oGroup&&this._oGroup.getCollapsed()){this._oGroup.aNodes.forEach(function(s){s._getAllChildren(t,e,i)})}if(this._oExpandState!==m.COLLAPSED){this.aChildren.forEach(function(s){s._getAllChildren(t,e,i)})}};N.prototype._hideShow=function(t){var e=t?"hide":"show",i;this._bIsHidden=t;this.aLines.forEach(function(e){e._hideShow(t)});this.aParentLines.forEach(function(e){e._hideShow(t)});if(this._oGroup&&!this._oGroup._bIsSwimLane){if(this._oGroup.getCollapsed()){this._oGroup._hideShow(t)}else{i=this._oGroup._hasVisibleNodes();if(i&&!t||!i&&t){this._oGroup._hideShow(t)}}}if(this._isInCollapsedGroup()&&this._isHtml()){return}if(this.$()){this.$()[e]()}};N.prototype._setActionButtonFocus=function(e,i){this.$().removeClass(this.FOCUS_CLASS);this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS);var s=i?"addClass":"removeClass";t(e)[s](this.FOCUS_CLASS)};N.prototype._getActionButtonTitle=function(e){if(this.getParent().getRenderType()==="Html"){var i=t(e).attr("title");return x.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(i?" "+i:"")}else{var s=t(e).find("title")[0];return x.getText("NETWORK_GRAPH_ACCESSIBILITY_ACTION_BUTTON")+(s?" "+s.textContent:"")}};N.prototype._getAccessibilityLabel=function(){var t=this.getTitle();var e=t?t:this.getAltText();var i=x.getText("NETWORK_GRAPH_NODE")+" "+e;if(this._isBox()){this.getVisibleAttributes().forEach(function(t){i+=" "+t.getLabel()+" "+t.getValue()})}if(this.getStatus()&&this.getStatus()!=""){var s=this.getParent();var o=this.getStatus();if(s._oStatuses[o]){i+=" "+x.getText("PF_ARIA_STATUS")+" "+s._oStatuses[o].getTitle()}else{i+=" "+x.getText("PF_ARIA_STATUS")+" "+this.getStatus()}}if(this.getSelected()){i+=" "+x.getText("NETWORK_GRAPH_SELECTED_NODE")}return i};N.prototype._setStatusColors=function(e){var s=function(s,n){if(n&&s){var a=this._getColor(i.ColorType[e+"Content"],n),h=o?"color":"fill";t(s).css(h,a||r)}}.bind(this);var o=this.getParent()&&this.getParent()._isUseNodeHtml();if(this._hasCustomStatus()){var r=this._getColor(i.ColorType[e+"Content"]),n=this._getColor(i.ColorType[e+"Background"]),a=this._getColor(i.ColorType[e+"Border"]);var h=e==="Selected"||e==="Hover";if(!o){var l=this.$("innerBox"),p=d?this.$("statusCircle"):this.$("innerStatusBox"),d=this._isCircle();p.css(d?"stroke":"fill",h?"none":n);l.css("fill",h?n:"");l.css("stroke",a);this.$().find(".sapSuiteUiCommonsNetworkStatusText").css("fill",r);this.$("focusCircle").css("stroke",this._getColor(i.ColorType[e+"Focus"]))}else{var u=this.$("wrapper"),c=this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText");u.css("border-color",a);this.$("focus").css("border-color",this._getColor(i.ColorType[e+"Focus"]));if(this._isBox()){this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeText").css("color",r);this.$("header").css("background-color",h&&!n?"":n);c.css("color",h?r:this._getColor(i.ColorType.HeaderContent));u.css("background-color",h&&n?n:"")}else{this.$("status").css("border-color",n);u.css("background-color",h&&n?n:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeCircleIcon").css("color",r)}}}this.getAttributes().forEach(function(t){if(t&&t.getVisible()){var e=t.getLabelStatus(),i=t.getValueStatus();if(e){s(t.$("icon"),e);s(t.$("label"),e)}if(i){s(t.$("value"),i)}}})};N.prototype._setNodeOpacity=function(e){if(this._isCircle()){this.$("wrapper").css("opacity",e?.3:"");this.$().find(".sapSuiteUiCommonsNetworkGraphDivNodeTitleText").css("opacity",e?.3:"");if(e){this.$("wrapperwithbuttons").append(t("<div></div>",{class:"sapSuiteUiCommonsNetworkGraphDivInnerCloned sapSuiteUiCommonsNetworkGraphDivInner"}))}else{this.$("wrapperwithbuttons").find(".sapSuiteUiCommonsNetworkGraphDivInnerCloned").detach()}return}this.$().css("opacity",e?.3:"")};N.prototype._getContentRect=function(){var t=this._getCirclePosition(),e=this._isCircle();var i=e?t.x:this.getX(),s=e?t.y:this.getY(),o=e?this._iCircleSize:this._iHeight,r=e?this._iCircleSize:this._iWidth;return{p1:{x:i,y:s},p2:{x:i+r,y:s+o}}};N.prototype._setFocus=function(t){i.prototype._setFocus.apply(this,arguments);var e=t?"Selected":"";this.$("focus").css("border-color",this._getColor(i.ColorType[e+"Focus"]))};N.prototype.getHeaderCheckbox=function(){return this._getHeaderCheckbox()};N.prototype.computeTextDimensions=function(e){var i=this.getDomRef(),s,o,r;if(i){s=this._createElement("text",e.attributes);i.appendChild(s);try{o=this._createLineText(e.text,e.width,s,e.maxLines);r=s.getBBox().height}catch(t){}t(s).detach();return{text:o,lineHeight:r}}};N.prototype.renderText=function(t){var e=16;var i="",s=t.lines;if(!s){if(t.text){s=[t.text.split(" ")]}else{return""}}for(var o=0;o<s.length;o++){i+=this._renderText({attributes:Object.assign({x:t.x+this.getX(),y:this.getY()+t.y+o*(t.lineSize||e)},t.attributes),close:false});i+=s[o].join(" ");i+="</text>"}return i};N.prototype.renderIcon=function(t){t.attributes=t.attributes||{};Object.assign(t.attributes,{"font-family":"SAP-icons"});t.attributes.x=this.getX()+(t.x||0);t.attributes.y=this.getY()+(t.y||0);return this._renderIcon({attributes:t.attributes,icon:t.icon})};N.prototype.renderHtmlIcon=function(t,e){if(e&&e.renderManager){this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon",null,null,null,e.renderManager)}else{return this._renderHtmlIcon(t,"sapSuiteUiCommonsNetworkGraphDivNodeIcon")}};N.prototype.renderHtmlActionButtons=function(t){t=t||{};var e=this._getElementId(t.idSufix)+"-rightdivbuttons",i=this._getElementId(t.idSufix)+"-leftdivbuttons",s=t.renderManager;s.openStart("div").attr("id",i).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsLeft").openEnd().close("div");s.openStart("div").attr("id",e).class("sapSuiteUiCommonsNetworkGraphDivActionButtons").class("sapSuiteUiCommonsNetworkGraphDivActionButtonsRight").openEnd().close("div")};N.prototype.renderHtmlInfoIcon=function(t,e){return this._renderHtmlInfoIcon(t,e)};N.prototype.renderContent=function(t){return this._isHtml()?this._renderHtmlContent(t):this._renderSvgContent(t)};N.prototype.renderItemContent=function(t){if(this._isHtml()){return this._isBox()?this._renderHtmlBoxContent(t):this._renderHtmlCircleContent(t)}return this._isBox()?this._renderBoxContent(t):this._renderCircleContent(t)};N.prototype.calculateSizes=function(){this._setupMaxWidth();this._createMultilineTitle();this._createDescription();this._resetDimensions();this._applyMaxWidth()};N.prototype.renderElement=function(t,e,i){return this._renderControl(t,e,i)};N.prototype.renderStatusIcon=function(t){return this._renderInfoIcon(this.getX()+t.x,this.getY()+t.y,t.size,t.iconSize)};N.prototype.setSize=function(t){if(t){if(t.width){this._iWidth=t.width}if(t.height){this._iHeight=t.height}if(t.titleHeight){this._iTitleHeight=t.titleHeight}}};N.prototype.hasVisibleActionButtons=function(){return this.$("actionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)||this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons").hasClass(this.VISIBLE_ACTIONS_BUTTONS_CLASS)};N.prototype.getEnabledActionButtons=function(){return this.$().find(".sapSuiteUiCommonsNetworkNodeActionButton, .sapSuiteUiCommonsNetworkGraphDivActionButton:not(.sapSuiteUiCommonsNetworkGraphDivActionButtonDisabled)").parent().toArray()};N.prototype.showActionButtons=function(e){if(!this.getParent()){return}var i,s,o=this,r=0,n=0,a=this.getParent()._bIsRtl,h,l,p,d,c,g,_;if(this._isHtml()){this._showDivActionButtons(e);return}var f=function(){var t=this.getParent()._bIsRtl?-S.ActionButtons.RADIUS-S.ActionButtons.MARGIN:S.ActionButtons.RADIUS+S.ActionButtons.MARGIN,e=S.ActionButtons.RADIUS,s=[[t,e]];for(var o=1;o<i;o++){s.push([t,e+S.ActionButtons.RADIUS*2*o+S.ActionButtons.OFFSET*o])}return s}.bind(this);var m=function(){var t=this.getActionButtons().length;if(this.getShowExpandButton()){t++}if(this.getShowDetailButton()){t++}if(this.getShowActionLinksButton()){t++}return t}.bind(this);var y=function(e){var i=13,s=2,o=e.position&&e.position===u.Left,l=o&&!a||!o&&a;e.x=e.x+(l?d:p);var c={cx:e.x,cy:e.y,id:e.id+"-circle",class:"sapSuiteUiCommonsNetworkNodeActionButton",r:S.ActionButtons.RADIUS},g={class:"sapSuiteUiCommonsNetworkGraphIcon sapSuiteUiCommonsNetworkNodeActionIcon "+(e.class?e.class:""),x:e.x,y:e.y},_,f,C,m,y,T;if(!e.enable){c.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabledBackground";h.appendChild(this._createElement("circle",c));c.class="sapSuiteUiCommonsNetworkNodeActionButtonDisabled";g.class+=" sapSuiteUiCommonsNetworkNodeActionButtonDisabled"}y=this._createElement("g",{id:e.id});_=this._createElement("circle",{id:e.id+"-circle",cx:e.x,cy:e.y,r:S.ActionButtons.RADIUS-s,class:"sapSuiteUiCommonsNetworkActionButtonFocusCircle"});C=this._createElement("circle",c);m=this._createIcon(g,e.icon,i);if(e.title){f=this._createElement("title");f.textContent=e.title;C.appendChild(f)}y.appendChild(C);y.appendChild(m);y.appendChild(_);h.appendChild(y);T=t(C);if(e.enable){T.on("click",function(){this._setActionButtonFocus(y,true);this._setFocus(false);if(this.getParent()){this.getParent().setFocus({item:this,button:y})}}.bind(this));t(C).on("click",e.click)}o?n++:r++;return{icon:m,wrapper:C}}.bind(this);i=m();s=f();if(i===0){return}if(e&&!this._bActionButtonsRendered){c=this.getY();if(this._isCircle()){p=this.getX()+(this._iWidth/2+this._iCircleSize/2);d=this.getX()+(this._iWidth/2-this._iCircleSize/2)}else{p=this.getX()+this._iWidth;d=this.getX()}var h=this.$("actionButtons")[0];if(!h){h=this._createElement("g",{class:"sapSuiteUiCommonsNetworkNodeActionButtonWrapper",id:this._getDomId("actionButtons")})}else{t(h).children().remove()}if(this.getParent()._isUseNodeHtml()){this.getParent().$("actiionbuttons")[0].appendChild(h)}else{this.$()[0].appendChild(h)}if(this.getShowExpandButton()){l=y({x:s[r][0],y:c+s[r][1],icon:this._getExpandIcon(true),class:"sapSuiteUiCommonsNetworkNodeActionCollapseIcon",enable:this._hasVisibleChildren(),title:x.getText("NETWORK_GRAPH_EXPAND_COLLAPSE"),id:this._getDomId("actionCollapse"),click:this._expandClick.bind(this)});this._expandIcon=l.icon}if(this.getShowDetailButton()){var T=this.getTitle();g=y({x:s[r][0],y:c+s[r][1],icon:"sap-icon://menu",enable:this._hasDetailData()||(T?T:this.getAltText()),id:this._getDomId("actionDetail"),title:x.getText("NETWORK_GRAPH_NODE_DETAILS"),click:function(){this._detailClick(g.wrapper)}.bind(this)})}if(this.getShowActionLinksButton()){_=y({x:s[r][0],y:c+s[r][1],icon:"sap-icon://chain-link",enable:this._hasActionLinks(),title:x.getText("NETWORK_GRAPH_NODE_LINKS"),id:this._getDomId("actionLinks"),click:function(){this._linksClick(_.wrapper)}.bind(this)})}for(var v=0;r+n<C*2&&v<this.getActionButtons().length;v++){(function(t){var e=t.getPosition(),i=e===u.Right?r:n;if(i>=C){e=e===u.Left?u.Right:u.Left;i=e===u.Right?r:n}var o=y({x:s[i][0],y:c+s[i][1],icon:t.getIcon(),title:t.getTitle(),id:t.getId(),click:function(e){t.firePress({buttonElement:o.wrapper})},enable:t.getEnabled(),position:e})})(this.getActionButtons()[v])}this._bActionButtonsRendered=true}else if(this._expandIcon){this._expandIcon.textContent=o._getExpandIcon();this.$().find("."+this.FOCUS_CLASS).removeClass(this.FOCUS_CLASS)}var I=e?"addClass":"removeClass";this.$("actionButtons")[I](this.VISIBLE_ACTIONS_BUTTONS_CLASS)};N.prototype.getChildNodes=function(){this._checkForProcessData();return this.aChildren};N.prototype.getChildLines=function(){this._checkForProcessData();return this.aLines};N.prototype.getParentNodes=function(){this._checkForProcessData();return this.aParents};N.prototype.getParentLines=function(){this._checkForProcessData();return this.aParentLines};N.prototype.isHidden=function(){return this._bIsHidden};N.prototype.setHidden=function(t){var e=this;var i=function(i){i.forEach(function(i){var s=i.getFromNode()===e?i.getToNode():i.getFromNode();i.setHidden(t||s.isHidden())})};i(this.getChildLines());i(this.getParentLines());this.$()[t?"hide":"show"]();this._bIsHidden=t;if(this._oGroup){this._oGroup.setHidden(!this._oGroup._hasVisibleNodes())}};N.prototype.getCenterPosition=function(){var t,e;if(this._isBox()){return{x:this.getX()+this._iWidth/2,y:this.getY()+this._iHeight/2}}t=this._getCirclePosition();e=this._getCircleSize()/2;return{x:t.x+e,y:t.y+e}};N.prototype.setHeaderCheckBoxState=function(t){this._setHeaderCheckBoxState(t);return this};N.prototype.setX=function(t){this.setProperty("x",t,true);return this};N.prototype.setY=function(t){this.setProperty("y",t,true);return this};N.prototype.setSelected=function(t){var e=this.getParent(),i=t?"addClass":"removeClass",s=this.getKey();this.setProperty("selected",t,true);if(e){this._setStatusColors(t?"Selected":"");this.$()[i](this.SELECT_CLASS);if(t){e._mSelectedNodes[s]=this}else{delete e._mSelectedNodes[s]}}return this};N.prototype.setCollapsed=function(t){var e={},i,s,o=t?"addClass":"removeClass",r=this.$().find(".sapSuiteUiCommonsNetworkGraphDivActionButtons, .sapSuiteUiCommonsNetworkNodeActionButtonWrapper").find(".sapSuiteUiCommonsNetworkNodeActionCollapseIcon");this.setProperty("collapsed",t,true);this._oExpandState=t?m.COLLAPSED:m.EXPANDED;this.aChildren.forEach(function(i){i._getAllChildren(t,this.getKey(),e)},this);i=Object.keys(e);i.forEach(function(i){e[i]._hideShow(t,this.getKey())},this);i.forEach(function(i){e[i]._processHideShowParents(t,this.getKey(),e)},this);this.aLines.forEach(function(e){e._hideShow(t)});if(r[0]){r[0].textContent=this._getExpandIcon()}this.$().removeClass("sapSuiteUiCommonsNetworkNodePartialCollapsed");this.$()[o]("sapSuiteUiCommonsNetworkNodeCollapsed");s=this.getParent();if(s){s._setupKeyboardNavigation();if(t&&!(s.getFocus()&&s.getFocus().item===this)){s.setFocus({item:this})}}return this};N.prototype.setGroup=function(t){this.setProperty("group",t,true);this._invalidateParent();return this};N.prototype.setShape=function(t){this.setProperty("shape",t,true);this._invalidateParent();return this};N.prototype.setWidth=function(t){this.setProperty("width",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iWidth=t}else{this._iWidth=0}this._invalidateParent();return this};N.prototype.setHeight=function(t){this.setProperty("height",t,true);if(this.getParent()&&this.getParent()._bPreventInvalidation){this._iHeight=t}else{this._iHeight=0}this._invalidateParent();return this};N.prototype.setMaxWidth=function(t){this.setProperty("maxWidth",t,true);this._invalidateParent();return this};N.prototype.setTitleLineSize=function(t){this.setProperty("titleLineSize",t,true);this._invalidateParent();return this};N.prototype.addAttribute=function(){i.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};N.prototype.insertAttribute=function(){i.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};N.prototype.removeAllAttributes=function(){i.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent();return this};N.prototype.removeAttribute=function(){i.prototype.removeAttribute.apply(this,arguments);this._invalidateParent();return this};N.prototype.addAttribute=function(){i.prototype.addAttribute.apply(this,arguments);this._invalidateParent();return this};N.prototype.insertAttribute=function(){i.prototype.insertAttribute.apply(this,arguments);this._invalidateParent();return this};N.prototype.removeAllAttributes=function(){i.prototype.removeAllAttributes.apply(this,arguments);this._invalidateParent()};N.prototype.removeAttribute=function(){i.prototype.removeAttribute.apply(this,arguments);this._invalidateParent()};N.prototype.getHeaderCheckBoxState=function(){if(this.getProperty("headerCheckBoxState")===c.Hidden){return c.Hidden}return this.getHeaderCheckbox().getSelected()?c.Checked:c.Unchecked};N.prototype._hasAdditionalContent=function(){return this._displayAttributes()||this._displayDescription()||this.getContent()};N.prototype._hasHeaderContent=function(){return this.getIcon()||this.getTitle()||this.getImage()};N.hasNativeLineClamp=typeof document.documentElement.style.webkitLineClamp!="undefined"&&r.browser.chrome;N.prototype._invalidateParent=function(){var t=this.getParent();if(t){t.invalidate()}};N.prototype._isIgnored=function(){var t=this.getParent(),e=t&&t._isSwimLane(),i=this._isInCollapsedGroup();if(e&&this._isHtml()){i=false}return i||this._isInIgnoredGroup()||!this._useInLayout()};N.prototype._getImageSize=function(){var t=function(t,e){return{width:t?parseInt(t,10):0,height:e?parseInt(e,10):0}};var e=this._isBox()?"Box":"Circle",i=this.getImage();if(!this._displayImage(i)){return t()}return t(i.getWidth()?i.getWidth():S.Image[e],i.getHeight()?i.getHeight():S.Image[e])};N.prototype._displayImage=function(t){t=t||this.getImage();return t&&t.getSrc()};N.prototype._isHtml=function(){return this.getParent()&&this.getParent()._isUseNodeHtml()};N.prototype._isInCollapsedGroup=function(){return this._oGroup&&this._oGroup._isCollapsed()};N.prototype._isInIgnoredGroup=function(){return this._oGroup&&this._oGroup._isIgnored()};N.prototype._displayAttributes=function(){return this.getVisibleAttributes().length!==0&&this._isBox()};N.prototype._displayDescription=function(){return this.getDescriptionLineSize()!==-1&&this.getDescription()};N.prototype._hasTitle=function(){return this.getTitle()||this.getIcon()};N.prototype._isBox=function(){return this.getShape()===d.Box&&this.getParent()._isLayered()};N.prototype._isCircle=function(){return this.getShape()===d.Circle};N.prototype._isCustom=function(){return this.getShape()===d.Custom};N.prototype._hasChildren=function(){return this.aChildren.length>0};N.prototype._showHeaderCheckBox=function(){return this.getHeaderCheckBoxState()!==c.Hidden&&this._isBox()};N.prototype._hasVisibleChildren=function(){return this.aChildren.some(function(t){return!(t._oGroup&&!t._oGroup.getVisible())&&t.getVisible()})};N.prototype._hasDetailData=function(){return this.getDescription()||this.getAttributes().length>0};N.prototype._hasActionLinks=function(){return this.getActionLinks().some(function(t){return t.getVisible()})};N.prototype._useAutomaticSize=function(){return!this.getWidth()&&this.getMaxWidth()>0};N.prototype._getShapeSize=function(t){if(this._isCircle()){return this._getCircleSize()}var e=this._isCustom()?this.getCoreNodeSize():0;return e||(t?this._iWidth:this._iHeight)};N.prototype._getCircleSize=function(){return this._isBox()?undefined:this._iCircleSize};N.prototype._hasMultiLineTitle=function(){return this._aTitleLines&&this._aTitleLines.length>1};N.prototype._getCirclePosition=function(){return this._isBox()?undefined:{x:this.getX()+(this._iWidth-this._getCircleSize())/2,y:this.getY()}};N.prototype._isOnScreen=function(t,e,s,o){var r=this.getX(),n=this.getY();return i._isRectOnScreen(r,r+this._iWidth,n,n+this._iHeight,t,e,s,o)};N.prototype.getFocusDomRef=function(){return this.getDomRef("wrapper")};N.prototype.setVisible=function(t){this.setProperty("visible",t);var e=this.getParent();if(e&&e._bIsLayedOut){this.getParentNodes().forEach(function(t){t._bActionButtonsRendered=false})}return this};N.prototype.setStatusIcon=function(t){var e=this.$("statusicon")[0],i=o.getIconInfo(t),s=i&&i.content;this.$("statusiconwrapper")[t?"addClass":"removeClass"]("sapSuiteUiCommonsNetworkNodeInfoWrapperCustomIcon");e&&(e.textContent=s);this.setProperty("statusIcon",t,true);return this};return N});