/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["./library","sap/ui/core/Control","./ProcessFlowConnectionRenderer"],function(e,t,o){"use strict";var a=t.extend("sap.suite.ui.commons.ProcessFlowConnection",{metadata:{library:"sap.suite.ui.commons",properties:{drawData:{type:"object[]",group:"Misc",defaultValue:null},zoomLevel:{type:"sap.suite.ui.commons.ProcessFlowZoomLevel",group:"Misc",defaultValue:"Two"},type:{type:"sap.suite.ui.commons.ProcessFlowConnectionType",group:"Appearance",defaultValue:"Normal",deprecated:true},state:{type:"sap.suite.ui.commons.ProcessFlowConnectionState",group:"Appearance",defaultValue:"Regular",deprecated:true}},defaultAggregation:"_labels",aggregations:{_labels:{type:"sap.suite.ui.commons.ProcessFlowConnectionLabel",multiple:true,singularName:"_label",visibility:"hidden"}}}});a.prototype._oResBundle=null;a.prototype._showLabels=false;a.prototype._oStateOrderMapping=null;a.prototype.init=function(){if(!this._oResBundle){this._oResBundle=sap.ui.getCore().getLibraryResourceBundle("sap.suite.ui.commons")}this._oStateOrderMapping={};this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Neutral]=1;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Positive]=2;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Critical]=3;this._oStateOrderMapping[e.ProcessFlowConnectionLabelState.Negative]=4};a.prototype._getAriaText=function(e){var t="";var o=" "+this._oResBundle.getText("PF_CONNECTION_ENDS");if(this._isHorizontalLine(e)){t=this._oResBundle.getText("PF_CONNECTION_HORIZONTAL_LINE");if(e.arrow){t+=o}}else if(this._isVerticalLine(e)){t=this._oResBundle.getText("PF_CONNECTION_VERTICAL_LINE");if(e.arrow){t+=o}}else{t=this._oResBundle.getText("PF_CONNECTION_BRANCH");if(e.arrow){t+=o}}return t};a.prototype._getVisibleLabel=function(){var e=null;if(this.getAggregation("_labels")){var t=this.getAggregation("_labels");for(var o=0;o<t.length;o++){var a=t[o];if(a&&a.getMetadata().getName()==="sap.suite.ui.commons.ProcessFlowConnectionLabel"){if(e){if(this._oStateOrderMapping[e.getState()]<this._oStateOrderMapping[a.getState()]){e=a}else if(this._oStateOrderMapping[e.getState()]===this._oStateOrderMapping[a.getState()]){if(e.getPriority()<a.getPriority()){e=a}}}else{e=a}}}}return e};a.prototype._getShowLabels=function(){return a.prototype._showLabels};a.prototype._setShowLabels=function(e){a.prototype._showLabels=e};a.prototype._traverseConnectionData=function(){var e=this.getDrawData();if(!e){return{}}var t=this._createConnection(e);if(this.getAggregation("_labels")){t.labels=this.getAggregation("_labels")}return t};a.prototype._isVerticalLine=function(e){return e.hasOwnProperty("left")&&!e.left.draw&&e.hasOwnProperty("right")&&!e.right.draw&&e.hasOwnProperty("top")&&e.top.draw&&e.hasOwnProperty("bottom")&&e.bottom.draw};a.prototype._isHorizontalLine=function(e){return e.hasOwnProperty("left")&&e.left.draw&&e.hasOwnProperty("right")&&e.right.draw&&e.hasOwnProperty("top")&&!e.top.draw&&e.hasOwnProperty("bottom")&&!e.bottom.draw};a.prototype._createConnection=function(e){var t={draw:false,type:"",state:""};var o={right:t,top:t,left:t,bottom:t,arrow:false};for(var a=0;a<e.length;a++){o.right=this._createLine(e[a],"r",o.right);o.top=this._createLine(e[a],"t",o.top);o.left=this._createLine(e[a],"l",o.left);o.bottom=this._createLine(e[a],"b",o.bottom);if(e[a].flowLine.indexOf("r")>=0){if(e[a].hasArrow){o.arrow=true}}}return o};a.prototype._createLine=function(t,o,a){var r={draw:a.draw,type:a.type,state:a.state};if(t.flowLine.indexOf(o)>=0){r.draw=true;if(t.targetNodeState===e.ProcessFlowNodeState.Neutral||t.targetNodeState===e.ProcessFlowNodeState.Positive||t.targetNodeState===e.ProcessFlowNodeState.Negative||t.targetNodeState===e.ProcessFlowNodeState.Critical){r.type=e.ProcessFlowConnectionType.Normal}else if(t.targetNodeState===e.ProcessFlowNodeState.Planned||t.targetNodeState===e.ProcessFlowNodeState.PlannedNegative){if(r.type!==e.ProcessFlowConnectionType.Normal){r.type=e.ProcessFlowConnectionType.Planned}}if(t.displayState===e.ProcessFlowDisplayState.Selected||t.displayState===e.ProcessFlowDisplayState.SelectedHighlighted||t.displayState===e.ProcessFlowDisplayState.SelectedHighlightedFocused||t.displayState===e.ProcessFlowDisplayState.SelectedFocused){r.state=e.ProcessFlowConnectionState.Selected}else if(t.displayState===e.ProcessFlowDisplayState.Highlighted||t.displayState===e.ProcessFlowDisplayState.HighlightedFocused){if(r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Highlighted}}else if(t.displayState===e.ProcessFlowDisplayState.Regular||t.displayState===e.ProcessFlowDisplayState.RegularFocused){if(r.state!==e.ProcessFlowConnectionState.Highlighted&&r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Regular}}else if(t.displayState===e.ProcessFlowDisplayState.Dimmed||t.displayState===e.ProcessFlowDisplayState.DimmedFocused){if(r.state!==e.ProcessFlowConnectionState.Highlighted&&r.state!==e.ProcessFlowConnectionState.Regular&&r.state!==e.ProcessFlowConnectionState.Selected){r.state=e.ProcessFlowConnectionState.Dimmed}}}return r};a.prototype.addConnectionData=function(e){var t=this.getDrawData();if(!t){t=[]}t.push(e);this.setDrawData(t);return t};a.prototype.destroyAggregation=function(e,t){this.removeAllAggregation("_labels",true)};return a});