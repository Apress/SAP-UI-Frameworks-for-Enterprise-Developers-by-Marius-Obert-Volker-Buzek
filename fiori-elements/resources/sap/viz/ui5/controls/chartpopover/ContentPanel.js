/*!
 * SAPUI5
 * (c) Copyright 2009-2023 SAP SE. All rights reserved.
 */
sap.ui.define(["./ShapeMarker","sap/ui/core/Control","sap/ui/layout/form/SimpleForm","sap/ui/layout/Grid","sap/m/Text","sap/m/ObjectNumber","sap/m/Label","sap/ui/core/library","../common/utils/ContentUtil","../common/utils/SelectionDetailUtil","sap/ui/layout/form/ResponsiveGridLayout"],function(e,t,o,a,s,i,r,l,n,h){"use strict";var p=l.TextAlign;var m=t.extend("sap.viz.ui5.controls.chartpopover.ContentPanel",{metadata:{properties:{showLine:"boolean"},publicMethods:["setContentData"]},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t).class("viz-controls-chartPopover-contentPanel").attr("aria-labelledby",t._oDimLabel.getId()+" "+t._oForm.getId()).attr("tabindex",-1).openEnd();e.renderControl(t._oShapeLabel);e.renderControl(t._oPanel);e.close("div")}}});m.prototype.init=function(){this._measureItemsLen=0;this._maxMeasureLableLen=15;this._maxMeasureValueLen=12;this._oShapeLabel=new e(this._createId("vizShapeMarker"),{}).addStyleClass("viz-controls-chartPopover-dimension-marker");this._oDimLabel=new s(this._createId("vizDimensionLabel"),{}).addStyleClass("viz-controls-chartPopover-dimension-label");this._oForm=new o({editable:false,maxContainerCols:2,layout:"ResponsiveGridLayout",labelSpanL:6,labelSpanM:6,labelSpanS:6,emptySpanL:0,emptySpanM:0,emptySpanS:0,columnsL:2,columnsM:2,content:[]});this._oPanel=new a({width:"100%",defaultSpan:"L12 M12 S12",content:[this._oDimLabel,this._oForm]}).addStyleClass("viz-controls-chartPopover-Vlt")};m.prototype.setContentData=function(e){this._measureItemsLen=0;var t=e.val,o="";if(t){this._oForm.removeAllContent();var a=false;var s=n.setContent("popover",e);var i=s.items;o=s.dims;a=s.isLongMode;for(var r=0;r<i.length;r++){this._renderLabels(a,i[r],e.isTimeSeries)}var l=function(e){var t=false;if(e.selectByTimeAxisGroup&&e.val){var o=0;for(var a=0;a<e.val.length;a++){if(e.val[a].type==="Measure"){o++}}if(o>1){t=true}}return t};if(!l(e)&&typeof e.color==="string"){var h=this._oDimLabel.$().css("margin-left");if(h){h=parseInt(h.substr(0,h.length-2));this._oShapeLabel.setMarkerSize(h)}this._oShapeLabel.setColor(e.color).setType(e.shape?e.shape:"square");if(this.getShowLine()){this._oShapeLabel.setShowWithLine(e.type).setLineInfo(e.lineInfo)}else{this._oShapeLabel.setShowWithLine(undefined)}if(e.stroke&&e.stroke.visible){this._oShapeLabel.setStroke(e.stroke)}}else{this._oShapeLabel.setType(null);this._oShapeLabel.setShowWithLine(undefined)}if(e.pattern){this._oShapeLabel.setPattern(e.pattern)}else{this._oShapeLabel.setPattern(null)}if(o&&o.length>0){this._oDimLabel.setVisible(true);this._oDimLabel.setText(o)}else{this._oDimLabel.setVisible(false)}this._measureItemsLen=e.val.length;if(this._oShapeLabel._isShowWithLine()){this._oForm.addStyleClass("viz-controls-chartPopover-measure-simpleForm")}else{this._oForm.removeStyleClass("viz-controls-chartPopover-measure-simpleForm")}if(!this._oDimLabel.getVisible()){this._oForm.addStyleClass("viz-controls-chartPopover-measure-simpleForm-withoutDimensionLabel")}else{this._oForm.removeStyleClass("viz-controls-chartPopover-measure-simpleForm-withoutDimensionLabel")}}};m.prototype._renderLabels=function(e,t,o){var a;if(e){this._oForm.setLabelSpanS(12);if(t.name!==""){this._oForm.addContent(new s({text:t.name}).addStyleClass("viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-labels-wrapper-name"))}a=new i({number:t.value,unit:t.unit,textAlign:p.Begin}).addStyleClass("viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-labels-wrapper-value");this._oForm.addContent(a);if(o&&t.name===""){a.addStyleClass("viz-controls-chartPopover-timeDayDimValue")}}else{this._oForm.setLabelSpanS(6);this._oForm.addContent(new r({text:t.name}).addStyleClass("viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-name"));if(t.value!==null){a=new i({number:t.value,unit:t.unit,textAlign:p.End}).addStyleClass("viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-value")}else{a=new i({number:this._getNoValueLabel(),textAlign:p.End}).addStyleClass("viz-controls-chartPopover-measure-labels viz-controls-chartPopover-measure-value")}if(o&&t.name===""){a.addStyleClass("viz-controls-chartPopover-timeDayValue")}this._oForm.addContent(a)}};m.prototype.isMultiSelected=function(){return this._measureItemsLen===0};m.prototype._createId=function(e){return this.getId()+"-"+e};m.prototype._getNoValueLabel=function(){return sap.viz.extapi.env.Language.getResourceString("IDS_ISNOVALUE")};m.prototype.exit=function(e){if(this._oForm){this._oForm.destroy();this._oForm=null}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null}if(this._oPanel){this._oPanel.destroy();this._oPanel=null}};return m});