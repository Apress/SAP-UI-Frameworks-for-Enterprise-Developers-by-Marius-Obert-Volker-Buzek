/* SAP CVOM 4.0 Â© <2012-2014> SAP AG. All rights reserved. Build Version PI_bycheckin.1630 */
(function(){var e=sap.viz.moduleloader.define;var t=sap.viz.moduleloader.require.config({context:"vizcontainer"});var r=t;e("jquery",function(){return jQuery});e("sap/viz/controls/Version",[],function(){var e={};e.VERSION="PI_bycheckin.1630";return e});e("sap/viz/controls/common/config/GlobalConfig",[],function(){function e(t,i){if(t.length===0)return;if(t.length===1)return i[t[0]];var r=t.shift();if(i[r]!=null)return e(t,i[r]);return}var t=e("sap/viz/controls/common/config/GlobalConfig".split("/"),this);if(t)return t;var i={};i.DEFAULT_UICONFIG_TYPE_BUILDER="uiconfig-builder";i.DEFAULT_UICONFIG_TYPE_CHART="uiconfig-chart";i.DEFAULT_UICONFIG_TYPE_FEEDING="uiconfig-feeding";i.DEFAULT_UICONFIG_TYPE_FRAME="uiconfig-frame";i.DEFAULT_UICONFIG_TYPE_SWITCHBAR="uiconfig-switchbar";i.DEFAULT_UICONFIG_TYPE_FILTERBAR0="uiconfig-filterbar0";i.DEFAULT_UICONFIG_TYPE_FILTERBAR="uiconfig-filterbar";i.DEFAULT_UICONFIG_TYPE_CONTEXTMENU="uiconfig-contextmenu";i.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON="uiconfig-custombutton";i.DEFAULT_UICONFIG_TYPE_ANNOTATION="uiconfig-annotation";i.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL="uiconfig-annotationcontrol";i.DEFAULT_UICONFIG_TYPE_MAPBUILDER="uiconfig-mapbuilder";i.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR="uiconfig-propertyeditor";var r="../src";var n=false;var s={};var o=function(){if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var e;try{e=sap.bi.framework.getServiceMetadata("sap.viz.controls.common.config")}catch(e){}if(e&&e.customProperties.defaultAssetsRoot){return e.framework.bundleUrl+"/"+e.customProperties.defaultAssetsRoot}}return undefined};i.registerUIConfig=function(e,t){if(e!=null){s[e]=t}};i.defaultUIConfig=function(e){var t={};if(e!=null&&s[e]!=null&&s[e].instance){return s[e].instance()}for(var i in s){if(i&&s[i]&&s[i].instance){t[i]=s[i].instance()}}return t};i.defaultAssetsRoot=function(e){if(arguments.length>0){r=e;n=true;i._setResourcePath()}else{if(n){return r}var t=o();if(t){return t}return r}};i._setResourcePath=function(){var e=[i.defaultAssetsRoot()+"/locale/"];var t=sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths");var r=t?e.concat(t):e;sap.viz.api.env.Resource.path("sap.viz.api.env.Language.loadPaths",r)};return i});e("sap/viz/controls/common/constants/ChartConst",[],function(){var e={};e.TYPE_COLUMN="viz/column";e.TYPE_STACKED_COLUMN="viz/stacked_column";e.TYPE_DUAL_COLUMN="viz/dual_column";e.TYPE_3D_COLUMN="viz/3d_column";e.TYPE_LINE="viz/line";e.TYPE_AREA="viz/area";e.TYPE_COMBINATION="viz/combination";e.TYPE_DUAL_LINE="viz/dual_line";e.TYPE_DUAL_COMBINATION="viz/dual_combination";e.TYPE_PIE="viz/pie";e.TYPE_DONUT="viz/donut";e.TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";e.TYPE_GEO_BUBBLE="viz/geobubble";e.TYPE_GEO_CHOROPLETH="viz/choropleth";e.TYPE_GEO_PIE="viz/geopie";e.TYPE_GEO_MAP="viz/geomap";e.TYPE_SCATTER="viz/scatter";e.TYPE_BUBBLE="viz/bubble";e.TYPE_SCATTER_MATRIX="viz/scatter_matrix";e.TYPE_HEATMAP="viz/heatmap";e.TYPE_TREEMAP="viz/treemap";e.TYPE_TABLE="viz/ext/table";e.TYPE_CROSSTAB="viz/ext/crosstab";e.TYPE_RADAR="viz/radar";e.TYPE_BOXPLOT="viz/boxplot";e.TYPE_WATERFALL="viz/waterfall";e.TYPE_TAG_CLOUD="viz/tagcloud";e.TYPE_TREE="viz/tree";e.TYPE_NETWORK="viz/network";e.TYPE_FUNNEL="viz/ext/pa/funnel";e.TYPE_PC="viz/ext/pa/pc";e.TYPE_NUMBER="viz/number";e.DIRECTION_HORIZONTAL="horizontal";e.DIRECTION_VERTICAL="vertical";e.STACKING_FULL="full";e.STACKING_NORMAL="normal";e.TYPE_BAR="viz/bar";e.TYPE_STACKED_BAR="viz/stacked_bar";e.TYPE_100_STACKED_COLUMN="viz/100_stacked_column";e.TYPE_100_STACKED_BAR="viz/100_stacked_bar";e.TYPE_DUAL_BAR="viz/dual_bar";e.TYPE_3D_BAR="viz/3d_bar";e.TYPE_HORIZONTAL_LINE="viz/horizontal_line";e.TYPE_HORIZONTAL_AREA="viz/horizontal_area";e.TYPE_100_AREA="viz/100_area";e.TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";e.TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";e.TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";e.TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";e.TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";e.TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";e.FEEDING_PRIMARY_VALUES="primaryValues";e.FEEDING_SECONDARY_VALUES="secondaryValues";e.FEEDING_AXIS_LABELS="axisLabels";e.MEASURE_NAMES_DIMENSION="measureNamesDimension";e.MEASURE_VALUES_GROUP="measureValuesGroup";e.ANALYSIS_AXIS="analysisAxis";e.AXIS_XAXIS="xAxis";e.AXIS_XAXIS1="xAxis1";e.AXIS_XAXIS2="xAxis2";e.AXIS_YAXIS="yAxis";e.AXIS_YAXIS1="yAxis1";e.AXIS_YAXIS2="yAxis2";return e});e("sap/viz/controls/common/constants/CSSConst",[],function(){var e={};e.PREFIX="viz-controls-";e.COMMON_PREFIX=e.PREFIX+"common-";e.SWITCHBAR_PREFIX=e.PREFIX+"switchbar-";e.FEEDINGPANEL_PREFIX=e.PREFIX+"feeding-";e.PROPERTYEDITOR_PREFIX=e.PREFIX+"propertyeditor-";e.VIZDATAPICKER_PREFIX=e.PREFIX+"datapicker-";e.FRAME_PREFIX=e.PREFIX+"frame-";e.BUILDER_PREFIX=e.PREFIX+"builder-";e.TRELLIS_PREFIX=e.PREFIX+"trellis-";e.MAPBUILDER_PREFIX=e.PREFIX+"mapbuilder-";e.CHART_PREFIX=e.PREFIX+"chart-";e.FILTERBAR0_PREFIX=e.PREFIX+"filterbar0-";e.FILTERBAR_PREFIX=e.PREFIX+"filterbar-";e.CONTEXTMENU_PREFIX=e.PREFIX+"contextmenu-";e.CUSTOMBUTTON_PREFIX=e.PREFIX+"custombutton-";e.ANNOTATION_PREFIX=e.PREFIX+"annotation-";e.PLAYCTRL_PREFIX=e.PREFIX+"playcontrol-";e.FEEDINGSHELF_PREFIX=e.COMMON_PREFIX+"feeding-";return e});e("sap/viz/controls/common/utils/Utils",[],function(){var e={};var t=0;e.genUID=function(){if(!t){t=0}return"vcgen_"+t++};var i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"};e.encodingToken="_encoded_";e.applyObjectProperty=function(t,i,r){try{if(e.isFunction(t[i])){t[i](r)}else{t[i]=r}}catch(e){}};e.applyProperties=function(t,i){if(i){var r=i.length;for(var n=0;n<r;n++){var s=i[n];if(s){e.applyObjectProperty(t,s.name,s.value)}}}};e.getObjectProperty=function(t,i){try{if(e.isFunction(t[i])){return t[i]()}else if(t.hasOwnProperty(i)){return t[i]}}catch(e){}};e.type=function(e){return e==null?String(e):i[Object.prototype.toString.call(e)]||"object"};e.isFunction=function(t){return e.type(t)==="function"};e.isBoolean=function(t){return e.type(t)==="boolean"};e.isString=function(t){return e.type(t)==="string"};e.isArray=function(t){return e.type(t)==="array"};e.isNumber=function(t){return e.type(t)==="number"};e.isRegExp=function(t){return e.type(t)==="regexp"};e.sortArrayOn=function(t,i,r){if(e.isArray(t)&&e.isString(i)){t.sort(function(e,t){return r?(e[i]<t[i])-(e[i]>t[i]):(e[i]>t[i])-(e[i]<t[i])})}};e.noop=function(){};e.delay=function(e,t){return setTimeout(function(){return e.apply(null)},t)};e.defer=function(t){return e.delay.call(null,t,1)};e.getEventPosition=function(e){var t=null;var i=null;if(e.originalEvent&&e.originalEvent.targetTouches&&e.originalEvent.targetTouches.length!==0){t=e.originalEvent.targetTouches[0].pageX;i=e.originalEvent.targetTouches[0].pageY}else{t=e.pageX;i=e.pageY}var r={};r.pageX=t;r.pageY=i;return r};e.clone=function(e){if(e===null||typeof e!=="object"){return e}var t=e.constructor===Array?[]:{};for(var i in e){if(e.hasOwnProperty(i)){t[i]=arguments.callee.call(null,e[i])}}return t};e.toJSON=function(t,i){if(e.isArray(t)){var r=[];for(var n=0;n<t.length;n++){r.push(i.call(null,t[n]))}return r}else if(t){return i.call(null,t)}else{return null}};e.fromJSON=function(t,i){if(e.isArray(t)){var r=[];for(var n=0;n<t.length;n++){r.push(i.call(null,t[n]))}return r}else if(t){return i.call(null,t)}else{return undefined}};e.updateJSON=function(t,i){var r=e.clone(t);r=r||{};var n=function(e,t){for(var i in t){if(t.hasOwnProperty(i)){var r=t[i];if(r!==undefined){if(typeof r!=="object"||r instanceof Array||r===null){e[i]=r}else{var s=e[i];if(!s){if(r===null||r===undefined){s=r}else{s=e[i]={}}}n(s,r)}}}}};n(r,i);return r};e.substitute=function(e,t){if(!e)return"";for(var i=1;i<arguments.length;i++){e=e.replace(new RegExp("\\{"+(i-1)+"\\}","g"),arguments[i])}return e};e.invert=function(e){var t={};for(var i in e){var r=e[i];t[r]=i}return t};e.encode=function(t,i){if(t.indexOf(e.encodingToken)>-1){return t}else{var r=t+e.encodingToken+i;return r}};e.decode=function(t){var i=t.split(e.encodingToken);return i};e.deepEqual=function(t,i){if(typeof t==="object"&&typeof i==="object"&&e.isExist(t)&&e.isExist(i)){var r=null;for(r in t){if(t.hasOwnProperty(r)){if(!i.hasOwnProperty(r)){return false}else if(!e.deepEqual(t[r],i[r])){return false}}}for(r in i){if(i.hasOwnProperty(r)){if(!t.hasOwnProperty(r)){return false}}}return true}else{return t===i}};e.hasCommonKeyValue=function(t,i){if(typeof t==="object"&&typeof i==="object"){var r=null;for(r in t){if(t.hasOwnProperty(r)){if(i.hasOwnProperty(r)&&e.deepEqual(t[r],i[r])){return true}}}return false}};e.isExist=function(e){if(typeof e==="undefined"||e===null){return false}return true};var r=e.genGetterSetter=function(e){return function(t){if(arguments.length>0){this[e]=t;return this}else{return this[e]}}};e.genGetterSetters=function(e,t){t.forEach(function(t){e[t.substring(1)]=r(t)})};return e});e("sap/viz/controls/common/managers/LangManager",[],function(){var e=function(){this.__className="sap.viz.controls.common.managers.LangManager"};e.get=function(e){return sap.viz.lang.langManager.get(e)};return e});e("sap/viz/controls/common/feeds/AnalyticalType",[],function(){var e={};e.UNIVERSAL="universal";e.MEASURE="measure";e.DIMENSION="dimension";e.HIERARCHY="hierarchy";e.MND="mnd";e.compatible=function(t,i){if(t===e.UNIVERSAL){return true}else if(t===e.DIMENSION){return i===e.DIMENSION||i===e.HIERARCHY||i===e.MND}else{return t===i}};return e});e("sap/viz/controls/common/utils/JsonUtil",[],function(){var e={};e.AnalysisObjectType="sap.viz.controls.common.feeds.AnalysisObject";e.HierarchyLevelObjectType="sap.viz.controls.common.feeds.HierarchyLevelObject";e.MenuItemType="sap.viz.controls.common.views.menu.MenuItem";e.MenuGroupType="sap.viz.controls.common.views.menu.MenuGroup";e._FuncMap={};e.register=function(t,i,r){var n={fromFunc:i,toFunc:r};e._FuncMap[t]=n};e.fromJSON=function(t,i){if(e._FuncMap[t]&&e._FuncMap[t].fromFunc){return e._FuncMap[t].fromFunc(i)}else{return null}};e.toJSON=function(t,i){if(e._FuncMap[t]&&e._FuncMap[t].toFunc){return e._FuncMap[t].toFunc(i)}else{return{}}};return e});e("sap/viz/controls/common/views/menu/MenuGroup",["sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/JsonUtil"],function(e,t){var i=function(e){this.__className="sap.viz.controls.common.views.menu.MenuGroup";this._menuItems=e};i.prototype.menuItems=function(){return this._menuItems};i.prototype.selectedItem=function(){for(var e=0;e<this._menuItems.length;e++){if(this._menuItems[e].selected()){return this._menuItems[e]}}return null};i.prototype.equal=function(e){if(e==undefined){return false}var t=this.menuItems()||[];var i=e.menuItems()||[];if(t.length!==i.length){return false}for(var r=0;r<t.length;r++){var n=t[r];var s=i[r];if(!(n==undefined&&s==undefined)){if(n==undefined){return false}if(!n.equal(s)){return false}}}return true};i.toJSON=function(i){return e.toJSON(i,function(e){return{menuItems:t.toJSON(t.MenuItemType,e._menuItems)}})};i.fromJSON=function(r){return e.fromJSON(r,function(e){return new i(t.fromJSON(t.MenuItemType,e.menuItems))})};t.register(t.MenuGroupType,i.fromJSON,i.toJSON);return i});e("sap/viz/controls/common/feeds/HierarchyLevelObject",["require","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/JsonUtil"],function(e,t,i){var r=e||r;var n=function(e,t,i){this.__className="sap.viz.controls.common.feeds.HierarchyLevelObject";this._id=e;this._name=t;this._analysis=i;this._selected=false};n.prototype.id=function(){return this._id};n.prototype.name=function(e){if(arguments.length>0){this._name=e;return this}else{return this._name}};n.prototype.analysis=function(){return this._analysis};n.prototype.selected=function(e){if(arguments.length>0){this._selected=e;return this}else{return this._selected}};n.prototype.clone=function(){var e=null;if(this._analysis){e=this._analysis.clone()}var t=new n(this._id,this._name,e);t.selected(this._selected);return t};n.toJSON=function(e){return t.toJSON(e,function(e){return{id:e._id,name:e._name,analysis:i.toJSON(i.AnalysisObjectType,e._analysis),selected:e._selected}})};n.fromJSON=function(e){return t.fromJSON(e,function(e){var t=new n(e.id,e.name,i.fromJSON(i.AnalysisObjectType,e.analysis));t.selected(e.selected);return t})};i.register(i.HierarchyLevelObjectType,n.fromJSON,n.toJSON);return n});e("sap/viz/controls/common/feeds/AnalysisObject",["sap/viz/controls/common/utils/Utils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/views/menu/MenuGroup","sap/viz/controls/common/utils/JsonUtil","sap/viz/controls/common/feeds/HierarchyLevelObject"],function(e,t,i,r,n){var s=function(e,t,i,r,n,s){this.__className="sap.viz.controls.common.feeds.AnalysisObject";this._id=e;this._name=t;this._type=i;this._dataType=r;this._aggregationType=n;this._aggregationTarget=s;this._actions=null;this._hierarchyLevels=null};s.genMND=function(){return new s("mnd","",i.MND,"string")};e.genGetterSetters(s.prototype,["_id","_name","_actions","_aggregationType","_aggregationTarget","_hierarchyLevels"]);s.prototype.type=function(){return this._type};s.prototype.dataType=function(){return this._dataType};s.prototype.selectedHierarchyLevel=function(){if(!this._hierarchyLevels){return}for(var e=0;e<this._hierarchyLevels.length;e++){if(this._hierarchyLevels[e].selected()){return this._hierarchyLevels[e]}}return};s.prototype.selectedHierarchyLevelID=function(e){if(!this._hierarchyLevels){return this}for(var t=0;t<this._hierarchyLevels.length;t++){var i=this._hierarchyLevels[t];i.selected(i.id()===e)}return this};s.prototype.clone=function(){var e=s.fromJSON(s.toJSON(this));return e};s.prototype.equal=function(e){if(this.type()===i.MND&&e.type()===i.MND){return true}if(this.type()!==e.type()||this.name()!==e.name()){return false}if(this.type()===i.HIERARCHY&&e.type()===i.HIERARCHY){if(this.selectedHierarchyLevel().id()!==e.selectedHierarchyLevel().id()){return false}var t=this.hierarchyLevels();var r=e.hierarchyLevels();if(!t||!r||t.length!==r.length){return false}for(var n=0;n<t.length;n++){var s=t[n];var o=r[n];if(s.id()!==o.id()){return false}if(s.name()!==o.name()){return false}}}if(this.actions()!=undefined||e.actions()!=undefined){var a=this.actions()||[];var l=e.actions()||[];if(a.length!==l.length){return false}for(var n=0;n<a.length;n++){var c=a[n];var p=l[n];if(!(c==undefined&&p==undefined)){if(c==undefined){return false}if(!c.equal(p)){return false}}}}return true};s.toJSON=function(t){return e.toJSON(t,function(e){return{id:e._id,name:e._name,type:e._type,dataType:e._dataType,actions:r.toJSON(e._actions),hierarchyLevels:n.toJSON(n.HierarchyLevelObjectType,e._hierarchyLevels),aggregationType:e._aggregationType,aggregationTarget:e._aggregationTarget}})};s.fromJSON=function(t){return e.fromJSON(t,function(e){var t=new s(e.id,e.name,e.type,e.dataType,e.aggregationType,e.aggregationTarget);if(e.actions){t.actions(r.fromJSON(e.actions))}if(e.hierarchyLevels){t.hierarchyLevels(n.fromJSON(n.HierarchyLevelObjectType,e.hierarchyLevels))}return t})};n.register(n.AnalysisObjectType,s.fromJSON,s.toJSON);return s});e("sap/viz/controls/common/feeds/FeedItem",["sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/AnalysisObject"],function(e,t){var i=function(e,t,i){this.__className="sap.viz.controls.common.feeds.FeedItem";this._id=e;this._type=t;this._values=i};i.prototype.type=function(){return this._type};i.prototype.id=function(){return this._id};i.prototype.values=function(e){if(arguments.length>0){this._values=e;return this}else{return this._values}};i.prototype.hasValues=function(){return this._values&&this._values.length>0};i.prototype.clone=function(){return i.fromJSON(i.toJSON(this))};i.toJSON=function(i){return e.toJSON(i,function(e){return{id:e._id,type:e._type,values:t.toJSON(e._values)}})};i.fromJSON=function(r){return e.fromJSON(r,function(e){return new i(e.id,e.type,t.fromJSON(e.values))})};return i});e("sap/viz/controls/common/feeds/FeedItemType",[],function(){var e=function(){this.__className="sap.viz.controls.common.feeds.FeedItemType"};e.MEASURE="Measure";e.DIMENSION="Dimension";e.SUBTOTAL="Subtotal";e.GEOGRAPHY="Geography";e.ROWS="rows";e.ROW_SUBTOTALS="r_subtotals";e.COLUMNS="columns";e.COLUMNS_SUBTOTALS="c_subtotals";e.CALCULATION="calculation";e.LEVEL="level";e.HIERARCHY="hierarchy";return e});e("sap/viz/controls/common/feeds/valueobjects/Shelf",[],function(){var e=function(){this.id=null;this.name=null;this.type=null;this.analysisType=null;this.feedItemType=null;this.capacity=0};e.prototype.equals=function(e){if(null==e){return false}if(this.id==e.id&&this.name==e.name&&this.type==e.type&&this.analysisType==e.analysisType&&this.feedItemType==e.feedItemType&&this.capacity==e.capacity){return true}return false};return e});e("sap/viz/controls/common/feeds/valueobjects/ShelfType",[],function(){var e=function(){};e.MEASURE="measure";e.ATTRIBUTE="attribute";e.SUBTOTAL="subtotal";e.TRELLIS="trellis";return e});e("sap/viz/controls/common/constants/DatasetTypeConst",[],function(){var e={};e.FlatTableDataset="FlatTableDataset";e.CrosstableDataset="CrosstableDataset";e.RawDataset="RawDataset";return e});e("sap/viz/controls/common/utils/PropertyFilterUtil",[],function(){var e={};var t={"viz/bubble":["plotArea.maxBubbleHeight","plotArea.maxBubbleWidth","plotArea.maxPriValue","plotArea.maxSecValue","plotArea.minBubbleHeight","plotArea.minBubbleWidth","plotArea.minSecValue","plotArea.minPriValue"],"viz/geobubble":["plotArea.maxValue","plotArea.minValue"],"info/donut":["plotArea.highlight.highlightContext","plotArea.highlight.unhighlightSliceColor","plotArea.applyUnhighlightSliceColor","plotArea.dataLabel.renderer","plotArea.sliceRenderer","plotArea.highlight.contextInfos"],"info/bar":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.markerRenderer"],"info/column":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.markerRenderer"],"info/line":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.markerRenderer","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.lineRenderer"],"info/horizontal_line":["valueAxis.layout.maxWidth","plotArea.primaryScale.autoMaxValue","plotArea.primaryScale.autoMinValue","categoryAxis.layout.maxWidth","plotArea.dataLabel.renderer","categoryAxis.labelRenderer","plotArea.lineRenderer"]};e.addDefaultProperties=function(i,r){var n=t[r];if(n){n.forEach(function(t){e.addProperty(i,t)})}e.addProperty(i,"interaction.behaviorType");return i};e.addProperty=function(e,t){if(!t){return e}e=e||{};var i=e;var r=t.split(".");for(var n=0;n<r.length;n++){if(!i.hasOwnProperty(r[n])){i[r[n]]={}}i=i[r[n]]}return e};return e});e("sap/viz/controls/common/utils/VizUtils",["sap/viz/controls/common/constants/DatasetTypeConst","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/utils/PropertyFilterUtil"],function(e,t,i,r,n){var s={};s.hasFakeData=function(e){var i=true;if(e){i=false;if(t.isFunction(e.hasFakeData)){i=e.hasFakeData()}else{i=e.isFake===true?true:false}}return i};s.getDatasetType=function(t){if(t){if(t instanceof sap.viz.api.data.CrosstableDataset){return e.CrosstableDataset}else if(t instanceof sap.viz.api.data.FlatTableDataset){return e.FlatTableDataset}else{return e.RawDataset}}return e.CrosstableDataset};s.isArrayOfFeedItem=function(e){return s._isArrayOf(e,i)};s.isArrayOfAnalysisObject=function(e){return s._isArrayOf(e,r)};s._isArrayOf=function(e,i){if(t.isArray(e)){for(var r=0;r<e.length;r++){if(!(e[r]instanceof i)){return false}}return true}return false};s._parseProperties=function(e){var t={};for(var i in e){if(e.hasOwnProperty(i)&&e[i]){var r=e[i];var n=r.name||i;if(r.supportedValueType==="Object"){if(r.supportedValues){t[n]=s._parseProperties(r.supportedValues)}}else{t[n]=r.defaultValue}}}return t};s._convertProperties=function(e){var t={};for(var i in e){if(e.hasOwnProperty(i)){t[i]=s._parseProperties(e[i])}}return t};s._getDefaultProperties=function(e){if(!e){return null}var t=sap.viz.api.manifest.Viz.get(e)[0];if(!t){return null}var i=t.allProperties();if(!i){return null}return s._convertProperties(i)};s._propertyExist=function(e,t){if(!t){return false}var i=t.split(".");var r=e;var n=false;for(var s=0;s<i.length;++s){if(r&&r.hasOwnProperty(i[s])){r=r[i[s]];n=true}else{n=false;break}}return n};s.hasProperties=function(e,i){var r=[];if(!i||i.length==0){return r}var n=s._getDefaultProperties(e);for(var o=0;o<i.length;++o){if(t.isArray(i[o])){r[o]=false;for(var a=0;a<i[o].length;++a){r[o]=r[o]||s._propertyExist(n,i[o][a])}}else{r[o]=s._propertyExist(n,i[o])}}return r};s._removeProperty=function(e,t){if(!t){return null}var i=t.split(".");var r=e;for(var n=0;n<i.length;++n){if(r&&r.hasOwnProperty(i[n])){if(n===i.length-1){var s=r[i[n]];delete r[i[n]];return s}else{r=r[i[n]]}}else{break}}return null};s._getProperty=function(e,t){if(!t){return null}var i=t.split(".");var r=e;for(var n=0;n<i.length;++n){if(r&&r.hasOwnProperty(i[n])){if(n===i.length-1){var s=r[i[n]];return s}else{r=r[i[n]]}}else{break}}return null};s.removeProperties=function(e,t){if(!t||t.length==0){return}for(var i=0;i<t.length;++i){s._removeProperty(e,t[i])}};s.getValueAxis=function(e){var t=sap.viz.api.manifest.Viz.get(e)[0];if(!t){return null}return t.valueAxis};s.isValueAxis=function(e,t){var i=s.getValueAxis(e);if(i){for(var r=0;r<i.length;r++){if(t===i[r]){return true}}}return false};s.convertValueAxisScale=function(e,t,i){if(!e||!t||!i){return}var r=s.getValueAxis(t);var n=s.getValueAxis(i);if(!r||r.length===0){return}var o=[];for(var a=0;a<r.length;++a){o[a]=s._removeProperty(e,r[a]+".scale")}if(n&&n.length>0){for(var l=0;l<n.length;++l){if(o[l]){e[n[l]]=e[n[l]]||{};e[n[l]]["scale"]=o[l]}}}};s.getCategoryAxis=function(e){var t=sap.viz.api.manifest.Viz.get(e)[0];if(!t){return null}return t.categoryAxis};s.getValidProperties=function(e,i){var r=s._getDefaultProperties(i);r=n.addDefaultProperties(r,i);var o=t.clone(e);s._deleteInvalidProperty(o,r);return o};s._deleteInvalidProperty=function(e,i){if(!i){return}var r;for(r in e){if(!i.hasOwnProperty(r)){delete e[r]}else if(t.type(e[r])==="object"){s._deleteInvalidProperty(e[r],i[r])}}};s.convertProperties=function(e,i,r){if(!e||!i||!r||i===r){return e}var n=t.clone(e);var o=s.getValueAxis(i);var a=s.getValueAxis(r);if(o&&o.length!==0){var l=[];for(var c=0;c<o.length;++c){l[c]=s._getProperty(e,o[c])}if(a&&a.length>0){for(var p=0;p<a.length;++p){if(l[p]){n[a[p]]=l[p]}}}}var h=s.getCategoryAxis(i);var d=s.getCategoryAxis(r);if(h&&h.length!==0){var u=[];for(var c=0;c<o.length;++c){u[c]=s._getProperty(e,h[c])}if(d&&d.length>0){for(var p=0;p<d.length;++p){if(u[p]){n[d[p]]=u[p]}}}}return n};return s});e("sap/viz/controls/common/utils/FakeDataUtils",["jquery","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/Utils"],function(e,t,i,r,n,s){var o={};o.buildFakeData=function(e,t,i){var r=i;var n=o.feedItems2feed(t);var s=o._buildRIVFeeding(e,n);return o._buildFake(e,s,r)};o.feedItems2feed=function(e){var t=[];e.forEach(function(e){var r=e.values();if(r.length>0){for(var n=0;n<r.length;++n){var o=r[n];var a={feed:e.id().indexOf("multiplier")!==-1?e.id().split(".")[0]:e.id()};if(o.type()===i.HIERARCHY){var l=o.hierarchyLevels();for(var c=0;c<l.length;c++){var p=l[c];if(p.selected()){a.objId=p.id()}}if(o.aggregationType()){a.aggregationType=o.aggregationType()}}else{if(o.type()===i.MND){a.objId=null}else{if(o.aggregationType()){a.aggregationType=o.aggregationType();if(o.aggregationTarget()){a.objId=o.aggregationTarget()}else{a.objId=s.decode(o.id())[0]}}else{a.objId=o.id()}}}t.push(a)}}});return t};o._buildRIVFeeding=function(i,n){var s=sap.viz.api.manifest.Viz;var a=s.get(i)[0];var l=a.allFeeds();var c=[];var p=[];var h=[];for(var d=0;d<l.length;d++){var u=l[d].id;var _=l[d].type;var v=[];for(var f=0;f<n.length;f++){if(n[f].feed==u){v.push(n[f])}}if(v.length>0){var m={};m.feedId=u;m.binding=[];var g=0;for(var E=0;E<v.length;E++){if(v[E].objId!=null){if(_===r.DIMENSION){if(e.inArray(l[d].aaIndex,c)==-1){m.binding[g]={};m.binding[g].type=t.ANALYSIS_AXIS;m.binding[g].index=l[d].aaIndex;c.push(l[d].aaIndex);g++}}else{if(e.inArray(l[d].mgIndex,p)==-1){m.binding[g]={};m.binding[g].type=t.MEASURE_VALUES_GROUP;m.binding[g].index=l[d].mgIndex;p.push(l[d].mgIndex);g++}}}else if(_===r.DIMENSION){m.binding[g]={};m.binding[g].type=t.MEASURE_NAMES_DIMENSION;g++}}h.push(m)}}c.sort();p.sort();o._fillAxesHoles(h,c);o._fillMgHoles(h,p);return h};o._fillAxesHoles=function(e,i){var r,n;if(i.length>0){n=i[0]-1;if(n>0){for(var r=0;r<e.length;r++){for(var s=0;s<e[r].binding.length;s++){if(e[r].binding[s].type==t.ANALYSIS_AXIS&&e[r].binding[s].index!=null&&e[r].binding[s].index>1){e[r].binding[s].index-=n}}}for(r=0;r<i.length;r++){i[r]-=n}}}for(var o=0;o<i.length-1;o++){n=i[o+1]-i[o]-1;if(n>0){for(r=0;r<e.length;r++){for(var s=0;s<e[r].binding.length;s++){if(e[r].binding[s].type==t.ANALYSIS_AXIS&&e[r].binding[s].index!=null&&e[r].binding[s].index>i[o]){e[r].binding[s].index-=n}}}for(r=o+1;r<i.length;r++){i[r]-=n}}}};o._fillMgHoles=function(e,i){var r;if(i.length>0){var n=i[0]-1;if(n>0){for(r=0;r<e.length;r++){if(e[r].binding[0].type==t.MEASURE_VALUES_GROUP&&e[r].binding[0].index!=null&&e[r].binding[0].index>1){e[r].binding[0].index-=n}}for(r=0;r<i.length;r++){i[r]-=n}}}for(var s=0;s<i.length-1;s++){var n=i[s+1]-i[s]-1;if(n>0){for(r=0;r<e.length;r++){if(e[r].binding[0].type==t.MEASURE_VALUES_GROUP&&e[r].binding[0].index!=null&&e[r].binding[0].index>i[s]){e[r].binding[0].index-=n}}for(r=s+1;r<i.length;r++){i[r]-=n}}}};o._getMNDfeed=function(e,i){if(!i)return;var r={priority:-1};for(var n=0;n<e.length;n++){var o=e[n].id;var a=e[n];var l=s.isNumber(a.acceptMND)?Number(a.acceptMND):-1;var c=false;for(var p=0;p<i.length;p++){if(i[p].feedId==o){if(i[p].binding.length>0){for(var h=0;h<i[p].binding.length;h++){if(i[p].binding[h].type==t.MEASURE_NAMES_DIMENSION){return o}}}if(i[p].binding.length<a.min){if(l>r.priority){r={feedId:o,priority:a.acceptMND}}}c=true;break}}if(!c){if(a.min>0&&l>=0){r={feedId:o,priority:a.acceptMND}}}}return r.feedId};o._validateInput=function(e,i){var r=0;if(i&&i.analysisAxis){r=i.analysisAxis.length}var n=0;if(i&&i.measureValuesGroup){n=i.measureValuesGroup.length}for(var s=0;s<e.length;s++){var o=e[s];if(o.binding){for(var a=0;a<o.binding.length;a++){var l=o.binding[a].index;var c=o.binding[a].type;if(c==t.ANALYSIS_AXIS&&l>r){return false}else if(c==t.MEASURE_VALUES_GROUP&&l>n){return false}}}}return true};o._buildFake=function(e,i,s){if(!o._validateInput(i,s)){s.analysisAxis=[];s.measureValuesGroup=[];return{feeding:i,dataset:s}}var a=sap.viz.api.manifest.Viz;var l=a.get(e)[0];var c=l.allFeeds();var p=l.id;var h=o._getMNDfeed(c,i);var d=[];var u=[];var _,v;for(_=0;_<c.length;_++){if(c[_].id==h){continue}var f=o._getFakeToBeBuilt(c[_],i,s);if(f.nb>0){if(f.axisIndex!=null){d.push(f)}else if(f.mgIndex!=null){u.push(f)}}}if(s.analysisAxis==null){s.analysisAxis=[]}for(_=0;_<d.length;_++){var m=d[_];var g=null;for(var v=0;v<s.analysisAxis.length;v++){if(s.analysisAxis[v].index==m.axisIndex){g=s.analysisAxis[v]}}if(g==null){g={};g.data=[];g.index=m.axisIndex;s.analysisAxis.push(g)}var E={};E.type=r.DIMENSION;E.name=n.get("VIZ_COMMON_FAKE_DIMENSION");E.isFake=true;var y=false;for(v=0;v<s.analysisAxis.length;v++){if(s.analysisAxis[v].data[0]!=null&&s.analysisAxis[v].data[0].values.length>0){y=true}else{y=false}}if(y||_>0){if(p===t.TYPE_TREE||p===t.TYPE_NETWORK){E.values=o._buildFakeDimensionValues(g.data[0].values.length)}else{E.values=o._buildFakeDimensionValues(1)}}else{var I=10;if(s.measureValuesGroup!=null&&s.measureValuesGroup[0]!=null){I=s.measureValuesGroup[0].data[0].values.length}E.values=o._buildFakeDimensionValues(I);if(o._isGeoOrNor(e)){E.infos=o._buildFakeGeoInfos(I)}}g.data.push(E)}if(s.measureValuesGroup==null){s.measureValuesGroup=[]}var C=o._sortAxes(c,s,i);if(C){o._swapMeasure(s)}for(_=0;_<u.length;_++){var T=u[_];var A=null;for(v=0;v<s.measureValuesGroup.length;v++){if(s.measureValuesGroup[v].index==T.mgIndex){A=s.measureValuesGroup[v]}}if(A==null){A={};A.data=[];A.index=T.mgIndex;s.measureValuesGroup.push(A)}for(var P=0;P<T.nb;P++){var R={};R.type=r.MEASURE;R.name=n.get("VIZ_COMMON_FAKE_MEASURE")+(_+P+1);R.isFake=true;var z=[];for(v=s.analysisAxis.length-1;v>=0;v--){z.push(s.analysisAxis[v].data[0].values.length)}if(z.length===0){z=[1]}var O=o._buildFakeMeasureValues(z);if(!Array.isArray(O[0])){O=[O]}R.values=O;A.data.push(R)}}return{feeding:i,dataset:s}};o._sortAxes=function(e,i,n){var o={};if(i.analysisAxis.length>1){for(var a=0;a<e.length;a++){var l=e[a];if(l.type===r.DIMENSION){for(var c=0;c<n.length;c++){if(n[c].feedId===l.id){var p=l.aaIndex;var h=n[c].binding;for(var d=0;d<h.length;d++){if(h[d]&&h[d].type==t.ANALYSIS_AXIS){var u=h[d].index;for(var _=0;_<i.analysisAxis.length;_++){if(i.analysisAxis[_].index===u){o[_]=p;break}}}}}}}}}var v=false;for(var a=0;a<i.analysisAxis.length;a++){for(var c=i.analysisAxis.length-1;c>=a+1;c--){if(o[c]<o[c-1]){var f=i.analysisAxis[c];i.analysisAxis[c]=i.analysisAxis[c-1];i.analysisAxis[c-1]=f;v=true}}}var m=s.clone(n);for(var a=0;a<i.analysisAxis.length;a++){var f=i.analysisAxis[a];var p=a+1;for(var c=0;c<m.length;c++){var h=m[c].binding;for(var g=0;g<h.length;g++){if(h[g]&&h[g].type==t.ANALYSIS_AXIS&&h[g].index==f.index){n[c].binding[g].index=p}}}f.index=p}return v};o._swapMeasure=function(e){var t=e.measureValuesGroup;if(t){for(var i=0;i<t.length;i++){var r=t[i].data;if(r){for(var n=0;n<r.length;n++){var s=r[n];var o=s.values.length;var a=s.values[0].length;var l=new Array(a);for(var c=0;c<a;c++){l[c]=new Array(o)}for(var p=0;p<o;p++){for(var c=0;c<a;c++){l[c][p]=s.values[p][c]}}s.values=l}}}}};o._getFakeToBeBuilt=function(e,i,n){var s=e.min;if(e.id==="treeNode"||e.id==="link"){s=e.minStackedDims}if(s==0){return{nb:0}}var o=0;var a,l,c;for(a=0;a<i.length;a++){var p=null;var h=null;if(e.id==i[a].feedId){if(e.type==r.DIMENSION){var d=i[a].binding;for(c=0;c<d.length;c++){if(d[c].index){p=d[c].index}}if(p!==null){if(!n.analysisAxis.length){return{nb:0,axisIndex:p}}else{for(l=0;l<n.analysisAxis.length;l++){if(n.analysisAxis[l].index==p){o=n.analysisAxis[l].data.length;var u=s-o;if(u<0){u=0}return{nb:u,axisIndex:p}}}}}else{return{nb:0}}}else if(e.type==r.MEASURE){h=i[a].binding[0].index;for(l=0;l<n.measureValuesGroup.length;l++){if(n.measureValuesGroup[l].index==h){o=n.measureValuesGroup[l].data.length;var u=s-o;if(u<0){u=0}return{nb:u,mgIndex:h}}}return{nb:0,mgIndex:h}}}}if(e.type==r.DIMENSION){var _=1;for(a=0;a<i.length;a++){for(c=0;c<i[a].binding.length;c++){if(i[a].binding[c].type==t.ANALYSIS_AXIS&&i[a].binding[c].index>=_){_=i[a].binding[c].index+1}}}var v={};v.feedId=e.id;v.binding=[];v.binding[0]={};v.binding[0].type=t.ANALYSIS_AXIS;v.binding[0].index=_;i.push(v);return{nb:s,axisIndex:_}}else if(e.type==r.MEASURE){var f=1;for(a=0;a<i.length;a++){if(i[a].binding[0].type==t.MEASURE_VALUES_GROUP&&i[a].binding[0].index>=f){f=i[a].binding[0].index+1}}var v={};v.feedId=e.id;v.binding=[];v.binding[0]={};v.binding[0].type=t.MEASURE_VALUES_GROUP;v.binding[0].index=f;i.push(v);return{nb:s,mgIndex:f}}return null};o._buildFakeMeasureValues=function(e){var t=[];var i=e[0];var r=0;if(e.length==1){for(r=0;r<i;r++){t[r]=Math.round(Math.random()*100)}}else{e.shift();for(r=0;r<i;r++){t[r]=o._buildFakeMeasureValues(e)}}return t};o._buildFakeDimensionValues=function(e){var t=[];for(var i=0;i<e;i++){t[i]=i.toString()}return t};o._buildFakeGeoInfos=function(e){var t=[];for(var i=0;i<e;i++){t[i]=""}return t};o._isGeoOrNor=function(e){if(e.search("geo")==-1&&e.search("choropleth")==-1){return false}else{return true}};return o});e("sap/viz/controls/common/utils/InfoChartUtil",["jquery","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils"],function(e,t,r,n){var s={line:1,column:1,bar:1,donut:1,horizontal_line:1};var o={getInfoType:function(e){var t=String(e).match(/^viz\/(.*)$/);if(t&&s[t[1]]){var i="info/"+t[1];var r=sap.viz.api.manifest.Viz.get(i);if(r&&r[0]){return i}}return null},isInfoChart:function(e){return/^info\/\w+$/.test(e)},getVizType:function(e){return this.isInfoChart(e)?e.replace("info/","viz/"):null},buildInfoDataset:function(e){var t=sap.viz.data.utils.CTB2TBConvertUtil.crossTable2FlatTableData(e);return new sap.viz.api.data.FlatTableDataset(t)},buildInfoFeeding:function(e,i){var r={};for(var n=0;n<e.length;n++){var s=e[n];var o=s.values()||[];var a=r[s.id()]=[];for(var l=0;l<o.length;l++){var c=o[l];if(c.type()===t.MND){if(i){a.unshift("MeasureNamesDimension")}else{a.push("MeasureNamesDimension")}}else{if(c.type()===t.HIERARCHY){for(var p=0;p<c.hierarchyLevels().length;p++){var h=c.hierarchyLevels()[p];a.push(h.id());if(h.selected()){break}}}else{a.push(c.id())}}}}return r},buildInfoProperties:function(t,i){var r=e.extend(true,{},i);var s=n.getCategoryAxis(t);if(s&&s.length){p(r,s[0],"categoryAxis");if(s.length>1){p(r,s[1],"categoryAxis2")}}var o=n.getValueAxis(t);if(o&&o.length){p(r,o[0],"valueAxis");if(o.length>1){p(r,o[1],"valueAxis2")}}c(r,"dataLabel","plotArea.dataLabel");c(r,"background","plotArea.background");c(r,"plotArea.background.body.color","plotArea.background.color");c(r,"valueAxis.scale","plotArea.primaryScale");c(r,"valueAxis2.scale","plotArea.secondaryScale");c(r,"valueAxis2.gridline","plotArea.gridline");c(r,"valueAxis.gridline","plotArea.gridline");p(r.valueAxis,"axisline","axisLine");p(r.valueAxis2,"axisline","axisLine");p(r.categoryAxis,"axisline","axisLine");p(r.categoryAxis2,"axisline","axisLine");c(r,"valueAxis.lineSize","valueAxis.axisLine.size");c(r,"valueAxis2.lineSize","valueAxis2.axisLine.size");c(r,"categoryAxis.lineSize","categoryAxis.axisLine.size");c(r,"categoryAxis2.lineSize","categoryAxis2.axisLine.size");h(r,"valueAxis.label.formatString");h(r,"valueAxis2.label.formatString");h(r,"plotArea.dataLabel.formatString");h(r,"tooltip.formatString");return r},buildInfoSeries:function(e,t){var n=e["regionColor"];var s=new Object,o=[];var a,l,c,p,h;if(!n||n.length===0){return null}var d=e["axisLabels"];var u=e["primaryValues"];var _=false;if(n.indexOf("MeasureNamesDimension")>=0){n.splice(n.indexOf("MeasureNamesDimension"),1);_=true}if(n.length<=0){var v;u.forEach(function(e){for(i=0;i<t.length;i++){a=t[i];if(a[e]!=null){h=new Object;h["name"]=e;p=new Object;p["MeasureNamesDimension"]=e;h["seriesData"]=p;s[e]=h;break}}});return s}for(i=0;i<t.length;i++){a=t[i];l=false;for(j=0;j<u.length;j++){if(a[u[j]]!=null){l=true;break}}if(l){c=a[n[0]];p=new Object;h=new Object;p[n[0]]=a[n[0]];for(j=1;j<n.length;j++){c=c+" / "+a[n[j]];p[n[j]]=a[n[j]]}if(_){var f,m;for(j=0;j<u.length;j++){if(!a.hasOwnProperty(u[j])){continue}f=c+" / "+u[j];if(f&&o.indexOf(f)<0){o.push(f);m=r.clone(p);m[u[j]]=a[u[j]];h=new Object;h["name"]=f;h["seriesData"]=m;s[f]=h}}}else if(c&&o.indexOf(c)<0){o.push(c);h["name"]=c;h["seriesData"]=p;s[c]=h}}}return s}};function a(e,t){return t?t.split(".").reduce(function(e,t){return e&&typeof e=="object"?e[t]:null},e):e}function l(e,t,i){t.split(".").reduce(function(e,t,r,n){if(r<n.length-1){e[t]=e[t]!=null?e[t]:{}}else{e[t]=i}return e[t]},e)}function c(e,t,i,r){var n=a(e,t);if(n!=null){if(!r){var s=t.split(".");var o=s.pop();var c=s.join(".");delete a(e,c)[o]}l(e,i,n)}}function p(e,t,i){if(e&&t in e){e[i]=e[t];delete e[t]}}function h(e,t){var i=a(e,t);if(!i){return}if(r.isString(i)){return}if(r.isArray(i)&&r.isArray(i[0])&&r.isString(i[0][0])){l(e,t,i[0][0])}}return o});e("sap/viz/controls/common/utils/TrellisUtils",["sap/viz/controls/common/constants/ChartConst"],function(e){var t={};var i={};i.TRELLIS="trellis";i.MULTIPLE="multi";i._register=function(e,i){if(i){t[i]=e}else{t["_default"]=e}};i._getProvider=function(e){var i=t[e];if(!i){i=t["_default"]}return i};i.providerName=function(e){var t=i._getProvider(e);return t.name};i.isMultipleChart=function(e){if(!e){return false}var t=i._getProvider(e);return t.isMultipleChart(e)};i.supportMultiChart=function(e){if(!e){return false}var t=i._getProvider(e);return t.supportMultiChart(e)};i.toSingleChartType=function(e){if(!e){return e}var t=i._getProvider(e);return t.toSingleChartType(e)};i.toMultiChartType=function(e){if(!e){return e}var t=i._getProvider(e);if(t.isMultipleChart(e)){return e}else{return t.toMultiChartType(e)}};function r(e){var t="viz/"+e+"_";var i={name:e};i.isMultipleChart=function(e){if(!e){return false}return e.indexOf(t)===0};i.supportMultiChart=function(e){if(e.indexOf(t)===0){return true}var r=i.toMultiChartType(e);if(r!==e){return true}else{return false}};i.toSingleChartType=function(e){if(i.isMultipleChart(e)){return e.replace(t,"viz/")}return e};i.toMultiChartType=function(e){var i=e.replace("viz/",t);if(sap.viz.api.manifest.Viz.get(i)[0]){return i}return e};return i}i._register(r(i.MULTIPLE));return i});e("sap/viz/controls/common/utils/ChartTypeUtil",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/DatasetTypeConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/utils/TrellisUtils"],function(e,t,i,r,n){var s={};s._CVOM_TYPE_MAPPING=function(){var t={};var i=function(e,i,n,s){var o={vizType:i};if(n){o.vizDirection=n}if(s){o.vizStacking=s}t[e]=o;e=r.getInfoType(e);if(e){t[e]=o}};i(e.TYPE_STACKED_BAR,e.TYPE_STACKED_BAR,null,e.STACKING_NORMAL);i(e.TYPE_100_STACKED_BAR,e.TYPE_STACKED_BAR,null,e.STACKING_FULL);i(e.TYPE_STACKED_COLUMN,e.TYPE_STACKED_COLUMN,null,e.STACKING_NORMAL);i(e.TYPE_100_STACKED_COLUMN,e.TYPE_STACKED_COLUMN,null,e.STACKING_FULL);i(e.TYPE_3D_BAR,e.TYPE_3D_COLUMN,e.DIRECTION_HORIZONTAL);i(e.TYPE_3D_COLUMN,e.TYPE_3D_COLUMN,e.DIRECTION_VERTICAL);i(e.TYPE_HORIZONTAL_LINE,e.TYPE_LINE,e.DIRECTION_HORIZONTAL);i(e.TYPE_LINE,e.TYPE_LINE,e.DIRECTION_VERTICAL);i(e.TYPE_HORIZONTAL_AREA,e.TYPE_AREA,e.DIRECTION_HORIZONTAL,e.STACKING_NORMAL);i(e.TYPE_100_HORIZONTAL_AREA,e.TYPE_AREA,e.DIRECTION_HORIZONTAL,e.STACKING_FULL);i(e.TYPE_AREA,e.TYPE_AREA,e.DIRECTION_VERTICAL,e.STACKING_NORMAL);i(e.TYPE_100_AREA,e.TYPE_AREA,e.DIRECTION_VERTICAL,e.STACKING_FULL);i(e.TYPE_HORIZONTAL_COMBINATION,e.TYPE_COMBINATION,e.DIRECTION_HORIZONTAL);i(e.TYPE_COMBINATION,e.TYPE_COMBINATION,e.DIRECTION_VERTICAL);i(e.TYPE_DUAL_HORIZONTAL_LINE,e.TYPE_DUAL_LINE,e.DIRECTION_HORIZONTAL);i(e.TYPE_DUAL_LINE,e.TYPE_DUAL_LINE,e.DIRECTION_VERTICAL);i(e.TYPE_DUAL_HORIZONTAL_COMBINATION,e.TYPE_DUAL_COMBINATION,e.DIRECTION_HORIZONTAL);i(e.TYPE_DUAL_COMBINATION,e.TYPE_DUAL_COMBINATION,e.DIRECTION_VERTICAL);i(e.TYPE_HORIZONTAL_BOXPLOT,e.TYPE_BOXPLOT,e.DIRECTION_HORIZONTAL);i(e.TYPE_BOXPLOT,e.TYPE_BOXPLOT,e.DIRECTION_VERTICAL);i(e.TYPE_HORIZONTAL_WATERFALL,e.TYPE_WATERFALL,e.DIRECTION_HORIZONTAL);i(e.TYPE_WATERFALL,e.TYPE_WATERFALL,e.DIRECTION_VERTICAL);return t};s._VIZ_TYPE_MAPPING=function(){var t={};var n=function(n,s){var o;if(n===e.TYPE_TABLE){o=i.get("VIZ_COMMON_TABLE_TEXT")}else if(n===e.TYPE_CROSSTAB){o=i.get("VIZ_COMMON_CROSSTAB_TEXT")}else{var a=sap.viz.api.manifest.Viz.get(n)[0];o=a?a.name:n}t[n]={id:n,caption:o,icon:s,whiteIcon:s+"-white",greyIcon:s+"-grey"};var l=r.getInfoType(n);if(l){t[l]=t[n]}};n(e.TYPE_BAR,"bar");n(e.TYPE_COLUMN,"column");n(e.TYPE_STACKED_BAR,"stacked-bar");n(e.TYPE_STACKED_COLUMN,"stacked-column");n(e.TYPE_DUAL_BAR,"dual-bar");n(e.TYPE_DUAL_COLUMN,"dual-column");n(e.TYPE_3D_COLUMN,"3D-column");n(e.TYPE_LINE,"line");n(e.TYPE_AREA,"area");n(e.TYPE_COMBINATION,"combination");n(e.TYPE_DUAL_LINE,"dual-line");n(e.TYPE_DUAL_COMBINATION,"dual-combination");n(e.TYPE_PIE,"pie");n(e.TYPE_DONUT,"donut");n(e.TYPE_PIE_WITH_DEPTH,"pie-with-depth");n(e.TYPE_GEO_BUBBLE,"geo-bubble");n(e.TYPE_GEO_CHOROPLETH,"geo-choropleth");n(e.TYPE_GEO_PIE,"geo-pie");n(e.TYPE_GEO_MAP,"geo-map");n(e.TYPE_SCATTER,"scatter");n(e.TYPE_BUBBLE,"bubble");n(e.TYPE_SCATTER_MATRIX,"scatter-matrix");n(e.TYPE_HEATMAP,"heatmap");n(e.TYPE_TREEMAP,"treemap");n(e.TYPE_TABLE,"table");n(e.TYPE_CROSSTAB,"crosstab");n(e.TYPE_RADAR,"radar");n(e.TYPE_BOXPLOT,"boxplot");n(e.TYPE_WATERFALL,"waterfall");n(e.TYPE_TAG_CLOUD,"tag-cloud");n(e.TYPE_TREE,"tree");n(e.TYPE_NETWORK,"network");n(e.TYPE_FUNNEL,"funnel");n(e.TYPE_PC,"pc");n(e.TYPE_NUMBER,"number");n("viz/ext/samplesbar","viz/ext/samplesbar");n("viz/ext/flagbar","viz/ext/flagbar");return t};s.getVizTypeObject=function(e){if(s.VIZ_TYPE__MAPPING==null){s.VIZ_TYPE__MAPPING=s._VIZ_TYPE_MAPPING()}var t=s.VIZ_TYPE__MAPPING[e];if(t){t=JSON.parse(JSON.stringify(t))}return t};s.toVizProperties=function(e){if(s.CVOM_TYPE_MAPPING==null){s.CVOM_TYPE_MAPPING=s._CVOM_TYPE_MAPPING()}var t=s.CVOM_TYPE_MAPPING[e];if(!t){t={vizType:e}}return t};s.fromVizProperties=function(e,t,i){if(!t&&!i){return e}var r=s.toVizProperties(e).vizType;for(var n in s.CVOM_TYPE_MAPPING){if(s.CVOM_TYPE_MAPPING.hasOwnProperty(n)){var o=s.CVOM_TYPE_MAPPING[n];if(o.vizType===r&&(!t||!o.vizDirection||o.vizDirection===t)&&(!i||!o.vizStacking||o.vizStacking===i)){return n}}}return e};s.updateType=function(e,t){var i=e;if(t.hasOwnProperty("direction")){i=s.changeDirection(i,t["direction"]);t["direction"]=undefined}if(t.hasOwnProperty("stacking")){i=s.changeStacking(i,t["stacking"]);t["stacking"]=undefined}return i};s.isMultipleChart=function(e){return n.isMultipleChart(e)};s.toMultiChartType=function(e){return n.toMultiChartType(e)};s.toSingleChartType=function(e){return n.toSingleChartType(e)};s.supportMultiChart=function(e){return n.supportMultiChart(e)};s.getDirection=function(e){var t=s.toSingleChartType(e);var i=s.toVizProperties(t);if(i.vizDirection){return i.vizDirection}return null};s.getStacking=function(e){var t=s.toSingleChartType(e);var i=s.toVizProperties(t);if(i.vizStacking){return i.vizStacking}return null};s.changeDirection=function(e,t){var i=s.toSingleChartType(e);var r=s.getDirection(i);if(r===t||!r){return e}var n=s.getStacking(i);var o=s.fromVizProperties(i,t,n);if(s.isMultipleChart(e)){return s.toMultiChartType(o)}return o};s.changeStacking=function(e,t){var i=s.toSingleChartType(e);var r=s.getStacking(i);if(r===t||!r){return e}var n=s.getDirection(i);var o=s.fromVizProperties(i,n,t);if(s.isMultipleChart(e)){return s.toMultiChartType(o)}return o};s.getType=function(e,t){if(!e){return t}var i=s.toSingleChartType(e);var r=s.getDirection(i);var n=s.getStacking(i);i=s.fromVizProperties(t,r,n);if(s.isMultipleChart(e)){return s.toMultiChartType(i)}return i};s.getVizType=function(e){var t=s.toSingleChartType(e);return s.toVizProperties(t).vizType};s.getDatasetType=function(e){if(s.isGeo(e)||r.isInfoChart(e)){return t.FlatTableDataset}else if(s.isTable(e)){return t.RawDataset}else{return t.CrosstableDataset}};s.isTable=function(t){return t===e.TYPE_TABLE||t===e.TYPE_CROSSTAB};s.isGeo=function(t){return t===e.TYPE_GEO_MAP};s.isInfoChart=function(e){if(e&&e.indexOf("info/")==0){return true}return false};s.supportTitle=function(e){if(s.isGeo(e)){return false}else{return true}};s.isBuildInType=function(e){var t=sap.viz.api.manifest.Viz.get(e)[0]||{};return!!t.isBuiltIn};s.supportAnimation=function(t){return t===e.TYPE_GEO_BUBBLE||t===e.TYPE_BUBBLE||t===e.TYPE_SCATTER};s.isEmptyData=function(e,i){var r=s.getDatasetType(e);if(r===t.RawDataset){return false}else if(r===t.FlatTableDataset){return false}else{var n=i?i.data()?i.data().analysisAxis:null:null;var o=i?i.data()?i.data().measureValuesGroup:null:null;if((!n||n&&n.length===0)&&(!n||o&&o.length===0)){return true}}return false};s.getCategoryAxis=function(e){if(e==="info/bar"||e==="info/horizontal_line"||e==="info/stacked_bar"||e==="info/100_stacked_bar"){return["yAxis"]}else{return["xAxis"]}};s.getValueAxis=function(e){if(e==="info/bar"||e==="info/horizontal_line"||e==="info/stacked_bar"||e==="info/100_stacked_bar"){return["xAxis"]}else{return["yAxis"]}};s.isHorizontal=function(e){if(e==="info/bar"||e==="info/horizontal_line"||e==="info/stacked_bar"||e==="info/100_stacked_bar"){return true}else{return false}};s.isCategoryAxis=function(e,t){if(e==="info/bar"||e==="info/horizontal_line"||e==="info/stacked_bar"||e==="info/100_stacked_bar"){return t==="yAxis"?true:false}else{return t==="xAxis"?true:false}};s.isSupportMorphing=function(t){if(t===e.TYPE_TREE||t===e.TYPE_NETWORK||t===e.TYPE_FUNNEL||t===e.TYPE_PC||s.supportAnimation(t)){return false}else if(!s.isBuildInType(t)){return false}else{return true}};s.getChartId=function(e){return s.getVizType(e).replace("viz/","")};return s});e("sap/viz/controls/common/feeds/FeedUtils",["require","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/FakeDataUtils","sap/viz/controls/common/utils/ChartTypeUtil"],function(e,t,i,r,n,s,o,a){var l=e||l;var c={};c.MultiplierFeedingName="multiplier";c.RowsFeedingName="multiplier.row";c.ColumnsFeedingName="multiplier.column";c.trillisFeeds={id:"multiplier",row:{id:"multiplier.row",maxStacked:3,minStacked:0,type:r.DIMENSION},column:{id:"multiplier.column",maxStacked:3,minStacked:0,type:r.DIMENSION}};c.geoFeeds={id:"geoFeatures"};c.MaxDemensionFeedsCount=2;c._mapFeedItem=function(e,t,n){var s=e.id();var o;var a=null;for(o=0;o<t.length;o++){if(t[o].id===s){a=t[o];break}}if(a===null){return e}var l=e.type();var p="aaIndex";if(l!==r.DIMENSION){p="mgIndex"}var h=null;for(o=0;o<n.length;o++){if(n[o][p]===a[p]){h=new i(n[o].id,l,e.values());n.splice(o,1);return h}}for(o=0;o<n.length;o++){if(l===n[o].type&&n[o].id!==c.MultiplierFeedingName){h=new i(n[o].id,l,e.values());n.splice(o,1);return h}}return h};c._idEquals=function(e,t){var i=e.id();var r=false;if(i===t.id){r=true}else if(t.id===c.MultiplierFeedingName&&(i===c.RowsFeedingName||i===c.ColumnsFeedingName)){r=true}return r};c.getVizFeeds=function(e){var t=sap.viz.api.manifest.Viz.get(e)[0];if(t){return t.allFeeds()}else{return null}};c.mapFeeds=function(e,t,r){if(!r||t===r||!e){return{feeds:e,feedsChanged:false}}var n=[];if(t&&s.isString(t)){n=c.getVizFeeds(t)||[]}var o=c.getVizFeeds(r);if(!o){return{feeds:[],feedsChanged:true}}o=o.slice();var a,l;var p=[];var h=[];var d=false;for(a=0;a<e.length;a++){var u=e[a].id();d=false;for(l=0;l<o.length;l++){if(o[l].id===u){p.push(e[a]);o.splice(l,1);d=true;break}}if(!d){h.push(e[a])}}var _;var v=false;for(a=0;a<h.length;a++){_=c._mapFeedItem(h[a],n,o);if(_){p.push(_)}if(_!==h[a]){v=true}}for(l=0;l<o.length;l++){d=false;for(var f=0;f<p.length;f++){if(c._idEquals(p[f],o[l])){d=true;break}}if(!d){v=true;if(o[l].id===c.MultiplierFeedingName){p.push(new i(c.RowsFeedingName,o[l].type,[]));p.push(new i(c.ColumnsFeedingName,o[l].type,[]))}else{p.push(new i(o[l].id,o[l].type,[]))}}}if(c.isEmptyFeeds(p)){v=false}return{feeds:p,feedsChanged:v}};c.canAddFeed=function(e,t,i,s){var o=t.id===c.MultiplierFeedingName;var a=0;if(o){a=s?s==="mainPlot"?2:1:2}for(var l=0;l<e.length;l++){if(!c._idEquals(e[l],t)){continue}if((s===c.RowsFeedingName||s===c.ColumnsFeedingName)&&e[l].id()!==s){continue}var p=e[l].values();for(var h=0;h<p.length;h++){var d=p[h];if(d.id()===i.id()){if(o){if(--a===0){return false}}else{return false}}}}var u=i.type();if(u){u=u.toLowerCase()}var _=i.dataType();if(_){_=_.toLowerCase()}var v=t.id===c.geoFeeds.id?r.GEOGRAPHY:t.type;if(!c.feedCompatible(v,u,_)){return false}else if(c.feedCompatible(u,n.MEASURE,_)){return true}var f=0;var m=0;for(var g=0;g<e.length;g++){var E=e[g];if(!E.hasValues()){continue}else if(c._idEquals(E,t)){return true}else if(E.type()===r.DIMENSION){if(E.id()===c.RowsFeedingName||E.id()===c.ColumnsFeedingName){m=Math.min(1,m+1)}else{f++}}}return f+m<c.MaxDemensionFeedsCount};c.checkDimensionFeedItemsToLimit=function(e){var t=0;var i=0;for(var n=0;n<e.length;n++){var s=e[n];if(s.type()===r.DIMENSION&&s.hasValues()){if(s.id()===c.RowsFeedingName||s.id()===c.ColumnsFeedingName){i=Math.min(1,i+1)}else{t++}}}return i+t>=c.MaxDemensionFeedsCount};c.getEmptyFeedItemsId=function(e){var t=[];var i=false;for(var n=0;n<e.length;n++){var s=e[n];if(s.type()===r.DIMENSION){if(s.id()===c.RowsFeedingName||s.id()===c.ColumnsFeedingName){if(s.values().length>0){i=true}continue}if(!s.values().length){t.push(s.id())}}}if(!i){t.push(c.RowsFeedingName);t.push(c.ColumnsFeedingName)}return t};c.hasRowOrColumn=function(e){var t=false;if(!e){return t}for(var i=0;i<e.length;i++){var r=e[i];if(r.id()===c.RowsFeedingName||r.id()===c.ColumnsFeedingName||r.id()===c.MultiplierFeedingName){if(r.values().length>0){t=true;break}}}return t};c.isEmptyFeeds=function(e){if(!e){return true}for(var t=0;t<e.length;t++){var i=e[t];if(i){var r=i.values();if(r&&r.length>0){return false}}}return true};c._toMap=function(e){var t={};for(var i=0;i<e.length;i++){var r=e[i];if(!r){continue}t[r.id()]={index:i,item:r}}return t};c.isFeedDefinitionEqual=function(e,t){if(e===t){return true}if(!e||!t){return false}var i=c.getVizFeeds(e);var r=c.getVizFeeds(t);if(!i||!r){return false}if(i.length!==r.length){return false}for(var n=0;n<i.length;n++){var s=i[n];var o=r[n];for(var a in s){if(s.hasOwnProperty(a)){if(s[a]!==o[a]){return false}}}}return true};c.equal=function(e,t){var i;var r=c._toMap(e);var n=c._toMap(t);var s;for(s in r){if(r.hasOwnProperty(s)){var o=r[s].item;var a=o.values();var l=n[s]?n[s].item:null;var p=n[s]?l.values():null;delete n[s];if(!l){if(a.length>0){return false}}else{if(p.length!==a.length){return false}else{var h;var d=c._toMap(a);var u=c._toMap(p);for(var _ in d){if(d.hasOwnProperty(_)){if(u[_]===undefined){return false}else if(d[_].index!==u[_].index){return false}else if(!d[_].item.equal(u[_].item)){return false}}}}}}}for(s in n){if(n.hasOwnProperty(s)){var v=n[s].item;var f=v.values();if(f.length>0){return false}}}return true};c.cloneFeeds=function(e){if(!e){return null}if(e.length===0){return[]}var t=[];for(var i=0;i<e.length;i++){var r=e[i];t.push(r.clone())}return t};c.feedHasValue=function(e,t){if(!e||!t){return false}var i=false;var r=t.values();for(var n=0;n<r.length;n++){if(r[n].id()===e.id()){i=true;break}}return i};c.buildMNDFeedings=function(e,i){if(!e){return}var r=sap.viz.api.manifest.Viz;var n=r.get(i)[0];var s=n.allFeeds();var o={feedId:null,index:-1,priority:-1};for(var a=0;a<s.length;a++){var l=s[a].id;var p=s[a];var h=false;for(var d=0;d<e.length;d++){if(e[d].feedId===l){if(e[d].binding.length<p.min){if(c.canAcceptMND(p.acceptMND)){o={feedId:l,index:d,priority:p.acceptMND}}}h=true;break}}if(!h){if(p.min>0&&c.canAcceptMND(p.acceptMND)){o={feedId:l,index:-1,priority:p.acceptMND}}}}var u=e;if(u&&o.index>=0){u[o.index].binding.push({type:t.MEASURE_NAMES_DIMENSION})}else if(u&&o.feedId){u.push({binding:[{type:t.MEASURE_NAMES_DIMENSION}],feedId:o.feedId})}return u};c._useFullHierarchies=function(e,t,i){var r=true;if(e==="geoFeatures"){r=false}else if(s.isNumber(t.maxStackedDims)){var o=0;for(var a=0;a<i.length;a++){var l=i[a];if(l.type()===n.HIERARCHY){var c=l.hierarchyLevels();for(var p=0;p<c.length;p++){o++;if(c[p].selected()){break}}}else if(l.type()===n.DIMENSION){o++}}if(t.maxStackedDims<o){r=false}}return r};c.buildFeedings=function(e,t,i){return c.buildFeedingsWithFakeData(e,t,i)};c._adjustMND=function(e,t){var i=t["multiplier"];if(i){var r=c.getNumberOfDimensionsInColumn(e);var s=i.length-r;if(s>0&&r>0){for(var o=0;o<i.length;o++){if(i[o].type()===n.MND){if(o>0&&o<s+r-1){var a=i[o];if(o<s){i.unshift(a);i.splice(o+1,1)}else{i.push(a);i.splice(o,1)}}break}}}}};c._findBindingIndex=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.data.length!==t.length){continue}var n=true;for(var s=0;s<r.data.length;s++){n=n&&r.data[s].name===t[s]}if(n){e.splice(i,1);return r.index}}};c.removeRowAndColumnFeedItems=function(e){var t=c.cloneFeeds(e);var i=t.length;while(i){var r=i-1;var n=t[r];if(n.id()===c.RowsFeedingName||n.id()===c.ColumnsFeedingName||n.id()===c.MultiplierFeedingName){t.splice(r,1)}i--}return t};c.getNumberOfDimensionsInColumn=function(e){var t=0;e.forEach(function(e){if(e.id()===c.ColumnsFeedingName){var i=e.values();i.forEach(function(e){if(e.type()===n.HIERARCHY){var i=e.hierarchyLevels();for(var r=0;r<i.length;r++){t++;if(i[r].selected()){break}}}else{t++}});return}});return t};c.buildFeedingsWithFakeData=function(e,t,i){var i=JSON.parse(JSON.stringify(i.data()));var r=o.buildFakeData(e,t,i).feeding;return r};c.meetMinDimensions=function(e,t){var i;var r=c.getManifestFeedsMap(e);var s=c._getFeedsValuesMap(t);for(i in r){var o=r[i];var a=s[i];var l=o.type.toLowerCase();if(n.compatible(n.DIMENSION,l)){var p=c.countDataContainers(a);if(p<o.min){return false}}}return true};c.removeMND=function(e){if(!e){return e}var t=[];for(var i=0;i<e.length;i++){if(e[i]){var r=e[i].clone();var s=r.values();if(s){for(var o=0;o<s.length;o++){var a=s[o];if(!a){continue}if(n.compatible(n.MND,a.type())){s.splice(o,1);o--}}}}t.push(r)}return t};c.hasMND=function(e){return c.countAnalyses(e,n.MND)>0};c.countAnalyses=function(e,t){var i=0;for(var r=0;r<e.length;r++){var s=e[r];var o=s.values();for(var a=0;a<o.length;a++){var l=o[a];if(n.compatible(t,l.type())){i++}}}return i};c.convertFeedType=function(e){if(e===r.GEOGRAPHY){return r.DIMENSION}return e};c.isGeoHierarchyFeed=function(e,t,i){var s=e?e.toLowerCase():null;var o=t?t.toLowerCase():null;var a=i?i.toLowerCase():null;return s===r.GEOGRAPHY.toLowerCase()&&o===n.HIERARCHY&&a===r.GEOGRAPHY.toLowerCase()};c.feedCompatible=function(e,t,i){var s=e?e.toLowerCase():null;var o=t?t.toLowerCase():null;var a=i?i.toLowerCase():null;if(s===r.DIMENSION.toLowerCase()){return o===n.DIMENSION||o===n.HIERARCHY||o===n.MND}else if(s===r.SUBTOTAL.toLowerCase()){return o===r.DIMENSION.toLowerCase()}else if(s===r.GEOGRAPHY.toLowerCase()){return(o===n.DIMENSION||o===n.HIERARCHY)&&a===r.GEOGRAPHY.toLowerCase()}else{return s===o}};c.getManifestFeedsMap=function(e){var t=c.getVizFeeds(e);if(!t){return{}}var i={};for(var r=0;r<t.length;r++){i[t[r].id]=t[r]}return i};c._getFeedsValuesMap=function(e,t){t=t!==false;var i={};for(var r=0;r<e.length;r++){var n=e[r];var s=n.id();if(t&&(s===c.RowsFeedingName||s===c.ColumnsFeedingName)){s="multiplier"}if(!i[s]){i[s]=n.values()}else{i[s]=i[s].concat(n.values())}}return i};c.countDataContainers=function(e){if(!e){return 0}var t=0,i=0,r=0;for(var s=0;s<e.length;s++){var o=e[s];if(n.compatible(n.MEASURE,o.type())){t++}else{if(n.compatible(n.MND,o.type())){r++}else if(n.compatible(n.DIMENSION,o.type())){i++}}}return t+Math.min(1,i)+Math.min(1,r)};c.countAAOfFeeds=function(e){var t=0;var i=0;for(var n=0;n<e.length;n++){var s=e[n];if(s.type()===r.DIMENSION&&c.countAAOfFeedItem(s)){if(s.id()===c.RowsFeedingName||s.id()===c.ColumnsFeedingName){i=Math.min(1,i+1)}else{t++}}}return i+t};c.countAAOfValues=function(e){if(!e||!e.length){return 0}var t=c.hasMNDInValues(e);if(t&&e.length===1){return 0}return 1};c.countAAOfFeedItem=function(e){if(!e||!e.hasValues()){return 0}var t=e.values();return c.countAAOfValues(t)};c.hasMNDInValues=function(e){return c.indexOfMNDInValues(e)!==-1};c.indexOfMNDInValues=function(e){if(!e||!e.length){return-1}var t=-1;for(var i=0;i<e.length;i++){var r=e[i];if(r.type()===n.MND){t=i;break}}return t};c._getCapacityOfFeedDef=function(e){var t=0;if(e.type===r.DIMENSION){if(e.id===c.RowsFeedingName||e.id===c.ColumnsFeedingName||e.id===c.MultiplierFeedingName){t=c.trillisFeeds.row.maxStacked}else{t=e.maxStackedDims?e.maxStackedDims:Number.MAX_VALUE}}else{t=e.max=="Infinity"?Number.MAX_VALUE:e.max}return t};c._getMNDfeed=function(e,t){if(!t)return;var i={priority:-1};for(var r in e){var n=e[r];var o=n.id;var a=s.isNumber(n.acceptMND)?Number(n.acceptMND):-1;var l=false;for(var c=0;c<t.length;c++){if(t[c].id()==o){var p=t[c].values().length;if(p<n.min){if(a>i.priority){i={feedId:o,priority:n.acceptMND}}}l=true}}if(!l){if(n.min>0&&a>i.priority){i={feedId:o,priority:n.acceptMND}}}}return i.feedId};c.canAddValue=function(e,t,i,o,a,l){var p=s.clone(i);if(!l){l=t}if(p[c.MultiplierFeedingName]){p[c.MultiplierFeedingName].min=0}if(p[c.RowsFeedingName]){p[c.RowsFeedingName].min=0}if(p[c.ColumnsFeedingName]){p[c.ColumnsFeedingName].min=0}var h=p[l];if(!h){return false}var d=c._toMap(e);var u=d[t]?d[t].item:null;var _=u?u.values():[];if(t===c.RowsFeedingName||t===c.ColumnsFeedingName){_=c.getRowAndColumnValues(e)}var v=c._getMNDfeed(p,e);var f=0;var m=0;for(var g=0;g<e.length;g++){var E=e[g];if(E.type()==r.DIMENSION){var y=E.values();for(var I=0;I<y.length;I++){var C=y[I];if(C.type()!="mnd"){f++;if(E.id()===c.RowsFeedingName||E.id()===c.ColumnsFeedingName){m++}break}}}}var T;for(var g=0;g<e.length;g++){var E=e[g];if(E.type()==r.DIMENSION){var y=E.values();for(var I=0;I<y.length;I++){var C=y[I];if(C.type()=="mnd"){T=E.id();break}}}}if(a&&T!=v&&t!=v){f++}else if(!a&&T&&v&&T!=v&&t!=v){f++}if(m>0){f-=m-1}if((t===c.RowsFeedingName||t===c.ColumnsFeedingName)&&m>0){f--}var A;if(a){A=c.canAcceptMND(h.acceptMND)&&f<=c.MaxDemensionFeedsCount}else{A=c._canAddValueAtAALimitaion(e,_,l,p);if(_.length==0||_.length==1&&_[0].id()==n.MND){A=A&&f<=c.MaxDemensionFeedsCount-1}}if(A){var P=h.max;A=c._canAddValueAtDataContainerLimitaion(_,P,o,a);if(A){var R=c._getCapacityOfFeedDef(h);A=c._canAddValueAtCapacityLimitaion(u,R,o)}}return A};c._canAddValueAtAALimitaion=function(e,t,i,n){var s=c.countAAOfFeeds(e);var o=s<=c.MaxDemensionFeedsCount;if(o){var a=c.countAAOfValues(t);if(a===0){var l=0;var p=e.reduce(function(e,t){var s=t.id();var o=s===c.RowsFeedingName||s===c.ColumnsFeedingName;var a=n[s];if(!a&&o){a=n[c.MultiplierFeedingName]}if(a&&s!==i&&a.type===r.DIMENSION&&a.min>0&&!t.values().length){if(o){l++}return e+1}return e},0);if(l>1){p-=l-1}var h=s+p+1;if(h>c.MaxDemensionFeedsCount){o=false}}}return o};c._canAddValueAtDataContainerLimitaion=function(e,t,i,r){var n=c.countDataContainers(e);if(n>t){return false}var s=t>0&&n<=t;if(s&&n===t){var o=c.hasMNDInValues(e);if(r){if(!o){if(n===1){s=false}else if(n===2){}}else{s=false}}else{if(!o){if(n===1){s=true}else if(n===2){}}else{if(n===1){if(i){s=false}else{s=true}}else if(n===2){s=true}}}}return s};c._canAddValueAtCapacityLimitaion=function(e,t,i){var r=e?e.values().length:0;if(r&&!i&&c.hasMNDInValues(e.values())){r--}return r<t};c.canAcceptMND=function(e){e=s.isNumber(e)?Number(e):-1;return e>=0};c.supportMultiChart=function(e,t){if(!e){return true}var i;var r;var n;var s;var o;for(i=0;i<e.length;i++){r=e[i];n=r.id();if(n===c.RowsFeedingName||n===c.ColumnsFeedingName){o=t[c.MultiplierFeedingName]}else{o=t[n]}s=c.countDataContainers(r.values());if(o&&s>o.max){return false}}return true};c.getRowAndColumnValues=function(e){if(!e){return null}var t;var i;var r;var n;var s=[];for(t=0;t<e.length;t++){i=e[t];r=i.id();if(r===c.RowsFeedingName||r===c.ColumnsFeedingName){s=s.concat(i.values())}}return s};c.match=function(e,t,i){if(!i&&a.supportMultiChart(e)){var r=a.toSingleChartType(e);var n=a.toMultiChartType(e);return c.match(r,t,true)||c.match(n,t,true)}else{var s=c.getManifestFeedsMap(e);var o=c._getFeedsValuesMap(t);var l;for(l in o){if(o.hasOwnProperty(l)){var p=s[l];if(!p){return false}}}return true}};c.buildEmptyFeeds=function(e){var t=[];var r=c.getVizFeeds(e);if(r){for(var n=0;n<r.length;n++){var s=r[n];if(s.id===c.MultiplierFeedingName){t.push(new i(c.RowsFeedingName,s.type,[]));t.push(new i(c.ColumnsFeedingName,s.type,[]))}else{t.push(new i(s.id,s.type,[]))}}}else{}return t};c.merge=function(e,t){var i=c._getFeedsValuesMap(t,false);for(var r=0;r<e.length;r++){var n=e[r];if(i[n.id()]){n.values(n.values().concat(i[n.id()]))}}return e};c.getFeed=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.id()===t){return r}}return null};c.supportMND=function(e){var t=c.getVizFeeds(e);for(var i=0;i<t.length;i++){var r=t[i].acceptMND;if(c.canAcceptMND(r)){return true}}return false};c.getColumnFeeding=function(e){var t=null;for(var i=0;i<e.length;i++){var r=e[i].id();if(r===c.trillisFeeds.column.id){t=e[i]}}return t};return c});e("sap/viz/controls/common/feeds/AutoFeedingUtils",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/valueobjects/Shelf","sap/viz/controls/common/feeds/valueobjects/ShelfType","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/utils/ChartTypeUtil"],function(e,t,i,r,n,s,o,a,l,c,p){var h={};h.getInitialShelves=function(e){var t={measure:[],attribute:[],subtotal:[],trellis:[]};var i=h.getFeedDefsMap(e);if(i){var r=i.measure;var n=h._getSortedIds(r,false);var s;var a;for(var l=0;l<n.length;l++){s=n[l];a=r[s];t["measure"].push(h._getShelfByFeedDef(a,o.MEASURE,e))}var d=i.dimension;var u=h._getSortedIds(d,true);for(var _=0;_<u.length;_++){s=u[_];a=d[s];if(s===c.RowsFeedingName||s===c.ColumnsFeedingName){t["trellis"].push(h._getShelfByFeedDef(a,o.TRELLIS))}else{t["attribute"].push(h._getShelfByFeedDef(a,o.ATTRIBUTE,e))}}var v=i.subtotal;var f=h._getSortedIds(v,false);for(var l=0;l<f.length;l++){s=f[l];a=v[s];t["subtotal"].push(h._getShelfByFeedDef(a,o.SUBTOTAL,e))}if(!p.isMultipleChart(e)&&p.supportMultiChart(e)){t["trellis"].push(h._getShelfByFeedDef(c.trillisFeeds.row,o.TRELLIS));t["trellis"].push(h._getShelfByFeedDef(c.trillisFeeds.column,o.TRELLIS))}}return t};h._getShelfByFeedDef=function(t,r,o){var a=p.isMultipleChart(o)?p.toSingleChartType(o):o;var h=new s;h.id=t.id;h.type=r;if(h.id===e.FEEDING_PRIMARY_VALUES){var u=l.getValueAxis(a);if(!u){if(a===e.TYPE_3D_BAR){h.name=n.get(d[h.id][1])}else{h.name=n.get(d[h.id][0])}}else{if(u.length===1){if(u[0]===e.AXIS_YAXIS){h.name=n.get(d[h.id][0])}else{h.name=n.get(d[h.id][1])}}else{for(var _=0;_<u.length;_++){if(u[_]===e.AXIS_YAXIS2){h.name=n.get(d[h.id][2]);break}else if(u[_]===e.AXIS_XAXIS2){h.name=n.get(d[h.id][3]);break}else{h.name=n.get(d[h.id][1])}}}}}else if(h.id===e.FEEDING_SECONDARY_VALUES){var u=l.getValueAxis(a);if(!!u){for(var _=0;_<u.length;_++){if(u[_]===e.AXIS_YAXIS2){h.name=n.get(d[h.id][0]);break}else if(u[_]===e.AXIS_XAXIS2){h.name=n.get(d[h.id][2]);break}else{h.name=n.get(d[h.id][1])}}}}else if(h.id===e.FEEDING_AXIS_LABELS){var v=l.getCategoryAxis(a);if(!v){if(a===e.TYPE_3D_BAR){h.name=n.get(d[h.id][1])}else{h.name=n.get(d[h.id][0])}}else{if(v[0]===e.AXIS_XAXIS){h.name=n.get(d[h.id][0])}else{h.name=n.get(d[h.id][1])}}}else{h.name=n.get(d[h.id])}if(!h.name){h.name=t.name}h.analysisType=t.type.toLowerCase();h.feedItemType=h.id===c.geoFeeds.id?i.GEOGRAPHY:t.type;h.capacity=t.maxStacked;return h};h.smartFeeding=function(e,t,i,r){return h._autoFeedItems(h._STRATEGY_SMART,e,t,i,r)};h.directFeeding=function(e,t,i){return h._autoFeedItems(h._STRATEGY_DIRECT,e,t,i)};h._STRATEGY_SMART="smart";h._STRATEGY_DIRECT="direct";h._autoFeedItems=function(e,t,i,n,s){t=c.cloneFeeds(t);var o=h.getFeedDefsMap(i);var a=h._prepareData(t);if(!o||!a){return t}var l={measure:[],dimension:[],subtotal:[]};n=n||[];for(var p=0;p<n.length;p++){var d=n[p];if(r.compatible(r.MEASURE,d.type())){l.measure.push(d)}else{if(r.compatible(r.DIMENSION,d.type())){l.dimension.push(d)}}}if(s){h._addFeedingScope(o.measure,s);h._addFeedingScope(o.dimension,s)}var u=h._mapFeedsProcess(e,a.measure,o.measure,false,l.measure);if(i==="viz/ext/table"&&a.dimension!==undefined&&a.dimension.length>=2&&a.dimension[0].id()==="regionColor"&&a.dimension[1].id()!=="regionShape"){var _=a.dimension[0];a.dimension[0]=a.dimension[1];a.dimension[1]=_}var v=h._mapFeedsProcess(e,a.dimension,o.dimension,true,l.dimension);var f=h._mapFeedsProcess(e,a.subtotal,o.subtotal,false,l.subtotal);for(var p=0;p<v.length;p++){var m=v[p];var g=m.values();for(var E=0;E<g.length;E++){var y=g[E];if(y.aggregationType()){g.splice(E,1)}}}var I=u.concat(v);I=I.concat(f);return I};h._addFeedingScope=function(e,t){if(t){for(var i in e){if(t.indexOf(i)===-1){e[i].outOfFeedingScope=true}}}};h.needAutoFeeding=function(e,t,i){var r=true;if(!i||t===i||!e){r=false}return r};h.getFeedDefsMap=function(e){var t={measure:{},dimension:{},subtotal:{}};var r=c.getVizFeeds(e);if(r){for(var n=0;n<r.length;n++){var s=r[n];if(s.type===i.MEASURE){t.measure[s.id]=h._addMinAndMaxStackedToFeedDef(s)}else if(s.type===i.DIMENSION){if(s.id===c.MultiplierFeedingName){var o=a.clone(s);o.id=c.RowsFeedingName;t.dimension[c.RowsFeedingName]=h._addMinAndMaxStackedToFeedDef(o,true);var l=a.clone(s);l.id=c.ColumnsFeedingName;t.dimension[c.ColumnsFeedingName]=h._addMinAndMaxStackedToFeedDef(l,true)}else{t.dimension[s.id]=h._addMinAndMaxStackedToFeedDef(s,true)}}else if(s.type===i.SUBTOTAL){t.subtotal[s.id]=h._addMinAndMaxStackedToFeedDef(s)}}}else{return null}return t};h._addMinAndMaxStackedToFeedDef=function(e,t){var i=a.clone(e);if(t){if(e.id===c.RowsFeedingName){i.minStacked=c.trillisFeeds.row.minStacked;i.maxStacked=c.trillisFeeds.row.maxStacked}else if(e.id===c.ColumnsFeedingName){i.minStacked=c.trillisFeeds.column.minStacked;i.maxStacked=c.trillisFeeds.column.maxStacked}else{var r=0;if(e.min){r=e.minStackedDims?e.minStackedDims:e.min}i.minStacked=r;var n=e.maxStackedDims?e.maxStackedDims:Number.MAX_VALUE;i.maxStacked=n}}else{i.minStacked=e.min;i.maxStacked=e.max=="Infinity"?Number.MAX_VALUE:e.max}return i};h._prepareData=function(e){var t=[];var r=[];var n=[];if(e.length>0){for(var s=0;s<e.length;s++){var o=e[s];if(o._id===i.ROW_SUBTOTALS){n.push(o)}if(o.type()===i.MEASURE){t.push(o)}else if(o.type()===i.DIMENSION){r.push(o)}}}return{measure:t,dimension:r,subtotal:n}};h._mapFeedsProcess=function(e,i,r,n,s){var o=h._idMapping(i,r);var a=o.feeds;s=o.pool.concat(s||[]);var l=h._getSortedIds(r,n,true);if(n){var p=c.indexOfMNDInValues(s);if(p!==-1){var d=s[p];s.splice(p,1);h._autoFeedMNDValue(l,r,a,d)}if(e===h._STRATEGY_SMART){h._feedGeographyFeedItem(l,r,a,s)}}l.forEach(function(e){a[e]=a[e]||new t(e,r[e].type,[])});var u=h._precalFeedItemValuesSize(e,l,r,a,s.length,n);var _=h._getSortedIds(r,n);var v=h._locateValuestoFeeds(_,r,a,s,u);var f=h._convertToFeeds(_,v);return f};h._idMapping=function(e,i){var r={};var n=[];var s;var o=c.getRowAndColumnValues(e);for(var a=0;a<e.length;a++){var l=e[a];var p=l.id();var d=l.values();d=d?d:[];var u=h._getIdByShelfName(p,i);if(u){if(i[u].outOfFeedingScope){r[u]=l;continue}var _=i[u].maxStacked;var v=c.canAcceptMND(i[u].acceptMND);var f=c.indexOfMNDInValues(d);var m=false;if(!v){m=true}else{if(f>_){m=true}else{var g=i[u].max;var E;var y=-1;if(p===c.RowsFeedingName||p===c.ColumnsFeedingName){E=c.countDataContainers(o);y=c.indexOfMNDInValues(o)}else{E=c.countDataContainers(d)}if(E>g){if(p===c.RowsFeedingName||p===c.ColumnsFeedingName){if(y===0){if(f===0){_=1}else if(f===-1){_=0}}else{m=true;if(f!==-1&&y!==-1){o.splice(y,1)}}}else{if(f===0){_=1}else{m=true}}}}}if(m&&f!==-1){s=d[f];d.splice(f,1);h._pushFeedItemValuesToPool([s],n)}if(_<d.length){var I=d.slice(_,d.length);h._pushFeedItemValuesToPool(I,n);var C=d.slice(0,_);var T=new t(u,l.type(),C);r[u]=T}else{r[u]=new t(u,l.type(),d)}}else{h._pushFeedItemValuesToPool(d,n)}}return{feeds:r,pool:n}};h._autoFeedMNDValue=function(e,i,r,n){var s=-1;var o;var a=h._convertToFeeds(e,r);for(var l=0;l<e.length;l++){var p=e[l];var d=i[p];var u=true;var _=true;var v=c.canAddValue(a,p,i,u,_);if(v){var f=d.acceptMND;var m=r[p];var g=m?m.values():null;var E=c.countDataContainers(g);var y=i[p].min;if(E<y){f+=10}if(f>s){s=f;o=p}}}if(o){var m=r[o];var d=i[o];var g=m?m.values():[];g.push(n);r[o]=new t(d.id,d.type,g)}};h._feedGeographyFeedItem=function(e,r,n,s){var o=r[c.geoFeeds.id];if(!o){return}var a=n[c.geoFeeds.id];if(!a){a=new t(c.geoFeeds.id,o.type,[])}var l=a.values();if(l.length>0){return}var p=function(e){var t=-1;for(var r=0;r<e.length;r++){var n=e[r];if(n.dataType()&&n.dataType().toLowerCase()===i.GEOGRAPHY.toLowerCase()){t=r;break}}return t};var h;var d=p(s);if(d!==-1){h=s[d];s.splice(d,1)}else{var u,_,v,f;for(var m=0;m<e.length;m++){u=e[m];_=r[u];v=n[u];if(u===c.geoFeeds.id||!v){continue}f=v.values();if(f.length>1&&f.length>_.minStacked){d=p(f);if(d!==-1){h=f[d];f.splice(d,1);break}}}}if(h){l.push(h);n[c.geoFeeds.id]=a}};h._getIdByShelfName=function(e,t){if(t[e]){return e}var i=d[e];for(var r in t){if(t.hasOwnProperty(r)){var n=t[r];var s=d[r];if(i===s){return r}}}return null};h._locateValuestoFeeds=function(e,i,n,s,o){var a,l,p,d,u;for(a=0;a<e.length;a++){l=e[a];p=n[l];if(p){d=p.values();u=o[l];if(d.length>u){var _=c.indexOfMNDInValues(d);if(_!==-1&&_>=u){var v=d[_];d.splice(_,1);d.splice(u-1,0,v)}var f=d.slice(u,d.length);h._pushFeedItemValuesToPool(f,s)}}}for(a=0;a<e.length;a++){l=e[a];p=n[l];if(!p){p=new t(l,i[l].type,[]);n[l]=p}var m=false;u=o[l];d=p.values();if(u<d.length){m=true;d=d.slice(0,u)}else if(u>d.length&&s.length>0){m=true;var g=[];var E=false;if(d.length>1&&d[d.length-1].type()===r.MND){E=true}while(s.length>0&&u>d.length){var y=s.shift();if(!c.feedHasValue(y,p)){if(E){d.splice(d.length-1,0,y)}else{d.push(y)}}else{g.push(y)}}if(g.length>0){s=s.concat(g)}}if(m){n[l]=new t(l,i[l].type,d)}}return n};h._pushFeedItemValuesToPool=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];t.push(r)}};h._precalFeedItemValuesSize=function(e,t,i,r,n,s){var o=h._initializeId2Size(t,r);var a;if(s){a=h._getFeedsStatus(t,i,r)}var l=h._getNeedToFillFeedsId(t,o,i);var c=!l.length;var p=0;var d;var u;var _;var v;var f;var m;if(!c&&n>0){d=true;for(u=0;u<l.length;u++){p=u;_=l[u];if(s&&!a[_]){continue}v=o[_];f=i[_].minStacked;m=f-v;if(n<m){m=n;d=false}o[_]=v+m;n-=m;if(!n){break}}c=d&&p==l.length-1}else if(!c){if(e===h._STRATEGY_SMART){var g=h._getOverMinFeedsId(t,o,i);if(g.length>0){d=true;var E=[];var y=0;var I;for(u=0;u<g.length;u++){I=g[u];var C=o[I];var T=i[I].minStacked;var A=C-T;E[I]=A;y+=A}var P=p;for(u=p;u<l.length;u++){P=u;_=l[u];if(s&&!a[_]){continue}v=o[_];f=i[_].minStacked;m=f-v;var R=m;for(var z in E){if(E.hasOwnProperty(z)){var A=E[z];if(A<R){R-=A;o[I]-=A}else{E[I]-=R;o[I]-=R;R=0;break}}}if(R>0){m-=R;d=false}o[_]=v+m;y-=m;if(!y){break}}c=d&&P==l.length-1}}return o}if(c&&n>0){var O=h._getEmptyFeedsId(t,o);for(u=0;u<O.length;u++){_=O[u];if(s&&!a[_]){continue}n--;o[_]=1;if(!n){if(u<O.length){c=false}break}}}if(c&&n>0){var b=h._getNotFullFeedsId(t,o,i);for(u=0;u<b.length;u++){_=b[u];if(s&&!a[_]){continue}v=o[_];var S=i[_].maxStacked;m=S-v;if(n<m){m=n}o[_]=v+m;n-=m;if(!n){break}}}return o};h._convertToFeeds=function(e,t){var i=[];for(var r=0;r<e.length;r++){var n=e[r];var s=t[n];if(s){i.push(s)}}return i};h._getSortedIds=function(e,t,i){var r=[];var n=[];for(var s in e){var o=e[s];var a=t?o.aaIndex:o.mgIndex;if(s===c.RowsFeedingName||s===c.ColumnsFeedingName){a=1e3+o.aaIndex}n.push({id:s,priority:a})}n.sort(function(e,t){return e.priority-t.priority});for(var l=0;l<n.length;l++){var p=n[l].id;if(i&&e[p].outOfFeedingScope){continue}r.push(p)}return r};h._initializeId2Size=function(e,t){var r={};for(var n=0;n<e.length;n++){var s=e[n];if(s===i.ROW_SUBTOTALS||s===i.COLUMNS_SUBTOTALS){continue}var o=0;var a=t[s];if(a){o=a.values().length}r[s]=o}return r};h._getNeedToFillFeedsId=function(e,t,i){var r=[];for(var n=0;n<e.length;n++){var s=e[n];var o=i[s];var a=o.minStacked;var l=t[s];if(l<a){r.push(s)}}return r};h._getNotFullFeedsId=function(e,t,i){var r=[];for(var n=0;n<e.length;n++){var s=e[n];var o=i[s];var a=o.maxStacked;var l=t[s];if(l<a){r.push(s)}}return r};h._getOverMinFeedsId=function(e,t,i){var r=[];for(var n=0;n<e.length;n++){var s=e[n];var o=i[s];var a=o.minStacked;var l=t[s];if(l>1&&l>a){r.push(s)}}return r};h._getEmptyFeedsId=function(e,t){var i=[];for(var r=0;r<e.length;r++){var n=e[r];var s=t[n];if(s===0){i.push(n)}}return i};h._getFeedsStatus=function(e,t,i){var r={};var n;var s=function(e){var t=0;if(e===c.RowsFeedingName||e===c.ColumnsFeedingName){if(n!==undefined){var r=i[c.RowsFeedingName]?i[c.RowsFeedingName].item:null;var s=i[c.ColumnsFeedingName]?i[c.ColumnsFeedingName].item:null;var o=r?r.values():[];var a=s?s.values():[];var l=o.concat(a);t=c.countAAOfValues(l);n=t}else{t=n}}else{var p=i[e];t=c.countAAOfFeedItem(p)}return t};var o=h._getSortedIds(t,true);var a=h._convertToFeeds(o,i);var l=c.countAAOfFeeds(a);var p=l<=c.MaxDemensionFeedsCount;var d=true;var u=false;for(var _=0;_<e.length;_++){var v=false;if(p){var f=e[_];if(f===c.geoFeeds.id){r[f]=false;continue}var m=t[f];v=c.canAddValue(a,f,t,d,u);if(v){var g=s(f);if(g===0){l++;if(l>c.MaxDemensionFeedsCount){v=false;l--}else if(f===c.RowsFeedingName){l--}}p=l<=c.MaxDemensionFeedsCount}}r[f]=v}return r};var d={primaryValues:["VIZ_COMMON_YAXIS","VIZ_COMMON_XAXIS","VIZ_COMMON_PRIMARY_YAXIS","VIZ_COMMON_PRIMARY_XAXIS"],secondaryValues:["VIZ_COMMON_SECONDARY_YAXIS","VIZ_COMMON_YAXIS","VIZ_COMMON_SECONDARY_XAXIS"],pieSectorSize:"VIZ_COMMON_PIE_SECTORS",pieDepthSize:"VIZ_COMMON_PIE_DEPTH",featureValues:"VIZ_COMMON_FEATUREVALUES",bubbleWidth:"VIZ_COMMON_BUBBLE_WIDTH",bubbleHeight:"VIZ_COMMON_BUBBLE_HEIGHT",rectangleColor:"VIZ_COMMON_RECTANGLECOLOR",rectangleWeight:"VIZ_COMMON_RECTANGLEWEIGHT",regionColor:"VIZ_COMMON_REGIONCOLOR",axisLabels:["VIZ_COMMON_XAXIS","VIZ_COMMON_YAXIS"],pieSectorColor:"VIZ_COMMON_REGIONCOLOR",geoFeatures:"VIZ_COMMON_GEO_FEATURES",featureAnalysis:"VIZ_COMMON_FEATUREANALYSIS",regionShape:"VIZ_COMMON_REGIONSHAPE",rectangleTitle:"VIZ_COMMON_AREANAME",mainLabelAxis:"VIZ_COMMON_AREANAME",secondaryLabelAxis:"VIZ_COMMON_SECONDARY_AREANAME",radarAxesValues:"VIZ_COMMON_YAXIS",radarAxes:"VIZ_COMMON_RADAR_AXES",tagWeight:"VIZ_COMMON_TAGWEIGHT",tagFamily:"VIZ_COMMON_TAGFAMILY",tagName:"VIZ_COMMON_TAGNAME","multiplier.column":"VIZ_COMMON_COLUMNS","multiplier.row":"VIZ_COMMON_ROWS",treeNode:"VIZ_COMMON_TREENODE",link:"VIZ_COMMON_LINK",rows:"VIZ_COMMON_TABLE_DIMENSION",values:"VIZ_COMMON_TABLE_MEASURE",r_subtotals:"VIZ_COMMON_TABLE_ROWS_SUBTOTALS",cols:"VIZ_COMMON_TABLE_COLUMNS_AXIS",c_subtotals:"VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS"};return h});e("sap/viz/controls/common/filter/AbstractFilter",[],function(){var e=function(e,t,i){this.__className="sap.viz.controls.common.filter.AbstractFilter";this.filterType=e;this.filteredObjectId=t;this.filteredObjectName=i;this.isReverse=true;this._isGlobalFilter=false};e.VALUE_TYPE="VALUE_FILTER_TYPE";e.NUMERIC_RANGE_TYPE="NUMERIC_RANGE_TYPE";e.DATE_RANGE_TYPE="DATE_RANGE_TYPE";e.prototype.getType=function(){return this.filterType};e.prototype.getFilteredObjectId=function(){return this.filteredObjectId};e.prototype.getFilteredObjectName=function(){return this.filteredObjectName};e.prototype.setReverseSelection=function(e){this.isReverse=e};e.prototype.isReverseSelection=function(){return this.isReverse};e.prototype.isEmpty=function(){return false};e.prototype.toJSON=function(){var e={};e.filteredObjectId=this.filteredObjectId;e.filteredObjectName=this.filteredObjectName;e.filterType=this.filterType;e.isReverse=this.isReverse;e.isGlobalFilter=this._isGlobalFilter;return e};e.prototype.analysisObjectId=function(){return this.getFilteredObjectId()};e.prototype.id=function(){return this.getFilteredObjectId()};e.prototype.filterName=function(){return this.getFilteredObjectName()};e.prototype.isExcluded=function(e){if(arguments.length>0){this.isReverse=!e}else{return!this.isReverse}};e.prototype.isGlobalFilter=function(e){if(arguments.length>0){this._isGlobalFilter=e;return this}else{return this._isGlobalFilter}};e.prototype.filterTitle=function(){return this.filteredObjectName};e.prototype.filterContent=function(){return this.filteredObjectName};return e});e("sap/viz/controls/common/utils/OOUtil",[],function(){var e;var t={};t.extend=function(e,t){var i=e.prototype;e.superclass=t.prototype;var r=function(){};r.prototype=t.prototype;e.prototype=new r;for(var n in i){if(i.hasOwnProperty(n)){e.prototype[n]=i[n]}}e.prototype.constructor=e;if(t.prototype.constructor==Object.prototype.constructor){t.prototype.constructor=t}return e};return t});e("sap/viz/controls/common/filter/DateRangeFilter",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/managers/LangManager"],function(e,t,i){var r=function(e,i){var n=[];n.push(t.DATE_RANGE_TYPE);n.push(e);n.push(i);r.superclass.constructor.apply(this,n);this.__className="sap.viz.controls.common.filter.DateRangeFilter";this.minDate=null;this.maxDate=null;this.excludeNull=false};e.extend(r,t);r.prototype.isEmpty=function(){if(this.minDate===null&&this.maxDate===null){return true}return false};r.prototype.getMin=function(){return this.minDate};r.prototype.getMax=function(){return this.maxDate};r.prototype.isExcludeNull=function(){return this.excludeNull};r.prototype.setMin=function(e){this.minDate=e};r.prototype.setMax=function(e){this.maxDate=e};r.prototype.setExcludeNull=function(e){this.excludeNull=e};r.prototype.toJSON=function(){var e=r.superclass.toJSON.apply(this,arguments);e.minDate=this.minDate;e.maxDate=this.maxDate;e.excludeNull=this.excludeNull;return e};r.fromJSON=function(e){var t=new r(e.filteredObjectId,e.filteredObjectName);t.setReverseSelection(e.isReverse);t.isGlobalFilter(e.isGlobalFilter);t.minDate=e.minDate;t.maxDate=e.maxDate;t.excludeNull=e.excludeNull;return t};r.prototype.clone=function(){var e=this.toJSON();return r.fromJSON(e)};r.prototype.filterTitle=function(){return this.filteredObjectName+"("+i.get("VIZ_COMMON_BETWEEN")+")"};r.prototype.filterContent=function(){return"("+this.minDate+"  -  "+this.maxDate+")"};return r});e("sap/viz/controls/common/filter/NumericRangeFilter",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/managers/LangManager"],function(e,t,i){var r=function(e,i){var n=[];n.push(t.NUMERIC_RANGE_TYPE);n.push(e);n.push(i);r.superclass.constructor.apply(this,n);this.__className="sap.viz.controls.common.filter.NumericRangeFilter";this.minValue=null;this.maxValue=null;this.excludeNull=false};e.extend(r,t);r.prototype.isEmpty=function(){if(this.minValue===null&&this.maxValue===null){return true}return false};r.prototype.getMin=function(){return this.minValue};r.prototype.getMax=function(){return this.maxValue};r.prototype.isExcludeNull=function(){return this.excludeNull};r.prototype.setMin=function(e){this.minValue=e};r.prototype.setMax=function(e){this.maxValue=e};r.prototype.setExcludeNull=function(e){this.excludeNull=e};r.prototype.toJSON=function(){var e=r.superclass.toJSON.apply(this,arguments);e.minValue=this.minValue;e.maxValue=this.maxValue;e.excludeNull=this.excludeNull;return e};r.fromJSON=function(e){var t=new r(e.filteredObjectId,e.filteredObjectName);t.setReverseSelection(e.isReverse);t.isGlobalFilter(e.isGlobalFilter);t.minValue=e.minValue;t.maxValue=e.maxValue;t.excludeNull=e.excludeNull;return t};r.prototype.clone=function(){var e=this.toJSON();return r.fromJSON(e)};r.prototype.filterTitle=function(){return this.filteredObjectName+"("+i.get("VIZ_COMMON_BETWEEN")+")"};r.prototype.filterContent=function(){return"("+this.minValue+"  -  "+this.maxValue+")"};return r});e("sap/viz/controls/common/filter/ValueFilter",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/filter/AbstractFilter"],function(e,t){var i=function(e,r){i.superclass.constructor.apply(this,[t.VALUE_TYPE,e,r]);this.__className="sap.viz.controls.common.filter.ValueFilter";this.hierarchyLevelId=null;this.filteredValues=[]};e.extend(i,t);i.prototype.getValues=function(){return this.filteredValues};i.prototype.isEmpty=function(){if(this.filteredValues&&this.filteredValues.length>0){return false}else{return true}};i.prototype.removeAllValues=function(){this.filteredValues.length=0};i.prototype.addValue=function(e){return this.filteredValues.push(e)};i.prototype.removeValue=function(e){for(var t=0;t<this.filteredValues.length;t++){if(this.filteredValues[t].key===e.key&&this.filteredValues[t].value===e.value){this.filteredValues.splice(t,1)}}};i.prototype.toJSON=function(){var e=i.superclass.toJSON.apply(this,arguments);e.filteredValues=this.filteredValues;if(this.hierarchyLevelId){e.hierarchyLevelId=this.hierarchyLevelId}return e};i.fromJSON=function(e){var t=new i(e.filteredObjectId,e.filteredObjectName);t.setReverseSelection(e.isReverse);t.isGlobalFilter(e.isGlobalFilter);t.filteredValues=e.filteredValues;if(e.hierarchyLevelId){t.hierarchyLevelId=e.hierarchyLevelId}return t};i.prototype.clone=function(){var e=this.toJSON();return i.fromJSON(e)};i.prototype.values=function(){return this.filteredValues};i.prototype.updateValues=function(e){return this.filteredValues=e};i.prototype.filterTitle=function(){return this.filteredObjectName+" ("+this.filteredValues.length+")"};i.prototype.filterContent=function(){var e="";for(var t=0,i=this.filteredValues.length;t<i;t++){if(e){e+=", "+this.filteredValues[t].value}else{e=this.filteredValues[t].value}}return e};return i});e("sap/viz/controls/common/events/EventDispatcher",["sap/viz/controls/common/utils/Utils"],function(e){var t=function(){this.__className="sap.viz.controls.common.events.EventDispatcher";this._enableDispatchEvent=true};t.prototype.addEventListener=function(e,t,i,r){if(!r){r=0}var n=this._findEventListener(e,t,i);if(n){return}n={type:e,scope:i,listener:t,priority:r};var s=this.listeners()[e];if(!s){this.listeners()[e]=s=[n]}else{var o=false;for(var a=0;a<s.length;++a){var l=s[a];if(r>l.priority){s.splice(a,0,n);o=true;break}}if(o===false){s.push(n)}}};t.prototype.removeEventListener=function(e,t,i){var r=this._findEventListener(e,t,i);if(r){var n=this.listeners()[e];n.splice(n.indexOf(r),1)}};t.prototype.removeEventListeners=function(e){this.listeners()[e]=[]};t.prototype.removeAllEventListeners=function(){this._listeners={}};t.prototype.hasEventListener=function(e,t,i){var r=this._findEventListener(e,t,i);return r!==null};t.prototype.hasEventListeners=function(e){var t=this.listeners()[e];if(t){return t.length>0}return false};t.prototype._dispatchEvent=function(e){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(this._enableDispatchEvent){var t=e.type();var i=this.listeners()[t];if(i){var r=i.slice(0);for(var n=0;n<r.length;++n){var s=r[n];s.listener.call(s.scope,e)}}}};t.prototype.enableDispatchEvent=function(t){if(this._enableDispatchEvent===undefined){this._enableDispatchEvent=true}if(arguments.length>=1){if(e.isBoolean(t)){this._enableDispatchEvent=t}return this}else{return this._enableDispatchEvent}};t.prototype._findEventListener=function(e,t,i){var r=this.listeners()[e];if(!r){return null}for(var n=0;n<r.length;++n){var s=r[n];if(s.listener===t&&s.scope===i){return s}}return null};t.prototype.listeners=function(){if(this._listeners===undefined){this._listeners={}}return this._listeners};return t});e("sap/viz/controls/common/UIControl",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/utils/Utils"],function(e,t,i,r){var n=function t(i,n){t.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.UIControl";this._dom=i;this._dom$=e(i);this._uiConfig=n;this._uid=r.genUID()};t.extend(n,i);n.prototype.size=function(e){if(arguments.length>0){if(e.width!=null){this._dom$.width(e.width)}if(e.height!=null){this._dom$.height(e.height)}this._validateSize();return this}else{return{width:this._dom$.width(),height:this._dom$.height()}}};n.prototype._validateSize=function(){};n.prototype.visible=function(e){this._dom$.css("visibility",e?"visible":"hidden");return this};n.prototype.hide=function(){this._dom$.hide();return this};n.prototype.show=function(){this._dom$.show();return this};n.prototype.destroy=function(){this._dom$.removeData().off().find("*").removeData().off();this._dom$.empty();this._dom=null};return n});e("sap/viz/controls/common/views/drag/DropAction",[],function(){var e={};e.ACCEPT="accept";e.ACCEPT_AS_REPLACEMENT="acceptAsReplacement";e.ACCEPT_AS_COPY="acceptAsCopy";e.DENY="deny";e.AS_TRASH="asTrash";return e});e("sap/viz/controls/common/views/drag/AnalysisToken",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/UIControl","sap/viz/controls/common/views/drag/DropAction"],function(e,t,i,r,n,s){var o=function(t,i,r){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.AnalysisToken";this._domHelper$=e(t);this._domDraggable$=e(i);this._fixDragingPosition();this._defaultAction=s.DENY;this.analysisObject=r;this.playDefaultAction()};i.extend(o,n);o.prototype._fixDragingPosition=function(){var t=this._domDraggable$;var i=e.proxy(function(e,t){t.position.top=t.offset.top;t.position.left=t.offset.left;t.helper.trigger("sap.viz.controls.analysisDrag.events.drag",[e.pageX,e.pageY])},this);var r=e.proxy(function(e,t){n()},this);var n=function(){t.off("drag",i);t.off("dragstop",r)};n();t.on("drag",i);t.on("dragstop",r)};o.prototype.defaultAction=function(e){if(arguments.length>0){this._defaultAction=e;return this}else{return this._defaultAction}};o.prototype.killRevertAnimation=function(){var e=this._domDraggable$;if(e){var t=e.draggable("option","revertDuration");e.draggable("option","revertDuration",0);r.defer(function(){try{e.draggable("option","revertDuration",t)}catch(e){}})}};o.prototype.dropTarget=function(e){};o.prototype.currentAction=function(e){if(arguments.length>0){this._domHelper$.data("sap.viz.controls.analysisDrag.action",e);this._domHelper$.trigger("sap.viz.controls.analysisDrag.events.dropAction",[e]);return this}else{return this._domHelper$.data("sap.viz.controls.analysisDrag.action")}};o.prototype.playDefaultAction=function(){this.currentAction(this._defaultAction)};o.prototype.showWarn=function(e){};return o});e("sap/viz/controls/common/views/drag/DefaultAnalysisToken",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/views/drag/AnalysisToken","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/utils/Utils"],function(e,t,i,r,n,s,o,a){var l=function(t,i,r){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.drag.DefaultAnalysisToken";this._dom$=e(t);this._icon$=null;this._warn$=null;this._warnspan$=null;this._dropTarget=null;this._createChildren();this._dom$.appendTo(document.body);this.currentAction(this._defaultAction);l._instance=this};r.extend(l,s);l._ACTION_TO_CLASS=function(){var e={};var i=t.COMMON_PREFIX;var r=i+"havanaVXTabSprite16 "+i+"analysisDraggingToken-"+"icon-dropAccepted";e[o.ACCEPT]=r;e[o.ACCEPT_AS_COPY]=r;r=i+"havanaVXTabSprite16 "+i+"analysisDraggingToken-icon-dropAcceptedAsReplacement";e[o.ACCEPT_AS_REPLACEMENT]=r;r=i+"havanaVXTabSprite16 "+i+"analysisDraggingToken-"+"icon-dropDenied";e[o.DENY]=r;r=i+"havanaSharedSprite16 "+i+"analysisDraggingToken-icon-dropAsTrash";e[o.AS_TRASH]=r;return e}();l.prototype.dropTarget=function(e){if(arguments.length>0){this._dropTarget=e;return this}else{return this._dropTarget}};l.prototype.currentAction=function(e){if(this._icon$){if(arguments.length>0){this._icon$.removeClass(l._ACTION_TO_CLASS[o.ACCEPT]);this._icon$.removeClass(l._ACTION_TO_CLASS[o.ACCEPT_AS_COPY]);this._icon$.removeClass(l._ACTION_TO_CLASS[o.ACCEPT_AS_REPLACEMENT]);this._icon$.removeClass(l._ACTION_TO_CLASS[o.DENY]);this._icon$.removeClass(l._ACTION_TO_CLASS[o.AS_TRASH]);this._icon$.addClass(l._ACTION_TO_CLASS[e])}}return l.superclass.currentAction.apply(this,arguments)};l.prototype.showWarn=function(i){if(i){if(!this._warn$){this._warn$=e(document.createElement("div")).addClass(t.COMMON_PREFIX+"analysisDraggingToken-warn").appendTo(this._dom$);this._warnspan$=e(document.createElement("span")).addClass(t.COMMON_PREFIX+"analysisDraggingToken-warn-text").appendTo(this._warn$)}this._warnspan$.text(i);this._layoutWarn();this._dom$.bind("mousemove",e.proxy(function(e){this._layoutWarn()},this))}else{if(this._warn$){this._warn$.hide(0);this._dom$.unbind("mousemove")}}};l.prototype._layoutWarn=function(){this._warn$.removeClass(t.COMMON_PREFIX+"analysisDraggingToken-warn");this._warn$.addClass(t.COMMON_PREFIX+"analysisDraggingToken-warn");this._warnspan$.removeClass(t.COMMON_PREFIX+"analysisDraggingToken-warn-text");this._warnspan$.addClass(t.COMMON_PREFIX+"analysisDraggingToken-warn-text");this._warn$.css({maxWidth:e(window).width()+"px"});var i=this._dom$.outerWidth();var r=this._dom$.outerHeight();var n=this._dom$.offset().left-document.body.scrollLeft;var s=e(window).width()-this._dom$.offset().left-i;var o=false;var a=0;var l=0;var c=i;var p=this._warnspan$.outerWidth();this._warn$.hide(0);if(s>=p){a=-r;l=i;c=p}else if(n>=p){l=-p}else if(s>=c){o=true;a=-r;l=i;c=s}else if(n>=c){o=true;l=-n;p=n}else{o=true;l=-n}c=Math.min(c,e(window).width());p=Math.min(p,e(window).width());this._warn$.css({marginTop:a+"px",marginLeft:l+"px",minWidth:c+"px",maxWidth:p+"px"});if(o){this._warnspan$.css({whiteSpace:"pre-line"})}this._warn$.show(0)};l.prototype._createChildren=function(){this._dom$.addClass(t.COMMON_PREFIX+"analysisDraggingToken");var r=this.analysisObject.name();if(this.analysisObject.type()===i.HIERARCHY){var n=this.analysisObject.selectedHierarchyLevel();r=n.name()}var s=e(document.createElement("span")).appendTo(this._dom$).text(r);s.addClass(t.COMMON_PREFIX+"text-ellipsis");var o=this._icon$=e(document.createElement("input")).appendTo(this._dom$);o.addClass(t.COMMON_PREFIX+"analysisDraggingToken-icon")};return l});e("sap/viz/controls/common/managers/DragManager",["jquery","sap/viz/controls/common/views/drag/DefaultAnalysisToken","sap/viz/controls/common/views/drag/AnalysisToken","sap/viz/controls/common/views/drag/DropAction"],function(e,t,i,r){var n=function(){this.__className="sap.viz.controls.common.managers.DragManager"};n._instance=null;n.instance=function(){if(!n._instance){n._instance=new n}return n._instance};n.enableDraggableFeeding=function(t,i,r){var s=e(t);s.off("dragstart",n._feedingDragStartHandler);s.on("dragstart",n._feedingDragStartHandler);s.addClass(n.DRAGGABLE_CLASS_ANALYSIS);s.data(n._KEY_ANALYSIS,i);s.data(n._KEY_BACKUPAOS,r)};n.disableDraggableFeeding=function(t){var i=e(t);i.off("dragstart",n._feedingDragStartHandler);i.removeClass(n.DRAGGABLE_CLASS_ANALYSIS);i.removeData(n._KEY_ANALYSIS);i.removeData(n._KEY_BACKUPAOS)};n.getDefaultHelper=function(i){var r=e(i);var s=r.data(n._KEY_ANALYSIS);if(!s){return null}var o=document.createElement("div");var a=new t(o,i,s);var l=r.data(n._KEY_BACKUPAOS);if(l){a.backupAOs=l}e(o).data(n._KEY_TOKEN,a);return o};n._feedingDragStartHandler=function(t,i){var r=e(t.currentTarget);i.helper.data(n._KEY_ANALYSIS,r.data(n._KEY_ANALYSIS));i.helper.data(n._KEY_DRAGGABLE,r[0])};n.DRAGGABLE_CLASS_ANALYSIS="viz-controls-common-analysisDraggable";n._KEY_ANALYSIS="sap.viz.controls.reserved.draggableFeeding.analysisObject";n._KEY_BACKUPAOS="sap.viz.controls.reserved.draggableFeeding.backupAnalysisObjects";n._KEY_TOKEN="sap.viz.controls.reserved.draggableFeeding.analysisToken";n._KEY_DRAGGABLE="sap.viz.controls.reserved.draggableFeeding.domDraggable";n.prototype.getAnalysisToken=function(e){var t=e.data(n._KEY_TOKEN);if(t){return t}else{var r=e.data(n._KEY_ANALYSIS);if(r){t=new i(e[0],e.data(n._KEY_DRAGGABLE),r);e.data(n._KEY_TOKEN,t);return t}else{return null}}};return n});e("sap/viz/controls/common/utils/DatasetUtil",["sap/viz/controls/common/utils/Utils"],function(e){var t={};t.findAAIndex=function(e,t){for(var i=0;i<t.length;i++){if(t[i].feedId===e){var r=t[i].binding;for(var n=0;n<r.length;n++){var s=r[n];if(s.index!=null){return s.index}}}}return-1};t.getValue=function(e,i,r,n,s){var o=null;t._searchDimension(function(e,t,i){o=e.values[s]},e,i,r,n);return o};t.getInfoValue=function(e,i,r,n,s,o){var a;if(i&&i.length){a=t._getInfoValue(e,i,r,n,s,o)}return a};t._getInfoValue=function(e,i,r,n,s,o){for(var a=0;a<i.length;a++){var l=i[a];if(l.type!=="additionalData"){continue}var c=l.info;var p=null;t._searchDimension(function(e,t,i){p=c[i].infoValues[o]},e,r,n,s);return p}return null};t._searchDimension=function(e,t,i,r,n){var s=t.analysisAxis;var o=0;for(var a=0;a<s.length;a++){var l=s[a];if(i===l.index){for(var c=0;c<l.data.length;c++){var p=l.data[c];var h=isNaN(n)?p.name===r:n===c;if(h){e(p,c,o)}o++}}else{o+=l.data.length}}};t._hasNegativeValue=function(t){var i=false;for(var r=0;r<t.length;r++){if(e.isNumber(t[r])&&t[r]<0){i=true;break}}return i};var i={"viz/bubble":["bubbleWidth","bubbleHeight"],"viz/geobubble":["featureValues"],"viz/multi_geobubble":["featureValues"],"viz/multi_bubble":["bubbleWidth","bubbleHeight"]};t.hasNegativeMeasureValue=function(t,r){var n=e.clone(i[r]);if(!n||!t){return false}var s=t.data();if(!s){return false}var o=s.measureValuesGroup;if(!sap.viz.api.manifest.Viz.get(r)[0]){return}var a=sap.viz.api.manifest.Viz.get(r)[0].allFeeds(true);var l=[];for(var c=0;c<a.length;c++){if(n.length<=0){break}for(var p=0;p<n.length;p++){if(a[c].id===n[p]){l.push(a[c].mgIndex);n.splice(p,1);break}}}for(c=0;c<o.length;c++){var h=o[c];if(!h||!e.isArray(h.data)){continue}if(l.indexOf(o[c].index)<0){continue}for(p=0;p<h.data.length;p++){var d=h.data[p];if(!d||!e.isArray(d.values)){continue}for(var u=0;u<d.values.length;u++){var _=d.values[u];if(!e.isArray(_)){continue}if(this._hasNegativeValue(_)){return true}}}}return false};return t});e("sap/viz/controls/common/filter/FilterHelper",["jquery","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/DatasetUtil","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/filter/DateRangeFilter","sap/viz/controls/common/filter/NumericRangeFilter","sap/viz/controls/common/filter/ValueFilter"],function(e,t,i,r,n,s,o,a,l,c){var p={};p.getMapFilterItems=function(e,t,i,r){if(!e||e.length<1||!r||r.length<1){return i}var n=[];for(var s=0;s<e.length;++s){var o=e[s].layerIndex;var a=r[o];if(!a||a.length<1){continue}for(var l in e[s].data){if(!e[s].data.hasOwnProperty(l)){continue}var c=p._getAnalysisObject(l,a);if(!c){continue}var h=p.getFilterInfo(c);var d={value:e[s].data[l]};var u=false;for(var _=0;_<n.length;++_){if(n[_].filterInfo.id===h.id&&n[_].filterInfo.hierarchyLevelId===h.hierarchyLevelId){u=true;n[_].values.push(d);break}}if(!u){n.push({filterInfo:h,values:[d]})}}}var v=i.slice(0);for(var f=0;f<n.length;f++){var m=p._getFilter(v,n[f].filterInfo.id,n[f].filterInfo.hierarchyLevelId);if(m){v=p._updateFilterItem(v,m,n[f].values,t)}else{v=p._addFilterItem(v,n[f].filterInfo,n[f].values,t)}}return v};p._getAnalysisObject=function(e,t){for(var i=0;i<t.length;i++){if(t[i].type()!==n.DIMENSION){continue}var r=t[i].values();for(var s=0;s<r.length;s++){if(r[s].id()===e){return r[s]}}}return null};p.getFilterInfo=function(e){var t=e.name();var i=e.id();if(e.type()===r.HIERARCHY){var n=e.selectedHierarchyLevel();t=n.name();i=n.analysis().id();return{name:t,id:i,hierarchyLevelId:n.id(),hierarchyInfo:p._buildFilterHierarchyInfo(e)}}return{name:t,id:i}};p._buildFilterHierarchyInfo=function(e){var t=null;if(e.type()===r.HIERARCHY){t={hierarchyId:e.id(),levels:p._buildFilterHierarchyLevels(e.hierarchyLevels())}}return t};p.getFilterItems=function(e,t,o,a,l,c){if(!e||e.length===0){return o}var h=l.data();var d=l.info("additionalData");var u;var _=s.cloneFeeds(a);var v=false;for(u=0;u<c.length;u++){if(c[u].feedId===s.MultiplierFeedingName&&c[u].binding.length>0){v=true;break}}if(v){_=p._getFilterFeeds(_)}var f=[],m=[],g=[];for(u=0;u<_.length;u++){if(_[u].type()!==n.DIMENSION){continue}var E=i.findAAIndex(_[u].id(),c);var y=_[u].values();var I=0;for(var C=0;C<y.length;C++){f.push(p.getFilterInfo(y[C]));if(y[C].type()===r.MND){m.push(-1);g.push(-1)}else{m.push(E);g.push(I);I++}}}o=o.slice(0);var T={};for(u=0;u<f.length;u++){var A=f[u];var E=m[u];if(E<0){continue}if(!T[E]){T[E]=0}var P=p._pathsIndex(A.hierarchyInfo);var R=p._getAADataLength(h,E);if(P>0&&P<R){T[E]+=P}var z=p._getFilterValues(h,d,e,E,A.name,g[u]+T[E],A.hierarchyInfo);if(!z||z.length===0){continue}var O=p._getFilter(o,A.id,A.hierarchyLevelId);if(O){o=p._updateFilterItem(o,O,z,t)}else{o=p._addFilterItem(o,A,z,t)}}return o};p._getFilterFeeds=function(e){var t;var i=[];for(var r=e.length-1;r>=0;r--){if(e[r].id().indexOf(s.MultiplierFeedingName)===0){i=i.concat(e[r].values().reverse());t=e[r];e.splice(r,1)}}t.values(i.reverse());t._id=s.MultiplierFeedingName;e.push(t);return e};p._excludeFilterValues=function(e,t){var i=e.values().slice(0);var r,n;if(e.isExcluded()){for(r=0;r<t.length;r++){var s=false;for(n=0;n<i.length;n++){if(p._filterValueEquals(t[r],i[n])){s=true;break}}if(!s){i.push(t[r])}}}else{for(r=0;r<t.length;r++){for(n=0;n<i.length;n++){if(p._filterValueEquals(t[r],i[n])){i.splice(n,1);break}}}}e.updateValues(i)};p._updateFilterItem=function(e,t,i,r){if(r){p._excludeFilterValues(t,i)}else{t.isExcluded(r);t.updateValues(i)}if(t.isEmpty()){var n=e.indexOf(t);e.splice(n,1)}return e};p._getFilterValues=function(e,t,r,n,s,o,a){var l=[];for(var c in r){var h=r[c];var d=h.ctx[0]["dii_a"+n];var u=i.getValue(e,n,s,o,d);if(!u){continue}var _=i.getInfoValue(e,t,n,s,o,d);var v;v={value:u,infoValue:_};if(!p._isValueExisted(l,v)){l.push(v)}}return l};p._getAADataLength=function(e,t){var i=0;var r=e;var n=t-1;if(r&&r.analysisAxis&&r.analysisAxis[n]){var s=r.analysisAxis[n].data;if(s){i=s.length}}return i};p._pathsIndex=function(e){if(e&&e.levels){var t=e.levels;for(var i in t){if(t[i].selected===true){return Number(i)}}}return-1};p._addFilterItem=function(e,t,i,r){var n=new c(t.id,t.name);n.hierarchyLevelId=t.hierarchyLevelId;n.updateValues(i);n.isExcluded(r);e.push(n);return e};p._buildFilterHierarchyLevels=function(e){var t=[];if(e&&e.length>0){for(var i in e){var r={id:e[i].id(),name:e[i].name(),selected:e[i].selected()};t.push(r)}}return t};p._filterValueEquals=function(e,i){if(!e&&!i){return true}if(!e&&i||e&&!i){return false}if(e.value!==i.value){return false}if(e.infoValue===i.infoValue){return true}if(e.infoValue==null||i.infoValue==null){return true}if(t.isFunction(e.infoValue.equals)){return e.infoValue.equals(i.infoValue)}else if(e.infoValue.hasOwnProperty("key")){return e.infoValue.key===i.infoValue.key}else{return true}};p._isValueExisted=function(e,t){var i=t.value;var r=t.infoValue;var n=false;if(!e||e.length===0){return n}for(var s=0;s<e.length;s++){if(e[s]){n=p._filterValueEquals(e[s],t);if(n===true){break}}}return n};p._getFilter=function(e,t,i){var r=null;for(var n=0;n<e.length;n++){var s=e[n];if(!s.isGlobalFilter()&&s.id()===t&&s.hierarchyLevelId==i){r=s;break}}return r};p.isFilterItemExisted=function(e,t,i){var r=p._getFilter(e.filterItems(),t,i);if(r){return true}else{return false}};p.toJSON=function(e){return t.toJSON(e,function(e){return e.toJSON()})};p.fromJSON=function(e){return t.fromJSON(e,function(e){var t=e.filterType;var i;switch(t){case o.VALUE_TYPE:i=c.fromJSON(e);break;case o.NUMERIC_RANGE_TYPE:i=l.fromJSON(e);break;case o.DATE_RANGE_TYPE:i=a.fromJSON(e);break}return i})};return p});e("sap/viz/controls/services/FakeDataService",["sap/viz/controls/common/utils/FakeDataUtils"],function(e){var t=function(e,t,i){this._createChart(e,t,i)};t.feedItems2feed=function(t){return e.feedItems2feed(t)};t.prototype.getVizType=function(){return this._vizType};t.prototype.getVizDataset=function(){return this._vizDataset};t.prototype._createChart=function(t,i,r){this._vizType=t;var n=e.buildFakeData(t,r,i);this._vizDataset=n.dataset;this._vizFeeding=n.feeding};return t});e("sap/viz/controls/common/utils/IncompleteGhost",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/services/FakeDataService"],function(e,t,i){var r={};r.getDataset=function(n){if(!sap.viz.api.manifest.Viz.get(n)[0]){var s=new sap.viz.api.data.CrosstableDataset;return s}else if(!t.isBuildInType(n)&&n!==e.TYPE_PC&&n!==e.TYPE_FUNNEL&&!t.isTable(n)){var o=new i(n,{},[]);var s=new sap.viz.api.data.CrosstableDataset;var a=o.getVizDataset();s.data(a);return s}else{var a=r._DATA_BY_TYPE[n]?r._DATA_BY_TYPE[n]:r._DATA_COMMON;if(t.isTable(n)){return a}else{var s=new sap.viz.api.data.CrosstableDataset;s.data(a);return s}}};r._DATA_COMMON={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1","Country 2","Country 3","Country 4","Country 5","Country 6","Country 7","Country 8","Country 9"]}]},{index:2,data:[{isFake:true,type:"Dimension",name:"Product",values:["Product 1","Product 2","Product 3","Product 4"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{index:2,data:[{isFake:true,type:"Measure",name:"Cost",values:[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{index:3,data:[{isFake:true,type:"Measure",name:"Margin",values:[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};r._DATA_BY_TYPE={};r._DATA_BY_TYPE[e.TYPE_NUMBER]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[null]]}]}]};r._DATA_BY_TYPE[e.TYPE_COMBINATION]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1","Country 2","Country 3","Country 4","Country 5","Country 6","Country 7","Country 8","Country 9"]}]},{index:2,data:[{isFake:true,type:"Dimension",name:"Product",values:["Product 1","Product 2","Product 3","Product 4"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]},{isFake:true,type:"Measure",name:"Cost",values:[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]}]};r._DATA_BY_TYPE[e.TYPE_GEO_BUBBLE]=r._DATA_BY_TYPE[e.TYPE_GEO_CHOROPLETH]=r._DATA_BY_TYPE[e.TYPE_GEO_PIE]=r._DATA_BY_TYPE[e.TYPE_GEO_MAP]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Region",values:["United Kingdom","Italy","United States","New Zealand","Germany","China","Russia","Canada","Brazil"],infos:[{featureId:"UK,NAVTEQ",latLong:undefined},{featureId:"20110484,NAVTEQ",latLong:undefined},{featureId:"21000001,NAVTEQ",latLong:undefined},{featureId:"23060936,NAVTEQ",latLong:undefined},{featureId:"20147700,NAVTEQ",latLong:undefined},{featureId:"22928332,NAVTEQ",latLong:undefined},{featureId:"20485579,NAVTEQ",latLong:undefined},{featureId:"21041602,NAVTEQ",latLong:undefined},{featureId:"23028911,NAVTEQ",latLong:undefined}]}]},{index:2,data:[{isFake:true,type:"Dimension",name:"Product",values:["Product 1","Product 2","Product 3","Product 4"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[98,113,105,29,53,31,48,51,58],[87,103,27,61,28,74,50,32,65],[148,109,91,43,114,50,35,76,75],[71,102,80,29,43,101,69,38,58]]}]},{index:2,data:[{isFake:true,type:"Measure",name:"Cost",values:[[32,78,91,45,110,55,39,26,50],[86,108,27,50,17,28,89,116,123],[83,28,58,100,86,59,66,87,63],[39,100,88,18,85,96,72,37,59]]}]},{index:3,data:[{isFake:true,type:"Measure",name:"Margin",values:[[46,58,90,5,10,4,79,86,30],[56,98,20,20,7,58,39,16,23],[103,98,78,40,76,29,16,59,43],[59,80,98,8,45,16,120,97,39]]}]}]};r._DATA_BY_TYPE[e.TYPE_SCATTER_MATRIX]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1","Country 1","Country 2","Country 2"]},{isFake:true,type:"Dimension",name:"Product",values:["Product 1","Product 2","Product 3","Product 4"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[43,31,43,41]]},{isFake:true,type:"Measure",name:"Cost",values:[[252,124,370,170]]}]}]};r._DATA_BY_TYPE[e.TYPE_TREE]=r._DATA_BY_TYPE[e.TYPE_NETWORK]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1","Country 2","Country 3","Country 4","Country 1","Country 2","Country 3","Country 4","Country 1","Country 2","Country 3","Country 4","Country 1","Country 2","Country 3","Country 4"]},{isFake:true,type:"Dimension",name:"Product",values:["Product 1","Product 1","Product 1","Product 1","Product 2","Product 2","Product 2","Product 2","Product 3","Product 3","Product 3","Product 3","Product 4","Product 4","Product 4","Product 4"]}]}],measureValuesGroup:[]};r._DATA_BY_TYPE[e.TYPE_PC]={analysisAxis:[{index:1,data:[{isFake:true,type:"Dimension",name:"Country",values:["Country 1","Country 1","Country 1","Country 2","Country 2","Country 3","Country 4","Country 4","Country 4","Country 5","Country 6","Country 7","Country 8","Country 9","Country 9"]}]}],measureValuesGroup:[{index:1,data:[{isFake:true,type:"Measure",name:"Revenue",values:[[5.1,4.9,4.7,4.6,5,7,6.4,6.9,5.5,6.5,6.3,5.8,7.1,6.3,6.5]]},{isFake:true,type:"Measure",name:"Cost",values:[[3.1,8.9,2.7,6.6,5,5,6.6,6.9,7.5,2.5,2.3,5.8,8.1,1.3,2.5]]}]}]};r._DATA_BY_TYPE[e.TYPE_TABLE]=r._DATA_BY_TYPE[e.TYPE_CROSSTAB]={isFake:true,queryResponse:[{dimAxes:{rowsDim:{count:0,values:[]}},metadata:{dictionary:{rowsDim:[],measures:[]}},valueAxes:[],ranges:{cellsDim:[{marksNum:[]}]},executionStatus:{status:"ok"}},{valueAxes:[],executionStatus:{status:"ok"}}]};return r});e("sap/viz/controls/common/utils/Serialization",["sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/utils/IncompleteGhost","sap/viz/controls/common/managers/LangManager","sap/viz/controls/Version","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/InfoChartUtil"],function(e,t,i,r,n,s,o,a,l,c,p,h,d){var u={};u.TypeConst={FlatTableDataset:"FlatTable",CrosstableDataset:"Crosstable",RawDataset:"JSON"};u.migrate=function(e){var t=n.clone(e);var i;var r=t["version"];if(r==="1.0"){var s=u.migrateVizFrame(t);t={};t["vizFrame"]=s}else{var s=t["vizFrame"];if(s){t["vizFrame"]=u.migrateVizFrame(s)}if(t["vizBuilder"]){var o=t["vizBuilder"]["feedingPanel"];if(o){t["vizBuilder"]["feedingPanel"]=u.migrateFeedingPanel(o)}}}return t};u.migrateVizFrame=function(e){var t=n.clone(e);var i=t["version"];if(i==="1.0"){var r={chart:{}};if(t["chart"]){var s=t["chart"]["vizModel"];if(s){r["chart"]["type"]=s["vizType"];r["chart"]["feedingItems"]=s["feedingItems"];r["filterBar"]={};r["filterBar"]["filterItems"]=s["filterItems"];r["contextMenu"]={};r["contextMenu"]["isMNDVisible"]=s["isMNDVisible"]}var o=t["chart"]["vizInstance"];if(o){r["chart"]["vizInstance"]=o}}var a=t["comments"];if(a){r["annotation"]=a}r["version"]=c.VERSION;t=r}if(t["chart"]){var l=t["chart"]["type"];var p=t["contextMenu"]?t["contextMenu"]["isMNDVisible"]:null;u._migrateFeeds(t["chart"],l,p)}return t};u.migrateFeedingPanel=function(e){var t=n.clone(e);var i=t.type;var r=t["mndVisible"];u._migrateFeeds(t,i,r);return t};u._migrateFeeds=function(e,t,i){if(i===false){var r=u._getFeedsFromInnerControl(e);if(h.isGeo(t)){for(var n=0;n<r.length;n++){r=p.removeMND(r[n])}}else{r=p.removeMND(r)}u._updateFeedsToInnerControl(e,r)}};u.getFeeds=function(t){var i=null;var r=u._getValue(t,["vizFrame","chart","feedingItems"]);var n=u._getValue(t,["vizBuilder","feedingPanel","feedingItems"]);var s;if(r){i=r;var o=u._getValue(t,["vizFrame","contextMenu"]);if(o){s=o.isMNDVisible}}else if(n){i=n;var a=u._getValue(t,["vizBuilder","feedingPanel"]);if(a){s=a.mndVisible}}if(i==null){return[]}var l=e.fromJSON(i);if(s===false){l=p.removeMND(l)}return l};u._getFeedsFromInnerControl=function(t){var i=null;var r=u._getValue(t,["feedingItems"]);if(r){i=r}if(i==null){return[]}var n=e.fromJSON(i);return n};u.updateFeeds=function(t,i){var r=e.toJSON(i);u._setValue(t,["vizFrame","chart","feedingItems"],r);u._setValue(t,["vizBuilder","feedingPanel","feedingItems"],r);return t};u._updateFeedsToInnerControl=function(t,i){var r=e.toJSON(i);u._setValue(t,["feedingItems"],r);return t};u.getFilters=function(e){var t=u._getValue(e,["vizFrame","filterBar","filterItems"]);if(t==null){return[]}var i=r.fromJSON(t);return i};u.updateFilters=function(e,t){var i=r.toJSON(t);u._setValue(e,["vizFrame","filterBar","filterItems"],i);return e};u.removeDataset=function(e){var t=u._getValue(e,["vizFrame","chart","vizInstance"]);if(t){delete t["data"]}return e};u.emptyDataset=function(e){var t=u._getValue(e,["vizFrame","chart","vizInstance","data"]);if(t){u._emptyDataset(t)}var i=u._getValue(e,["vizFrame","playControl","slicedData"]);if(i){i.measuresInfo=[];i.slices=[]}return e};u._emptyDataset=function(e){if(!e){return}if(e instanceof Array){for(var t=0;t<e.length;t++){u._emptyDataset(e[t])}}else{var i=e["type"];var r=e["val"];var n={};var s={};if(i===u.TypeConst.CrosstableDataset){n=new sap.viz.api.data.CrosstableDataset;n.data(r);s=n.toJSON({emptyDataset:true}).data}else if(i===u.TypeConst.FlatTableDataset){n=new sap.viz.api.data.FlatTableDataset(feedData);s=n.toJSON({emptyDataset:true}).data}else if(i===u.TypeConst.RawDataset){s={}}else{throw l.get("VIZ_COMMON_SERIALIZATION_FAILED")+l.get("VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE")}e["val"]=s}};u.updateDataset=function(e,t){var i=u._getValue(e,["vizFrame","chart","vizInstance"]);if(i){i["data"]={};if(d.isInfoChart(i.type)&&t instanceof sap.viz.api.data.CrosstableDataset){t=d.buildInfoDataset(t)}u._updateDataset(i["data"],t)}return e};u._updateDataset=function(e,t){if(!e||!t){return}if(t instanceof Array){for(var i=0;i<t.length;i++){var r=t[i];u._updateDataset(e[i],r)}}else if(t instanceof sap.viz.api.data.CrosstableDataset){e["type"]=u.TypeConst.CrosstableDataset;e["val"]=t.data()}else if(t instanceof sap.viz.api.data.FlatTableDataset){e["type"]=u.TypeConst.FlatTableDataset;e["val"]=t.data()}else{e["type"]=u.TypeConst.RawDataset;e["val"]=t}};u.convertToVizSerialization=function(e){var t=u._getValue(e,["vizFrame","vizInstance"]);if(t){return n.clone(t)}return null};u.updateProperties=function(e,t){u._setValue(e,["vizFrame","chart","vizInstance","properties"],t);return e};u.getProperties=function(e){var t=u._getValue(e,["vizFrame","chart","vizInstance","properties"]);return t||{}};u.updateAnalysisObjectLabels=function(e,t){if(!t){return e}var r=u.getFeeds(e)||[];var n=u.getFilters(e)||[];var s=u._getSliceDimension(e);function o(e){var t={};e.forEach(function(e){if(e){t[e.id()]=e}});return t}function a(e){var t={};var i=e.slice();while(i.length){var r=i.shift();if(r){var n=r.hierarchyLevels()||[];t[r.id()]={ao:r,hlHash:o(n)};i=i.concat(n.map(function(e){return e._analysis}))}}return t}var l=a(t);r.forEach(function(e){var t=e.values();if(t){var i=a(t);for(var r in i){var n=i[r];var s=l[r];if(s){n.ao.name(s.ao.name());for(var o in n.hlHash){var c=n.hlHash[o];var p=s.hlHash[o];if(p){c._name=p.name()}}}}}});n.forEach(function(e){if(e){var r=e.getType();if(r===i.NUMERIC_RANGE_TYPE||r===i.DATE_RANGE_TYPE||r===i.VALUE_TYPE&&!e.hierarchyLevelId){var n=l[e.getFilteredObjectId()];if(n){e.filteredObjectName=n.ao.name()}}else if(r===i.VALUE_TYPE&&e.hierarchyLevelId){for(var s=0;s<t.length;s++){var o=t[s].hierarchyLevels();if(o){for(var a=0;a<o.length;a++){var c=o[a];if(c&&c.id()===e.hierarchyLevelId){e.filteredObjectName=c.name();break}}}}}}});if(s){var c=l[s.id()];if(c){s.name(c.ao.name());var p=o(s.hierarchyLevels()||[]);for(var h in p){var d=p[h];var _=c.hlHash[h];if(_){d._name=_.name();if(d._analysis&&_._analysis&&d._analysis.id()===_._analysis.id()){d._analysis.name(_._analysis.name())}}}}}u.updateFeeds(e,r);u.updateFilters(e,n);u._updateSliceDimension(e,s);return e};u.defaultIncompletePackage=function(e){var t=o.defaultUIConfig(o.DEFAULT_UICONFIG_TYPE_CHART);var i;if(e){var r=h.getChartId(e);if(t&&t.hasOwnProperty("specificProperties")){i=n.updateJSON(t.defaultProperties,t.specificProperties[r])}else{i=t?t.defaultProperties:{}}i=s.convertProperties(i,h.getVizType(e),e)}else{i={}}var l=a.getDataset(e);var p;if(h.isTable(e)){p={type:u.TypeConst.RawDataset,val:l}}else{p={type:u.TypeConst.CrosstableDataset,val:l.data()}}return{vizFrame:{version:c.VERSION,chart:{vizInstance:{data:p,properties:i,type:e},vizTitleMode:"auto"},contextMenu:{}}}};u.updateCustomData=function(e,t){u._setValue(e,["customData"],t);return e};u.getCustomData=function(e){return u._getValue(e,["customData"])||{}};u.updateControlSettings=function(e,t,i,r){var n=u._getValue(e,["vizFrame","chart","type"]);if(h.supportAnimation(n)&&t==="playControl"){if(i==="slicedData"){u._updateSlicedData(e,r)}else if(i==="sliceDimension"){u._updateSliceDimension(e,r)}else if(i==="value"){u._setValue(e,["vizFrame","playControl","value"],r)}}};u.getControlSettings=function(e,t,i){if(t==="playControl"){if(i==="slicedData"){return u._getSlicedData(e)}else if(i==="sliceDimension"){return u._getSliceDimension(e)}if(i==="value"){return u._getValue(e,["vizFrame","playControl","value"])}}else{return null}};u.getChartType=function(e){return u._getValue(e,["vizFrame","chart","type"])};u.updateCss=function(e,t){u._setValue(e,["vizFrame","chart","vizInstance","css"],t);return e};u._updateSliceDimension=function(e,i){if(n.isArray(i)){return}var r=t.toJSON(i);u._setValue(e,["vizFrame","playControl","sliceDimension"],r)};u._getSliceDimension=function(e){var i=u._getValue(e,["vizFrame","playControl","sliceDimension"]);if(i){return t.fromJSON(i)}else{return null}};u._updateSlicedData=function(e,t){var i={};i.measuresInfo=t.measuresInfo;if(n.isArray(t.slices)){i.slices=[];for(var r=0;r<t.slices.length;r++){i.slices.push({data:t.slices[r].data.toJSON(),dimensionMember:t.slices[r].dimensionMember})}}u._setValue(e,["vizFrame","playControl","slicedData"],i)};u._getSlicedData=function(e){var t=u._getValue(e,["vizFrame","playControl","slicedData"]);if(t){var i={};i.measuresInfo=t.measuresInfo;i.slices=[];var r=t.slices;if(r){for(var n=0;n<r.length;n++){var s=r[n];i.slices.push({data:sap.viz.api.data.CrosstableDataset.fromJSON(s.data),dimensionMemeber:s.dimensionMemeber})}}return i}else{return null}};u._getValue=function(e,t){if(!e||!t||!t.length){return null}var i=e;for(var r=0;r<t.length;r++){if(!i[t[r]]){return null}i=i[t[r]]}return i};u._setValue=function(e,t,i){if(!e||!t||!t.length){return null}var r=e;for(var n=0;n<t.length-1;n++){if(!r[t[n]]){return}r=r[t[n]]}var s=t[t.length-1];r[s]=i};return u});e("sap/viz/controls/common/views/menu/MenuItem",["require","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/JsonUtil"],function(e,t,i){var r=e||r;var n=function(e,t,i){this.__className="sap.viz.controls.common.views.menu.MenuItem";this._id=e;this._name=t;this._enabled=true;this._selected=false;this._subMenuGroups=i};n.prototype.id=function(){return this._id};n.prototype.name=function(){return this._name};n.prototype.icon=function(){return this._icon};n.prototype.subMenuGroups=function(){return this._subMenuGroups};n.prototype.enabled=function(e){if(arguments.length>0){this._enabled=e;return this}else{return this._enabled}};n.prototype.selected=function(e){if(arguments.length>0){this._selected=e;return this}else{return this._selected}};n.prototype.equal=function(e){if(e==undefined){return false}if(this.id()!==e.id()){return false}if(this.name()!==e.name()){return false}if(this.enabled()!==e.enabled()){return false}if(this.selected()!==e.selected()){return false}var t=this.subMenuGroups()||[];var i=e.subMenuGroups()||[];if(t.length!==i.length){return false}for(var r=0;r<t.length;r++){var n=t[r];var s=i[r];if(!(n==undefined&&s==undefined)){if(n==undefined){return false}if(!n.equal(s)){return false}}}return true};n.toJSON=function(e){return t.toJSON(e,function(e){return{id:e._id,name:e._name,subMenuGroups:i.toJSON(i.MenuGroupType,e._subMenuGroups),enabled:e._enabled,selected:e._selected}})};n.fromJSON=function(e){return t.fromJSON(e,function(e){var t=new n(e.id,e.name,i.fromJSON(i.MenuGroupType,e.subMenuGroups));t.enabled(e.enabled);t.selected(e.selected);return t})};i.register(i.MenuItemType,n.fromJSON,n.toJSON);return n});e("sap/viz/controls/common/events/Event",[],function(){var e=function(e,t,i){this.__className="sap.viz.controls.common.events.Event";this._type=e;this._target=t;this.data=i};e.prototype.type=function(){return this._type};e.prototype.target=function(){return this._target};return e});e("sap/viz/controls/common/events/FeedEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.events.FeedEvent"};e.extend(i,t);i.FEED_READY="feedReady";i.REQUEST_FEED="requestFeed";i.FEEDS_CHANGED="feedsChanged";return i});e("sap/viz/controls/runtime/Runtime",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher"],function(e,t,i){var r=function(){this._models={};this._modelRefs={}};e.extend(r,i);r.prototype.registerModel=function(e,t){this._models[e]=t;this._modelRefs[e]=1};r.prototype.addModelRef=function(e){this._modelRefs[e]++};r.prototype.removeModelRef=function(e){this._modelRefs[e]--;if(this._modelRefs[e]===0){this._models[e]=null}};r.prototype.getModel=function(e){return this._models[e]};return r});e("sap/viz/controls/runtime/RuntimeManager",["sap/viz/controls/runtime/Runtime"],function(e){var t=null;var i={};i.getRuntime=function(){if(t===null){t=new e}return t};return i});e("sap/viz/controls/common/services/BVRService",["sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/Utils"],function(e,t,i,r){var n={};n.VERSION="1.0";n.switchFeeds=function(n,s,o){if(!t.needAutoFeeding(o,s,n)){return{vizType:n,feeds:o}}if(n&&e.isEmptyFeeds(o)){var a=e.buildEmptyFeeds(n);if(!a.length){}return{vizType:n,feeds:a}}var l;if(i.toSingleChartType(r.clone(n))===i.toSingleChartType(r.clone(s))){l=t.directFeeding(o,n)}else{l=t.smartFeeding(o,n)}return{vizType:n,feeds:l}};n.suggestFeeds=function(e,i,r,n){var s,o,a;if(arguments.length===2){s=[];o=i}else if(arguments.length>=3){s=i;o=r;a=n}return{vizType:e,feeds:t.smartFeeding(s,e,o,a)}};n.suggestChartWithFeeds=function(e){};return n});e("sap/viz/controls/common/helpers/MapLayers",["sap/viz/controls/common/utils/Utils"],function(e){var t={};t.toJSON=function(t){return e.toJSON(t,function(e){return e})};t.fromJSON=function(t){return e.fromJSON(t,function(e){return e})};return t});e("sap/viz/controls/runtime/ModelHandler",["sap/viz/controls/common/utils/ChartTypeUtil"],function(e){var t=function(e){this.__className="sap.viz.controls.runtime.ModelHandler";this._vizModel=e;this._isMNDVisibleChanged=false;this._feedingItemsChanged=false};t.prototype._type=function(e){if(arguments.length>0){this._vizModel._type=e;return this}else{return this._vizModel._type}};t.prototype._feedingItems=function(e){if(arguments.length>0){this._vizModel._feedingItems=e;return this}else{return this._vizModel._feedingItems}};t.prototype._filterItems=function(e){if(arguments.length>0){this._vizModel._filterItems=e;return this}else{return this._vizModel._filterItems}};t.prototype.explicitFeedingItems=function(e){return this._vizModel.feedingItems()};t.prototype.deactive=function(){};t.prototype.postLoad=function(){};t.prototype.feedingItemsChanged=function(e,t){};t.prototype.isMNDVisibleChanged=function(e){};t.prototype._setIsMNDVisible=function(e){};t.prototype.vizModelChanged=function(e){};t.prototype._restorePlayerFieldHistory=function(t){if(!e.supportAnimation(t)){var i=this._vizModel.playerField()?this._vizModel.playerField().clone():null;this._vizModel.playerField(null);if(i){this._vizModel._playerFieldHistory=i}}else{if(!this._vizModel.playerField()){this._vizModel.playerField(this._vizModel._playerFieldHistory)}}};t.prototype.propertiesChanged=function(e,t){};t.prototype.getFilterItems=function(e,t,i,r){};t.prototype.cloneFeeds=function(e){};t.prototype.clone=function(e){};return t});e("sap/viz/controls/runtime/InfoModelHandler",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/helpers/MapLayers","sap/viz/controls/common/services/BVRService","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/runtime/ModelHandler"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f){var m=function(e){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.InfoModelHandler"};e.extend(m,f);m.prototype.feedingItemsChanged=function(e,t){this._feedingItems(e||[])};m.prototype.vizModelChanged=function(e){var t=false;var i=this._type();if(e.type){this._type(e.type)}var r=this._type();if(r!==i){this._restorePlayerFieldHistory(r)}var t=false;if(e.feedingItems){t=true;this._feedingItems(e.feedingItems)}var n=false;if(e.filterItems){this._filterItems(e.filterItems);n=true}var s={vizTypeChanged:i!==r,feedingItemsChanged:this._feedingItemsChanged||t,filterChanged:n};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(s)};m.prototype.propertiesChanged=function(e,t){var i=this._type();if(!i){return}var r={vizTypeChanged:t};if(r.vizTypeChanged){this._restorePlayerFieldHistory(e)}this._vizModel.dispatchPropertiesChangedEvent(r)};m.prototype.getFilterItems=function(e,t,i,r){return v.getFilterItems(e,t,this._filterItems(),this._feedingItems(),i,r)};m.prototype.clone=function(e){var t=e;t._type=this._type();var i=this._feedingItems();if(i&&i.length>0){for(var r=0;r<i.length;r++){t._feedingItems[r]=i[r].clone()}}var n=this._filterItems();if(n&&n.length>0){for(var s=0;s<n.length;s++){t._filterItems[s]=n[s].clone()}}return t};return m});e("sap/viz/controls/runtime/MapModelHandler",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/helpers/MapLayers","sap/viz/controls/common/services/BVRService","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/runtime/ModelHandler"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f){var m=function(e){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.MapModelHandler"};e.extend(m,f);m.prototype.feedingItemsChanged=function(e,t){if(t!==false){var i=[];var r=this._feedingItems();for(var n=0;n<e.length;n++){if(r[n]!==e[n]){if(r[n]&&e[n]&&p.equal(r[n],e[n])){continue}else{i.push(n)}}}this._feedingItems(e);if(i.length>0){this._vizModel._feedingItemsHistory=null;var s={feedingItemsChanged:true,feedsChangedInfo:{items:i}};this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(s)}}else{this._feedingItems(e)}};m.prototype.isMNDVisibleChanged=function(e){this._vizModel._feedingItemsHistory=null};m.prototype._setIsMNDVisible=function(e){if(this._vizModel.isMNDVisible()!==e){this._vizModel._isMNDVisible=e;this._isMNDVisibleChanged=true}};m.prototype.vizModelChanged=function(e){var t=false;var i=this._type();if(e.type){this._type(e.type)}var r=this._type();if(r!==i){this._restorePlayerFieldHistory(r)}if(e.feedingItems){var n=this._feedingItems();if(n.length!=e.feedingItems.length){t=true}else{for(var s=0;s<n.length;s++){if(!p.equal(n[s],e.feedingItems[s])){t=true;break}}}if(t){this._vizModel._feedingItemsHistory=null;this._feedingItems(e.feedingItems);this._vizModel.extensionValues({map:{feeding:e.feedingItems}})}}var o=false;if(e.filterItems){this._filterItems(e.filterItems);o=true}var a={vizTypeChanged:i!==r,feedingItemsChanged:this._feedingItemsChanged||t,filterChanged:o};this._type(r);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(a)};m.prototype.propertiesChanged=function(e,t){var i=this._type();if(!i){return}var r=i;var n={vizTypeChanged:t||i!==e};this._type(r);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(n.vizTypeChanged){this._restorePlayerFieldHistory(r)}this._vizModel.dispatchPropertiesChangedEvent(n)};m.prototype.getFilterItems=function(e,t,i,r){return v.getMapFilterItems(e,t,this._filterItems(),this._feedingItems())};m.prototype.clone=function(e){var t=e;t._type=this._type();var i=this._feedingItems();if(i&&i.length>0){for(var r=0;r<i.length;r++){t._feedingItems[r]=[];for(var n=0;n<i[r].length;n++){t._feedingItems[r][n]=i[r][n].clone()}}}var s=this._filterItems();if(s&&s.length>0){for(var o=0;o<s.length;o++){t._filterItems[o]=s[o].clone()}}return t};return m});e("sap/viz/controls/runtime/VizModelHandler",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/helpers/MapLayers","sap/viz/controls/common/services/BVRService","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/runtime/ModelHandler"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f){var m=function(e){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModelHandler"};e.extend(m,f);m.prototype.explicitFeedingItems=function(e){e=e||{};var t=this._feedingItems();var i=this._type();if(!_.isMultipleChart(i)){t=p.removeRowAndColumnFeedItems(t)}var r=e.withMND!=null?e.withMND===true:this._vizModel.isMNDVisible();if(!r){t=p.removeMND(t)}var n=p.buildEmptyFeeds(i);t=p.merge(n,t);return t};m.prototype.deactive=function(){this._vizModel._feedingItemsHistory=p.cloneFeeds(this._feedingItems());this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null};m.prototype.postLoad=function(){var e=this._feedingItems();this._vizModel._feedingItemsHistory=p.cloneFeeds(e);this._vizModel._playerFieldHistory=this._vizModel.playerField()?this._vizModel.playerField().clone():null;var t=this._type();var i=p.hasMND(e);this._vizModel._isMNDVisible=i;if(!i){var r=I(t,e,i);this._feedingItems(r.feeds)}};m.prototype.feedingItemsChanged=function(e,t){var i=this._vizModel.extensionValues();t=i.feedingPanel?i.feedingPanel.enableTrellis:t;if(t===false){e=p.removeRowAndColumnFeedItems(e)}this._setIsMNDVisible(p.hasMND(e));this._feedingItemsChanged=!p.equal(e,this._feedingItems());if(this._feedingItemsChanged){this._feedingItems(e||[]);this._vizModel._feedingItemsHistory=null;var r=p.hasRowOrColumn(this._feedingItems());var n=this._type();var s;if(r&&!_.isMultipleChart(n)){s=_.toMultiChartType(n);this._vizModel.type(s)}else if(!r&&_.isMultipleChart(n)){s=_.toSingleChartType(n);this._vizModel.type(s)}else{this.propertiesChanged(n,false)}this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null}};m.prototype.isMNDVisibleChanged=function(e){this._isMNDVisibleChanged=true;this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null;this.propertiesChanged(this._type(),false);this._vizModel._feedingItemsHistory=null;this._vizModel._playerFieldHistory=null};m.prototype._setIsMNDVisible=function(e){var t=e===true;if(this._vizModel.isMNDVisible()!==t){this._vizModel._isMNDVisible=t;this._isMNDVisibleChanged=true}};m.prototype.vizModelChanged=function(e){var t=false;if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=p.cloneFeeds(this._feedingItems())}var i=this._vizModel.isMNDVisible();var r=this._type();if(e.type){this._type(e.type)}var n=this._type();if(n!==r){this._restorePlayerFieldHistory(n)}var s;if(e.feedingItems){if(p.supportMND(n)){i=p.hasMND(e.feedingItems);this._setIsMNDVisible(i)}if(p.match(n,e.feedingItems,false)){s=I(n,e.feedingItems,i);n=s.vizType;e.feedingItems=s.feeds}t=!p.equal(this._feedingItems(),e.feedingItems);if(t){this._feedingItems(e.feedingItems);this._vizModel._feedingItemsHistory=p.cloneFeeds(e.feedingItems)}}var o=this._vizModel._feedingItemsHistory;i=this._vizModel.isMNDVisible();n=y(n,o,i);if(!t){var a;if(n!==r){a=d.switchFeeds(n,r,o).feeds;s=I(n,a,i);n=s.vizType;a=s.feeds}if(a){this._feedingItems(a);if(p.isEmptyFeeds(this._feedingItems())&&p.isEmptyFeeds(a)){t=false}else{t=!p.isFeedDefinitionEqual(r,n)||!p.equal(this._feedingItems(),a)}}}var l=false;if(e.filterItems){this._filterItems(e.filterItems);l=true}var c={vizTypeChanged:r!==n,feedingItemsChanged:this._feedingItemsChanged||t,filterChanged:l};this._type(n);this._feedingItemsChanged=false;this._vizModel.dispatchPropertiesChangedEvent(c)};m.prototype.propertiesChanged=function(e,t){var i=this._type();if(!i){return}var r=this._feedingItems();if(!this._vizModel._feedingItemsHistory){this._vizModel._feedingItemsHistory=p.cloneFeeds(r)}if(e!=="viz/number"){this._saveSubtotals(r,this._vizModel)}var n=i;var s=e;var o=this._vizModel._feedingItemsHistory;var a=this._vizModel.isMNDVisible();n=y(n,o,a);var l;if(p.match(n,o,false)){l=I(n,o,a);n=l.vizType;o=l.feeds}var c=d.switchFeeds(n,s,o).feeds;l=I(n,c,a);n=l.vizType;c=l.feeds;var h=true;if(p.isEmptyFeeds(r)&&p.isEmptyFeeds(c)){h=false}else{h=!p.isFeedDefinitionEqual(s,n)||!p.equal(r,c)}var u={vizTypeChanged:t||s!==n,feedingItemsChanged:this._feedingItemsChanged||h,isMNDVisibleChanged:this._isMNDVisibleChanged};this._type(n);this._feedingItems(c);this._feedingItemsChanged=false;this._isMNDVisibleChanged=false;if(u.vizTypeChanged){this._restorePlayerFieldHistory(n)}this._vizModel.dispatchPropertiesChangedEvent(u)};m.prototype._saveSubtotals=function(e,t){var i=[];var r=false;var n=false;for(var s=0;s<e.length;s++){if(e[s].type()==="calculation"){t.savedSubtotals(e[s])}if(t.savedSubtotals()!==null&&e[s].type()==="Dimension"){r=true;for(var o=0;o<e[s].values().length;o++){for(var a=0;a<t.savedSubtotals().values().length;a++){if(e[s].values()[o].id()===t.savedSubtotals().values()[a].aggregationTarget()){i.push(t.savedSubtotals().values()[a]);n=true}}}}}if((r===false||n===false)&&t.savedSubtotals()!==null){t.savedSubtotals().values([])}if(t.savedSubtotals()!==null&&i[0]){t.savedSubtotals().values(i);var l=false;for(var s=0;s<t.feedingItemsHistory().length;s++){if(t.feedingItemsHistory()[s].type()==="calculation"){var c=t.savedSubtotals();t.feedingItemsHistory()[s]=c;l=true}}if(l===false){t.feedingItemsHistory().push(t.savedSubtotals())}}};m.prototype.getFilterItems=function(e,t,i,r){return v.getFilterItems(e,t,this._filterItems(),this._feedingItems(),i,r)};m.prototype.clone=function(e){var t=e;t._type=this._type();var i=this._feedingItems();if(i&&i.length>0){for(var r=0;r<i.length;r++){t._feedingItems[r]=i[r].clone()}}var n=this._filterItems();if(n&&n.length>0){for(var s=0;s<n.length;s++){t._filterItems[s]=n[s].clone()}}return t};function g(e,t){var i=_;if(i.supportMultiChart(e)){if(p.hasRowOrColumn(t)){return i.toMultiChartType(e)}else{return i.toSingleChartType(e)}}else{return e}}function E(e){var t=_;if(t.supportMultiChart(e)){var i=t.toMultiChartType(e);if(e!==i&&!p.supportMND(e)&&p.supportMND(i)){return i}else{return e}}else{return e}}function y(e,t,i){var r=g(e,t);if(i){r=E(r)}return r}function I(e,t,i){if(i){e=E(e);if(!p.hasMND(t)){t=a.directFeeding(t,e,[s.genMND()])}}else{t=p.removeMND(t);e=g(e,t);if(!p.isEmptyFeeds(t)){if(!p.meetMinDimensions(e,t)){t=a.directFeeding(t,e,[s.genMND()])}}}if(p.countAnalyses(t,o.MEASURE)===0){t=p.removeMND(t)}e=g(e,t);return{vizType:e,feeds:t}}return m});e("sap/viz/controls/runtime/VizModel",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/services/BVRService","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/runtime/InfoModelHandler","sap/viz/controls/runtime/MapModelHandler","sap/viz/controls/runtime/VizModelHandler"],function(e,t,i,r,n,s,o,a,l,c){var p=function(){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizModel";this._type=null;this._isMNDVisible=false;this._feedingItems=[];this._feedingItemsHistory=null;this._savedSubtotals=null;this._filterItems=[];this._playerFieldHistory=null;this._playerField=null;this._extensionValues={};this._handler=this._vizModelHandler=new c(this)};e.extend(p,r);p.PropertiesChangedEvent="propertiesChangedEvent";p.prototype._updateHandler=function(e){var t=this._vizModelHandler;if(n.TYPE_GEO_MAP===e){if(!this._mapModelHandler){this._mapModelHandler=new l(this)}t=this._mapModelHandler}else if(o.isInfoChart(e)){if(!this._infoModelHandler){this._infoModelHandler=new a(this)}t=this._infoModelHandler}if(t!==this._handler){this._handler.deactive();this._handler=t;this._feedingItems=[]}};p.prototype.load=function(e){if(!e){return}var t=false;var i=false;var r=false;if(e.type&&e.type!==this._type){this._type=e.type;this._updateHandler(this._type);t=true}if(e.feedingItems){this._feedingItems=e.feedingItems;i=true}else{this._feedingItems=[]}var n=this._isMNDVisible;this._handler.postLoad();r=n!==this._isMNDVisible;if(t||i){var s={vizTypeChanged:t,isMNDVisibleChanged:r,feedingItemsChanged:i};this.dispatchPropertiesChangedEvent(s)}};p.prototype.filterItems=function(e){if(arguments.length>0){this._filterItems=e;var t={filterChanged:true};var r=new i(p.PropertiesChangedEvent,this,t);this._dispatchEvent(r);return this}else{return this._filterItems}};p.prototype.explicitFeedingItems=function(e){return this._handler.explicitFeedingItems(e)};p.prototype.feedingItems=function(e,t){if(arguments.length>0){this._handler.feedingItemsChanged(e,t);return this}else{return this._feedingItems.slice(0)}};p.prototype.savedSubtotals=function(e){if(arguments.length>0){this._savedSubtotals=e;return this}else{return this._savedSubtotals}};p.prototype.feedingItemsHistory=function(e){if(arguments.length>0){this._feedingItemsHistory=e;return this}else{return this._feedingItemsHistory}};p.prototype.type=function(e){if(arguments.length>0){if(this._type!==e){var t=this._type;this._type=e;this._updateHandler(this._type);this._handler.propertiesChanged(t,true)}return this}else{return this._type}};p.prototype.playerField=function(e){if(arguments.length>0){var t;if(e){if(!this._playerField||!this._playerField.equal(e)){this._playerField=e;t={sliceDimensionChanged:true};this.dispatchPropertiesChangedEvent(t)}}else{if(this._playerField){this._playerField=null;t={sliceDimensionChanged:true};this.dispatchPropertiesChangedEvent(t)}}return this}else{return this._playerField}};p.prototype.isMNDVisible=function(e){if(arguments.length>0){var t=e===true;if(this._isMNDVisible!==t){this._isMNDVisible=t;this._handler.isMNDVisibleChanged()}return this}else{return this._isMNDVisible}};p.prototype.vizModelChanged=function(e){if(e.type){this._updateHandler(e.type)}this._handler.vizModelChanged(e)};p.prototype.updateFilterItems=function(e,t,i,r){var n=this._handler.getFilterItems(e,t,i,r);this.filterItems(n)};p.prototype.clone=function(){var e=new p;this._handler.clone(e);return e};p.prototype.extensionValues=function(e){if(arguments.length>0){var t={};if(e){if(this._extensionValues!==e){this._extensionValues=e;t={extensionValuesChanged:true}}}var r=new i(p.PropertiesChangedEvent,this,t);this._dispatchEvent(r);return this}else{return this._extensionValues}};p.prototype.dispatchPropertiesChangedEvent=function(e){var t=new i(p.PropertiesChangedEvent,this,e);this._dispatchEvent(t)};p.prototype.dispatchEvent=function(e){this._dispatchEvent(e)};return p});e("sap/viz/controls/common/ProxyBase",[],function(){var e=function e(t){this.__className="sap.viz.controls.runtime.ProxyBase";this.__client=t};e.prototype._client=function(){return this.__client};e.prototype.updateClient=function(e){this.__client=e};return e});e("sap/viz/controls/runtime/VizProxy",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/ProxyBase","sap/viz/controls/common/events/Event"],function(e,t,i,r){var n=function e(t){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.runtime.VizProxy"};t.extend(n,i);n.VizProxyEvent="VizProxy.VizProxyEvent";n.GetTitleZoneOperation="getTitleZoneOperation";n.GetTitleTextOperation="getTitleTextOperation";n.SetTitleTextOperation="setTitleTextOperation";n.GetTitleTextByFeedingOperation="getTitleTextByFeedingOperation";n.RestoreTitleTextOperation="restoreTitleTextOperation";n.IsFakeChartOperation="isFakeChartOperation";n.IsTitleCustomizedOperation="isTitleCustomizedOperation";n.GetPropertiesOperation="getPropertiesOperation";n.SetPropertiesOperation="setPropertiesOperation";n.SetDatasetOperation="SetDatasetOperation";n.GetSelectionOperation="getSelectionOperation";n.SetTitleModeOperation="setTitleModeOperation";n.GetPropertyZonesOperation="getPropertyZonesOperation";n.SetPropertyZonesOperation="setPropertyZonesOperation";n.GetDatasetOperation="GetDatasetOperation";n.QueryPropertiesOperation="queryPropertiesOperation";n.UpdatePropertiesOperation="updatePropertiesOperation";n.AddEventListenerOperation="addEventListenerOperation";n.RemoveEventListenerOperation="removeEventListenerOperation";n.SetAxisScaleOperation="setAxisScaleOperation";n.GetTypeOperation="getTypeOperation";n.GetDataPointsPosition="getDataPointsPosition";n.OnOperation="onOperation";n.OffOperation="offOperation";n.GetSizeOperation="getSizeOperation";n.SetSizeOperation="setSizeOperation";n.GetVizFeedingOperation="getVizFeedingOperation";n.prototype._model=function(){return this._client()};n.prototype._doOperation=function(e,t){t=t||{};t.operation=e;var i=new r(n.VizProxyEvent,this._model(),t);this._model().dispatchEvent(i);return i.data.result};n.prototype.getTitleZone=function(){return this._doOperation(n.GetTitleZoneOperation)};n.prototype.getTitleText=function(){return this._doOperation(n.GetTitleTextOperation)};n.prototype.setTitleText=function(e){var t={args:arguments};this._doOperation(n.SetTitleTextOperation,t)};n.prototype.getTitleTextByFeeding=function(){return this._doOperation(n.GetTitleTextByFeedingOperation)};n.prototype.restoreTitleText=function(){this._doOperation(n.RestoreTitleTextOperation)};n.prototype.SetDataset=function(e){var t={args:arguments};this._doOperation(n.SetDatasetOperation,t)};n.prototype.setTitleMode=function(e){var t={args:arguments};this._doOperation(n.SetTitleModeOperation,t)};n.prototype.isFakeChart=function(){return this._doOperation(n.IsFakeChartOperation)};n.prototype.isTitleCustomized=function(){return this._doOperation(n.IsTitleCustomizedOperation)};n.prototype.getProperties=function(){return this._doOperation(n.GetPropertiesOperation)};n.prototype.setProperties=function(e){var t={args:arguments};this._doOperation(n.SetPropertiesOperation,t)};n.prototype.getSelection=function(){return this._doOperation(n.GetSelectionOperation)};n.prototype.getType=function(){return this._doOperation(n.GetTypeOperation)};n.prototype.getPropertyZones=function(){return this._doOperation(n.GetPropertyZonesOperation)};n.prototype.setPropertyZones=function(e){var t={args:arguments};this._doOperation(n.SetPropertyZonesOperation,t)};n.prototype.queryProperties=function(e){var t={args:arguments};return this._doOperation(n.QueryPropertiesOperation,t)};n.prototype.updateProperties=function(e){var t={args:arguments};this._doOperation(n.UpdatePropertiesOperation,t)};n.prototype.getDataset=function(){return this._doOperation(n.GetDatasetOperation)};n.prototype.setAxisScale=function(e){var t={args:arguments};return this._doOperation(n.SetAxisScaleOperation,t)};n.prototype.addEventListener=function(e,t,i,r){var s={args:arguments};this._doOperation(n.AddEventListenerOperation,s)};n.prototype.removeEventListener=function(e,t,i){var r={args:arguments};this._doOperation(n.RemoveEventListenerOperation,r)};n.prototype.getDataPointsPosition=function(e){var t={args:arguments};return this._doOperation(n.GetDataPointsPosition,t)};n.prototype.on=function(e,t){this._doOperation(n.OnOperation,{args:arguments})};n.prototype.off=function(e){this._doOperation(n.OffOperation,{args:arguments})};n.prototype.getSize=function(){return this._doOperation(n.GetSizeOperation)};n.prototype.setSize=function(e){var t={args:arguments};this._doOperation(n.SetSizeOperation,t)};n.prototype.getVizFeeding=function(){return this._doOperation(n.GetVizFeedingOperation)};return n});e("sap/viz/controls/common/VizControlBase",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/UIControl","sap/viz/controls/runtime/RuntimeManager","sap/viz/controls/runtime/VizModel","sap/viz/controls/runtime/VizProxy"],function(e,t,i,r,n,s){var o=function e(t,i,r){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlBase";sap.viz.base.utils.log.Analyzer.pnrContext("sap.viz.controls performance log context");this._vizUid=null;if(r){this._parent=r;this.__vizModel=r._vizModel()}else{this.__vizModel=this._createModel()}this.__vizModel.addEventListener(n.PropertiesChangedEvent,this._onVizModelChanged,this);this._updatingProperty=0;this.__vizProxy=new s(this.__vizModel)};e.extend(o,i);o.prototype.connect=function(e){if(this._vizUid===e){return}this._vizUid=e;var t=r.getRuntime();var i=t.getModel(e);var s=false;if(!i){t.registerModel(e,this.__vizModel)}else{if(this.__vizModel!==i){s=true;this.__vizModel.removeEventListener(n.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=i;this.__vizModel.addEventListener(n.PropertiesChangedEvent,this._onVizModelChanged,this)}t.addModelRef(e)}this._onConnect(e,s)};o.prototype._vizModel=function(){return this.__vizModel};o.prototype._vizProxy=function(){return this.__vizProxy};o.prototype._onVizModelChanged=function(e){};o.prototype._createModel=function(){return new n};o.prototype._onConnect=function(e,t){this._vizProxy().updateClient(this.__vizModel)};o.prototype._onDisconnect=function(){};o.prototype._onAfterDisconnect=function(){};o.prototype.disconnect=function(){this._removeSharedModel(true)};o.prototype._removeSharedModel=function(e){var t=this._vizUid;if(t){var i=r.getRuntime().getModel(t);if(i){if(e){this._onDisconnect()}i.removeEventListener(n.PropertiesChangedEvent,this._onVizModelChanged,this);this.__vizModel=i.clone();this.__vizModel.addEventListener(n.PropertiesChangedEvent,this._onVizModelChanged,this);r.getRuntime().removeModelRef(t)}if(e){this._onAfterDisconnect()}this._vizUid=null}};o.prototype.destroy=function(){this._removeSharedModel(false);o.superclass.destroy.apply(this,arguments)};o.prototype._beginUpdateProperty=function(){this._updatingProperty++};o.prototype._inUpdatingProperty=function(){return this._updatingProperty>0};o.prototype._endUpdateProperty=function(){this._updatingProperty--};o.prototype._dispatchPropertyEvent=function(e){if(!this._updatingProperty){o.superclass._dispatchEvent.apply(this,arguments)}};o.prototype._dispatchEvent=function(e){if(!e.data){e.data={}}e.data.token=this._vizUid;o.superclass._dispatchEvent.apply(this,arguments)};o.prototype.save=function(){return{}};o.prototype.load=function(e){};return o});e("sap/viz/controls/common/VizControlHost",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/VizControlBase"],function(e,t,i){var r=function e(){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.VizControlHost";this._children=[]};e.extend(r,i);r.prototype._onConnect=function(e){r.superclass._onConnect.apply(this,arguments);for(var t=0;t<this._children.length;t++){this._children[t].connect(e)}};r.prototype._onDisconnect=function(){r.superclass._onDisconnect.apply(this,arguments);for(var e=0;e<this._children.length;e++){this._children[e].disconnect()}};r.prototype._addChild=function(e,t,i){if(!e){return}this._children.push(e);var r=this;t&&t.forEach(function(t){r[t]=function(){return e[t].apply(e,arguments)}});i&&i.forEach(function(t){e.addEventListener(t,function(e){r._dispatchEvent(e)})})};r.prototype.destroy=function(){var e;while(e=this._children.shift()){try{e.destroy()}catch(e){}}r.superclass.destroy.apply(this,arguments)};return r});e("sap/viz/controls/common/views/feed/FeedingShelfEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelfEvent"};t.extend(r,i);r.CLICK_ADD_FEEDING="clickAddFeeding";r.ACTION_CHANGED="actionChanged";r.FEEDING_CHANGED="feedingChanged";r.FEEDING_EMPTY_CHANGED="feedingEmptyChanged";r.FEEDING_DROP_DENY="feedingDropDeny";return r});e("sap/viz/controls/feeding/FeedingPanelConfig",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/config/GlobalConfig"],function(e,t){var i={};i.instance=function(){return{useBuildInFeedList:true,defaultVizType:e.TYPE_COLUMN,enableTrellis:true}};t.registerUIConfig(t.DEFAULT_UICONFIG_TYPE_FEEDING,i);return i});e("sap/viz/controls/mapbuilder/MapBuilderConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{basemap:{providers:["ESRI","CVOM","NAVTEQ"],changeable:true,selected:"ESRI"},feedMap:{actionGroups:[]},feedingPanel:{}}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_MAPBUILDER,t);return t});e("sap/viz/controls/switchbar/SwitchBarConfig",["sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/managers/LangManager"],function(e,t,i){var r={};r.instance=function(){return{visible:true,defaultVizType:t.TYPE_BAR,groups:[{name:i.get("VIZ_SWITCHBAR_BAR_COLUMN_CHARTS"),types:[{id:t.TYPE_BAR},{id:t.TYPE_COLUMN},{id:t.TYPE_STACKED_BAR},{id:t.TYPE_STACKED_COLUMN},{id:t.TYPE_DUAL_BAR},{id:t.TYPE_DUAL_COLUMN},{id:t.TYPE_3D_COLUMN}]},{name:i.get("VIZ_SWITCHBAR_LINE_CHARTS"),types:[{id:t.TYPE_LINE},{id:t.TYPE_AREA},{id:t.TYPE_COMBINATION},{id:t.TYPE_DUAL_LINE},{id:t.TYPE_DUAL_COMBINATION}]},{name:i.get("VIZ_SWITCHBAR_PIE_CHARTS"),types:[{id:t.TYPE_PIE},{id:t.TYPE_DONUT},{id:t.TYPE_PIE_WITH_DEPTH}]},{name:i.get("VIZ_SWITCHBAR_GEO_CHARTS"),types:[{id:t.TYPE_GEO_BUBBLE},{id:t.TYPE_GEO_CHOROPLETH},{id:t.TYPE_GEO_PIE}]},{name:i.get("VIZ_SWITCHBAR_SCATTER_CHARTS"),types:[{id:t.TYPE_SCATTER},{id:t.TYPE_BUBBLE},{id:t.TYPE_SCATTER_MATRIX}]},{name:i.get("VIZ_SWITCHBAR_MAP_CHARTS"),types:[{id:t.TYPE_HEATMAP},{id:t.TYPE_TREEMAP}]},{name:i.get("VIZ_SWITCHBAR_TABLES"),types:[{id:t.TYPE_TABLE}]},{name:i.get("VIZ_SWITCHBAR_NUMBER_CHARTS"),types:[{id:t.TYPE_NUMBER}]},{name:i.get("VIZ_SWITCHBAR_OTHER_CHARTS"),types:[{id:t.TYPE_BOXPLOT},{id:t.TYPE_FUNNEL},{id:t.TYPE_NETWORK},{id:t.TYPE_PC},{id:t.TYPE_RADAR},{id:t.TYPE_TAG_CLOUD},{id:t.TYPE_TREE},{id:t.TYPE_WATERFALL}]}]}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_SWITCHBAR,r);return r});e("sap/viz/controls/builder/VizBuilderConfig",["sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/feeding/FeedingPanelConfig","sap/viz/controls/mapbuilder/MapBuilderConfig","sap/viz/controls/switchbar/SwitchBarConfig"],function(e,t,i,r,n){var s={};s.instance=function(){return{defaultVizType:t.TYPE_COLUMN,header:{visible:true},controls:{switchBar:n.instance(),feedingPanel:i.instance(),mapBuilder:r.instance()}}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_BUILDER,s);return s});e("sap/viz/controls/builder/VizBuilderEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilderEvent"};t.extend(r,i);return r});e("sap/viz/controls/mapbuilder/constants/Const",[],function(){var e={};e.VIZ_TYPE_CHOROPLETH="choropleth";e.VIZ_TYPE_MARKER="marker";e.VIZ_TYPE_BUBBLE="bubble";return e});e("sap/viz/controls/mapbuilder/components/PropertyTriangle",["jquery","sap/viz/controls/common/constants/CSSConst"],function(e,t){var i=function(){this.__className="sap.viz.controls.geo.compnents.PropertyTriangle"};i.prototype.createTriangle=function(){var e=document.createElement("DIV");this.turnToExpandTriangle(e);return e};i.prototype.turnToExpandTriangle=function(i){if(i){e(i).removeClass(t.MAPBUILDER_PREFIX+"section-expand");e(i).addClass(t.MAPBUILDER_PREFIX+"section-collapse");e(i).removeClass(t.MAPBUILDER_PREFIX+"header-collapse");e(i).addClass(t.MAPBUILDER_PREFIX+"header-expand")}};i.prototype.turnToShrinkTriangle=function(i){if(i){e(i).removeClass(t.MAPBUILDER_PREFIX+"section-collapse");e(i).addClass(t.MAPBUILDER_PREFIX+"section-expand");e(i).removeClass(t.MAPBUILDER_PREFIX+"header-expand");e(i).addClass(t.MAPBUILDER_PREFIX+"header-collapse")}};return i});e("sap/viz/controls/mapbuilder/events/GeoEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.events.GeoEvent"};e.extend(i,t);i.ADD_LAYER="addLayer";i.SHOW_LAYER="showLayer";i.HIDE_LAYER="hideLayer";i.EXPAND_SECTION="expandSection";i.HIDE_SECTION="hideSection";i.DELETE_LAYER="deleteLayer";i.REORDER_LAYER="reorderLayer";i.CHANGE_LAYER_VIZTYPE="changeLayerVizType";i.CHANGE_BASEMAP_PROVIDER="changeBasemapProvider";i.UPDATE_LAYER_DATA="updateLayerData";i.RENAME_LAYER="renameLayer";i.DISPLAY_SETTINGMENU="displaySettingMenu";i.SHOW_LEGEND="showLegend";i.HIDE_LEGEND="hideLegend";i.CHANGE_VIZ_PROPERITIES="changeVizProperties";i.CHANGE_BASEMAP_TYPE="changeBaseMapType";i.ACTION_CHANGED="actionChanged";return i});e("sap/viz/controls/mapbuilder/sections/SectionBase",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/components/PropertyTriangle","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/constants/Const"],function(e,t,i,r,n,s,o,a){var l=function(e,t){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.SectionBase";this._config=t;this._checkable=this._config.checkable;this._configable=this._config.configable;this._sortable=this._config.sortable;this._isExpand=false;this._isChecked=true;this._instanceDom=this._dom;this._checkBoxDom=null;this._symbolDom=null;this._headerDom=null;this._iconDom=null;this._labelDom=null;this._configDom$=null;this._controlPanel=null;this._childControls=[];this._isMouseDown=false;this._selected=false;this._propertyTriangle=new s;this._availableControls=[];this._createCompoment()};t.extend(l,r);l.prototype._createCompoment=function(){if(this._isCreated){return}this._titleString=this._config.title?this._config.title:null;this._childControlDom=[];this._createSection();this._attachEventHandler();this._isCreated=true;e(this._instanceDom).prepend(e(this._sectionDom))};l.prototype._createSection=function(){this._sectionDom=document.createElement("div");this._headerDom=document.createElement("div");e(this._sectionDom).addClass(n.MAPBUILDER_PREFIX+"section");e(this._headerDom).addClass(n.MAPBUILDER_PREFIX+"section-header");this._checkBoxDom=document.createElement("input");this._checkBoxDom.type="checkbox";this._checkBoxDom.checked=this._isChecked;e(this._checkBoxDom).addClass(n.MAPBUILDER_PREFIX+"section-block");if(!this._checkable){this._checkBoxDom.disabled=true}this._symbolDom=this._propertyTriangle.createTriangle();e(this._symbolDom).addClass(n.MAPBUILDER_PREFIX+"section-expand");this._headerDom.appendChild(this._symbolDom);this._headerDom.appendChild(this._checkBoxDom);this._labelDom=document.createElement("div");e(this._labelDom).addClass(n.MAPBUILDER_PREFIX+"section-title");this._labelDom.innerText=this._titleString?this._titleString:"";this._headerDom.appendChild(this._labelDom);this._iconDom=e("<div/>").addClass(n.MAPBUILDER_PREFIX+"section-icon");this._iconDom.appendTo(e(this._headerDom));this.showIcon(false);if(this._config.vizType){this._iconDom.removeClass(n.MAPBUILDER_PREFIX+"section-icon");if(this._config.vizType===a.VIZ_TYPE_CHOROPLETH){this._iconDom.addClass(n.MAPBUILDER_PREFIX+"section-icon-choropleth")}else if(this._config.vizType===a.VIZ_TYPE_MARKER){this._iconDom.addClass(n.MAPBUILDER_PREFIX+"section-icon-marker")}else if(this._config.vizType===a.VIZ_TYPE_BUBBLE){this._iconDom.addClass(n.MAPBUILDER_PREFIX+"section-icon-bubble")}this.showIcon(true)}if(this._configable){this._configDom$=e("<div/>").addClass(n.MAPBUILDER_PREFIX+"section-setting");this._configDom$.appendTo(e(this._headerDom))}this._sectionDom.appendChild(this._headerDom)};l.prototype._attachEventHandler=function(){e(this._symbolDom).bind("tap click",function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new o(this._isExpand?o.HIDE_SECTION:o.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}))}.bind(this));e(this._headerDom).bind("tap click",function(e){e.stopPropagation();e.preventDefault();this._dispatchEvent(new o(this._isExpand?o.HIDE_SECTION:o.EXPAND_SECTION,this,{sectionIdx:this.getSectionIdx()}))}.bind(this));if(this._configable){this._configDom$.bind("tap click",function(e){this._dispatchEvent(new o(o.DISPLAY_SETTINGMENU,this,{sectionIdx:this.getSectionIdx()}));e.stopPropagation();e.preventDefault()}.bind(this))}e(this._checkBoxDom).bind("click tap",function(e){e.stopPropagation();e.preventDefault()});e(this._checkBoxDom).bind("mousedown",function(e){this._isMouseDown=true}.bind(this));e(this._checkBoxDom).bind("mouseup",function(e){if(this._isMouseDown){this._isChecked=!this._isChecked;e.target.checked=this._isChecked;e.stopPropagation();e.preventDefault();this._isMouseDown=false;this._selected=true;this._dispatchEvent(new o(this._isChecked?o.SHOW_LAYER:o.HIDE_LAYER,this,{sectionIdx:this.getSectionIdx()}))}}.bind(this));if(this._sortable){e(this._instanceDom).sortable({start:function(e,t){t.item.data("__origIdx",t.item.index())},update:function(e,t){this._dispatchEvent(new o(o.REORDER_LAYER,this,{from:t.item.data("__origIdx"),to:t.item.index()}))}.bind(this)})}};l.prototype._hideSectionHandler=function(){var t=this;if(this._controlPanel!=null){e(this._controlPanel).hide()}e(this._sectionDom).removeClass(n.MAPBUILDER_PREFIX+"section-header-expand");this._propertyTriangle.turnToExpandTriangle(this._symbolDom);e(this._headerDom).bind("mouseover",function(){t._configDom$.show()}).bind("mouseout",function(){t._configDom$.hide()});this._isExpand=false};l.prototype._expandSectionHandler=function(){this._propertyTriangle.turnToShrinkTriangle(this._symbolDom);e(this._sectionDom).addClass(n.MAPBUILDER_PREFIX+"section-header-expand");this._configDom$.show();e(this._headerDom).unbind("mouseover").unbind("mouseout");if(this._controlPanel!=null){e(this._controlPanel).show()}else{this._controlPanel=e("<div/>").appendTo(e(this._sectionDom));this._createChildControlPanel(this._controlPanel)}this._isExpand=true};l.prototype.getSectionIdx=function(){return e(this._sectionDom).index()};l.prototype.getSectionDom=function(){return e(this._sectionDom)};l.prototype.title=function(e,t){if(!arguments.length){return this._labelDom.innerText}else{if(t){this._titleString=e;this._labelDom.innerText=this._titleString}else{if(this._titleString!=null){this._titleString=e;this._labelDom.innerText=this._titleString}else{this._labelDom.innerText=e}}}};l.prototype.showIcon=function(e){if(!arguments.length){return this._showIconDom}if(e){this._iconDom.css("visibility","");this._showIconDom=true}else{this._iconDom.css("visibility","hidden");this._showIconDom=false}};return l});e("sap/viz/controls/mapbuilder/widgets/WidgetBase",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase"],function(e,t,i){var r=function(e,t){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetBase";this._config=t};t.extend(r,i);return r});e("sap/viz/controls/mapbuilder/widgets/WidgetTitle",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function(e,t,i,r){var n=function(e,t){n.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetTitle";this._title$=null;this._creatControls()};t.extend(n,r);n.prototype._creatControls=function(){var t=e(this._dom);this._title$=e("<div/>").appendTo(t).addClass(i.MAPBUILDER_PREFIX+"section-category-title");var r=e("<div/>").appendTo(this._title$).addClass(i.MAPBUILDER_PREFIX+"section-category-title-text");r.text(this._config.title)};n.prototype.show=function(){this._title$.show()};n.prototype.hide=function(){this._title$.hide()};return n});e("sap/viz/controls/mapbuilder/widgets/WidgetDataPoint",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase"],function(e,t,i,r,n,s,o){var a=i.MAPBUILDER_PREFIX+"inline-block";var l=i.MAPBUILDER_PREFIX+"viztype-selected";var c=function(e,t){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetDataPoint";this._vizTypeButton$={};this._creatControls();this._addEventListeners()};t.extend(c,o);c.prototype.update=function(e){var t=e.vizType;if(t){for(var i in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(i)){this._vizTypeButton$[i].removeClass(l)}}this._vizTypeButton$[t].addClass(l)}};c.prototype._creatControls=function(){var t=e(this._dom);var n=e("<button/>").appendTo(t).addClass(i.MAPBUILDER_PREFIX+"viztype").addClass(a);e("<div/>").addClass(i.MAPBUILDER_PREFIX+"viztype-choropleth").addClass(i.MAPBUILDER_PREFIX+"viztype-icon").appendTo(n);n.data("__viztype","choropleth");n.attr("title",r.get("VIZ_MAPBUILDER_CHOROPLETH"));this._vizTypeButton$["choropleth"]=n;n=e("<button/>").appendTo(t).addClass(i.MAPBUILDER_PREFIX+"viztype").addClass(a);e("<div/>").addClass(i.MAPBUILDER_PREFIX+"viztype-bubble").addClass(i.MAPBUILDER_PREFIX+"viztype-icon").appendTo(n);n.data("__viztype","bubble");n.attr("title",r.get("VIZ_MAPBUILDER_BUBBLE"));this._vizTypeButton$["bubble"]=n;n=e("<button/>").appendTo(t).addClass(i.MAPBUILDER_PREFIX+"viztype").addClass(a);e("<div/>").addClass(i.MAPBUILDER_PREFIX+"viztype-marker").addClass(i.MAPBUILDER_PREFIX+"viztype-icon").appendTo(n);n.data("__viztype","marker");n.attr("title",r.get("VIZ_MAPBUILDER_MARKER"));this._vizTypeButton$["marker"]=n;this._vizTypeButton$[this._config.selected].addClass(l)};c.prototype._addEventListeners=function(){var t=this;for(var i in this._vizTypeButton$){if(this._vizTypeButton$.hasOwnProperty(i)){this._vizTypeButton$[i].bind("click tap",function(i){for(var r in t._vizTypeButton$){if(t._vizTypeButton$.hasOwnProperty(r)){t._vizTypeButton$[r].removeClass(l)}}e(this).addClass(l);t._dispatchEvent(new n(n.CHANGE_LAYER_VIZTYPE,this,{vizType:e(this).data("__viztype")}))})}}};return c});e("sap/viz/controls/common/helpers/Rectangle",[],function(){var e=function(e,t,i,r){this._left=e;this._top=t;this._width=i;this._height=r};e.parseDOM=function(t){var i=t.offset();return new e(i.left,i.top,t.outerWidth(),t.outerHeight())};e.prototype.left=function(e){if(arguments.length>0){this._left=e}else{return this._left}};e.prototype.top=function(e){if(arguments.length>0){this._top=e}else{return this._top}};e.prototype.right=function(e){if(arguments.length>0){this.left(e-this.width())}else{return this.left()+this.width()}};e.prototype.bottom=function(e){if(arguments.length>0){this.top(e-this.height())}else{return this.top()+this.height()}};e.prototype.width=function(){return this._width};e.prototype.height=function(){return this._height};e.prototype.hCenter=function(){return this.left()+this.width()/2};e.prototype.vCenter=function(){return this.top()+this.height()/2};e.prototype.hContains=function(e){return this.left()<=e.left()&&this.right()>=e.right()};e.prototype.vContains=function(e){return this.top()<=e.top()&&this.bottom()>=e.bottom()};e.prototype.contains=function(e){return this.hContains(e)&&this.vContains(e)};e.toJSON=function(e){return{left:e.left(),top:e.top(),width:e.width(),height:e.height()}};return e});e("sap/viz/controls/common/views/menu/PopUpMenuEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.PopUpMenuEvent"};t.extend(r,i);r.OPENED="opened";r.CLOSED="closed";r.ITEM_SELECTED="itemSelected";return r});e("sap/viz/controls/common/views/menu/DockStrategy",[],function(){var e={};e.RIGHT="right";e.RIGHT_WITH_ARROW="rightWithArrow";e.LEFT="left";e.LEFT_WITH_ARROW="leftWithArrow";e.DOWN="down";e.DOWN_WITH_ARROW="downWithArrow";e.UP="up";e.UP_WITH_ARROW="upWithArrow";e._oppsosite=function(){var t={};t[e.RIGHT]=e.LEFT;t[e.RIGHT_WITH_ARROW]=e.LEFT_WITH_ARROW;t[e.DOWN]=e.UP;t[e.DOWN_WITH_ARROW]=e.UP_WITH_ARROW;return t}();e.oppsosite=function(t){for(var i in e._oppsosite){if(e._oppsosite.hasOwnProperty(i)){var r=e._oppsosite[i];if(i===t){return r}else if(r===t){return i}}}};e.arrow=function(t){return t===e.RIGHT_WITH_ARROW||t===e.LEFT_WITH_ARROW||t===e.DOWN_WITH_ARROW||t===e.UP_WITH_ARROW};e.up=function(t){return t===e.UP||t===e.UP_WITH_ARROW};e.down=function(t){return t===e.DOWN||t===e.DOWN_WITH_ARROW};e.left=function(t){return t===e.LEFT||t===e.LEFT_WITH_ARROW};e.right=function(t){return t===e.RIGHT||t===e.RIGHT_WITH_ARROW};e.horizontal=function(t){return e.left(t)||e.right(t)};e.vertical=function(t){return e.up(t)||e.down(t)};return e});e("sap/viz/controls/common/views/menu/PopUpMenu",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/UIControl","sap/viz/controls/common/helpers/Rectangle","sap/viz/controls/common/views/menu/PopUpMenuEvent","sap/viz/controls/common/views/menu/DockStrategy"],function(e,t,i,r,n,s,o,a){var l=t.COMMON_PREFIX;var c=function(t,i){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.menu.PopUpMenu";this._menuGroups=i;this._dock$=null;this._preferredDockStrategy=null;this._dockStrategy=null;this._hOffset=null;this._vOffset=null;this._subMenu=null;this._documentHandler=null;this._createChildren();this._dom$.appendTo(e("body"))};i.extend(c,n);c.prototype.open=function(t,i,r,n){this._dock$=t;this._preferredDockStrategy=i;this._hOffset=r?r:0;this._vOffset=n?n:0;this._locate(this._preferredDockStrategy);this._dispatchEvent(new o(o.OPENED,this));this._documentHandler=e.proxy(function(t){var i=this._dock$[0];if(!e.contains(this._dom,t.target)&&(!this._subMenu&&(!e.contains(i,t.target)||i.nodeName!=="LI")||this._subMenu&&!e.contains(this._subMenu._dom,t.target))){this.close()}},this);document.addEventListener("mousedown",this._documentHandler,true);e(window).on("blur",this._documentHandler)};c.prototype.close=function(){var t=this._dom$;document.removeEventListener("mousedown",this._documentHandler,true);e(window).off("blur",this._documentHandler);this._dispatchEvent(new o(o.CLOSED,this));this.removeAllEventListeners();r.delay(function(){t.removeClass(l+"menu-transition");t.detach()},240);this._dom$.css("opacity",0).addClass(l+"menu-transition");this.destroy()};c.prototype._createChildren=function(){var i,n;var s=this._dom$;s.addClass(l+"menu");var p=e("<div/>").addClass([l+"menu-list",t.COMMON_PREFIX+"scrollable",t.COMMON_PREFIX+"scrollable-y"].join(" ")).appendTo(s);var h=e("<ul/>").appendTo(p);for(i=0;i<this._menuGroups.length;i++){var d=this._menuGroups[i];for(n=0;n<d.menuItems().length;n++){var u=d.menuItems()[n];var _=e("<li/>").appendTo(h);_.addClass(l+"menu-list-prefix-icon-x1");_.data("item",u);if(d.selectedItem()===u){_.addClass(l+"menu-list-selected")}_.on("mouseenter",function(t){e("li",h).each(function(){var i=e(this);if(this===t.currentTarget){i.addClass(l+"menu-list-hovered")}else{i.removeClass(l+"menu-list-hovered")}})}).on("mouseleave",function(e){});_.on("click",e.proxy(function(t){var i=e(t.currentTarget);var r=i.data("item");if(r.subMenuGroups()){return}else{this._dispatchEvent(new o(o.ITEM_SELECTED,this,{selectedItem:r}));this.close()}},this));var v=e("<div/>").addClass([l+"menu-list-caption",l+"text-ellipsis"].join(" ")).appendTo(_);v.text(u.name());var f=false;_.on("mouseenter",e.proxy(function(e){this._closeSubMenu()},this)).on("mouseleave",e.proxy(function(t){var i=e(t.currentTarget);var n=i.data("item");r.defer(e.proxy(function(){if(!f){this._closeSubMenu()}},this))},this));if(u.subMenuGroups()){_.addClass(l+"menu-list-suffix-icon-x1");e("<div/>").addClass([l+"menu-list-suffix-icon-submenu",l+"havanaSharedSprite16"].join(" ")).appendTo(_);_.on("mouseenter",e.proxy(function(t){var i=e(t.currentTarget);var r=i.data("item");f=r.subMenuGroups().length>0;if(r.subMenuGroups().length>0){this._subMenu=new c(document.createElement("div"),r.subMenuGroups());this._subMenu.addEventListener(o.ITEM_SELECTED,function(e){this._dispatchEvent(e);this.close()},this);this._subMenu.open(i,a.RIGHT,-6,6);e(this._subMenu._dom).on("mouseenter",e.proxy(function(e){f=true},this))}},this))}}if(i!==this._menuGroups.length-1){var m=e("<div/>").addClass(l+"menu-list-group-splitter").appendTo(h)}}};c.prototype._closeSubMenu=function(){if(this._subMenu){e(this._subMenu._dom).off("mouseenter");this._subMenu.close();this._subMenu=null}};c.prototype._locate=function(t){var i=t===this._preferredDockStrategy;var n=false;var o={from:{visibility:"hidden",opacity:0},to:{visibility:"",opacity:1}};var c=6;var p=6;var h=s.parseDOM(this._dock$);var d=s.parseDOM(this._dom$);var u=s.parseDOM(e("body"));var _=a.arrow(t);if(a.horizontal(t)){if(a.left(t)){p*=-1;c*=-1;d.right(h.left()+c-this._hOffset)}else if(a.right(t)){d.left(h.right()+c+this._hOffset)}d.top(h.top()+this._vOffset);n=!u.hContains(d);o.from.left=d.left()-p+"px";o.to.left=d.left()+"px";o.from.top=o.to.top=d.top()+"px"}else if(a.vertical(t)){if(_){d.left(h.hCenter()-d.width()*3/4+this._hOffset)}else{d.left(h.left()+this._hOffset)}if(a.up(t)){p*=-1;c*=-1;d.bottom(h.top()+c+this._vOffset)}else if(a.down(t)){d.top(h.bottom()+c+this._vOffset)}n=!u.vContains(d);o.from.left=o.to.left=d.left()+"px";o.from.top=d.top()-p+"px";o.to.top=d.top()+"px"}if(i&&n){this._locate(a.oppsosite(t))}else{this._dockStrategy=t;if(o){this._dom$.css(o.from);r.defer(e.proxy(function(){this._dom$.css(o.to).addClass(l+"menu-transition")},this));r.delay(e.proxy(function(){this._dom$.removeClass(l+"menu-transition")},this),240)}}};return c});e("sap/viz/controls/common/feeds/SubtotalItemType",["sap/viz/controls/common/managers/LangManager"],function(e){var t=function(){this.__className="sap.viz.controls.common.feeds.SubtotalItemType"};t.action="addSubTotal";t.TOTAL="default";t.SUM="sum";t.MIN="min";t.MAX="max";t.COUNT="count";t.AVG="average";t.getAggregationType=function(e){if(e.indexOf(t.TOTAL)!==-1){return t.TOTAL}else if(e.indexOf(t.SUM)!==-1){return t.SUM}else if(e.indexOf(t.MIN)!==-1){return t.MIN}else if(e.indexOf(t.MAX)!==-1){return t.MAX}else if(e.indexOf(t.COUNT)!==-1){return t.COUNT}else if(e.indexOf(t.AVG)!==-1){return t.AVG}return null};t.getSubTotalsAggregationDisplayType=function(i){switch(i){case t.SUM:return e.get("VIZ_COMMON_SUM_OF");case t.MIN:return e.get("VIZ_COMMON_MIN_OF");case t.MAX:return e.get("VIZ_COMMON_MAX_OF");case t.COUNT:return e.get("VIZ_COMMON_COUNT_OF");case t.AVG:return e.get("VIZ_COMMON_AVERAGE_OF");case t.TOTAL:return e.get("VIZ_COMMON_TOTAL_OF");default:return" "}};t.sanitizeAnalysisObjects=function(e){for(var i=0;i<e.length;i++){var r=e[i].name();if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.TOTAL))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.TOTAL),e[i])}else if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.SUM))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.SUM),e[i])}else if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.MIN))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.MIN),e[i])}else if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.MAX))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.MAX),e[i])}else if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.COUNT))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.COUNT),e[i])}else if(r.indexOf(t.getSubTotalsAggregationDisplayType(t.AVG))!==-1){t.removeSubtotalItemTokenFromName(t.getSubTotalsAggregationDisplayType(t.AVG),e[i])}}return e};t.removeSubtotalItemTokenFromName=function(e,t){var i=e.length;var r=t.name().substr(i+1);t.name(r)};return t});e("sap/viz/controls/common/menu/MenuExtensionBuilder",[],function(){var e=null;var t=function(){this.__className="sap.viz.controls.common.menu.MenuExtensionBuilder"};var i=function(e){if(e&&(e.indexOf("http://")===0||e.indexOf("https://")===0||e.indexOf("/")===0)){return true}return false};var r=function(e){var t=e.split("?");var i=t[0];var r={};if(t.length>1){var n=t[1].split("&");for(var s=0;s<n.length;s++){var o=n[s];var a=o.split("=");if(a.length===2){r[a[0]]=a[1]}}}return{location:i,parameters:r}};var n=function(e,t){if(e&&sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getServiceMetadata!==undefined){var i=[];if(t){i=sap.bi.framework.getServiceMetadata("*sap.bi.framework.ui.menugroup")}else{i=sap.bi.framework.getServiceMetadata("*sap.bi.framework.ui.menuitem")}for(var r=0;r<i.length;r++){var n=i[r];if(n.framework&&n.id===e){return n.framework.bundleUrl}}}return null};var s=function(e,t){e.push(t);var i=e.slice(0);for(var r=0;r<i.length;r++){var n=i[r];if(n._locationBefore||n._locationAfter){for(var s=0;s<e.length;s++){var o=e[s];if(o.id===n._locationBefore){var a=e.indexOf(n);e.splice(a,1);e.splice(s,0,n);break}else if(o.id===n._locationAfter){var a=e.indexOf(n);e.splice(a,1);e.splice(s+1,0,n);break}}}}};var o=function(){var e=[];if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService!==undefined){var t=sap.bi.framework.getService("*","*sap.bi.framework.ui.menugroup");var o=sap.bi.framework.getService("*","*sap.bi.framework.ui.menuitem");t=JSON.parse(JSON.stringify(t));o=JSON.parse(JSON.stringify(o));for(var a=0;a<t.length;a++){var l=t[a];if(l&&l.location){var c=r(l.location);var p=c.location;l._locationBefore=c.parameters["before"];l._locationAfter=c.parameters["after"];if(!l.subMenuItems){l.subMenuItems=[]}if(l.icon&&l.icon.url&&i(l.icon.url)===false){var h=n(l.id);if(h){l.icon.url=h+"/"+l.icon.url}}for(var d=0;d<t.length;d++){var u=t[d];if(u!==l&&u.id===p){l.parentMenuGroup=u;if(!u.subMenuItems){u.subMenuItems=[]}s(subMenuItems,l);break}}if(!l.parentMenuGroup){e.push(l)}}}for(var a=0;a<o.length;a++){var _=o[a];if(_&&_.location){var c=r(_.location);var p=c.location;_._locationBefore=c.parameters["before"];_._locationAfter=c.parameters["after"];if(_.icon&&_.icon.url&&i(_.icon.url)===false){var h=n(_.id);if(h){_.icon.url=h+"/"+_.icon.url}}for(var d=0;d<t.length;d++){var u=t[d];if(u.id===p){_.parentMenuGroup=u;if(!u.subMenuItems){u.subMenuItems=[]}s(subMenuItems,_);break}}}}}return e};var a=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];if(r.id===t){return r}else if(r.subMenuItems&&r.subMenuItems.length>0){r=a(r.subMenuItems,t);if(r){return r}}}return null};t.getMenu=function(t){if(!e){e=o()}return a(e,t).subMenuItems};t.clearCache=function(){e=null};return t});e("sap/viz/controls/common/views/feed/FeedingShelf",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/UIControl","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/views/menu/PopUpMenu","sap/viz/controls/common/views/menu/PopUpMenuEvent","sap/viz/controls/common/views/menu/DockStrategy","sap/viz/controls/common/views/menu/MenuGroup","sap/viz/controls/common/views/menu/MenuItem","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/feeds/SubtotalItemType","sap/viz/controls/common/menu/MenuExtensionBuilder"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y){var I=function(t,i){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedingShelf";this._dom$.addClass(r.FEEDINGSHELF_PREFIX+"view");this._list$=null;this._ghostCard$=null;this._draggingCard$=null;this._addIndicator$=null;this._addIcon$=null;this._activeHandler=e.proxy(this._active,this);this._dropIndicator$=e(document.createElement("hr")).addClass(r.FEEDINGSHELF_PREFIX+"drop-indicator");this._shelf=i;this._lastCardRemoved=null;this._lastAnalysisObjectRemoved=null;this._lastTwinAnalysisObjectRemoved=null;this._lastHierarchyOjbectUpdated=null;this._createChildren();this._droppable();this._enableFeeding=true};t.extend(I,n);I.CARD_HEIGHT=24;I.prototype.shelf=function(){return this._shelf};I.prototype.popUpDock=function(){var e=this;return function(){var t=e._list$.offset();return{x:t.left,y:t.top+I.CARD_HEIGHT/2,shelfWidth:e._list$.outerWidth()}}};I.prototype.analyses=function(t){if(arguments.length>0){var i;var r={};for(i=0;i<t.length;){if(!r[t[i].id()]){r[t[i].id()]=true;i++}else{t.splice(i,1)}}this._traversalCards(function(){e(this).remove()},true,true);for(i=0;i<t.length;i++){this._addCardAt(t[i],-1)}this._analysesChanged();return this}else{var n=[];this._traversalCards(function(t){var i=e(this);var r=i.data("__analysis");if(r){n.push(r)}},true,true);return n}};I.prototype._numCards=function(){var e=0;this._traversalCards(function(t){e++},true,true);return e};I.prototype.addAnalysis=function(e){return this._addAnalysisAt(e,-1)};I.prototype._addAnalysisAt=function(e,t){this._lastCardRemoved=null;this._lastAnalysisObjectRemoved=null;var i=this._addCardAt(e,t);this._analysesChanged();return i};I.prototype.lastAnalysisObjectRemoved=function(e){if(arguments.length>0){this._lastAnalysisObjectRemoved=e}else{return this._lastAnalysisObjectRemoved}};I.prototype.lastCardRemoved=function(e){if(arguments.length>0){this._lastCardRemoved=e}else{return this._lastCardRemoved}};I.prototype.lastTwinAnalysisObjectRemoved=function(e){if(arguments.length>0){this._lastTwinAnalysisObjectRemoved=e}else{return this._lastTwinAnalysisObjectRemoved}};I.prototype.lastHierarchyOjbectUpdated=function(e){if(arguments.length>0){this._lastHierarchyOjbectUpdated=e}else{return this._lastHierarchyOjbectUpdated}};I.prototype.destroy=function(){this.removeAllEventListeners();e("body").off("mouseup",this._activeHandler);I.superclass.destroy.apply(this,arguments)};I.prototype._createChildren=function(){var t=e(document.createElement("div")).appendTo(this._dom$).addClass(r.FEEDINGSHELF_PREFIX+"item");var i=e(document.createElement("div")).appendTo(t).addClass(r.FEEDINGSHELF_PREFIX+"item-title");i.text(this._shelf.name);var n=e(document.createElement("div")).appendTo(t).addClass(r.FEEDINGSHELF_PREFIX+"item-content");var s=this._list$=e(document.createElement("div")).appendTo(n).addClass(r.FEEDINGSHELF_PREFIX+"item-list");var o=this._addIndicator$=e(document.createElement("div")).appendTo(s);o.addClass(r.FEEDINGSHELF_PREFIX+"item-ph");var a=e(document.createElement("a")).appendTo(o);a.addClass(r.FEEDINGSHELF_PREFIX+"item-ph-text");var l=this._addIcon$=e(document.createElement("div")).appendTo(n).addClass(r.COMMON_PREFIX+"havanaVXTabSprite16");l.addClass(r.FEEDINGSHELF_PREFIX+"item-add-icon");var c=e.proxy(this._dispatchAddFeedingEvent,this);o.on("mousedown",this._activeHandler).on("mouseenter",this._activeHandler).on("mouseleave",this._activeHandler).on("click",c);l.on("mousedown",this._activeHandler).on("mouseenter",this._activeHandler).on("mouseleave",this._activeHandler).on("click",c);e("body").on("mouseup",this._activeHandler)};I.prototype._dispatchAddFeedingEvent=function(){if(this.enableFeeding()){this._dispatchEvent(new a(a.CLICK_ADD_FEEDING,this))}};I.prototype._active=function(e){if(this._enableFeeding){if(e.type==="mouseup"||e.type==="mouseleave"){this._list$.removeClass(r.FEEDINGSHELF_PREFIX+"item-list_active");this._addIcon$.removeClass(r.FEEDINGSHELF_PREFIX+"item-add-icon_active")}else if(e.type==="mousedown"||e.type==="mouseenter"){this._list$.addClass(r.FEEDINGSHELF_PREFIX+"item-list_active");this._addIcon$.addClass(r.FEEDINGSHELF_PREFIX+"item-add-icon_active")}}};I.prototype._isValidToken=function(e){if(this._draggingCard$){return true}if(e.aggregationTarget()!==undefined){return false}var t=e.type();var i=e.dataType();var r=t?t.toLowerCase():t;var n=i?i.toLowerCase():i;var s=this._shelf.feedItemType;var o=f.feedCompatible(s,r,n);if(o){var a=this.analyses();for(var l=0;l<a.length;l++){if(a[l].id()===e.id()||a[l].aggregationTarget()===e.id()){o=false;break}}}return o};I.prototype._droppable=function(){var t=this;var r;var n;var a;var l=function(i,s){s.killRevertAnimation();if(r){s.currentAction(o.ACCEPT_AS_REPLACEMENT);e(r).detach()}else{s.currentAction(o.ACCEPT)}t._addAnalysisAt(i,n)};var c=function(i,s,a){if(t._numCards()===0){s.off("sap.viz.controls.analysisDrag.events.drag");if(!t._enableFeeding){a.currentAction(o.DENY);var l=u.get("VIZ_COMMON_DIMENSION_LIMITATION_WARN");a.showWarn(l);return}else{t._ghostCard$=t._addGhostAnalysisAt(i,0);a.currentAction(o.ACCEPT)}}else{s.on("sap.viz.controls.analysisDrag.events.drag",function(s,l,c){var p=[];var h=-1;t._traversalCards(function(i){if(t._draggingCard$&&t._draggingCard$[0]===this){h=i}p.push({card:this,offset:e(this).offset()})},false,true);n=-1;r=null;for(var d=0;d<p.length;d++){var v=p[d].offset.top;if(c<v+I.CARD_HEIGHT-6){n=d;if(c>=v+2){}break}}if(n===-1){n=p.length}if(i.type===_.MND){n=n<p.length/2?0:p.length}if(!t._draggingCard$&&t._numCards()===t._shelf.capacity){r=p[n===p.length?n-1:n].card}var f=h!==-1;var m=f&&(h===n||h+1===n&&!r);if(f){r=null}t._dropIndicator$.detach();if(r){a.currentAction(o.ACCEPT_AS_REPLACEMENT)}else{if(!t._enableFeeding){a.currentAction(o.DENY);var g=u.get("VIZ_COMMON_DIMENSION_LIMITATION_WARN");a.showWarn(g)}else{a.currentAction(o.ACCEPT);if(!m){t._addElementAt(t._list$,t._dropIndicator$,n)}}}})}};this._list$.droppable({tolerance:"pointer",accept:"."+s.DRAGGABLE_CLASS_ANALYSIS,activate:function(e,t){},deactivate:e.proxy(function(e,t){if(this._ghostCard$){this._ghostCard$.remove()}if(this._dropIndicator$){this._dropIndicator$.detach()}},this),drop:e.proxy(function(e,t){var r=t.helper;var n=s.instance().getAnalysisToken(r);var a=n.analysisObject;if(n.currentAction()!==o.DENY&&this._isValidToken(a)){l(a,n)}else if(n.currentAction()!==o.DENY&&i.isArray(n.backupAOs)){var c=false;for(var p=0;p<n.backupAOs.length;p++){if(this._isValidToken(n.backupAOs[p])){l(n.backupAOs[p],n);c=true;break}}if(!c){n.currentAction(o.DENY)}}else{n.currentAction(o.DENY)}n.dropTarget(this._shelf);if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach()},this),over:function(e,r){var n=r.helper;a="over";i.defer(function(){if(a!="over"){return}var e=s.instance().getAnalysisToken(n);var r=e.analysisObject;if(t._isValidToken(r)){c(r,n,e)}else if(i.isArray(e.backupAOs)){var l=false;for(var p=0;p<e.backupAOs.length;p++){if(t._isValidToken(e.backupAOs[p])){c(e.backupAOs[p],n,e);l=true;break}}if(!l){e.currentAction(o.DENY)}}else{e.currentAction(o.DENY)}})},out:e.proxy(function(e,t){var i=t.helper;a="out";i.off("sap.viz.controls.analysisDrag.events.drag");var r=s.instance().getAnalysisToken(i);r.playDefaultAction();if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach();r.showWarn()},this)})};I.prototype._traversalCards=function(e,t,i){var r=this._list$.children();var n=0;for(var s=0;s<r.length;s++){var o=r[s];if(this._addIndicator$&&this._addIndicator$[0]===o){continue}if(this._dropIndicator$&&this._dropIndicator$[0]===o){continue}if(t&&this._draggingCard$&&this._draggingCard$[0]===o){continue}if(i&&this._ghostCard$&&this._ghostCard$[0]===o){continue}e.call(o,n);n++}};I.prototype._addGhostAnalysisAt=function(e,t){var i=this._addCardAt(e,t);i.addClass(r.FEEDINGSHELF_PREFIX+"card-ghost");return i};I.prototype.removeCard=function(e){if(e.data){this._lastAnalysisObjectRemoved=e.data("__analysis")}this._lastCardRemoved=e;e.remove();this._analysesChanged()};I.prototype._analysesChanged=function(){var e=this._numCards();if(e>=1){this._addIndicator$.addClass(r.FEEDINGSHELF_PREFIX+"item-ph-half")}else{this._addIndicator$.removeClass(r.FEEDINGSHELF_PREFIX+"item-ph-half")}if(e>=this._shelf.capacity){this._addIcon$.css("display","none");this._addIndicator$.detach()}else{this._addIcon$.css("display","");this._addIndicator$.appendTo(this._list$)}this._dispatchEvent(new a(a.FEEDING_CHANGED,this))};I.prototype._updateCard=function(t,i){var n;if(i.type()===_.HIERARCHY){n=i.selectedHierarchyLevel().name();this._lastHierarchyOjbectUpdated=i}else{n=i.name()}t.data("__analysis",i);t.attr("title",n);var s=e("."+r.FEEDINGSHELF_PREFIX+"card-text",t);s.text(n)};I.prototype._genHierarchyMenuGroups=function(e){var t=[];var i=e.hierarchyLevels();if(e.aggregationType()!==undefined){E.sanitizeAnalysisObjects(i)}for(var r=0;r<i.length;r++){var n=i[r];var s=new d(n.id(),n.name());s.selected(n.selected());t.push(s)}var o=[new h(t,true)];var a=e.actions();if(a){for(var r=0;r<a.length;r++){var l=a[r];o.push(l)}}return o};I.prototype._genMenuGroups=function(e){return e.actions()};I.prototype._addCardAt=function(t,i){var n=e(document.createElement("div")).addClass(r.FEEDINGSHELF_PREFIX+"card");n.attr("id",t.id());var s=0;var o,l;var c,p,h,d;if(t.type()===_.HIERARCHY){var u=e(document.createElement("span")).appendTo(n);u.addClass([r.FEEDINGSHELF_PREFIX+"hierarchy-card-icon",r.COMMON_PREFIX+"UVBSharedSprite"].join(" "));this._createCardAction(n,this._genHierarchyMenuGroups,e.proxy(function(e){var i=e.data.selectedItem.id();var r=false;var s=t.hierarchyLevels();for(o=0;o<s.length;o++){if(s[o].id()===i){r=true;break}}if(r){t=t.clone();t.selectedHierarchyLevelID(e.data.selectedItem.id());this._updateCard(n,t);this._dispatchEvent(new a(a.FEEDING_CHANGED,this))}else{this._dispatchEvent(new a(a.ACTION_CHANGED,this,{feedItemID:this._shelf.id,analysisObjectID:t.id(),actionID:e.data.selectedItem.id()}))}},this),t);s++}else if(t.actions()&&t.actions().length>0){this._createCardAction(n,this._genMenuGroups,e.proxy(function(e){this._dispatchEvent(new a(a.ACTION_CHANGED,this,{feedItemID:this._shelf.id,analysisObjectID:t.id(),actionID:e.data.selectedItem.id()}))},this),t);s++}var v=e(document.createElement("div")).appendTo(n);v.attr("style","width:19px; height:22px;");v.addClass(r.FEEDINGSHELF_PREFIX+"card-operation-div");var f=e(document.createElement("span")).appendTo(v);f.addClass(r.FEEDINGSHELF_PREFIX+"card-operation "+r.COMMON_PREFIX+"havanaSharedSprite16");v.click(e.proxy(function(){this.removeCard(n)},this));s++;var m=e(document.createElement("div")).appendTo(n);m.addClass([r.FEEDINGSHELF_PREFIX+"card-text",r.FEEDINGSHELF_PREFIX+"card-text-with-icon-"+s].join(" "));m.addClass(r.COMMON_PREFIX+"text-ellipsis");this._updateCard(n,t);this._addElementAt(this._list$,n,i);this._draggable(n);return n};I.prototype.getCardFromAnalysisObject=function(t){var i;var r=this._list$[0];if(t.dataType()===m.LEVEL||t.dataType()===m.HIERARCHY){var n=t.hierarchyLevels();for(var s=0;s<n.length;s++){var o=n[s];if(o.selected()){i=o._name}}}else{i=t.name()}for(var s=0;s<r.childNodes.length;s++){var a=r.childNodes[s];if(a.innerText.indexOf(i)!==-1){return e(a)}else if(a.textContent&&a.textContent.indexOf(i)!==-1){return e(a)}}return null};I.prototype._createCardAction=function(t,i,n,s){var o=e(document.createElement("div")).appendTo(t);o.attr("style","width:19px; height:22px;");o.addClass(r.FEEDINGSHELF_PREFIX+"action-icon-div");var a=e(document.createElement("span")).appendTo(o);if(s.type()===_.HIERARCHY){t.addClass(r.FEEDINGSHELF_PREFIX+"card-hierarchy");a.addClass([r.FEEDINGSHELF_PREFIX+"action-icon-hierarchy",r.COMMON_PREFIX+"UVBSharedSprite"].join(" "))}if(s.actions()){t.addClass(r.FEEDINGSHELF_PREFIX+"card-measure");a.addClass([r.FEEDINGSHELF_PREFIX+"action-icon-measure",r.COMMON_PREFIX+"havanaSharedSprite16"].join(" "))}o.on("click",e.proxy(function(){var e=new l(document.createElement("div"),i.call(this,t.data("__analysis")));e.addEventListener(c.ITEM_SELECTED,n,this);e.open(o,p.DOWN_WITH_ARROW)},this));return o};I.prototype._addElementAt=function(t,i,r){var n=t.children();if(r!==-1&&r<n.length){e(n[r]).before(i)}else{t.append(i)}};I.prototype._draggable=function(t){var i=this;s.enableDraggableFeeding(t[0],t.data("__analysis"));t.draggable({containment:"document",revert:"valid",helper:function(t){var i=s.getDefaultHelper(this);var r=s.instance().getAnalysisToken(e(i));r.defaultAction(o.AS_TRASH);return i},start:e.proxy(function(t,i){this._draggingCard$=e(this);this._draggingCard$.addClass(r.FEEDINGSHELF_PREFIX+"card-ghost");var n=i.helper;var o=s.instance().getAnalysisToken(n);var l=o.analysisObject;var c={analysisObject:l,feedId:this._shelf.id};this._dispatchEvent(new a(a.FEEDING_EMPTY_CHANGED,this,c))},this),stop:function(t,n){var l=n.helper;if(i._draggingCard$){i._draggingCard$.removeClass(r.FEEDINGSHELF_PREFIX+"card-ghost");i._draggingCard$=null}var c=s.instance().getAnalysisToken(l);if(!c.dropTarget()||c.currentAction()===o.ACCEPT||c.currentAction()===o.ACCEPT_AS_REPLACEMENT){i.removeCard(e(this))}else{var p={analysisObject:c.analysisObject,feedId:i._shelf.id};i._dispatchEvent(new a(a.FEEDING_DROP_DENY,this,p))}},drag:function(e,t){}})};I.prototype.enableFeeding=function(e){if(arguments.length>0){this._enableFeeding=e;this._updateFeedingEnabled(e)}else{return this._enableFeeding}};I.prototype._updateFeedingEnabled=function(e){if(e){this._list$.css("cursor","pointer");this._addIcon$.css("display","block")}else{this._list$.css("cursor","default");this._addIcon$.css("display","none")}};I.prototype.resetLastRemoved=function(){this._lastAnalysisObjectRemoved=null;this._lastCardRemoved=null};I.prototype.resetTwinAnalysisObject=function(){this._lastTwinAnalysisObjectRemoved=null};I.langProps={changeCalculation:"VIZ_COMMON_CHANGE_CALCULATION",sum:"VIZ_COMMON_SUM",average:"VIZ_COMMON_AVERAGE",min:"VIZ_COMMON_MIN",max:"VIZ_COMMON_MAX",countDistinct:"VIZ_COMMON_COUNT_DISTINCT",countAll:"VIZ_COMMON_COUNT_ALL",none:"VIZ_COMMON_NONE",sum_short:"VIZ_COMMON_SUM_SHORT",average_short:"VIZ_COMMON_AVERAGE_SHORT",min_short:"VIZ_COMMON_MIN_SHORT",max_short:"VIZ_COMMON_MAX_SHORT",countDistinct_short:"VIZ_COMMON_COUNT_DISTINCT_SHORT",countAll_short:"VIZ_COMMON_COUNT_ALL_SHORT",none_short:"VIZ_COMMON_NONE_SHORT"};return I});e("sap/viz/controls/common/views/feed/FeedListEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedListEvent"};t.extend(r,i);r.DROP_DOWN_OPENED="dropDownOpened";r.DROP_DOWN_CLOSED="dropDownClosed";r.ITEM_SELECTED="itemSelected";return r});e("sap/viz/controls/common/constants/KeyboardEventConst",[],function(){var e={};e.UP=38;e.DOWN=40;e.ENTER=13;e.SPACE=32;e.ESC=27;e.SUBTRACT=45;e.DECIMAL=46;e.NUM_0=48;e.NUM_9=57;return e});e("sap/viz/controls/common/views/feed/FeedList",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/views/feed/FeedListEvent","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/constants/KeyboardEventConst"],function(e,t,i,r,n,s,o,a,l,c,p){var h=function(t,i,r,n){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.FeedList";this._dom$=e(t);this._analyses=i;this._feedingType=r;this._dataProvider=[];var s,a;var l=function(e){for(var t=0;t<n.length;t++){if(n[t].id()===e){return true}}return false};if(i){for(s=0;s<i.length;s++){var p=i[s];if(l(p.id())){continue}if(c.feedCompatible(this._feedingType,p.type(),p.dataType())){this._dataProvider.push({label:p.name(),analysis:p})}}}this._header={label:o.get(h.langProps[this._feedingType]),suffix:this._dataProvider.length};this._container$=null;this._content$=null;this._header$=null;this._ul$=null;this._arrow$=null;this._createChildren();this._dock=null;this._calDockPosFun=null;this._resizeHandler=null;this._documentHandler=null;this._keyDownHandlerProvider=e.proxy(this._keyDownHandler,this);this._mouseMoveHandlerProvider=e.proxy(this._mouseMoveHandler,this)};r.extend(h,n);h.langProps={Measure:"VIZ_COMMON_MEASURES",Dimension:"VIZ_COMMON_DIMENSIONS",Geography:"VIZ_COMMON_DIMENSIONS",Subtotal:"VIZ_COMMON_SUBTOTALS"};var d="down";var u="up";h.prototype.locate=function(i,r){var n=this._dom$;var s=this._ul$;var o=s.outerHeight();var a=Math.max(e(document.body).height(),e(window).height());var l=a-this._header$.outerHeight()-15;if(o>l){o=l}s.outerHeight(o);var c=o+this._header$.outerHeight()+5;var p=Math.max(s.outerWidth(),this._header$.outerWidth());var h=this._arrow$.outerWidth();var d="left";if(r==="left"||r==="right"){d=r}else if(p+h*3/4>i.x){d="right"}var u=8;var _=this._arrow$.outerHeight()+18;var v=Math.max(0,i.y-a+_/2+u);i.y=Math.min(i.y,a-_/2-u);var f=Math.max(i.y-v+_/2+u-c,5);var m=Math.min(i.y-f-12,a-_-u-f-v);var g=2;if(d==="right"){this._container$.addClass(t.COMMON_PREFIX+"feedlist-container-right");n.css({left:i.x+i.shelfWidth+h*3/4,top:f});this._arrow$.css({left:-h/2+g,top:m})}else if(d==="left"){this._container$.addClass(t.COMMON_PREFIX+"feedlist-container-left");n.css({left:i.x-p-h*3/4,top:f});this._arrow$.css({left:p-h/2-g,top:m})}this._content$.css({width:p+"px",height:c+"px"});this._container$.css({width:p+2+"px",height:c+"px"})};h.prototype.open=function(t){if(typeof t==="function"){this._dock=t();this._calDockPosFun=t}else{this._dock=t}var i=this._dom$;i.appendTo(e("body"));this._dispatchEvent(new s(s.DROP_DOWN_OPENED,this));this.locate(this._dock);this._documentHandler=e.proxy(function(t){if(!e.contains(this._dom,t.target)){this.close()}},this);this._addEventListeners();document.addEventListener("mousedown",this._documentHandler,true);document.addEventListener("keydown",this._keyDownHandlerProvider,true);e(window).on("blur",this._documentHandler);this._cursorShowed=true};h.prototype.close=function(){var i=this._dom$;var r=1;if(this._classVisible){i.removeClass(this._classVisible);r=2e3}setTimeout(function(){i.detach()},r);document.removeEventListener("mousedown",this._documentHandler,true);document.removeEventListener("keydown",this._keyDownHandlerProvider,true);document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);e(window).off("blur",this._documentHandler);e(window).off("resize",this._resizeHandler);this._dispatchEvent(new s(s.DROP_DOWN_CLOSED,this));if(!this._cursorShowed){e("."+t.COMMON_PREFIX+"hide-cursor").removeClass(t.COMMON_PREFIX+"hide-cursor")}this._calDockPosFun=null;this.destroy()};h.prototype._createChildren=function(i){this._dom$.addClass(t.COMMON_PREFIX+"feedlist");var r=this;var n=this._container$=e(document.createElement("div")).appendTo(this._dom$);n.addClass(t.COMMON_PREFIX+"feedlist-container");var s=this._arrow$=e(document.createElement("div")).appendTo(n);s.addClass(t.COMMON_PREFIX+"feedlist-arrow");s.addClass(t.PREFIX+"feedlist");var o=this._content$=e(document.createElement("div")).appendTo(n);o.addClass(t.COMMON_PREFIX+"feedlist-content");var p=this._header$=e(document.createElement("div")).appendTo(o).text(this._header.label);p.addClass(t.COMMON_PREFIX+"feedlist-content-header");var h=this._ul$=e(document.createElement("ul")).appendTo(o);h.addClass(t.COMMON_PREFIX+"scrollable");h.addClass(t.COMMON_PREFIX+"scrollable-y");var d;var u;for(d=0;d<this._dataProvider.length;d++){var _=e(document.createElement("li")).appendTo(h);var v=e(document.createElement("a")).appendTo(_);u=this._dataProvider[d];var f,m;var g=u.analysis.dataType();var E=c.isGeoHierarchyFeed(this._feedingType,u.analysis.type(),g);if(this._feedingType===l.DIMENSION&&u.analysis.type()===a.HIERARCHY||E){var y=this._setHierarchyAnalysis(u.analysis.clone(),0);_.data("__item",y);f=e(document.createElement("div")).appendTo(_);f.addClass(t.COMMON_PREFIX+"feedlist-li-hierarchy-indicator");m=e(document.createElement("div")).appendTo(f);m.addClass(t.COMMON_PREFIX+"UVBSharedSprite");if(g&&g.toLowerCase()===l.GEOGRAPHY.toLowerCase()){m.addClass(t.COMMON_PREFIX+"geography")}else{m.addClass(t.COMMON_PREFIX+"feedlist-li-hierarchy-Icon")}var I=e(document.createElement("div")).appendTo(_);I.data("__items",u.analysis);I.addClass(t.COMMON_PREFIX+"feedlist-li-button");var C=e(document.createElement("div")).appendTo(I);C.addClass(t.COMMON_PREFIX+"havanaVXTabSprite16 "+t.COMMON_PREFIX+"feedlist-li-plus-icon");I.attr("command","open");I.click(function(e){e.stopPropagation();r._expandButtonHandler(e)});_.click(e.proxy(this._analysisSelectedHandler,this))}else{if(g&&g.toLowerCase()===l.GEOGRAPHY.toLowerCase()){f=e(document.createElement("div")).appendTo(_);f.addClass(t.COMMON_PREFIX+"feedlist-li-hierarchy-indicator");m=e(document.createElement("div")).appendTo(f);m.addClass(t.COMMON_PREFIX+"geography")}_.data("__item",u.analysis);_.click(e.proxy(this._analysisSelectedHandler,this))}_.hover(e.proxy(function(t){this._highlightItem(e(t.currentTarget))},this),e.proxy(function(t){this._unhighlightItem(e(t.currentTarget))},this));v.text(u.label);v.addClass(t.COMMON_PREFIX+"text-ellipsis");if(u.suffix){v.addClass(t.COMMON_PREFIX+"feedlist-li-a_suffix").attr("__suffix",u.suffix)}if(u.icon){}}};h.prototype._expandButtonHandler=function(t){var i=e(t.currentTarget);if(i.attr("command")==="open"){this._openHierarchyItem(i)}else{this._closeHierarchyItem(i)}};h.prototype._setHierarchyAnalysis=function(e,t){var i=e.hierarchyLevels();for(var r=0;r<i.length;r++){var n=i[r];if(r===t){n.selected(true)}else{n.selected(false)}}return e};h.prototype._analysisSelectedHandler=function(t){var i=this;var r=e(t.currentTarget);var n=r.data("__item");i._dispatchEvent(new s(s.ITEM_SELECTED,i,{selectedItem:n}));i.close()};h.prototype._keyDownHandler=function(i){var r=i.keyCode;if(!i.ctrlKey&&(r===p.DOWN||r===p.UP)){if(this._cursorShowed){e("*").addClass(t.COMMON_PREFIX+"hide-cursor");this._cursorShowed=false;setTimeout(e.proxy(function(){document.addEventListener("mousemove",this._mouseMoveHandlerProvider,true)},this),200)}}var n=e("."+t.COMMON_PREFIX+"feedlist-li-highlight",this._ul$);switch(r){case p.UP:if(i.ctrlKey){var s=e("."+t.COMMON_PREFIX+"feedlist-li-minus-icon",n);if(s[0]){this._closeHierarchyItem(s.parent())}}else if(n[0]!=this._ul$[0].firstChild){this._unhighlightItem(n);this._highlightItem(n.prev());if(n.offset().top-this._ul$.offset().top<n.height()){this._updateScrollBarPosition(n,u)}}break;case p.DOWN:if(i.ctrlKey){var o=e("."+t.COMMON_PREFIX+"feedlist-li-plus-icon",n);if(o[0]){this._openHierarchyItem(o.parent())}}else{if(!n[0]){this._highlightItem(e(this._ul$[0].firstChild))}else if(n[0]!=this._ul$[0].lastChild){this._unhighlightItem(n);this._highlightItem(n.next());if(n.offset().top+n.height()>this._ul$.offset().top+this._ul$.height()){this._updateScrollBarPosition(n,d)}}}break;case p.ENTER:case p.SPACE:if(n[0]){this._selectItem(n)}break;case p.ESC:this.close();break}};h.prototype._validateSize=function(){if(!!this._calDockPosFun&&typeof this._calDockPosFun==="function"){this.locate(this._calDockPosFun())}};h.prototype._resizer=function(e){var t=this;if(!e.data.invalidateSize){setTimeout(function(){e.data.invalidateSize=false;t._validateSize()},1e3/24)}e.data.invalidateSize=true};h.prototype._addEventListeners=function(){this._resizeHandler=e.proxy(this._resizer,this);e(window).resize({invalidateSize:false},this._resizeHandler)};h.prototype._mouseMoveHandler=function(i){if(!this._cursorShowed){e("."+t.COMMON_PREFIX+"hide-cursor").removeClass(t.COMMON_PREFIX+"hide-cursor");this._cursorShowed=true;document.removeEventListener("mousemove",this._mouseMoveHandlerProvider,true);var r=e("."+t.COMMON_PREFIX+"feedlist-li-highlight",this._ul$);this._unhighlightItem(r)}};h.prototype._highlightItem=function(e){e.addClass(t.COMMON_PREFIX+"feedlist-li-highlight")};h.prototype._unhighlightItem=function(e){e.removeClass(t.COMMON_PREFIX+"feedlist-li-highlight")};h.prototype._selectItem=function(e){var t=e.data("__item");this._dispatchEvent(new s(s.ITEM_SELECTED,this,{selectedItem:t}));this.close()};h.prototype._openHierarchyItem=function(i){var r=i.data("__items");var n=r.hierarchyLevels();var s=i.parent();for(var o=0;o<n.length;o++){var a=e(document.createElement("li"));e(s).after(a);s=a;var l=e(document.createElement("span")).appendTo(a);var c=this._setHierarchyAnalysis(r.clone(),o);a.data("__item",c);l.text(n[o].name());l.addClass(t.COMMON_PREFIX+"text-ellipsis");a.click(e.proxy(this._analysisSelectedHandler,this));a.hover(e.proxy(function(t){this._highlightItem(e(t.currentTarget))},this),e.proxy(function(t){this._unhighlightItem(e(t.currentTarget))},this))}i.attr("command","close");i.addClass(t.COMMON_PREFIX+"feedlist-li-button-close");i.children().attr("class",t.COMMON_PREFIX+"havanaVXTabSprite16 "+t.COMMON_PREFIX+"feedlist-li-minus-icon");this._updateAllExpandButtons()};h.prototype._closeHierarchyItem=function(e){var i=e.data("__items");var r=i.hierarchyLevels();for(var n=0;n<r.length;n++){e.parent().next().remove()}e.attr("command","open");e.removeClass(t.COMMON_PREFIX+"feedlist-li-button-close");e.children().attr("class",t.COMMON_PREFIX+"havanaVXTabSprite16 "+t.COMMON_PREFIX+"feedlist-li-plus-icon");this._updateAllExpandButtons()};h.prototype._updateAllExpandButtons=function(){var i=this._ul$[0].scrollHeight>this._ul$.outerHeight();e("."+t.COMMON_PREFIX+"feedlist-li-button").each(function(){e(this).removeClass(t.COMMON_PREFIX+"feedlist-li-button-offset");if(i){e(this).addClass(t.COMMON_PREFIX+"feedlist-li-button-offset")}})};h.prototype._updateScrollBarPosition=function(t,i){var r=this._ul$.scrollTop();if(i===d){var n=t.nextAll();var s=t.height()*n.length;if(s<=this._ul$.height()){r+=s}else{r+=this._ul$.scrollHeight()/t.height()}}else{var o=t.prevAll();var a=t.height()*o.length;if(a<=this._ul$.height()){r=0}else{r-=this._ul$.scrollHeight()/t.height()}}this._cursorShowed=true;this._ul$.scrollTop(r);setTimeout(e.proxy(function(){this._cursorShowed=false},this),500)};return h});e("sap/viz/controls/mapbuilder/widgets/WidgetFeeding",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/views/feed/FeedingShelf","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/views/feed/FeedList","sap/viz/controls/common/views/feed/FeedListEvent","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/events/GeoEvent"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f){var m={id:"location",name:"VIZ_MAPBUILDER_GEO",capacity:1,analysisType:"dimension",feedItemType:l.GEOGRAPHY};var g={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"measure",feedItemType:l.MEASURE};var E={id:"color",name:"VIZ_MAPBUILDER_GEO_COLOR",capacity:1,analysisType:"dimension",feedItemType:l.DIMENSION};var y={id:"size",name:"VIZ_MAPBUILDER_GEO_SIZE",capacity:1,analysisType:"measure",feedItemType:l.MEASURE};var I=function(t,i){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetFeeding";this._feedMap=this._config.feedMap;this._measures=null;this._attributes=null;this._measures$=null;this._attributes$=null;this._feedingSelves={};this._feedingPanel$=e("<div/>").appendTo(t);this._vizType=this._config.vizType!=null?this._config.vizType:u.VIZ_TYPE_CHOROPLETH;this._titleMeasure=null;this._creatControls();this.update({feeding:this._config.feeding})};t.extend(I,_);I.prototype._prepareFeeding=function(e){if(e==u.VIZ_TYPE_CHOROPLETH){this._measures=[i.clone(g)];this._attributes=[i.clone(m)]}else if(e==u.VIZ_TYPE_BUBBLE){this._measures=[i.clone(y),i.clone(E)];this._attributes=[i.clone(m)]}else if(e==u.VIZ_TYPE_MARKER){this._measures=[];this._attributes=[i.clone(m)]}else{throw n.get("VIZ_MAPBUILDER_NOT_SUPPORT_ERROR")}var t=function(e){var t=e.target();this._uiShelf=t;if(this._config.feedingPanel&&this._config.feedingPanel.useBuildInFeedList===true){var i=t.shelf();var r=document.createElement("div");var n=this._getFeed(i.id);var s=n?n.values():[];var o=new p(r,this._allAnalyses,i.feedItemType,s);o.addEventListener(h.ITEM_SELECTED,function(e){var i=e.data.selectedItem;t.addAnalysis(i)},this);o.open(t.popUpDock())}else{this._dispatchEvent(new d(d.REQUEST_FEED,this,{feedId:t.shelf().id,fieldLocalPosition:t.popUpDock()}))}};if(this._measures.length>0){this._measures$.show();for(var r=0;r<this._measures.length;r++){var a=n.get(this._measures[r].name);this._measures[r].name=a?a:"Color";var l=new s(this._measures$,this._measures[r],this._feedMap);l.addEventListener(o.FEEDING_CHANGED,function(e){this._dispatchEvent(e)},this);l.addEventListener(o.CLICK_ADD_FEEDING,t,this);this._feedingSelves[this._measures[r].id]=l;l.addEventListener(o.ACTION_CHANGED,this._actionChangedHandler,this)}}else{this._measures$.hide()}if(this._attributes.length>0){for(var c=0;c<this._attributes.length;c++){this._attributes[c].name=n.get(this._attributes[c].name);var _=new s(this._attributes$,this._attributes[c],this._feedMap);_.addEventListener(o.FEEDING_CHANGED,function(e){this._dispatchEvent(e)},this);_.addEventListener(o.CLICK_ADD_FEEDING,t,this);this._feedingSelves[this._attributes[c].id]=_;_.addEventListener(o.ACTION_CHANGED,this._actionChangedHandler,this)}}};I.prototype._creatControls=function(){var t=e(this._dom);this._attributes$=e("<div/>").appendTo(t).addClass(r.MAPBUILDER_PREFIX+"feeding-container");this._measures$=e("<div/>").appendTo(t).addClass(r.MAPBUILDER_PREFIX+"feeding-container");this._prepareFeeding(this._vizType)};I.prototype.update=function(e){var t=e.feeding;if(t){for(var i=0;i<t.length;i++){var r=t[i];if(r){this._feedingSelves[r.id()].enableDispatchEvent(false);this._feedingSelves[r.id()].analyses(r.values());this._feedingSelves[r.id()].enableDispatchEvent(true)}}}};I.prototype.changeFeeding=function(e){this._measures$.empty();for(var t in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(t)){this._feedingSelves[t].removeAllEventListeners()}}this._feedingSelves={};this._attributes$.empty();this._prepareFeeding(e)};I.prototype.getFeeds=function(){var e=[];for(var t in this._feedingSelves){if(this._feedingSelves.hasOwnProperty(t)){var i=this._feedingSelves[t].shelf();e.push(new a(i.id,c.convertFeedType(i.feedItemType),this._feedingSelves[t].analyses()))}}return e};I.prototype._getFeed=function(e){var t=this.getFeeds();for(var i=0;i<t.length;i++){var r=t[i];if(r.id()===e){return r}}return null};I.prototype.save=function(){var e=[];for(var t=0;t<this.getFeeds().length;t++){e[t]=a.toJSON(this.getFeeds()[t])}var i={feeding:e};return i};I.prototype.feedingFromJson=function(e){if(!e){return}var t=[];for(var i=0;i<e.feeding.length;i++){t[i]=a.fromJSON(e.feeding[i])}return t};I.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};I.prototype._actionChangedHandler=function(e){this._dispatchEvent(new f(f.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID}))};return I});e("sap/viz/controls/mapbuilder/widgets/WidgetProperties",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function(e,t,i,r,n,s){var o=function(e,t){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetProperties";this._properties=this._config.properties;this._settings=this._config.settings;this._settings$={};this._creatControls()};t.extend(o,n);o.prototype._creatSettings=function(){var t=e(this._dom);for(var n=0;n<this._settings.length;n++){var s=this._settings[n];var o;if(s.type==="check"){o=e("<div/>").appendTo(t);var a=e('<input type="checkbox"></input>').appendTo(o).addClass(i.MAPBUILDER_PREFIX+"inline-block");var l=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"inline-block").html(r.get(s.name)).addClass(i.MAPBUILDER_PREFIX+"inline-block").addClass(i.MAPBUILDER_PREFIX+"property-text").appendTo(o);a.on("click",e.proxy(this._clickCheckBoxHandler,a,s,this));a.attr("checked",s.value);this._settings$[s.id]=a;if(n===0&&!this._config.showLegend){o.hide()}}}};o.prototype._creatControls=function(){this._creatSettings()};o.prototype._clickCheckBoxHandler=function(e,t,i){if(e.checkedEvent&&e.uncheckedEvent){if(this.attr("checked")){t._dispatchEvent(new s(e.checkedEvent,this))}else{t._dispatchEvent(new s(e.uncheckedEvent,this))}}if(e.event){t._dispatchEvent(new s(e.event,this,{id:e.id,value:this[0].checked}))}};o.prototype.update=function(t){e.each(t,function(e,i){if(this.settings[i].type==="check"){this.setting$[i].attr("checked",t[i])}})};o.prototype.changeSetting=function(t){this._settings=t;e(this._dom).empty();this._settings$={};this._creatSettings()};return o});e("sap/viz/controls/mapbuilder/utils/UIHelper",["sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/Utils","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent"],function(e,t,i,r){var n={id:"legendVisible",name:"VIZ_MAPBUILDER_SHOW_LEGEND",type:"check",value:true,checkedEvent:r.SHOW_LEGEND,uncheckedEvent:r.HIDE_LEGEND};var s={id:"markerCluster",name:"VIZ_MAPBUILDER_MARKER_CLUSTER",type:"check",value:false,event:r.CHANGE_VIZ_PROPERITIES};var o={id:"bubbleCluster",name:"VIZ_MAPBUILDER_BUBBLE_CLUSTER",type:"check",value:false,event:r.CHANGE_VIZ_PROPERITIES};var a=function(){this.__className="sap.viz.controls.geo.utils.UIHelper"};a.getAvailableSettings=function(r){if(r===i.VIZ_TYPE_CHOROPLETH){return[t.clone(n)]}else if(r===i.VIZ_TYPE_MARKER){return[t.clone(n),t.clone(s)]}else if(r===i.VIZ_TYPE_BUBBLE){return[t.clone(n),t.clone(o)]}else{throw e.get("VIZ_MAPBUILDER_NOT_SUPPORT_ERROR")}};return a});e("sap/viz/controls/mapbuilder/sections/GeoVizLayerSection",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetDataPoint","sap/viz/controls/mapbuilder/widgets/WidgetFeeding","sap/viz/controls/mapbuilder/widgets/WidgetProperties","sap/viz/controls/mapbuilder/utils/UIHelper"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f){var m=function(e,t){m.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoVizLayerSection";this._feedMap=this._config.feedMap;this._feeding=null;this._dataType=null;this._properties=null;this._vizType=this._config.vizType?this._config.vizType:c.VIZ_TYPE_CHOROPLETH;this._lableTitle=null;this._lableText=null;this._geoLocationFeedId="";this._geoFeatureColorFeedId="";this._geoFeatureSizeFeedId="";this._geoLocationFeedName="";this._geoFeatureColorFeedName="";this._geoFeatureSizeFeedName="";this._geoLocationFeedValues=[];this._geoFeatureColorFeedValues=[];this._geoFeatureSizeFeedValues=[];this._colorAnalysisType="";this._locationLength="";this._colorMeasureLength="";this._colorDimensionLength="";this._sizeLength="";this._showIconDom=false;this._clusterChecked=false;this._lableTitleText=n.get("VIZ_MAPBUILDER_CHOROPLETH");this._allAnalyses=null};t.extend(m,h);m.prototype.update=function(e){if(e.vizType){this._feeding.changeFeeding(e.vizType)}if(e.feeding){this._feeding.update({feeding:e.feeding})}if(e.title){this.title(e.title,true)}if(e.properties){this._properties.update(e.properties)}};m.prototype._createChildControl=function(t){var r=new d(t,{title:n.get("VIZ_MAPBUILDER_DATA_POINTS")+": "});this._lableTitle=e(document.createElement("div")).appendTo(t).addClass(i.MAPBUILDER_PREFIX+"chartType-icon-title");this._lableText=e("<div/>").appendTo(this._lableTitle).addClass(i.MAPBUILDER_PREFIX+"chartType-icon-title-text");this._lableText.text(this._lableTitleText);var s=e(document.createElement("div")).appendTo(t).addClass(i.MAPBUILDER_PREFIX+"datapointchooser");this._dataType=new u(s,{title:n.get("VIZ_MAPBUILDER_TYPE")+": ",selected:this._vizType});var o=e(document.createElement("div")).appendTo(t);this._feeding=new _(o,{feedMap:this._feedMap,vizType:this._vizType,feeding:this._config.feeding?this._config.feeding:[],feedingPanel:this._config.feedingPanel});this._feeding._analysisObjectsForPicker(this._allAnalyses);var a=e(document.createElement("div")).appendTo(t).addClass(i.MAPBUILDER_PREFIX+"properites");this._properties=new v(a,{properites:this._config.properties,settings:f.getAvailableSettings(this._vizType),showLegend:this._config.showLegend})};m.prototype._addEventHandler=function(){this._feeding.addEventListener(r.FEEDING_CHANGED,function(e){this._dispatchEvent(new r(r.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}))},this);this._feeding.addEventListener(p.ACTION_CHANGED,function(e){this._dispatchEvent(new p(p.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID,sectionIdx:this.getSectionIdx()}))},this);this._dataType.addEventListener(p.CHANGE_LAYER_VIZTYPE,function(e){this._changeVizType(e.data.vizType)},this);if(this._config.showLegend){this._properties.addEventListener(p.SHOW_LEGEND,function(e){this._dispatchEvent(new p(p.SHOW_LEGEND,this,{sectionIdx:this.getSectionIdx()}))},this);this._properties.addEventListener(p.HIDE_LEGEND,function(e){this._dispatchEvent(new p(p.HIDE_LEGEND,this,{sectionIdx:this.getSectionIdx()}))},this)}this._properties.addEventListener(p.CHANGE_VIZ_PROPERITIES,function(e){this._clusterChecked=e.data.value;this._dispatchEvent(new p(p.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:e.data.id,value:this._clusterChecked}))},this)};m.prototype._createChildControlPanel=function(e){this._createChildControl(e);this._addEventHandler()};m.prototype.getFeeds=function(){return this._feeding.getFeeds()};m.prototype.destroy=function(){this.getSectionDom().detach()};m.prototype._changeVizType=function(e){var t=this._vizType;this._vizType=e;var a=[];var l=this.getFeeds();var h;for(var d=0;d<l.length;d++){h=l[d];var u=h.values().length;if(h.id()==="location"){this._locationLength=u}else if(h.id()==="color"){if(h.type()===o.MEASURE){this._colorMeasureLength=u}else{this._colorDimensionLength=u}}else if(h.id()==="size"){this._sizeLength=u}for(var _=0;_<u;_++){var v=h.values()[_].id();var m=h.values()[_].name();var g=h.values();if(h.id()==="location"){this._geoLocationFeedName=m;this._geoLocationFeedId=v;this._geoLocationFeedValues=g}else if(h.id()==="color"){this._geoFeatureColorFeedName=m;this._geoFeatureColorFeedId=v;this._geoFeatureColorFeedValues=g;this._colorAnalysisType=h.type()}else if(h.id()==="size"){this._geoFeatureSizeFeedName=m;this._geoFeatureSizeFeedId=v;this._geoFeatureSizeFeedValues=g}}}if(this._vizType===c.VIZ_TYPE_CHOROPLETH){this.title("",false);this.showIcon(false);this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(i.MAPBUILDER_PREFIX+"section-icon-choropleth");this._lableTitleText=n.get("VIZ_MAPBUILDER_CHOROPLETH");if(this._geoLocationFeedId&&this._locationLength>0){a[0]=new s("location",o.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true)}if(this._geoFeatureColorFeedId&&this._colorAnalysisType===o.MEASURE&&this._colorMeasureLength>0){a[1]=new s("color",o.MEASURE,this._geoFeatureColorFeedValues);this.title(this._geoFeatureColorFeedName,false);this.showIcon(true)}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){a[1]=new s("color",o.MEASURE,this._geoFeatureSizeFeedValues);this.title(this._geoFeatureSizeFeedName,false);this.showIcon(true)}}else if(this._vizType===c.VIZ_TYPE_MARKER){this.title("",false);this.showIcon(false);this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-bubble");this._iconDom.addClass(i.MAPBUILDER_PREFIX+"section-icon-marker");this._lableTitleText=n.get("VIZ_MAPBUILDER_MARKER");if(this._geoLocationFeedId&&this._locationLength>0){a[0]=new s("location",o.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true)}}else if(this._vizType===c.VIZ_TYPE_BUBBLE){this.title("",false);this.showIcon(false);this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-choropleth");this._iconDom.removeClass(i.MAPBUILDER_PREFIX+"section-icon-marker");this._iconDom.addClass(i.MAPBUILDER_PREFIX+"section-icon-bubble");this._lableTitleText=n.get("VIZ_MAPBUILDER_BUBBLE");if(this._geoLocationFeedId&&this._locationLength>0){a[0]=new s("location",o.DIMENSION,this._geoLocationFeedValues);this.title(this._geoLocationFeedName,false);this.showIcon(true)}if(this._geoFeatureSizeFeedId&&this._sizeLength>0){if(this._colorDimensionLength===0&&this._geoFeatureSizeFeedName===this._geoFeatureColorFeedName&&this._geoFeatureSizeFeedId===this._geoFeatureColorFeedId){}else{a[1]=new s("size",o.MEASURE,this._geoFeatureSizeFeedValues);if(a[0]){this.title(this._geoFeatureSizeFeedName,false);this.showIcon(true)}}}if(this._geoFeatureColorFeedId&&this._colorMeasureLength>0&&this._colorAnalysisType===o.MEASURE){a[1]=new s("size",o.MEASURE,this._geoFeatureColorFeedValues);if(a[0]){this.title(this._geoFeatureColorFeedName,false);this.showIcon(true)}}if(this._geoFeatureColorFeedId&&this._colorAnalysisType===o.DIMENSION&&this._colorDimensionLength>0){a[2]=new s("color",o.DIMENSION,this._geoFeatureColorFeedValues)}}this._lableText.text(this._lableTitleText);this._feeding.changeFeeding(this._vizType);this.update({feeding:a});this._properties.changeSetting(f.getAvailableSettings(this._vizType));this._dispatchEvent(new p(p.CHANGE_LAYER_VIZTYPE,this,{sectionIdx:this.getSectionIdx(),vizType:this._vizType,feeding:a.length===1&&this._geoLocationFeedId&&this._locationLength>0||t===this._vizType?null:a}));this._dispatchEvent(new r(r.FEEDING_CHANGED,this,{sectionIdx:this.getSectionIdx()}));if(t===this._vizType&&this._clusterChecked){if(this._vizType===c.VIZ_TYPE_BUBBLE){this._properties._settings$.bubbleCluster[0].checked=this._clusterChecked;this._dispatchEvent(new p(p.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:"bubbleCluster",value:this._clusterChecked}))}else if(this._vizType===c.VIZ_TYPE_MARKER){this._properties._settings$.markerCluster[0].checked=this._clusterChecked;this._dispatchEvent(new p(p.CHANGE_VIZ_PROPERITIES,this,{sectionIdx:this.getSectionIdx(),id:"markerCluster",value:this._clusterChecked}))}}};m.prototype._analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;if(this._feeding){this._feeding._analysisObjectsForPicker(this._allAnalyses)}}else{return this._allAnalyses}};m.prototype.save=function(){var e={vizType:this._vizType,feedMap:this._feedMap,feeding:this._feeding.save(),title:this.title(),checked:this._isChecked,checkable:this._checkable,configable:this._configable,expand:this._isExpand,sortable:this._sortable,titleText:this._lableTitleText,clusterChecked:this._vizType===c.VIZ_TYPE_CHOROPLETH?null:this._clusterChecked,showLegend:this._config.showLegend,showIconDom:this._showIconDom};return e};return m});e("sap/viz/controls/mapbuilder/models/Analysis",[],function(){var e=function(){this.__className="sap.viz.controls.geo.models.Analysis";this.id=null;this.name=null;this.type=null};return e});e("sap/viz/controls/mapbuilder/models/VizLayer",[],function(){var e=function(){this.__className="sap.viz.controls.geo.models.VizLayer";this._feedItems=[]};e.prototype.feedItems=function(e){if(!arguments.length){return this._feedItems}else{this._feedItems=e}};return e});e("sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/events/GeoEvent"],function(e,t,i,r,n,s,o){var a=[{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP",type:"topo"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE",type:"satellite"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN",type:"national-geographic"},{name:"VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS",type:"streets"}];var l=function(e,t){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetESRIMapStyle";this._creatControls()};t.extend(l,n);l.prototype._creatControls=function(){var t=e(this._dom).addClass(i.MAPBUILDER_PREFIX+"map-styles");var n=new s(t,{title:"STYLES"});var l=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"map-styles-container").appendTo(t);for(var c=0;c<a.length;c++){var p=a[c];var h=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"map-style").appendTo(l);var d=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"map-style-title").appendTo(h);d.html(r.get(p.name)+": ");var u=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"map-style-esri-"+p.type).appendTo(h);u.addClass(i.MAPBUILDER_PREFIX+"map-style-esri-icon");u.data("__basemapType",p.type);var _=this;u.on("click tap",function(){e("."+i.MAPBUILDER_PREFIX+"map-style-esri-icon").removeClass(i.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");e(this).addClass(i.MAPBUILDER_PREFIX+"map-style-esri-icon-selected");_._dispatchEvent(new o(o.CHANGE_BASEMAP_TYPE,this,{basemapType:e(this).data("__basemapType")}))})}};return l});e("sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/widgets/WidgetTitle","sap/viz/controls/mapbuilder/widgets/WidgetESRIMapStyle"],function(e,t,i,r,n,s,o,a){var l='<select id="combobox"><select>';var c=function(e,t){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.sections.GeoBasemapLayerSection";this._config=t;this._providers=this._config.providers;this._changable=this._config.changable;this._$providerSelector=null;this._esriMapStyle=null;this._esriMapStyle$=null};t.extend(c,s);c.prototype._createChildControl=function(t){var n=new o(t,{title:r.get("VIZ_MAPBUILDER_MAP")});var s=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"map-provider").appendTo(t);e(document.createElement("div")).html(r.get("VIZ_MAPBUILDER_PROVIDERS")+":").addClass(i.MAPBUILDER_PREFIX+"section-sub-title-text").appendTo(s);this._$providerSelector=e(l).appendTo(s);var c=0;for(var p=0;p<this._providers.length;p++){var h;if(this._config.defaultProvider==this._providers[p]){h='<option selected="selected" value="'+this._providers[p]+'">'+this._providers[p]+"</option>"}else{h='<option value="'+this._providers[p]+'">'+this._providers[p]+"</option>"}e(h).appendTo(this._$providerSelector)}this._esriMapStyle$=e(document.createElement("div")).appendTo(t);this._esriMapStyle=new a(this._esriMapStyle$);if(this._config.defaultProvider!=="ESRI"){this._esriMapStyle$.hide()}};c.prototype._addEventHandler=function(){this._$providerSelector.change(function(){this._dispatchEvent(new n(n.CHANGE_BASEMAP_PROVIDER,this,{basemapProvider:this._$providerSelector.val()}));if(this._$providerSelector.val()!=="ESRI"){this._esriMapStyle$.hide()}else{this._esriMapStyle$.show()}}.bind(this));this._esriMapStyle.addEventListener(n.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e)},this)};c.prototype._createChildControlPanel=function(e){this._createChildControl(e);this._addEventHandler()};return c});e("sap/viz/controls/mapbuilder/widgets/WidgetContextMenu",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/mapbuilder/widgets/WidgetBase","sap/viz/controls/mapbuilder/events/GeoEvent"],function(e,t,i,r,n,s){var o={iconClass:i.MAPBUILDER_PREFIX+"contextmenu-delete",actionType:s.DELETE_LAYER,name:"VIZ_MAPBUILDER_DELETE"};var a={iconClass:i.MAPBUILDER_PREFIX+"contextmenu-moveup",actionType:s.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEUP"};var l={iconClass:i.MAPBUILDER_PREFIX+"contextmenu-movedown",actionType:s.REORDER_LAYER,name:"VIZ_MAPBUILDER_MOVEDOWN"};var c=function(e,t){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.widgets.WidgetContextMenu";this._menu$=null;this._text$=null;this._buttonCancel$=null;this._buttonOk$=null;this._actionType="";this._container$=null;this._layerName=null;this._moveName=null;this._layerIndex=null;this._layerCount=null;this._instanceDom=null;this._beforeInstanceDom=null;this._afterInstanceDom=null;this._firstInstanceDom=null;this._showHideMenu=null;this._showHideMenuItem=null;this._actionContainer$=null;this._warning$=null;this._creatControls()};t.extend(c,n);c.prototype._creatControls=function(){var t=e(document.createElement("div")).appendTo(e(this._dom)).addClass(i.MAPBUILDER_PREFIX+"contextmenu-container");this._container$=t;var r=document.createElement("ul");this._menu$=e(r).addClass(i.MAPBUILDER_PREFIX+"contextmenu");this._createMenuItem(this._menu$,a);this._createMenuItem(this._menu$,l);this._createMenuItem(this._menu$,o);this._menu$.appendTo(t);this._actionContainer$=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-container").appendTo(t);this._warning$=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-warning").appendTo(this._actionContainer$);var n=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-title").appendTo(this._actionContainer$);this._text$=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-name").appendTo(n);var c=e(document.createElement("div")).addClass(i.MAPBUILDER_PREFIX+"contextmenu-action").appendTo(t);this._buttonCancel$=e('<button type="button"></button>').addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-cancel").appendTo(c);this._buttonOk$=e('<button type="button"></button>').addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-button").addClass(i.MAPBUILDER_PREFIX+"contextmenu-action-ok").appendTo(c);this._actionContainer$.hide();this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._buttonOk$.click(function(){if(this._actionType==s.DELETE_LAYER){this._dispatchEvent(new s(s.DELETE_LAYER,this))}this._close()}.bind(this));this._buttonCancel$.click(function(){this._close()}.bind(this))};c.prototype._createMenuItem=function(t,n){var s=e(document.createElement("li")).addClass(i.MAPBUILDER_PREFIX+"menuitem");e(document.createElement("div")).appendTo(s).addClass(n.iconClass);var o=e(document.createElement("div")).appendTo(s).addClass(i.MAPBUILDER_PREFIX+"menutext");o.text(r.get(n.name));s.appendTo(t);s.data("actionType",n.actionType);s.click(e.proxy(this._clickHanlder,this))};c.prototype._clickHanlder=function(t){var n=this;this._actionType=e(t.currentTarget).data("actionType");this._moveName=t.currentTarget.children[1].innerText;this._menu$.hide();this._actionContainer$.show();this._warning$.hide();this._text$.show();if(this._actionType===s.DELETE_LAYER){this._warning$.show();this._text$.html(r.get("VIZ_MAPBUILDER_DELETE_GEO_LAYER")+"?");this._buttonCancel$.show();this._buttonOk$.show();this._container$.removeClass(i.MAPBUILDER_PREFIX+"contextmenu-container");this._container$.addClass(i.MAPBUILDER_PREFIX+"configmenu-container");var o=e(this._dom);o.css({top:this._container$.offset().top,left:this._container$.offset().left-35,position:"absolute"})}else if(this._actionType===s.REORDER_LAYER){var a=this._layerIndex;var l;if(this._moveName===r.get("VIZ_MAPBUILDER_MOVEUP")){l=a+1;this._instanceDom.insertBefore(this._beforeInstanceDom)}else if(this._moveName===r.get("VIZ_MAPBUILDER_MOVEDOWN")){l=a-1;this._instanceDom.insertAfter(this._afterInstanceDom)}this._dispatchEvent(new s(s.REORDER_LAYER,this,{from:a,to:l}));this._close()}};c.prototype._mouseDownHandler=function(t){if(!e.contains(this._dom,t.srcElement)){this._close()}};c.prototype.show=function(t){var r=e(this._dom);r.css({top:t.top,left:t.left+85,position:"absolute"});r.appendTo(e("body"));if(this._layerCount>0){if(this._layerCount===1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block"}else if(this._layerCount>1&&this._layerIndex===this._layerCount-1){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="none";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block"}else if(this._layerCount>1&&this._layerIndex===0){this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="none";this._menu$[0].children[2].style.display="block"}else{this._menu$[0].style.display="block";this._menu$[0].children[0].style.display="block";this._menu$[0].children[1].style.display="block";this._menu$[0].children[2].style.display="block"}}this._text$.hide();this._buttonCancel$.hide();this._buttonOk$.hide();this._warning$.hide();this._actionContainer$.hide();document.addEventListener("mousedown",e.proxy(this._mouseDownHandler,this),true);e(window).on("blur",e.proxy(this._mouseDownHandler,this));this._container$.removeClass(i.MAPBUILDER_PREFIX+"configmenu-container");this._container$.addClass(i.MAPBUILDER_PREFIX+"contextmenu-container")};c.prototype._close=function(){e(this._dom).detach();document.removeEventListener("mousedown",e.proxy(this._mouseDownHandler,this),true);e(window).off("blur",e.proxy(this._mouseDownHandler,this))};c.prototype.setLayerIdx=function(e){this._layerIndex=e};c.prototype.setLayerCount=function(e){this._layerCount=e};c.prototype.setInstanceDom=function(e){this._instanceDom=e};c.prototype.setBeforeInstanceDom=function(e){this._beforeInstanceDom=e};c.prototype.setAfterInstanceDom=function(e){this._afterInstanceDom=e};c.prototype.setFirstInstanceDom=function(e){this._firstInstanceDom=e};return c});e("sap/viz/controls/mapbuilder/MapBuilder",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/mapbuilder/constants/Const","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/mapbuilder/MapBuilderConfig","sap/viz/controls/mapbuilder/sections/SectionBase","sap/viz/controls/mapbuilder/sections/GeoVizLayerSection","sap/viz/controls/mapbuilder/models/Analysis","sap/viz/controls/mapbuilder/models/VizLayer","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/mapbuilder/sections/GeoBasemapLayerSection","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/mapbuilder/widgets/WidgetContextMenu"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g){var E=function(e,t,i){e.splice(i,0,e.splice(t,1)[0])};var y=function(e,t){y.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.geo.MapBuilder";this._uiConfig=t;this._feedMap=!this._uiConfig.feedMap?{}:this._uiConfig.feedMap;this._$mapBuilder=null;this._$controller=null;this._$header=null;this._$headerPlus=null;this._$headerText=null;this._vizSectionsContainer=null;this._vizSections=[];this._vizLayers=[];this._baseMapSection=null;this._contextMenu=null;this._$footer=null;this._$footerText=null;this._createChildren();this._currentSettingLayer=-1;this._loadConfig()};t.extend(y,r);y.prototype.config=function(e,t){this._vizSections[t].update(e)};y.prototype._createHeader=function(){this._$header=e("<div/>").appendTo(this._$controller).addClass(o.MAPBUILDER_PREFIX+"header");this._$headerPlus=e("<div></div>").appendTo(this._$header).addClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerText=e("<div></div>").appendTo(this._$header).addClass(o.MAPBUILDER_PREFIX+"header-text").html(l.get("VIZ_MAPBUILDER_ADD_NEW_LAYER"));this._$headerPlus.bind("tap click",this._addHeaderEventHandler.bind(this));this._$headerText.bind("tap click",this._addHeaderEventHandler.bind(this))};y.prototype._createFooter=function(){this._$footer=e("<div/>").appendTo(this._$controller).addClass(o.MAPBUILDER_PREFIX+"footer");this._$footerText=e("<div></div>").appendTo(this._$footer).addClass(o.MAPBUILDER_PREFIX+"footer-text").html(l.get("VIZ_MAPBUILDER_IMPORT_ESRI_CUSTOM_SERVICE"));this._$footerRadio=e(document.createElement("input")).attr("type","checkbox").addClass(o.MAPBUILDER_PREFIX+"footer-radio").appendTo(this._$footer).on("click tap",function(){if(this._$footerRadio.prop("checked")){this._$footerRadioText.removeClass("disable");this._notifyModelChange({mapBuilder:{mapservice:{action:"enable"}}})}else{this._$footerRadioText.addClass("disable");this._notifyModelChange({mapBuilder:{mapservice:{action:"disable"}}})}}.bind(this));this._$footerRadio.hide();this._$footerRadioText=e("<div></div").html(l.get("VIZ_MAPBUILDER_ESRI_CUSTOM_SERVICE")).addClass(o.MAPBUILDER_PREFIX+"footer-radio-text").appendTo(this._$footer);this._$footerRadioText.hide();this._$footerText.bind("tap click",this._footerClickEventHandler.bind(this));this._$footerRadioText.bind("tap click",this._footerClickTextEventHandler.bind(this))};y.prototype._addHeaderEventHandler=function(e){if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}else if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerText.css("color","#008fd3");this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"header-plus");if(this._vizLayers.length===4){this._addVizSection();this._$header.disabled=true;this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}else{this._addVizSection()}e.stopPropagation();e.preventDefault()}};y.prototype._footerClickEventHandler=function(e){this._notifyModelChange({mapBuilder:{mapservice:{action:"choose"}}})};y.prototype._footerClickTextEventHandler=function(e){if(this._$footerRadio.prop("checked")){this._notifyModelChange({mapBuilder:{mapservice:{action:"choose"}}})}};y.prototype._hide=function(){this._$mapBuilder.hide()};y.prototype._show=function(){this._$mapBuilder.show()};y.prototype.reset=function(){for(var e=0;e<this._vizSections.length;e++){this._vizSections[e].destroy()}this._vizSections.length=0;this._vizLayers.length=0};y.prototype._createChildren=function(){var t=e("<div/>").appendTo(this._dom).addClass(o.PREFIX+"mapbuilder");this._$controller=e("<div/>").appendTo(t).addClass(o.MAPBUILDER_PREFIX+"area");this._createHeader();this._createFooter();var i=document.createElement("div");e(i).addClass(o.MAPBUILDER_PREFIX+"section-container");var r=document.createElement("div");this._vizSectionsContainer=document.createElement("div");if(this._uiConfig.showBaseMap){this._baseMapSection=new f(r,{title:l.get("VIZ_MAPBUILDER_BASE_MAP_NAME"),providers:this._uiConfig.basemap.providers,changeable:this._uiConfig.basemap.changable,checkable:false,sortable:false,configable:false,defaultProvider:this._uiConfig.basemap.selected});this._baseMapSection.addEventListener(m.CHANGE_BASEMAP_PROVIDER,function(e){this._dispatchEvent(e)},this);this._baseMapSection.addEventListener(m.CHANGE_BASEMAP_TYPE,function(e){this._dispatchEvent(e)},this)}i.appendChild(this._vizSectionsContainer);i.appendChild(r);e(i).appendTo(this._$controller);this._contextMenu=new g(document.createElement("div"),{});this._contextMenu.addEventListener(m.DELETE_LAYER,function(e){this._removeLayer(this._currentSettingLayer)},this);this._contextMenu.addEventListener(m.REORDER_LAYER,function(e){this._reorderLayer(e.data.from,e.data.to)},this);this._$mapBuilder=t;this._hide()};y.prototype._loadConfig=function(){var e=this._uiConfig.layers;if(e){for(var t=0;t<e.length;t++){var i=e[t];var r=this._createVizLayerSection({vizType:i.vizType,feeding:i.feeding,title:i.title,showLegend:this._uiConfig.showLegend})}}};y.prototype.save=function(){var e=[];for(var t=0;t<this._vizSections.length;t++){var i=this._vizSections[t];if(i){var r=i.save();e.push(r)}}return e};y.prototype.load=function(t){if(!t){return}this.reset();for(var i=0;i<t.length;i++){var r=t[i];var s=[];for(var l=0;l<r.feeding.feeding.length;l++){s[l]=n.fromJSON(r.feeding.feeding[l])}var c=this._createVizLayerSection({feedMap:r.feedMap,vizType:r.vizType,feeding:s,title:r.title,checkable:r.checkable,configable:r.configable,sortable:r.sortable,showLegend:r.showLegend});if(r.showIconDom){c.showIcon(true);if(r.vizType===a.VIZ_TYPE_CHOROPLETH){c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-marker");c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-bubble");c._iconDom.addClass(o.MAPBUILDER_PREFIX+"section-icon-choropleth")}else if(r.vizType===a.VIZ_TYPE_BUBBLE){c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-marker");c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-choropleth");c._iconDom.addClass(o.MAPBUILDER_PREFIX+"section-icon-bubble")}else if(r.vizType===a.VIZ_TYPE_MARKER){c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-bubble");c._iconDom.removeClass(o.MAPBUILDER_PREFIX+"section-icon-choropleth");c._iconDom.addClass(o.MAPBUILDER_PREFIX+"section-icon-marker")}}c._lableText.text(r.titleText);c._lableTitleText=r.titleText;if(!r.checked){c._checkBoxDom.checked=r.checked;c._isChecked=r.checked;e(c._labelDom).css("color","#a6a6a6")}if(!r.expand){c._isExpand=r.expand}if(r.clusterChecked){c._clusterChecked=true;if(r.vizType===a.VIZ_TYPE_MARKER){c._properties._settings$.markerCluster[0].checked=true}else{c._properties._settings$.bubbleCluster[0].checked=true}}}if(t.length>=5){this._$header.disabled=true;this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerText.css("color","#a6a6a6")}for(var l=0;l<t.length;l++){if(t[l].expand&&t[l].checked){this._vizSections[l]._expandSectionHandler()}else{this._vizSections[l]._hideSectionHandler()}}};y.prototype._getLayerCount=function(){return this._vizLayers.length};y.prototype._createVizLayerSection=function(t){var i=new d(this._vizSectionsContainer,{feedMap:this._feedMap,title:t.title,checkable:t.checkable?t.checkable:true,configable:t.configable?t.configable:true,sortable:t.sortable?t.sortable:true,vizType:t.vizType,feeding:t.feeding,showLegend:t.showLegend,feedingPanel:this._uiConfig.feedingPanel});i._analysisObjectsForPicker(this._allAnalyses);i._expandSectionHandler();if(i._sortable){e(i._instanceDom).sortable("disable")}i.addEventListener(v.FEEDING_CHANGED,function(e){this._layerFeedChange(this._getLayerIdxBySectionIdx(e.data.sectionIdx))},this);i.addEventListener(m.ACTION_CHANGED,function(e){this._dispatchEvent(new m(m.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID,layerIdx:this._getLayerIdxBySectionIdx(e.data.sectionIdx)}))},this);i.addEventListener(m.EXPAND_SECTION,function(t){var r=this._getLayerIdxBySectionIdx(t.data.sectionIdx);this._dispatchEvent(new m(m.EXPAND_SECTION,this,{layerIdx:r}));if(this._vizSections.length>=1){for(var n=0;n<this._vizSections.length;n++){if(n===r&&!i._isExpand&&i._isChecked){this._vizSections[n]._expandSectionHandler()}else{if(i._isChecked){this._vizSections[n]._hideSectionHandler()}}if(this._vizSections[n]._sortable){e(this._vizSections[n]._instanceDom).sortable("disable")}}}},this);i.addEventListener(m.HIDE_SECTION,function(t){var r=this._getLayerIdxBySectionIdx(t.data.sectionIdx);this._dispatchEvent(new m(m.HIDE_SECTION,this,{layerIdx:r}));if(this._vizSections.length>=1){for(var n=0;n<this._vizSections.length;n++){if(n===r&&i._isExpand){this._vizSections[n]._hideSectionHandler()}if(this._vizSections[n]._sortable){e(this._vizSections[n]._instanceDom).sortable("enable")}}}},this);i.addEventListener(m.SHOW_LAYER,function(t){var r=this._getLayerIdxBySectionIdx(t.data.sectionIdx);this._notifyModelChange({mapBuilder:{layer:{action:"show",idx:r}}});this._dispatchEvent(new m(m.SHOW_LAYER,this,{layerIdx:r}));if(i._isChecked){e(i._labelDom).css("color","#333333");for(var n=0;n<this._vizSections.length;n++){if(n===r&&i._isChecked){this._vizSections[n]._expandSectionHandler()}else{this._vizSections[n]._hideSectionHandler()}if(this._vizSections[n]._sortable){e(this._vizSections[n]._instanceDom).sortable("disable")}}}},this);i.addEventListener(m.HIDE_LAYER,function(t){var r=this._getLayerIdxBySectionIdx(t.data.sectionIdx);this._notifyModelChange({mapBuilder:{layer:{action:"hide",idx:r}}});this._dispatchEvent(new m(m.HIDE_LAYER,this,{layerIdx:r}));if(!i._isChecked){e(i._labelDom).css("color","#a6a6a6");i._hideSectionHandler();e(i._instanceDom).sortable("enable")}},this);i.addEventListener(m.DISPLAY_SETTINGMENU,function(e){this._displaySettingMenu(this._getLayerIdxBySectionIdx(e.data.sectionIdx),e.data.position)},this);i.addEventListener(m.REORDER_LAYER,function(e){this._reorderLayer(this._getLayerIdxBySectionIdx(e.data.from),this._getLayerIdxBySectionIdx(e.data.to))},this);i.addEventListener(m.CHANGE_LAYER_VIZTYPE,function(e){var t=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var i=e.data.vizType;var r=e.data.feeding;this._notifyModelChange({mapBuilder:{layer:{action:"changeVizType",idx:t,vizType:i,feeding:r}}});this._dispatchEvent(new m(m.CHANGE_LAYER_VIZTYPE,this,{layerIdx:t,vizType:i,feeding:r}))},this);i.addEventListener(m.CHANGE_VIZ_PROPERITIES,function(e){var t=this._getLayerIdxBySectionIdx(e.data.sectionIdx);var i=e.data.id;var r=e.data.value;this._notifyModelChange({mapBuilder:{layer:{action:"changeProperties",idx:t,propKey:i,propValue:r}}});this._dispatchEvent(new m(m.CHANGE_VIZ_PROPERITIES,this,{layerIdx:t,id:i,value:r}))},this);this._vizSections.push(i);if(this._vizSections.length>1){for(var r=0;r<this._vizSections.length;r++){if(r===this._vizSections.length-1){this._vizSections[r]._expandSectionHandler()}else{this._vizSections[r]._hideSectionHandler()}}}if(t.title){i.title(t.title,true)}else{var n=this._vizSections.length}this._vizLayers.push(new _);return i};y.prototype._addVizSection=function(){var e=this._createVizLayerSection({showLegend:this._uiConfig.showLegend});this._notifyModelChange({mapBuilder:{layer:{action:"add",feeds:e.getFeeds()}}});this._dispatchEvent(new m(m.ADD_LAYER,this,{layerIdx:this._vizSections.length-1}))};y.prototype._getLayerIdxBySectionIdx=function(e){return this._vizSections.length-e-1};y.prototype._createAnalysis=function(e,t,i){var r=new u;r.id=e;r.name=t;r.type=i;this._feedMap[e]=r;return r};y.prototype._layerFeedChange=function(e){var t=this._vizLayers[e];var i=this._vizSections[e];var r=i._vizType;var n=i.getFeeds();t.feedItems(n);var o,l,c,p,h;for(var d=0;d<n.length;d++){var u=n[d];for(var _=0;_<u.values().length;_++){o=u.values()[_].name();if(u.id()==="location"){l=o}else if(u.id()==="color"){c=o;h=u.type()}else if(u.id()==="size"){p=o}}}if(r===a.VIZ_TYPE_CHOROPLETH){i.title("",false);i.showIcon(false);if(l!=undefined){if(c!=undefined&&h===s.MEASURE){i.title(c,false)}else{i.title(l,false)}i.showIcon(true)}}else if(r===a.VIZ_TYPE_BUBBLE){i.title("",false);i.showIcon(false);if(l!=undefined){if(p!=undefined){i.title(p,false)}else{i.title(l,false)}i.showIcon(true)}}else if(r===a.VIZ_TYPE_MARKER){i.title("",false);i.showIcon(false);if(l!=undefined){i.title(l,false);i.showIcon(true)}}var v=this._vizModel().feedingItems();v[e]=n;this._vizModel().feedingItems(v);this._dispatchEvent(new m(m.UPDATE_LAYER_DATA,this,{feedItems:n,layerIdx:e}))};y.prototype._removeLayer=function(e){this._vizSections[e].destroy();this._vizSections.splice(e,1);this._vizLayers.splice(e,1);this._notifyModelChange({mapBuilder:{layer:{action:"delete",idx:e}}});this._dispatchEvent(new m(m.DELETE_LAYER,this,{layerIdx:e}));if(this._vizLayers.length<5){this._$header.disabled=false;this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"disable-header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerText.css("color","#008fd3")}else if(this._vizLayers.length>=5){this._$header.disabled=true;this._$headerText.css("color","#a6a6a6");this._$headerPlus.removeClass(o.MAPBUILDER_PREFIX+"header-plus");this._$headerPlus.addClass(o.MAPBUILDER_PREFIX+"disable-header-plus")}};y.prototype._reorderLayer=function(e,t){E(this._vizSections,e,t);E(this._vizLayers,e,t);this._notifyModelChange({mapBuilder:{layer:{action:"reorder",from:e,to:t}}});this._dispatchEvent(new m(m.REORDER_LAYER,this,{from:e,to:t}))};y.prototype._notifyModelChange=function(e){this._vizModel().extensionValues(e)};y.prototype._displaySettingMenu=function(e,t){this._currentSettingLayer=e;var i=this._vizSections[this._currentSettingLayer].getSectionDom();var r,n;if(this._vizSections.length>0){if(this._vizSections.length===1){r=null;n=null}else if(this._vizSections.length>1&&this._currentSettingLayer===this._vizSections.length-1){r=null;n=this._vizSections[this._currentSettingLayer-1].getSectionDom()}else if(this._vizSections.length>1&&this._currentSettingLayer===0){r=this._vizSections[this._currentSettingLayer+1].getSectionDom();n=null}else{r=this._vizSections[this._currentSettingLayer+1].getSectionDom();n=this._vizSections[this._currentSettingLayer-1].getSectionDom()}}var s=i.offset();this._contextMenu.setLayerIdx(this._currentSettingLayer);this._contextMenu.setLayerCount(this._vizSections.length);this._contextMenu.setInstanceDom(i);this._contextMenu.setBeforeInstanceDom(r);this._contextMenu.setAfterInstanceDom(n);this._contextMenu.show(s)};y.prototype._onVizModelChanged=function(e){if(e.data.extensionValuesChanged){var t=this._vizModel().extensionValues();if(t.mapBuilder){if(t.mapBuilder.status){this._show();this.load(t.mapBuilder.status)}else if(t.mapBuilder.mapservice&&t.mapBuilder.mapservice.showRadio){this._show();this._$footerText.hide();this._$footerRadio.show();this._$footerRadioText.show();this._$footerRadio.prop("checked",t.mapBuilder.mapservice.checked);if(!t.mapBuilder.mapservice.checked){this._$footerRadioText.addClass("disable")}else{this._$footerRadioText.removeClass("disable")}}}if(t.map){if(t.map.created){this._show();this.reset();this._addVizSection()}else if(t.map.logOnFail){this._hide()}if(t.map.feeding){for(var i=0;i<t.map.feeding.length;i++){this._vizSections[i].update({feeding:t.map.feeding[i]})}}}}};y.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e;for(var t=0;t<this._vizSections.length;t++){this._vizSections[t]._analysisObjectsForPicker(this._allAnalyses)}}else{return this._allAnalyses}};return y});e("sap/viz/controls/switchbar/SwitchBarEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event","jquery"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBarEvent"};e.extend(r,t);r.VIZ_TYPE_CHANGED="vizTypeChanged";return r});e("sap/viz/controls/switchbar/views/SwitcherEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.SwitcherEvent"};t.extend(r,i);r.TYPE_CHANGED="typeChanged";return r});e("sap/viz/controls/switchbar/views/DropDownListEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownListEvent"};t.extend(r,i);r.DROP_DOWN_OPENED="dropDownOpened";r.DROP_DOWN_CLOSED="dropDownClosed";r.ITEM_SELECTED="itemSelected";return r});e("sap/viz/controls/switchbar/views/DropDownList",["jquery","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/UIControl","sap/viz/controls/switchbar/views/DropDownListEvent"],function(e,t,i,r,n,s,o,a){var l=i.SWITCHBAR_PREFIX;var c=function(t,i,r){c.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.DropDownList";this._header=i;this._typeObjects=r;this._selectedChartList=null;this._dom$=e(t);this._$container=null;this._$content=null;this._$arrow=null;this._mousedownHandler=e.proxy(this._globalMouseDownHandler,this);this._createChildren()};n.extend(c,o);c.prototype.open=function(t){this._dispatchEvent(new a(a.DROP_DOWN_OPENED,this));this._dom$.appendTo(e("body"));this._locate(t);document.addEventListener("mousedown",this._mousedownHandler,true);e(window).on("blur",this._mousedownHandler);this._$container.css("opacity","1");this._$container.css("top","15px")};c.prototype._globalMouseDownHandler=function(t){var i=t.srcElement?t.srcElement:t.target;if(!e.contains(this._dom,i)){this.close()}};c.prototype._updateDropdownPosition=function(e){var t=this._$li.outerHeight()*11+this._$content.outerHeight()%this._$li.outerHeight();var i=this._$content.outerHeight()>t;if(i){this._$content.outerWidth(this._$li.outerWidth()+28);this._$content.outerHeight(t)}else{this._$content.outerWidth(this._$li.outerWidth()+14)}var r=this._$content.outerWidth();var n=this._$content.outerHeight();this._$container.css({width:r+"px",height:n+"px"});var s=-5;var o=this._$container.outerWidth();var a=o/3*2+1;if(a/2>e){a+=a/2-e}var l=s+a;this._$arrow.css({left:l});this._$container.css({left:-a})};c.prototype._locate=function(t){var i=document.body.scrollWidth-e(window).width();var r=e(window).outerWidth()-t.offset().left;this._updateDropdownPosition(r+i);this._dom$.css({right:r,top:t.offset().top+t.outerHeight()});if(this._$container.offset().left<0){var n=this._dom$.offset().left;var s=this._$container.offset().left;this._$container.css({left:-n+"px"});var o=Number(this._$arrow.css("left").replace("px",""));this._$arrow.css({left:o+s-this._$container.offset().left+"px"})}var a=e(window).width()-this._$arrow.offset().left-this._$arrow.outerWidth()-12;var l=e(window).width()-this._$container.offset().left-this._$container.outerWidth();var c=l-a;if(c>0){this._$container.css({width:this._$container.width()+c});this._$content.css({width:this._$content.width()+c})}};c.prototype.close=function(){var t=e(this._dom);var i=1;if(this._classVisible){t.removeClass(this._classVisible);i=2e3}setTimeout(function(){t.detach()},i);this._dispatchEvent(new a(a.DROP_DOWN_CLOSED,this));document.removeEventListener("mousedown",this._mousedownHandler,true);e(window).off("blur",this._mousedownHandler);this.destroy()};c.prototype._createChildren=function(){var r=this;this._dom$.addClass(l+"dropDownList");var n=this._$container=e("<div/>").appendTo(this._dom$);this._$container.addClass(l+"dropDownList-container");var o=this._$arrow=e("<div/>").appendTo(n);this._$arrow.addClass(l+"dropDownList-arrow uvb-dropDownList");var a=this._$content=e("<div/>").appendTo(n);this._$content.addClass([l+"dropDownList-content",i.COMMON_PREFIX+"scrollable",i.COMMON_PREFIX+"scrollable-y"].join(" "));var c=this._$ul=e("<ul/>").appendTo(a);this._$ul.addClass(l+"chart-list-container");var p=e("<div/>").appendTo(c).text(this._header);p.addClass(l+"chart-list-header");var h;var d;for(h=0;h<this._typeObjects.length;h++){d=this._typeObjects[h];this._$li=e("<li/>").appendTo(c).attr("class","chartList");var u=this._$li;u.data("type",d);u.click(e.proxy(this._chartListClickHandler,this));var _=e("<div/>");_.addClass(l+"dropDownList-chart-list");var v=d.id;if(s.isBuildInType(v)||v===t.TYPE_TABLE||v===t.TYPE_CROSSTAB||v===t.TYPE_FUNNEL||v===t.TYPE_PC){_.append(e("<div/>",{class:l+"chart-icon"+" "+l+"chart-icon-"+d.icon}),e("<span/>",{class:l+"chart-text",text:d.caption}))}else{if(!d.srcIcon){_.append(e("<div/>",{class:l+"chart-icon"+" "+l+"chart-icon-extension"}),e("<span/>",{class:l+"chart-text",text:d.caption}))}else{_.append(e("<img/>",{class:l+"chart-icon",src:d.srcIcon}),e("<span/>",{class:l+"chart-text",text:d.caption}));_.children("img").css("background","none")}}e(_[0].firstChild).css("margin","3px 5px 3px 0px");_.appendTo(u)}};c.prototype._chartListClickHandler=function(t){this._dispatchEvent(new a(a.ITEM_SELECTED,this,{selectedTypeObject:e(t.currentTarget).data("type")}));this.close()};c.prototype.updateSelectedUI=function(t){var i=this._$ul.children("li");for(var r=0;r<i.length;r++){var n=e(i[r]);if(n.text()===t){n.addClass(l+"dropDownList-chart-list-selected");break}}};return c});e("sap/viz/controls/switchbar/views/Switcher",["jquery","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/UIControl","sap/viz/controls/switchbar/views/SwitcherEvent","sap/viz/controls/switchbar/views/DropDownList","sap/viz/controls/switchbar/views/DropDownListEvent"],function(e,t,i,r,n,s,o,a,l,c){var p=i.SWITCHBAR_PREFIX;var h=i.COMMON_PREFIX;var d=function(t,i,r){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.views.Switcher";this._caption=i;this._typeObjects=r;this._selectedTypeObject=null;this._dom$=e(t);this._chartIcon$=null;this._arrow$=null;this._createChildren();this._commitSelectedType();this.size({width:58,height:34})};n.extend(d,o);d.prototype.selectedType=function(e){if(arguments.length>0){var t=null;if(e){for(var i=0;i<this._typeObjects.length;i++){if(this._typeObjects[i].id===e){t=this._typeObjects[i];break}}}this.selectedTypeObject(t)}else{return this._selectedTypeObject?this._selectedTypeObject.id:null}};d.prototype.selectedTypeObject=function(e){if(arguments.length>0){if(this._selectedTypeObject!=e||this._selectedTypeObject&&e&&this._selectedTypeObject.id!=e.id){this._selectedTypeObject=e;this._commitSelectedType();this._dispatchEvent(new a(a.TYPE_CHANGED,this))}}else{return this._selectedTypeObject}};d.prototype._createChildren=function(){this._dom$.addClass([p+"chart",p+"switcher"].join(" "));var t=e(document.createElement("div"));t.addClass(p+"chart-icon-wrapper");var i=this._typeObjects[0].srcIcon;if(!i){this._chartIcon$=e(document.createElement("div"))}else{this._chartIcon$=e(document.createElement("img"))}this._chartIcon$.addClass(p+"chart-icon");this._updateChartIcon(this._typeObjects[0],false);this._chartIcon$.appendTo(t);t.click(e.proxy(this._chartIconClickHandler,this));t.appendTo(this._dom$);var r=this._arrow$=e(document.createElement("div"));r.addClass(p+"splitter");r.appendTo(this._dom$);var n=this._arrow$=e(document.createElement("div"));n.addClass(p+"dropdown-arrow");e(document.createElement("div")).addClass([p+"dropdown-arrow-icon",h+"havanaSharedSprite16-mask"].join(" ")).appendTo(n);n.click(e.proxy(this._arrowClickHandler,this));n.appendTo(this._dom$)};d.prototype._chartIconClickHandler=function(e){this.selectedTypeObject(this._chartIcon$.data("type"))};d.prototype._arrowClickHandler=function(e){var t=this._dropDownList=new l(document.createElement("div"),this._caption,this._typeObjects);t.addEventListener(c.ITEM_SELECTED,function(e){this.selectedTypeObject(e.data.selectedTypeObject)},this);if(this._selectedTypeObject){t.updateSelectedUI(this._selectedTypeObject.caption)}t.open(this._arrow$)};d.prototype._commitSelectedType=function(){if(this._selectedTypeObject){this._updateChartIcon(this._selectedTypeObject,true);this._dom$.removeClass(p+"chart");this._dom$.addClass(p+"chart-selected")}else{this._updateChartIcon(this._selectedTypeObject,false);this._dom$.addClass(p+"chart");this._dom$.removeClass(p+"chart-selected")}};d.prototype._updateChartIcon=function(i,r){if(!i){i=this._chartIcon$.data("type")}var n=i.id;if(s.isBuildInType(n)||n===t.TYPE_TABLE||n===t.TYPE_CROSSTAB||n===t.TYPE_FUNNEL||n===t.TYPE_PC){this._chartIcon$.attr({class:p+"chart-icon"+" "+p+"chart-icon-"+(r?i.whiteIcon:i.icon),title:i.caption}).data("type",i)}else{if(!i.srcIcon){if(this._chartIcon$[0].nodeName==="IMG"){this._chartIcon$=e(document.createElement("div")).replaceAll(this._chartIcon$)}this._chartIcon$.attr({class:p+"chart-icon"+" "+p+"chart-icon-"+(r?"extension-white":"extension"),title:i.caption}).data("type",i)}else{if(this._chartIcon$[0].nodeName==="DIV"){this._chartIcon$=e(document.createElement("img")).replaceAll(this._chartIcon$)}this._chartIcon$.attr({class:p+"chart-icon",src:r?i.srcWhiteIcon:i.srcIcon,title:i.caption}).data("type",i);this._chartIcon$.css("background","none")}}};return d});e("sap/viz/controls/switchbar/SwitchBar",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/runtime/RuntimeManager","sap/viz/controls/switchbar/SwitchBarConfig","sap/viz/controls/switchbar/SwitchBarEvent","sap/viz/controls/switchbar/views/Switcher","sap/viz/controls/switchbar/views/SwitcherEvent"],function(e,t,i,r,n,s,o,a,l,c,p,h,d){var u=i.SWITCHBAR_PREFIX;var _=2;var v=2;var f=function(t,r){f.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.switchbar.SwitchBar";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_switchbar_control");this._vizGroups=null;this._selectedTypeObject=null;this._direction=null;this._stacking=null;this._uiSwitchers=null;this._dom$=e(this._dom);this._dom$.addClass([i.SWITCHBAR_PREFIX+"view",i.COMMON_PREFIX+"scrollable",i.COMMON_PREFIX+"scrollable-y"].join(" "));this._container$=null;if(sap&&sap.bi&&sap.bi.framework&&sap.bi.framework.getService!==undefined){var n=sap.bi.framework.getService("*","sap.viz.controls.switchbar.groups");if(n){r=JSON.parse(JSON.stringify(r));if(!r.defaultVizType&&n.defaultVizType){r.defaultVizType=n.defaultVizType}if(!r.groups&&n.groups){r.groups=n.groups}}}if(!r){r=c.instance()}this._parseConfiguration(r);this._horizontalGap=24;this._verticalGap=14;this._createChildren();this._validateSize();if(this._vizModel().type()===r.defaultVizType){this._applyModel()}else{this._vizModel().type(r.defaultVizType)}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_switchbar_control")};s.extend(f,t);f.prototype.vizType=function(e){if(arguments.length>0){if(!o.isString(e)){return}var t=this._vizModel();var i=a.getType(t.type(),e);this._beginUpdateProperty();t.type(i);this._endUpdateProperty();return this}else{return this._selectedTypeObject?this._selectedTypeObject.id:null}};f.prototype.horizontalGap=function(e){if(arguments.length>0){if(isNaN(e)){throw n.get("VIZ_CONTROLS_API_PARAMETER_ERROR")}e=Math.max(_,Number(e));if(this._horizontalGap!==e){this._horizontalGap=e;this._validateSize()}return this}else{return this._horizontalGap}};f.prototype.verticalGap=function(e){if(arguments.length>0){if(isNaN(e)){throw n.get("VIZ_CONTROLS_API_PARAMETER_ERROR")}e=Math.max(v,Number(e));if(this._verticalGap!==e){this._verticalGap=e;this._validateSize()}return this}else{return this._verticalGap}};f.prototype.selectedTypeObject=function(e){if(arguments.length>0){if(this._selectedTypeObject!=e||this._selectedTypeObject&&e&&this._selectedTypeObject.id!=e.id){this._selectedTypeObject=e;this._commitSelectedTypeObject()}return this}else{return this._selectedTypeObject}};f.prototype.save=function(){var e={};e["type"]=this.vizType();return e};f.prototype.load=function(e){this.vizType(e.type)};f.prototype._onConnect=function(e){var t=this._vizModel();var i=a.getVizType(t.type());this._changeVizType(i)};f.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:change_switchbar_viz_type");this._applyModel();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:change_switchbar_viz_type")}};f.prototype._applyModel=function(e){var t=this._vizModel().type();this._direction=a.getDirection(t)||this._direction;this._stacking=a.getStacking(t)||this._stacking;this._changeVizType(a.getVizType(t))};f.prototype._changeVizType=function(e){var t=false;for(var i=0;i<this._vizGroups.length;i++){var r=this._vizGroups[i];for(var n=0;n<r.typeObjects.length;n++){var s=r.typeObjects[n];if(s.id===e){this.selectedTypeObject(s);t=true;break}}if(t){break}}if(!t){this.selectedTypeObject(null)}};f.prototype._commitSelectedTypeObject=function(){var e=this._selectedTypeObject?this._selectedTypeObject.id:null;for(var t=0;t<this._uiSwitchers.length;t++){this._uiSwitchers[t].selectedType(e)}this._dispatchPropertyEvent(new p(p.VIZ_TYPE_CHANGED,this,{vizType:e}))};f.prototype._parseConfiguration=function(e){var t=function(e){};try{this._vizGroups=[];var i={};var r=e.groups;if(r&&r.length){for(var n=0;n<r.length;n++){var s=r[n];var o=s.types;if(!o||o.length===0){continue}var l={caption:s.name,typeObjects:[]};for(var c=0;c<o.length;c++){var p=o[c];var h=p.id;if(i[h]){continue}var d=sap.viz.api.manifest.Viz.get(h);if(!d||!d[0]){continue}i[h]=true;var u=a.getVizTypeObject(h);if(!u){u={id:h};var _=sap.viz.api.manifest.Viz.get(u.id);u.caption=_&&_[0]?_[0].name:"";u.srcIcon=p.icon;u.srcWhiteIcon=p.whiteIcon}l.typeObjects.push(u)}if(l.typeObjects.length>0){this._vizGroups.push(l)}}}}catch(e){t("Invalid config format")}};f.prototype._createChildren=function(){this._uiSwitchers=[];var t=this._container$=e(document.createElement("div")).addClass(u+"switcher-container");for(var i=0;i<this._vizGroups.length;i++){var r=this._vizGroups[i];var n=e(document.createElement("div"));var s=new h(n[0],r.caption,r.typeObjects);s.addEventListener(d.TYPE_CHANGED,this._switcherTypeChanged,this);n.appendTo(t);this._uiSwitchers.push(s)}t.appendTo(this._dom$)};f.prototype._switcherTypeChanged=function(e){var t=e.target();if(t.selectedTypeObject()){var i=this._vizModel();var r={};if(this._stacking){r.stacking=this._stacking}if(this._direction){r.direction=this._direction}var n=a.updateType(t.selectedTypeObject().id,r);if(a.isMultipleChart(i.type())){n=a.toMultiChartType(n)}i.type(n)}};f.prototype._validateSize=function(){var t=this._dom$.width();var i=0;var r=0;var n=0;for(var s=0;s<this._uiSwitchers.length;s++){var o=this._uiSwitchers[s];var a=o.size();var l=e(o._dom);l.css({left:i,top:r});i=i+a.width+this._horizontalGap;if(s+1<this._uiSwitchers.length){var c=this._uiSwitchers[s+1];if(i+c.size().width>t){i=0;r=r+a.height+this._verticalGap;n++}}else{n++}}if(this._uiSwitchers.length>0){var p=(this._uiSwitchers[0].size().height+this._verticalGap)*n;this._container$.height(p)}};return f});e("sap/viz/controls/common/views/feed/PlayerFieldShelfEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.PlayerFieldShelfEvent"};t.extend(r,i);r.CLICK_ADD_PLAYER_FIELD="clickAddplayerField";r.PLAYER_FIELD_CHANGED="playerFieldChanged";r.ACTION_CHANGED="playerFieldActionChanged";r.PLAYER_FIELD_EMPTY_CHANGED="playerFieldEmptyChanged";r.PLAYER_FIELD_DROP_DENY="playerFieldDropDeny";return r});e("sap/viz/controls/common/views/feed/PlayerFieldShelf",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/UIControl","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/views/feed/PlayerFieldShelfEvent","sap/viz/controls/common/views/menu/PopUpMenu","sap/viz/controls/common/views/menu/PopUpMenuEvent","sap/viz/controls/common/views/menu/DockStrategy","sap/viz/controls/common/views/menu/MenuGroup","sap/viz/controls/common/views/menu/MenuItem","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/feeds/valueobjects/Shelf","sap/viz/controls/common/feeds/FeedItemType"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E){var y=function(t){y.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.common.views.PlayerFieldShelf";this._dom$.addClass(r.FEEDINGSHELF_PREFIX+"view");this._list$=null;this._ghostCard$=null;this._draggingCard$=null;this._addIndicator$=null;this._addIcon$=null;this._activeHandler=e.proxy(this._active,this);this._dropIndicator$=e(document.createElement("hr")).addClass(r.FEEDINGSHELF_PREFIX+"drop-indicator");this._shelf=new g;this._shelf.id="playerField";this._shelf.name=u.get("VIZ_COMMON_ANIMATION");this._shelf.type=E.DIMENSION;this._shelf.analysisType=_.DIMENSION;this._shelf.feedItemType=E.DIMENSION;this._shelf.capacity=1;this._createChildren();this._droppable();this._enableFeeding=true};t.extend(y,n);y.CARD_HEIGHT=24;y.prototype.shelf=function(){return this._shelf};y.prototype.popUpDock=function(){var e=this;return function(){var t=e._list$.offset();return{x:t.left,y:t.top+y.CARD_HEIGHT/2,shelfWidth:e._list$.outerWidth()}}};y.prototype.analyses=function(t){if(arguments.length>0){var i;var r={};for(i=0;i<t.length;){if(!r[t[i].id()]){r[t[i].id()]=true;i++}else{t.splice(i,1)}}this._traversalCards(function(){e(this).remove()},true,true);for(i=0;i<t.length;i++){this._addCardAt(t[i],-1)}this._analysesChanged();return this}else{var n=[];this._traversalCards(function(t){var i=e(this);var r=i.data("__analysis");if(r){n.push(r)}},true,true);return n}};y.prototype._numCards=function(){var e=0;this._traversalCards(function(t){e++},true,true);return e};y.prototype.addAnalysis=function(e){return this._addAnalysisAt(e,-1)};y.prototype._addAnalysisAt=function(e,t){var i=this._addCardAt(e,t);this._analysesChanged();return i};y.prototype.destroy=function(){this.removeAllEventListeners();e("body").off("mouseup",this._activeHandler);y.superclass.destroy.apply(this,arguments)};y.prototype._createChildren=function(){var t=e(document.createElement("div")).appendTo(this._dom$).addClass(r.FEEDINGSHELF_PREFIX+"item");var i=e(document.createElement("div")).appendTo(t).addClass(r.FEEDINGSHELF_PREFIX+"item-title");i.text(this._shelf.name);var n=e(document.createElement("div")).appendTo(t).addClass(r.FEEDINGSHELF_PREFIX+"item-content");var s=this._list$=e(document.createElement("div")).appendTo(n).addClass(r.FEEDINGSHELF_PREFIX+"item-list");var o=this._addIndicator$=e(document.createElement("div")).appendTo(s);o.addClass(r.FEEDINGSHELF_PREFIX+"item-ph");var a=e(document.createElement("a")).appendTo(o);a.addClass(r.FEEDINGSHELF_PREFIX+"item-ph-text");var l=this._addIcon$=e(document.createElement("div")).appendTo(n).addClass(r.COMMON_PREFIX+"havanaVXTabSprite16");l.addClass(r.FEEDINGSHELF_PREFIX+"item-add-icon");var c=e.proxy(this._dispatchAddFeedingEvent,this);o.on("mousedown",this._activeHandler).on("mouseenter",this._activeHandler).on("mouseleave",this._activeHandler).on("click",c);l.on("mousedown",this._activeHandler).on("mouseenter",this._activeHandler).on("mouseleave",this._activeHandler).on("click",c);e("body").on("mouseup",this._activeHandler)};y.prototype._dispatchAddFeedingEvent=function(){if(this.enableFeeding()){this._dispatchEvent(new a(a.CLICK_ADD_PLAYER_FIELD,this))}};y.prototype._active=function(e){if(this._enableFeeding){if(e.type==="mouseup"||e.type==="mouseleave"){this._list$.removeClass(r.FEEDINGSHELF_PREFIX+"item-list_active");this._addIcon$.removeClass(r.FEEDINGSHELF_PREFIX+"item-add-icon_active")}else if(e.type==="mousedown"||e.type==="mouseenter"){this._list$.addClass(r.FEEDINGSHELF_PREFIX+"item-list_active");this._addIcon$.addClass(r.FEEDINGSHELF_PREFIX+"item-add-icon_active")}}};y.prototype._isValidToken=function(e){if(this._draggingCard$){return true}var t=e.type();var i=e.dataType();var r=t?t.toLowerCase():t;var n=i?i.toLowerCase():i;var s=this._shelf.feedItemType;var o=f.feedCompatible(s,r,n);if(o){var a=this.analyses();for(var l=0;l<a.length;l++){if(a[l].id()===e.id()){o=false;break}}}return o};y.prototype._droppable=function(){var t=this;var r;var n;this._list$.droppable({tolerance:"pointer",accept:"."+s.DRAGGABLE_CLASS_ANALYSIS,activate:function(e,t){},deactivate:e.proxy(function(e,t){if(this._ghostCard$){this._ghostCard$.remove()}if(this._dropIndicator$){this._dropIndicator$.detach()}},this),drop:e.proxy(function(t,i){var a=i.helper;var l=s.instance().getAnalysisToken(a);var c=l.analysisObject;if(l.currentAction()!==o.DENY&&this._isValidToken(c)){l.killRevertAnimation();if(r){l.currentAction(o.ACCEPT_AS_REPLACEMENT);e(r).detach()}else{l.currentAction(o.ACCEPT)}this._addAnalysisAt(c,n)}else{l.currentAction(o.DENY)}l.dropTarget(this._shelf);if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach()},this),over:function(a,l){var c=l.helper;i.defer(function(){var i=s.instance().getAnalysisToken(c);var a=i.analysisObject;if(t._isValidToken(a)){if(t._numCards()===0){if(!t._enableFeeding){i.currentAction(o.DENY);var l=u.get("VIZ_COMMON_DIMENSION_LIMITATION_WARN");i.showWarn(l);return}else{t._ghostCard$=t._addGhostAnalysisAt(a,0);i.currentAction(o.ACCEPT)}}else{c.on("sap.viz.controls.analysisDrag.events.drag",function(s,l,c){var p=[];var h=-1;t._traversalCards(function(i){if(t._draggingCard$&&t._draggingCard$[0]===this){h=i}p.push({card:this,offset:e(this).offset()})},false,true);n=-1;r=null;for(var d=0;d<p.length;d++){var v=p[d].offset.top;if(c<v+y.CARD_HEIGHT-6){n=d;if(c>=v+2){}break}}if(n===-1){n=p.length}if(a.type===_.MND){n=n<p.length/2?0:p.length}if(!t._draggingCard$&&t._numCards()===1){r=p[n===p.length?n-1:n].card}var f=h!==-1;var m=f&&(h===n||h+1===n&&!r);if(f){r=null}t._dropIndicator$.detach();if(r){i.currentAction(o.ACCEPT_AS_REPLACEMENT)}else{if(!t._enableFeeding){i.currentAction(o.DENY);var g=u.get("VIZ_COMMON_DIMENSION_LIMITATION_WARN");i.showWarn(g)}else{i.currentAction(o.ACCEPT);if(!m){t._addElementAt(t._list$,t._dropIndicator$,n)}}}})}}else{i.currentAction(o.DENY)}})},out:e.proxy(function(e,t){var i=t.helper;i.off("sap.viz.controls.analysisDrag.events.drag");var r=s.instance().getAnalysisToken(i);r.playDefaultAction();if(this._ghostCard$){this._ghostCard$.remove()}this._dropIndicator$.detach();r.showWarn()},this)})};y.prototype._traversalCards=function(e,t,i){var r=this._list$.children();var n=0;for(var s=0;s<r.length;s++){var o=r[s];if(this._addIndicator$&&this._addIndicator$[0]===o){continue}if(this._dropIndicator$&&this._dropIndicator$[0]===o){continue}if(t&&this._draggingCard$&&this._draggingCard$[0]===o){continue}if(i&&this._ghostCard$&&this._ghostCard$[0]===o){continue}e.call(o,n);n++}};y.prototype._addGhostAnalysisAt=function(e,t){var i=this._addCardAt(e,t);i.addClass(r.FEEDINGSHELF_PREFIX+"card-ghost");return i};y.prototype._removeCard=function(e){e.remove();this._analysesChanged()};y.prototype._analysesChanged=function(){var e=this._numCards();if(e>=1){this._addIndicator$.addClass(r.FEEDINGSHELF_PREFIX+"item-ph-half")}else{this._addIndicator$.removeClass(r.FEEDINGSHELF_PREFIX+"item-ph-half")}if(e>=1){this._addIcon$.css("display","none");this._addIndicator$.detach()}else{this._addIcon$.css("display","block");this._addIndicator$.appendTo(this._list$)}this._dispatchEvent(new a(a.PLAYER_FIELD_CHANGED,this))};y.prototype._updateCard=function(t,i){var n;if(i.type()===_.HIERARCHY){n=i.selectedHierarchyLevel().name()}else{n=i.name()}t.data("__analysis",i);t.attr("title",n);var s=e("."+r.FEEDINGSHELF_PREFIX+"card-text",t);s.text(n)};y.prototype._genHierarchyMenuGroups=function(e){var t=[];var i=e.hierarchyLevels();for(var r=0;r<i.length;r++){var n=i[r];var s=new d(n.id(),n.name());s.selected(n.selected());t.push(s)}var o=[new h(t,true)];return o};y.prototype._genMeasureMenuGroups=function(e){return e.actions()};y.prototype._addCardAt=function(t,i){var n=e(document.createElement("div")).addClass(r.FEEDINGSHELF_PREFIX+"card");var s=0;var o,l;var c,p,h,d;if(t.type()===_.HIERARCHY){var u=e(document.createElement("span")).appendTo(n);u.addClass([r.FEEDINGSHELF_PREFIX+"hierarchy-card-icon",r.COMMON_PREFIX+"UVBSharedSprite"].join(" "));this._createCardAction(n,this._genHierarchyMenuGroups,e.proxy(function(e){t=t.clone();t.selectedHierarchyLevelID(e.data.selectedItem.id());this._updateCard(n,t);this._dispatchEvent(new a(a.PLAYER_FIELD_CHANGED,this))},this),t);s++}else if(t.type()===_.MEASURE&&t.actions()&&t.actions().length>0){this._createCardAction(n,this._genMeasureMenuGroups,e.proxy(function(e){this._dispatchEvent(new a(a.ACTION_CHANGED,this,{feedItemID:this._shelf.id,analysisObjectID:t.id(),actionID:e.data.selectedItem.id()}))},this),t);s++}var v=e(document.createElement("div")).appendTo(n);v.attr("style","width:19px; height:22px;");v.addClass(r.FEEDINGSHELF_PREFIX+"card-operation-div");var f=e(document.createElement("span")).appendTo(v);f.addClass(r.FEEDINGSHELF_PREFIX+"card-operation "+r.COMMON_PREFIX+"havanaSharedSprite16");v.click(e.proxy(function(){this._removeCard(n)},this));s++;var m=e(document.createElement("div")).appendTo(n);m.addClass([r.FEEDINGSHELF_PREFIX+"card-text",r.FEEDINGSHELF_PREFIX+"card-text-with-icon-"+s].join(" "));m.addClass(r.COMMON_PREFIX+"text-ellipsis");this._updateCard(n,t);this._addElementAt(this._list$,n,i);this._draggable(n);return n};y.prototype._createCardAction=function(t,i,n,s){var o=e(document.createElement("div")).appendTo(t);o.attr("style","width:19px; height:22px;");o.addClass(r.FEEDINGSHELF_PREFIX+"action-icon-div");var a=e(document.createElement("span")).appendTo(o);if(s.type()===_.HIERARCHY){t.addClass(r.FEEDINGSHELF_PREFIX+"card-hierarchy");a.addClass([r.FEEDINGSHELF_PREFIX+"action-icon-hierarchy",r.COMMON_PREFIX+"UVBSharedSprite"].join(" "))}if(s.type()===_.MEASURE){t.addClass(r.FEEDINGSHELF_PREFIX+"card-measure");a.addClass([r.FEEDINGSHELF_PREFIX+"action-icon-measure",r.COMMON_PREFIX+"havanaSharedSprite16"].join(" "))}o.on("click",e.proxy(function(){var e=new l(document.createElement("div"),i.call(this,t.data("__analysis")));e.addEventListener(c.ITEM_SELECTED,n,this);e.open(o,p.DOWN_WITH_ARROW)},this));return o};y.prototype._addElementAt=function(t,i,r){var n=t.children();if(r!==-1&&r<n.length){e(n[r]).before(i)}else{t.append(i)}};y.prototype._draggable=function(t){var i=this;s.enableDraggableFeeding(t[0],t.data("__analysis"));t.draggable({containment:"document",revert:"valid",helper:function(t){var i=s.getDefaultHelper(this);var r=s.instance().getAnalysisToken(e(i));r.defaultAction(o.AS_TRASH);return i},start:e.proxy(function(t,i){this._draggingCard$=e(this);this._draggingCard$.addClass(r.FEEDINGSHELF_PREFIX+"card-ghost");var n=i.helper;var o=s.instance().getAnalysisToken(n);var l=o.analysisObject;var c={analysisObject:l,feedId:this._shelf.id};this._dispatchEvent(new a(a.PLAYER_FIELD_EMPTY_CHANGED,this,c))},this),stop:function(t,n){var l=n.helper;if(i._draggingCard$){i._draggingCard$.removeClass(r.FEEDINGSHELF_PREFIX+"card-ghost");i._draggingCard$=null}var c=s.instance().getAnalysisToken(l);if(!c.dropTarget()||c.currentAction()===o.ACCEPT||c.currentAction()===o.ACCEPT_AS_REPLACEMENT){i._removeCard(e(this))}else{var p={analysisObject:c.analysisObject,feedId:i._shelf.id};i._dispatchEvent(new a(a.PLAYER_FIELD_DROP_DENY,this,p))}},drag:function(e,t){}})};y.prototype.enableFeeding=function(e){if(arguments.length>0){this._enableFeeding=e;this._updateFeedingEnabled(e)}else{return this._enableFeeding}};y.prototype._updateFeedingEnabled=function(e){if(e){this._list$.css("cursor","pointer");this._addIcon$.css("display","block")}else{this._list$.css("cursor","default");this._addIcon$.css("display","none")}};y.langProps={changeCalculation:"VIZ_COMMON_CHANGE_CALCULATION",sum:"VIZ_COMMON_SUM",average:"VIZ_COMMON_AVERAGE",min:"VIZ_COMMON_MIN",max:"VIZ_COMMON_MAX",countDistinct:"VIZ_COMMON_COUNT_DISTINCT",countAll:"VIZ_COMMON_COUNT_ALL",none:"VIZ_COMMON_NONE",sum_short:"VIZ_COMMON_SUM_SHORT",average_short:"VIZ_COMMON_AVERAGE_SHORT",min_short:"VIZ_COMMON_MIN_SHORT",max_short:"VIZ_COMMON_MAX_SHORT",countDistinct_short:"VIZ_COMMON_COUNT_DISTINCT_SHORT",countAll_short:"VIZ_COMMON_COUNT_ALL_SHORT",none_short:"VIZ_COMMON_NONE_SHORT"};return y});e("sap/viz/controls/feeding/FeedingPanelEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.FeedingPanelEvent"};t.extend(r,i);r.ACTION_CHANGED="actionChanged";return r});e("sap/viz/controls/feeding/FeedingPanel",["jquery","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/SubtotalItemType","sap/viz/controls/common/views/feed/FeedList","sap/viz/controls/common/views/feed/FeedListEvent","sap/viz/controls/common/views/feed/FeedingShelf","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/views/feed/PlayerFieldShelf","sap/viz/controls/common/views/feed/PlayerFieldShelfEvent","sap/viz/controls/runtime/RuntimeManager","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/feeding/FeedingPanelConfig","sap/viz/controls/feeding/FeedingPanelEvent","sap/viz/controls/common/services/BVRService","sap/viz/controls/common/utils/Serialization"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A,P){var R=s.COMMON_PREFIX;var z=function(t,i){z.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.feeding.FeedingPanel";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_feedingpanel_control");this._dom$=e(t);this._dom$.addClass([s.FEEDINGPANEL_PREFIX+"view",R+"scrollable",R+"scrollable-y"].join(" "));this._uiShelf=null;this._dicUIShelf={};this._trellisArrowIcon$=null;this._trellisCollapsed=true;this._trellisDom$=null;this._trellisContainer$=null;this._allAnalyses=null;this._uiConfig=i?i:C.instance();this._enableTrellis=this._uiConfig.enableTrellis!==false;this._feedsUpdatedRequested=false;if(this._vizModel().type()===this._uiConfig.defaultVizType){this._applyModel()}else{this._vizModel().type(this._uiConfig.defaultVizType)}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_feedingpanel_control")};r.extend(z,a);z.prototype.feeds=function(e){if(arguments.length>0&&i.isArray(e)){if(e!=null&&!n.isArrayOfFeedItem(e)){return}var t=this._vizModel().type();if(y.isGeo(t)){var r=[];for(var s=0;s<e.length;s++){r[s]=I.cloneFeeds(e[s])}this._vizModel().feedingItems(r,this._enableTrellis)}else{var r=I.cloneFeeds(e);this._vizModel().feedingItems(r,this._enableTrellis)}return this}else{return this._vizModel().explicitFeedingItems(e)}};z.prototype.playerField=function(e){if(arguments.length>0){this._vizModel().playerField(e);return this}else{return this._vizModel().playerField()}};z.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){if(e!=null&&!n.isArrayOfAnalysisObject(e)){return}this._allAnalyses=e}else{return this._allAnalyses}};z.prototype.feedAnalysisObjects=function(e,t){if(e!=null&&!n.isArrayOfAnalysisObject(e)){return}var i=this._vizModel();var r;if(t===true){r=A.suggestFeeds(i.type(),i.explicitFeedingItems(),e)}else{r=A.suggestFeeds(i.type(),e)}if(r){i.feedingItems(r.feeds)}return r.feeds};z.prototype.save=function(){var e={};var t=this._vizModel().type();e["type"]=t;if(y.isGeo(t)){var i=[];var r=this.feeds();for(var n=0;n<r.length;n++){i[n]=c.toJSON(r[n])}e["feedingItems"]=i}else{e["feedingItems"]=c.toJSON(this.feeds())}return e};z.prototype.load=function(e){var t=P.migrateFeedingPanel(e);var i=t.type;this._vizModel().type(i);var r=t.feedingItems;if(r){if(y.isGeo(i)){var n=[];for(var s=0;s<r.length;s++){n[s]=c.fromJSON(r[s])}this.feeds(n)}else{var n=c.fromJSON(r);if(n&&n.length>0){this.feeds(n)}}}var o=this.playerField();if(o){this._playerFieldShelf.analyses([o])}};z.langProps={measures:"VIZ_COMMON_MEASURES",dimensions:"VIZ_COMMON_DIMENSIONS",subtotals:"VIZ_COMMON_SUBTOTALS",trellis:"VIZ_COMMON_TRELLIS"};z.prototype._onConnect=function(e,t){if(t){this._vizModel().extensionValues({feedingPanel:{enableTrellis:this._enableTrellis}});this._applyModel()}};z.prototype._onVizModelChanged=function(e){var t=this._vizModel().type();if(y.isGeo(t)){return}if(e.data.vizTypeChanged){this._applyModel()}else if(e.data.feedingItemsChanged||e.data.isMNDVisibleChanged||e.data.sliceDimensionChanged){this._applyModel(false)}};z.prototype._getFeed=function(e){var t=this._vizModel().feedingItems()||[];for(var i=0;i<t.length;i++){var r=t[i];if(r.id()===e){return r}}return null};z.prototype._applyModel=function(e){if(e!==false){this._createShelves()}this._updateShelves()};z.prototype._createShelves=function(){var e=E.getInitialShelves(this._vizModel().type());this._redrawShelves(e.measure,e.attribute,e.subtotal,e.trellis,e.playerField)};z.prototype._updateShelves=function(){var e=this._vizModel().explicitFeedingItems()||[];var t=function(t){for(var i in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(i)){var r=this._dicUIShelf[i];var n=[];for(var s=0;s<e.length;s++){var o=e[s];if(o.id()===r.shelf().id){n=o.values()}}t(r,n)}}};var i=[];t.call(this,function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(l.compatible(l.MEASURE,n.type())){i.push(n.name())}}});t.call(this,function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if(l.compatible(l.MND,n.type())){n.name("("+i.join(",")+")")}}e.analyses(t)});var r=this.playerField();if(this._playerFieldShelf){if(r){this._playerFieldShelf.analyses([r])}else{this._playerFieldShelf.analyses([])}}};z.prototype._isShelvesEqual=function(e,t){if(null==e||null==t||e.length!==t.length){return false}for(var i=0;i<e.length;i++){var r=e[i];var n=t[i];if(!r.equals(n)){return false}}return true};z.prototype._redrawShelves=function(e,t,i,r,n){var s;if(this._oldvizModelType){var a=E.getInitialShelves(this._oldvizModelType);if(this._isShelvesEqual(e,a.measure)&&this._isShelvesEqual(t,a.attribute)&&this._isShelvesEqual(i,a.subtotal)&&this._isShelvesEqual(r,a.trellis)&&y.supportAnimation(this._vizModel().type())==y.supportAnimation(this._oldvizModelType)){return}}this._dom$.empty();for(var l in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(l)){s=this._dicUIShelf[l];s.destroy()}}this._dicUIShelf={};this._playerFieldShelf=null;this._createSection(o.get(z.langProps["measures"]),e);this._createSection(o.get(z.langProps["dimensions"]),t);this._createSection(o.get(z.langProps["subtotals"]),i);if(y.supportAnimation(y.toSingleChartType(this._vizModel().type()))){this._createPlayerField()}if(this._enableTrellis){this._createSection(o.get(z.langProps["trellis"]),r)}for(var c in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(c)){s=this._dicUIShelf[c];s.addEventListener(v.CLICK_ADD_FEEDING,this._clickAddFeeding,this);s.addEventListener(v.FEEDING_CHANGED,this._deferFeedsUpdated,this);s.addEventListener(v.FEEDING_EMPTY_CHANGED,this._dragToUpdateShelvesStatus,this);s.addEventListener(v.FEEDING_DROP_DENY,this._updateShelvesStatus,this);s.addEventListener(v.ACTION_CHANGED,this._actionChangedHandler,this)}}if(this._playerFieldShelf){this._playerFieldShelf.addEventListener(m.CLICK_ADD_PLAYER_FIELD,this._clickAddPlayerField,this);this._playerFieldShelf.addEventListener(m.PLAYER_FIELD_CHANGED,this._deferFeedsUpdated,this);this._playerFieldShelf.addEventListener(m.PLAYER_FIELD_EMPTY_CHANGED,this._dragToUpdateShelvesStatus,this);this._playerFieldShelf.addEventListener(m.PLAYER_FIELD_DROP_DENY,this._updateShelvesStatus,this)}this._oldvizModelType=this._vizModel().type()};z.prototype._clickAddFeeding=function(e){var r=e.target();this._uiShelf=r;if(this._uiConfig&&this._uiConfig.useBuildInFeedList===true){var n=r.shelf();var s=document.createElement("div");var o=this._getFeed(n.id);var a=o?o.values():[];if(n.id===p.ROW_SUBTOTALS||n.id===p.COLUMNS_SUBTOTALS){for(var l=0;l<a.length;l++){var c;if(a[l].aggregationTarget()!==undefined){c=a[l].aggregationTarget()}else{c=i.decode(a[l].id())[0]}a[l].id(c)}for(var _=a.length-1;_>=0;_--){if(a[_].aggregationType()!==null&&a[_].aggregationType()!==h.TOTAL){a.splice(_,1)}}var v=new d(s,h.sanitizeAnalysisObjects(this._allAnalyses),n.feedItemType,a)}else{var v=new d(s,this._allAnalyses,n.feedItemType,a)}v.addEventListener(u.ITEM_SELECTED,function(e){var t=e.data.selectedItem;r.addAnalysis(t)},this);v.open(r.popUpDock())}else{this._dispatchEvent(new t(t.REQUEST_FEED,this,{feedId:r.shelf().id,fieldLocalPosition:r.popUpDock()}))}};z.prototype._clickAddPlayerField=function(e){var t=e.target();this._playerFieldShelf=t;var i=t.shelf();var r=document.createElement("div");var n=this._getFeed(i.id);var s=n?n.values():[];var o=new d(r,this._allAnalyses,i.feedItemType,s);var a=this;o.addEventListener(u.ITEM_SELECTED,function(e){var t=e.data.selectedItem;a.playerField(t)},this);o.open(t.popUpDock())};z.prototype._actionChangedHandler=function(e){if(e.data.feedItemID===p.ROWS&&e.data.actionID.indexOf(h.action)!==-1){aggregationType=h.getAggregationType(e.data.actionID);if(aggregationType===null){return}this.updateSubtotalsWithRowAction(aggregationType,e.data.analysisObjectID,e.data.feedItemID)}this._dispatchEvent(new T(T.ACTION_CHANGED,this,{feedItemID:e.data.feedItemID,analysisObjectID:e.data.analysisObjectID,actionID:e.data.actionID}))};z.prototype._deferFeedsUpdated=function(t){if(!this._feedsUpdatedRequested){this._feedsUpdatedRequested=true;i.defer(e.proxy(function(){this._feedsUpdatedRequested=false;if(this._dom){this._feedsUpdated()}},this))}};z.prototype._createSection=function(t,i){if(i.length===0){return}var r=e(document.createElement("div")).appendTo(this._dom$);var n=e(document.createElement("div")).appendTo(r);n.addClass(s.FEEDINGPANEL_PREFIX+"title-without-icon");var o=e(document.createElement("label")).appendTo(n);o.addClass(s.FEEDINGPANEL_PREFIX+"title-text");o.text(t);var a=e(document.createElement("div")).appendTo(r);a.addClass(s.FEEDINGPANEL_PREFIX+"separator");var l=e(document.createElement("div")).appendTo(r);l.addClass(s.FEEDINGPANEL_PREFIX+"container");var c=this._vizModel();for(var p=0;p<i.length;p++){var h=i[p];var d=new _(document.createElement("div"),h,this._uiConfig.measure);if(c){this._setUiShelfAddIconState(d,c)}l.append(d._dom);this._dicUIShelf[h.id]=d}if(i[0].type==="trellis"){this._trellisDom$=r;n.removeClass(s.FEEDINGPANEL_PREFIX+"title-without-icon");n.addClass(s.FEEDINGPANEL_PREFIX+"title-with-icon");var u=this._trellisArrowIcon$=e(document.createElement("div"));u.appendTo(n);u.click(e.proxy(this._trellisArrowIconClickHandler,this));o.click(e.proxy(this._trellisArrowIconClickHandler,this));this._trellisContainer$=l;this._updateTrellisSection(this._trellisCollapsed)}};z.prototype._createPlayerField=function(){var t=e(document.createElement("div")).appendTo(this._dom$);var i=e(document.createElement("div")).appendTo(t);i.addClass(s.FEEDINGPANEL_PREFIX+"container");var r=new f(document.createElement("div"));i.append(r._dom);this._playerFieldShelf=r};z.prototype._setUiShelfAddIconState=function(e,t){var i=I.cloneFeeds(t.feedingItems());var r=t.type();var n=e._shelf.id;var s=I.getManifestFeedsMap(r);if(!y.isMultipleChart(r)&&y.supportMultiChart(r)){var o=y.toMultiChartType(r);var a=I.getManifestFeedsMap(o);var c=I.supportMultiChart(i,a);if(c){var p=a[I.MultiplierFeedingName];s[I.MultiplierFeedingName]=p}}var h=t.isMNDVisible();var d=false;var u=n;var _,v;if(e){if(e.shelf().analysisType===l.MEASURE){v=this._getFeed(u);_=(v?v.values().length:0)<e.shelf().capacity}else{if(n===I.RowsFeedingName||n===I.ColumnsFeedingName){u=I.MultiplierFeedingName}if(u===I.MultiplierFeedingName&&this.playerField()){_=false}else{_=I.canAddValue(i,n,s,h,d,u)}}e.enableFeeding(_)}};z.prototype._feedsUpdated=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_feeds");var e=this._vizModel();var i=this.playerField();if(this._playerFieldShelf){i=this._playerFieldShelf.analyses()[0]}var r=[];for(var n in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(n)){var s=this._dicUIShelf[n];var o=s.shelf();if(n===p.ROW_SUBTOTALS||n===p.ROWS){this._compareRowsAndSubtotals(this._dicUIShelf);r.push(new c(p.ROW_SUBTOTALS,p.CALCULATION,this._dicUIShelf[p.ROW_SUBTOTALS].analyses()));r.push(new c(p.ROWS,I.convertFeedType(o.feedItemType),this._dicUIShelf[p.ROWS].analyses()));this._compareRowsAndSubtotalsForHierarchies(this._dicUIShelf);break}r.push(new c(o.id,I.convertFeedType(o.feedItemType),s.analyses()))}}var a=e.explicitFeedingItems();var l=!I.equal(a,r);if(l){e.feedingItems(r);this._dispatchEvent(new t(t.FEEDS_CHANGED,this,{feeds:this.feeds()}))}if(this._playerFieldShelf){e.playerField(i)}this._updateShelvesStatus();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_feeds")};z.prototype._compareRowsAndSubtotalsForHierarchies=function(e){var t=null;var i=null;for(var r in this._dicUIShelf){if(r===p.ROWS){i=this._dicUIShelf[r]}if(r==p.ROW_SUBTOTALS){t=this._dicUIShelf[r]}}var n=i.analyses();var s=t.analyses();if(i.lastHierarchyOjbectUpdated()){for(var o=0;o<s.length;o++){var a=s[o];if(a.id().indexOf(i.lastHierarchyOjbectUpdated().id())>-1){var l=a.hierarchyLevels();var c=i.lastHierarchyOjbectUpdated().selectedHierarchyLevel();for(var h=0;h<l.length;h++){var d=l[h];if(d.id()===c.id()){a.selectedHierarchyLevelID(d.id())}}}}}else if(t.lastHierarchyOjbectUpdated()){for(var o=0;o<n.length;o++){var a=n[o];if(t.lastHierarchyOjbectUpdated().id().indexOf(a.id())>-1){var l=a.hierarchyLevels();var c=t.lastHierarchyOjbectUpdated().selectedHierarchyLevel();for(var h=0;h<l.length;h++){var d=l[h];if(d.id()===c.id()){a.selectedHierarchyLevelID(d.id())}}}}}i.lastHierarchyOjbectUpdated(null);t.lastHierarchyOjbectUpdated(null)};z.prototype.updateSubtotalsWithRowAction=function(e,t,r){var n=null;var s=null;var o=null;for(var a in this._dicUIShelf){if(a===p.ROWS){s=this._dicUIShelf[a]}if(a==p.ROW_SUBTOTALS){n=this._dicUIShelf[a]}}if(s){var l=s.analyses();for(var c=0;c<l.length;c++){if(l[c].id()===t){o=l[c].clone()}}}if(n&&o){var h=o.id();o.id(i.encode(h,e));o.aggregationType(e);o.aggregationTarget(i.decode(h)[0]);o.actions(null);n.addAnalysis(o)}};z.prototype._compareRowsAndSubtotals=function(e){var t;var r;var n=true;for(var s in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(s)){var o=this._dicUIShelf[s];if(s===p.ROWS){r=o}if(s==p.ROW_SUBTOTALS){t=o}}}if(r._lastAnalysisObjectRemoved!==null&&r.analyses().length!==0){for(var a=0;a<r.analyses().length;a++){if(r._lastAnalysisObjectRemoved.id()===r.analyses()[a].id()){n=false}}}var l=t._lastAnalysisObjectRemoved;if(l!==null){r._lastTwinAnalysisObjectRemoved=l}var c=t.analyses().length;var d=[];for(var a=0;a<c;a++){var u=t.analyses()[a];var _=t.analyses();var v=u.clone();var f=u.clone();if(!u.aggregationType()&&r._lastTwinAnalysisObjectRemoved===null){r._lastTwinAnalysisObjectRemoved=u;for(var a=0;a<r.analyses().length;a++){if(u.id()===r.analyses()[a].id()){r._lastTwinAnalysisObjectRemoved=null;break}}}if(r._lastTwinAnalysisObjectRemoved===null){if(r._lastCardRemoved!==null&&this._analysisObjectInShelfAnalyses(r._lastAnalysisObjectRemoved,t.analyses())){var m=r._lastCardRemoved;var g=r._lastAnalysisObjectRemoved;var E;if(u.aggregationTarget()!==undefined){E=u.aggregationTarget()}else{E=i.decode(u._id)[0]}if(E===g._id){var y=t.getCardFromAnalysisObject(u);if(y){d.push(y)}}}else if(!this._analysisObjectInShelfAnalyses(u,r.analyses())){r.addAnalysis(v);z.updateSubtotalsAnalysisObject(f,h.TOTAL,_,a,t)}else if(!u.aggregationType()){z.updateSubtotalsAnalysisObject(f,h.TOTAL,_,a,t)}else if(u.aggregationType()&&this._analysisObjectInShelfAnalyses(u,r.analyses())&&this._compareSubtotalNameToParentDimension(u,r.analyses())){z.updateSubtotalsAnalysisObject(f,u.aggregationType(),_,a,t)}}else if(r._lastTwinAnalysisObjectRemoved){if(!this._analysisObjectInShelfAnalyses(u,r.analyses())){r.addAnalysis(v);z.updateSubtotalsAnalysisObject(f,h.TOTAL,_,a,t)}else if(!u.aggregationType()){z.updateSubtotalsAnalysisObject(f,h.TOTAL,_,a,t)}r.resetTwinAnalysisObject();t.resetLastRemoved()}}if(d.length>0){r.resetLastRemoved();t.resetLastRemoved();if(n===true){for(var I=0;I<d.length;I++){t.removeCard(d[I])}}}};z.updateSubtotalsAnalysisObject=function(e,t,r,n,s){if(e.dataType()===p.LEVEL||e.dataType()===p.HIERARCHY){var o=e.hierarchyLevels();for(var a=0;a<o.length;a++){var l=o[a];if(l.selected()){l._name=h.getSubTotalsAggregationDisplayType(t)+" "+l._name}}}else{e.name(h.getSubTotalsAggregationDisplayType(t)+" "+e.name())}var c=e.id();e.aggregationType(t);if(e.aggregationTarget()!==undefined){e.aggregationTarget(e.aggregationTarget())}else{e.aggregationTarget(i.decode(c)[0])}e.id(i.encode(c,t));e.actions(null);if(s.analyses().length>1){temp=e.id().split("_encoded")[0];for(var d=0;d<s.analyses().length;d++){if(temp===s.analyses()[d].id()){n=d;break}}}r[n]=e;s.analyses(r)};z.foundTokenInName=function(e,t){if(e._name.indexOf(t)===-1){return false}else{return true}};z.prototype._analysisObjectInShelfAnalyses=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];var s=i.decode(n.id())[0];var o=i.decode(e.id())[0];if(s===o){return true}else if(n.aggregationTarget()!==undefined&&o===n.aggregationTarget()){return true}else if(e.aggregationTarget()!==undefined&&s===e.aggregationTarget()){return true}}return false};z.prototype._compareSubtotalNameToParentDimension=function(e,t){for(var r=0;r<t.length;r++){var n=t[r];if((e.dataType()===p.LEVEL||e.dataType()===p.HIERARCHY)&&(n.dataType()===p.LEVEL||n.dataType()===p.HIERARCHY)){var s;if(e.aggregationTarget()!==undefined){s=e.aggregationTarget()}else{s=i.decode(e.id())[0]}if(s===n.id()){var o=e.hierarchyLevels();var a=n.hierarchyLevels();for(var l=0;l<o.length;l++){var c=o[l];if(c.selected()){for(var h=0;h<a.length;h++){var d=a[h];if(d.selected()){if(d.name()===c.name()){return true}}}}}}}else if(n.name()===e.name()){return true}}return false};z.prototype._dragToUpdateShelvesStatus=function(e){var t=e.data;var r=t.analysisObject;var n=t.feedId;var s=this._vizModel();if(s){var o=I.cloneFeeds(s.feedingItems());for(var a=0;a<o.length;a++){var c=o[a];if(c.id()===n){var p=c.values();for(var a=0;a<p.length;a++){var h=p[a];if(h.id()===r.id()){p.splice(a,1);break}}break}}var d=i.clone(s.type());var u=I.getManifestFeedsMap(d);var _;if(y.isMultipleChart(d)){var v=I.hasRowOrColumn(o);if(v){_=u}else{var f=y.toSingleChartType(d);_=I.getManifestFeedsMap(f);var m=u[I.MultiplierFeedingName];_[I.MultiplierFeedingName]=m}}else{_=u;if(y.supportMultiChart(d)){var g=y.toMultiChartType(d);var E=I.getManifestFeedsMap(g);var C=I.supportMultiChart(o,E);if(C){var m=I.getManifestFeedsMap(g)[I.MultiplierFeedingName];_[I.MultiplierFeedingName]=m}}}var T=s.isMNDVisible();var A=r.type()===l.MND;for(var P in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(P)){var R=this._dicUIShelf[P];if(R&&R.shelf().analysisType!==l.MEASURE){var n;if(P===I.RowsFeedingName||P===I.ColumnsFeedingName){n=I.MultiplierFeedingName}else{n=P}var z=I.canAddValue(o,P,_,T,A,n);R.enableFeeding(z)}}}if(this._playerFieldShelf){var z=this.playerField()==null||t.feedId==="playerField";this._playerFieldShelf.enableFeeding(z)}}};z.prototype._updateShelvesStatus=function(){var e=this._vizModel();if(e){var t=I.cloneFeeds(e.feedingItems());for(var i in this._dicUIShelf){if(this._dicUIShelf.hasOwnProperty(i)){var r=this._dicUIShelf[i];this._setUiShelfAddIconState(r,e)}}var n=I.hasRowOrColumn(t);if(n){this._CollapseTrellis(false)}if(this._playerFieldShelf){var s=false;if(y.supportAnimation(e.type())){s=this.playerField()==null}this._playerFieldShelf.enableFeeding(s)}}};z.prototype._validateSize=function(){var e=this.size();this._dom$.height(e.height);this._dom$.width(e.width)};z.prototype._trellisArrowIconClickHandler=function(){this._CollapseTrellis(!this._trellisCollapsed)};z.prototype._updateTrellisSection=function(e){if(!this._trellisArrowIcon$){return}this._trellisArrowIcon$.removeClass();this._trellisArrowIcon$.addClass(s.COMMON_PREFIX+"UVBSharedSprite");if(e){this._trellisArrowIcon$.addClass(s.FEEDINGPANEL_PREFIX+"collapse-icon");this._trellisContainer$.hide()}else{this._trellisArrowIcon$.addClass(s.FEEDINGPANEL_PREFIX+"expand-icon");this._trellisContainer$.show()}};z.prototype._CollapseTrellis=function(e){if(arguments.length>0){if(this._trellisCollapsed!==e){this._trellisCollapsed=e;this._updateTrellisSection(e)}}else{return this._trellisCollapsed}};return z});e("sap/viz/controls/builder/VizBuilder",["jquery","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/VizControlHost","sap/viz/controls/common/views/feed/FeedingShelfEvent","sap/viz/controls/common/managers/LangManager","sap/viz/controls/builder/VizBuilderConfig","sap/viz/controls/builder/VizBuilderEvent","sap/viz/controls/mapbuilder/MapBuilder","sap/viz/controls/mapbuilder/events/GeoEvent","sap/viz/controls/switchbar/SwitchBar","sap/viz/controls/switchbar/SwitchBarEvent","sap/viz/controls/feeding/FeedingPanel","sap/viz/controls/feeding/FeedingPanelEvent","sap/viz/controls/Version","sap/viz/controls/feeding/FeedingPanelConfig","sap/viz/controls/mapbuilder/MapBuilderConfig","sap/viz/controls/switchbar/SwitchBarConfig"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I){var C=i.COMMON_PREFIX;var T=function t(r,n){t.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.builder.VizBuilder";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizbuilder_control");this._dom=r;this._dom$=e(this._dom);this._dom$.addClass([i.BUILDER_PREFIX+"area",C+"scrollable",C+"scrollable-y"].join(" "));this._uiConfig=n?n:p.instance();this._vizModel().type(this._uiConfig.defaultVizType);for(var s in this._uiConfig.controls){if(this._uiConfig.controls.hasOwnProperty(s)){var o=this._uiConfig.controls[s];if(o.defaultVizType&&o.defaultVizType!==this._uiConfig.defaultVizType){o.defaultVizType=this._uiConfig.defaultVizType}}}this._layout=null;this._divContainer=null;this._switchBar=null;this._feedingPanel=null;this._mapBuilder=null;this._switchBarDiv=null;this._feedingPanelDiv=null;this._mapBuilderDiv=null;this._activeFeedingDiv=null;this._trellisHistory={};this._attributeHistory={};this._measureHistory={};this._createChildren();var a=this._vizModel().type()?this._vizModel().type():this._uiConfig.defaultVizType;if(a===this._uiConfig.defaultVizType){this._updateActiveFeedingDiv()}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizbuilder_control")};n.extend(T,a);T.prototype._createChildren=function(){this._layout=e(document.createElement("div")).addClass(i.BUILDER_PREFIX+"view-list");var t=this._uiConfig.controls;var n;var s=true;if(this._uiConfig.header){s=this._uiConfig.header.visible===false?false:true}var a=this._divContainer=e(document.createElement("div"));a.addClass(i.BUILDER_PREFIX+"switcher-container");a.appendTo(this._layout);var l=t.switchBar?t.switchBar:I.instance();if(l){if(s){var p=e(document.createElement("div"));p.addClass(i.BUILDER_PREFIX+"header");var h=e(document.createElement("span"));h.addClass(i.BUILDER_PREFIX+"header-text").text(c.get("VIZ_BUILDER_CHART"));var g=this._headerValue$=e("<span/>");g.addClass(i.BUILDER_PREFIX+"header-value");h.appendTo(p);g.appendTo(p);p.appendTo(a)}this._switchBarDiv=e(document.createElement("div"));this._switchBar=new _(this._switchBarDiv,l);this._switchBar.size({width:212});this._switchBar.horizontalGap(15);if(s){this._switchBar.addEventListener(v.VIZ_TYPE_CHANGED,function(e){var t=this._switchBar.selectedTypeObject();g.text(t?t.caption:"")},this)}var C=this._switchBar.vizType();if(s&&C&&C.length>0){g.text(o.getVizTypeObject(C).caption)}this._switchBarDiv.appendTo(a);this._addChild(this._switchBar,["vizType","horizontalGap","verticalGap"],[v.VIZ_TYPE_CHANGED])}var T=t.feedingPanel?t.feedingPanel:E.instance();if(T){n=T;this._feedingPanelDiv=e(document.createElement("div"));this._feedingPanel=new f(this._feedingPanelDiv,n);this._addChild(this._feedingPanel,["feeds","feed","feedAnalysisObjects"],[r.REQUEST_FEED,r.FEEDS_CHANGED,m.ACTION_CHANGED])}var A=t.mapBuilder?t.mapBuilder:y.instance();if(A){n=A;n.feedingPanel.useBuildInFeedList=t.feedingPanel.useBuildInFeedList;this._mapBuilderDiv=e(document.createElement("div"));this._mapBuilder=new d(this._mapBuilderDiv,n);this._addChild(this._mapBuilder,["config"],[u.CHANGE_BASEMAP_PROVIDER,u.CHANGE_BASEMAP_TYPE,u.SHOW_LAYER,u.HIDE_LAYER,u.CHANGE_LAYER_VIZTYPE,u.SHOW_LEGEND,u.HIDE_LEGEND,u.CHANGE_VIZ_PROPERITIES,u.ADD_LAYER,u.UPDATE_LAYER_DATA,u.DELETE_LAYER,u.REORDER_LAYER,u.RENAME_LAYER,u.ACTION_CHANGED])}e(this._layout).appendTo(this._dom)};T.prototype._validateSize=function(){};T.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){this._updateActiveFeedingDiv();if(this._headerValue$){var t=this._vizModel().type();if(t&&t.length>0){t=o.getVizType(t);this._headerValue$.text(o.getVizTypeObject(t).caption)}}}};T.prototype._updateActiveFeedingDiv=function(){var e=this._vizModel();if(e.type()===t.TYPE_GEO_MAP){this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._mapBuilderDiv);if(this._mapBuilder){this._mapBuilder.reset()}}else{this._activeFeedingDiv=this._replaceDiv(this._layout,this._activeFeedingDiv,this._feedingPanelDiv)}};T.prototype._replaceDiv=function(e,t,i){if(t!==i){if(t){t.detach()}if(i){i.appendTo(e);t=i}}return t};T.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){if(this._feedingPanel){this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel,arguments)}if(this._mapBuilder){this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder,arguments)}}else{if(this._feedingPanel){return this._feedingPanel.analysisObjectsForPicker.apply(this._feedingPanel)}if(this._mapBuilder){return this._mapBuilder.analysisObjectsForPicker.apply(this._mapBuilder)}}};T.prototype.save=function(){var e={};e["version"]=g.VERSION;if(this._switchBar){e["switchBar"]=this._switchBar.save()}if(this._feedingPanel){e["feedingPanel"]=this._feedingPanel.save()}if(this._mapBuilder){e["mapBuilder"]=this._mapBuilder.save()}return e};T.prototype.load=function(e){if(!e){return}var t=e["switchBar"];if(t&&this._switchBar){this._switchBar.load(t)}t=e["feedingPanel"];if(t&&this._feedingPanel){this._feedingPanel.load(t)}t=e["mapBuilder"];if(t&&this._mapBuilder){this._mapBuilder.load(t)}};T.prototype.feedingPanel=function(){return this._feedingPanel};T.prototype.switchBar=function(){return this._switchBar};T.prototype.mapBuilder=function(){return this._mapBuilder};return T});e("sap/viz/controls/common/constants/EventTypeConst",[],function(){var e={};e.VC_CHANGE_VIZ_TYPE="vc-changeVizType";e.PRESS_FILTER_BUTTON="vc-filter";e.PRESS_EXCLUDE_BUTTON="vc-exclude";e.PRESS_DRILLDOWN_BUTTON="vc-drillDown";e.SELECT_SHOW_LEGEND="vc-showLegend";e.SELECT_SHOW_DATALABELS="vc-showDataLabels";e.SELECT_CHANGE_DIRECTION="vc-changeDirection";e.SELECT_CHANGE_STACKING="vc-changeStacking";e.SELECT_INSERT_COMMENT="vc-insertComment";e.SELECT_CHART_EDITOR="vc-chartEditor";e.SHOW_MESSAGE="vc-showMessage";e.CLEAR_MESSAGE="vc-clearMessage";e.VIZ_DEFINITION_CHANGED="vizDefinitionChanged";e.REQUEST_FILTER_VALUES="requestFilterValues";return e});e("sap/viz/controls/annotation/AnnotationConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_ANNOTATION,t);return t});e("sap/viz/controls/annotation/AnnotationEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.AnnotationEvent"};e.extend(i,t);i.COMMENT_CHANGED_EVENT="commentChanged";return i});e("sap/viz/controls/annotation/views/DialogEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.DialogEvent"};e.extend(i,t);i.OK="OK";i.Cancel="Cancel";return i});e("sap/viz/controls/annotation/views/ConfirmDialog",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/annotation/views/DialogEvent","jquery"],function(e,t,i,r,n,s){var o=function(){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.ConfirmDialog";this._confirmDialog$=null;this._needConfirm=true;this._visible=false;this._createChildren()};e.extend(o,t);o.prototype._createChildren=function(){var e=this;this._confirmDialog$=s(document.createElement("div"));this._confirmDialog$.addClass(i.ANNOTATION_PREFIX+"confirmdialog");var t=s(document.createElement("div"));t.addClass(i.ANNOTATION_PREFIX+"confirmdialog-header");this._confirmDialog$.append(t);var o=s(document.createElement("span"));o.addClass(i.ANNOTATION_PREFIX+"confirmdialog-headerleft");t.append(o);var a=s(document.createElement("span"));a.addClass(i.ANNOTATION_PREFIX+"confirmdialog-headerleft-label");o.append(a);var l=s(document.createElement("span"));l.addClass(i.ANNOTATION_PREFIX+"confirmdialog-headerright");t.append(l);var c=s(document.createElement("a"));c.addClass(i.ANNOTATION_PREFIX+"confirmdialog-headerright-close");l.append(c);c.click(function(){e.hide()});var p=s(document.createElement("div"));p.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content");this._confirmDialog$.append(p);var h=s(document.createElement("div"));h.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-up");h.appendTo(p);var d=s(document.createElement("div"));d.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-icon");d.appendTo(h);var u=s(document.createElement("div"));u.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-info");u.text(r.get("VIZ_COMMON_DELETE_COMMENT_MESSAGE"));u.appendTo(h);var _=s(document.createElement("div"));_.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-down");_.appendTo(p);this._checkBoxNeedConfirm$=s(document.createElement("input"));this._checkBoxNeedConfirm$.attr("type","checkbox");this._checkBoxNeedConfirm$.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-checkbox");this._checkBoxNeedConfirm$.appendTo(_);var v=s(document.createElement("div"));v.addClass(i.ANNOTATION_PREFIX+"confirmdialog-content-checkboxlabel");v.text(r.get("VIZ_COMMON_DONT_SHOW_MESSAGE"));v.appendTo(_);var f=s(document.createElement("div"));f.addClass(i.ANNOTATION_PREFIX+"confirmdialog-footer");this._confirmDialog$.append(f);var m=s(document.createElement("div"));m.addClass(i.ANNOTATION_PREFIX+"confirmdialog-footer-buttons");f.append(m);var g=s(document.createElement("button"));g.text(r.get("VIZ_COMMON_OK"));g.addClass(i.ANNOTATION_PREFIX+"confirmdialog-footer-button");g.addClass(i.COMMON_PREFIX+"button");m.append(g);g.click(function(){e.hide();e._needConfirm=!e._checkBoxNeedConfirm$.prop("checked");e._dispatchEvent(new n(n.OK,e,e._needConfirm))});var E=s(document.createElement("button"));E.text(r.get("VIZ_COMMON_CANCEL"));E.addClass(i.ANNOTATION_PREFIX+"confirmdialog-footer-button");E.addClass(i.COMMON_PREFIX+"button");m.append(E);E.click(function(){e.hide()});this._blockLayout$=s(document.createElement("div"));this._blockLayout$.addClass(i.ANNOTATION_PREFIX+"block-layer")};o.prototype.show=function(e){this._visible=true;s(document.body).append(this._blockLayout$);s(document.body).append(this._confirmDialog$);if(e){this.setPos(e)}};o.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};o.prototype.setPos=function(e){this._confirmDialog$.css({position:"absolute",left:e.pageX-this._confirmDialog$.width()/2,top:e.pageY-this._confirmDialog$.height()/2})};o.prototype.isVisible=function(){return this._visible};return o});e("sap/viz/controls/annotation/models/Comment",["sap/viz/controls/common/managers/LangManager"],function(e){var t=function(t,i,r){this._dimension=t;this._dimension2=i;this._series=r;this._text="";this._createTime=e.get("VIZ_ANNOTATION_COMMENT")};t.prototype.dimension=function(e){if(arguments.length>0){this._dimension=e;return this}else{return this._dimension}};t.prototype.dimension2=function(e){if(arguments.length>0){this._dimension2=e;return this}else{return this._dimension2}};t.prototype.series=function(e){if(arguments.length>0){this._series=e;return this}else{return this._series}};t.prototype.createTime=function(e){if(arguments.length>0){this._createTime=e;return this}else{return this._createTime}};t.prototype.text=function(e){if(arguments.length>0){this._text=e;return this}else{return this._text}};return t});e("sap/viz/controls/annotation/views/Comments",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/annotation/views/DialogEvent","sap/viz/controls/annotation/views/ConfirmDialog","sap/viz/controls/annotation/models/Comment"],function(e,t,i,r,n,s,o,a,l,c,p,h){var d="#F1AB00";var u=12;var _=4;var v=200;var f=8;var m={width:14,height:16};var g="font-family:Arial;font-size:12px;font-weight:bold;fill:#000000;";var E="font-family:Arial;font-size:12px;font-weight:normal;fill:#000000;";var y=function(){this._commentsMap={};this._commentsPositionMap={};this._vizData=null;this._vizType=null;this._eventHandlers={};this._needConfirm=true;this._currentComment=null};r.extend(y,l);y.Event_EditComment="Event_EditComment";y.Event_RemoveComment="Event_RemoveComment";y.Event_DragComment="Event_DragComment";y.prototype._showConfirmDialog=function(){this._getConfirmDialog().show({pageX:e(this._parent).offset().left+e(this._parent).width()/2,pageY:e(this._parent).offset().top+e(this._parent).height()/2})};y.prototype._getConfirmDialog=function(){if(!this._confirmDialog){this._confirmDialog=new p;this._confirmDialog.addEventListener(c.OK,this._confirmChangedHandler,this)}return this._confirmDialog};y.prototype._confirmChangedHandler=function(e){this._needConfirm=e.data;this._onRemoveComment(this._currentComment)};y.prototype.assetFolder=function(e){if(arguments.length>0){this._assetFolder=e;return this}else{return this._assetFolder}};y.prototype.setChartInfo=function(e){if(arguments.length>0){this._vizData=e.vizData;this._vizType=e.vizType;return this}else{return this._vizData}};y.prototype.feedsChanged=function(){this._commentsPositionMap={}};y.prototype._initDIV=function(){if(this._parent){this._parent.empty()}else{var i=document.createElement("DIV");this._parent=e(i);this._chartHolderDiv=e("div."+t.PREFIX+"chart-holder")[0];this._parent.appendTo(this._chartHolderDiv).attr("id","comments-parent");this._parent.attr("style","overflow:hidden;position:absolute;pointer-events:none;left:0px;top:0px;")}this._triangleHolder=null;this._lineHolder=null};y.prototype.redraw=function(){this._initDIV();var e=n.getVizType(this._vizType);if(!x.supportType[e]||o.hasFakeData(this._vizData)){return}for(var t in this._commentsMap){if(this._commentsMap.hasOwnProperty(t)){this._drawComment(t)}}};y.prototype.clean=function(){this._initDIV()};y.prototype._getPathInfo=function(e,t){var i=e.dii_a1;var r=e.mi;var n=t._crosstableDataset;var s=n.getAnalysisAxisByIdx(0);var o=null;if(s){o="";s=s.getDimensionLabels();for(var a=0;a<s.length;a++){o+=s[a].getValues()[i]}}else{o=n.getMeasureValuesGroupByIdx(0).getMeasureValues()[i].getId()}var l=n.getAnalysisAxisByIdx(1);var c=null;if(l){c="";l=l.getDimensionLabels();for(var p=0;p<l.length;p++){c+=l[p].getValues()[e.dii_a2]}}var h={dimensionIndex:i,seriesIndex:r,dimension:o,dimension2:c};h.series=n.getMeasureValuesGroupByIdx(e.mg).getMeasureValues()[r].getId();return h};y.prototype._findDataPoint=function(e){var t=d3.selectAll(".v-datapoint")[0];var r=e.dimension();var o=e.dimension2();var a=e.series();for(var l=0;l<t.length;l++){var c=t[l].__data__;if(c){var p;if(s.isArray(c.ctx)){p=this._getPathInfo(c.ctx[0].path,this._vizData);if(p.dimension===r&&p.dimension2===o&&p.series==a){return t[l]}}else if(n.getVizType(this._vizType)===i.TYPE_BOXPLOT){for(var h=0;h<c.length;h++){p=this._getPathInfo(c[h].ctx.path,this._vizData);if(p.dimension===r&&p.dimension2===o&&p.series==a){return t[l]}}}else if(c.ctx){p=this._getPathInfo(c.ctx.path,this._vizData);if(p.dimension===r&&p.dimension2===o&&p.series==a){return t[l]}}}}};function I(t){var i=t.__data__;if(i&&i.r&&i.midAngle){var r=i.midAngle();var n=i.r*Math.sin(r);var s=i.r-i.r*Math.cos(r);var o=e(t).parentsUntil(".v-m-plot");if(o.length>0){var a=e(o[o.length-1]).parent()[0];var l=a.getElementsByTagName("rect");var c=l[0].getAttribute("height");var p=l[0].getAttribute("width");var h=a.getBoundingClientRect();var d=h.left+p/2;var u=h.top+6+i.r;var _={width:1,height:1,top:u-i.r+s,left:d+n};return _}else{return t.getBoundingClientRect()}}else{return t.getBoundingClientRect()}}function C(e){var t=e.dimension()+"-"+e.dimension2()+"-"+e.series();t=t.replace(/[^(0-9|A-z)]/g,"_");return t}function T(e){return e+"-line"}function A(e){return e+"-triangle"}function P(e){var t=e.currentTarget.parentNode.__data;if(e.data&&t){if(e.data._needConfirm){e.data._currentComment=t;e.data._showConfirmDialog()}else{e.data._onRemoveComment(t)}}e.stopPropagation()}function R(e){var t=e.currentTarget.parentNode.__data;if(e.data&&t){e.data._onEditComment(t)}e.stopPropagation()}function z(t){var i=t.target;if(i&&i.className!=="ui-draggable"){var r=e(i).parentsUntil(t.data._parent);if(r&&r.length>0){i=r[r.length-1]}}if(t.data&&i&&i.className==="ui-draggable"){e(i).detach();e(i).appendTo(t.data._parent)}t.stopPropagation()}function O(e,t,i,r,n){var s={x:e.left,y:e.top+e.height/2};var o={x:t.left+t.width/2,y:t.top};var a=s.x-o.x;var l=s.y-o.y;var c=Math.sqrt(a*a+l*l);var p=Math.asin(l/c)*180/Math.PI;if(s.x<o.x){p=180-p}var h="rotate("+p+"deg)";var d="0 0";r.css({transform:h,"transform-origin":d,"-webkit-transform":h,"-webkit-transform-origin":d,"-ms-transform":h,"-ms-transform-origin":d,"-moz-transform":h,"-moz-transform-origin":d,width:Math.floor(c)-_+"px",left:o.x-i.left+"px",top:o.y-i.top+"px"});h="rotate("+(p+90)+"deg)";d="50% 100%";n.css({transform:h,"transform-origin":d,"-webkit-transform":h,"-webkit-transform-origin":d,"-ms-transform":h,"-ms-transform-origin":d,"-moz-transform":h,"-moz-transform-origin":d,left:o.x-i.left-u/2+"px",top:o.y-i.top-u+"px"})}function b(e,t){var i="height:0px;width:0px;margin:0px;padding:0px;";i+="border-top-width:"+e+"px;border-left-width: "+t/2+"px;border-right-width: "+t/2+"px;";i+="border-bottom-width: 0px;border-style: solid;border-color: "+d+" transparent transparent transparent;";return i}y.prototype._initCommentUI=function(t,i,r){var n=I(t);var s=this._parent[0].getBoundingClientRect();var o=0;var a=0;var l=i.attr("id");if(this._commentsPositionMap.hasOwnProperty(l)&&this._commentsPositionMap[l].hasOwnProperty(this._vizType)){o=this._commentsPositionMap[l][this._vizType].left;a=this._commentsPositionMap[l][this._vizType].top}else{o=0;a=n.top-s.top-80;var c=t.__data__;if(c&&c.r&&c.midAngle&&Math.sin(c.midAngle())<0){o=n.left-Math.max(n.width,40)-s.left-150}else{o=n.left+Math.max(n.width,40)-s.left}}var p="pointer-events:auto;";p+="padding:4px;background-color:#FFFFCC;";p+="border-radius:4px;border-width:2px; border-color:"+d+"; border-style:solid;";p+="position:absolute;left: "+o+"px; top:"+a+"px;";p+="width:"+v+"px;";i.attr("style",p);i.bind("mouseenter",function(t){var i=e(t.currentTarget).attr("id");var r=e("div#"+i+" img");r.css("visibility","");var n=e("div#"+i+" div#"+"createTime");if(n){n.css("right","68px")}});i.bind("mouseleave",function(t){var i=e(t.currentTarget).attr("id");var r=e("div#"+i+" img");r.css("visibility","hidden");var n=e("div#"+i+" div#"+"createTime");if(n){n.css("right","18px")}});i.bind("contextmenu",function(e){e.stopPropagation()});if(o+i.outerWidth()>this._parent.innerWidth()){o=this._parent.innerWidth()-i.outerWidth()}if(a+i.outerHeight()>this._parent.innerHeight()){o=this._parent.innerHeight()-i.outerHeight()}i.css({left:o+"px",top:a+"px"})};y.prototype._addCommentUI=function(t,i,r){var n=f;for(var s=0;s<r.length;s++){var o=e(document.createElement("DIV")).appendTo(i).attr("style","position:absolute;padding:"+f+"px;left:0px;right:0px;top:"+n+"px;width:"+v+"px;height:auto;");var a=this._appendItem(o,r[s]);o.css("height",a+"px");n+=a+f;o[0].__data=r[s]}n-=f;i.css("height",n+"px");var l=I(t);var c=this._parent[0].getBoundingClientRect();var p=Number(i.css("left").replace("px",""));var h=Number(i.css("top").replace("px",""));p=Math.min(Math.max(p,0),c.width-v);h=Math.min(Math.max(h,0),c.height-n);i.css({left:p,top:h});var m=i[0].getBoundingClientRect();i[0].__dataPoint=t;i[0].__parent=this._parent[0];var g=i.attr("id");var E=A(g);var y=e("#"+E);if(y.length===0){y=e(document.createElement("DIV"));if(this._triangleHolder){y.insertAfter(this._triangleHolder)}else{y.insertBefore(i)}this._triangleHolder=y;y.attr("id",E).attr("style","position:absolute;"+b(u,u))}var C=T(g);var P=e("#"+C);if(P.length===0){P=e(document.createElement("DIV"));if(this._lineHolder){P.insertAfter(this._lineHolder)}else{P.insertBefore(i)}this._lineHolder=P;P.attr("id",C).attr("style","position:absolute;border-left-width:"+_+"px; border-top-width:2px;border-bottom-width:0px;border-right-width:0px;border-color:"+d+" transparent; border-style:solid;width:1px;height:0px;")}O(m,l,c,P,y)};y.prototype._appendItem=function(t,i){var r=this;var n=null;var s=false;var o=0;var a=e(document.createElement("IMG")).appendTo(t);a.attr("src",this._assetFolder+"/edit.png").attr("style","position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:"+(f*3+m.width)+"px;width:"+m.width+"px;height:"+m.height+"px;visibility:hidden;");a.bind("mousedown",this,R);var l=a[0].getBoundingClientRect();var c=e(document.createElement("IMG")).appendTo(t);c.attr("src",this._assetFolder+"/delete.png").attr("style","position:absolute;pointer-events:auto;cursor:pointer;top:0px; right:"+f*2+"px;width:"+m.width+"px;height:"+m.height+"px;visibility:hidden;");c.bind("mousedown",this,P);var p=c[0].getBoundingClientRect();var h=this._creatorDiv=e(document.createElement("DIV")).appendTo(t);h.attr("id","createTime");h.text(i.createTime()).attr("style","position:absolute;cursor:default;line-height:normal;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;left:5px;right:18px;top:0px;"+g);h.mouseover(function(r){if(h[0].scrollWidth>h[0].clientWidth){s=true;var o=setTimeout(function(){if(s){if(!n){n=e(document.createElement("div")).appendTo(t);n.attr("style","position:absolute;border-radius:4px;z-index:100;display:block;background-color:#F2F2F2;border:1px solid #7F7F7F;box-shadow:5px 5px 10px rgba(0,0,0,0.5);-webkit-box-shadow:5px 5px 10px rgba(0,0,0,0.5);-moz-box-shadow:5px 5px 10px rgba(0,0,0,0.5);");var r=e(document.createElement("span")).appendTo(n);r.attr("style","border-radius:4px;padding-left:4px;padding-right:4px;display:block;font-size:10px;white-space:nowrap;top:0px;overflow:hidden;");r.text(i.createTime())}var o=e(h).offset();n.offset({left:o.left-5,top:o.top-10})}},500)}});h.mouseout(function(e){if(h[0].scrollWidth>h[0].clientWidth){s=false;if(n){n.remove();n=null}}});var d=h[0].getBoundingClientRect();o+=Math.max(l.height,d.height);var u=e(document.createElement("DIV"));u[0].innerHTML=i.text();u.attr("style","position:absolute;pointer-events:none;line-height:normal;word-wrap:break-word;overflow:hidden;top:"+o+"px;width:"+v+"px;"+E).appendTo(t);o+=u[0].getBoundingClientRect().height;return o};y.prototype._removeCommentUI=function(t){var i=T(t);var r=A(t);if(this._triangleHolder&&this._triangleHolder.attr("id")===r){this._triangleHolder=null}if(this._lineHolder&&this._lineHolder.attr("id")===i){this._lineHolder=null}e("div#"+t).remove();e("div#"+i).remove();e("div#"+r).remove();var n=this._parent.children();if(this._triangleHolder===null&&n.length>=3){this._triangleHolder=e(n[n.length/3-1])}if(this._lineHolder===null&&n.length>=3){this._lineHolder=e(n[n.length/3])}};function S(t){var i=e(t.target);var r=t.data;if(t.target.__dataPoint&&t.target.__parent){var n=i[0].getBoundingClientRect();var s=I(i[0].__dataPoint);var o=i[0].__parent.getBoundingClientRect();var l=i.attr("id");var c=e("#"+T(l));var p=e("#"+A(l));O(n,s,o,c,p);if(!r._commentsPositionMap.hasOwnProperty(l)){r._commentsPositionMap[l]={}}r._commentsPositionMap[l][r._vizType]={left:Number(i.css("left").replace("px","")),top:Number(i.css("top").replace("px",""))};t.stopPropagation();r._dispatchEvent(new a(y.Event_DragComment,r,r._commentsMap[l]))}}y.prototype._drawComment=function(t){var i=this;var r=this._commentsMap[t];if(!r||r.length===0){this._removeCommentUI(t);return}var n=this._findDataPoint(r[0]);if(!n){return}var s=e("div#"+t);if(s.length===0){s=e(document.createElement("DIV"));s.appendTo(this._parent).attr("id",t);this._initCommentUI(n,s)}else{s.empty()}this._addCommentUI(n,s,r);s.draggable({containment:"parent",start:function(e,t){e.target.__lastPosition={x:e.clientX,y:e.clientY}},stop:function(e,t){e.data=i;S(e)},drag:function(e,t){e.data=i;S(e)}});s.bind("click",this,z)};y.prototype._onEditComment=function(e){if(e==null){return}var t=C(e);var i=this._commentsMap[t];if(i==null){return}this._dispatchEvent(new a(y.Event_EditComment,this,e))};y.prototype._onRemoveComment=function(e){if(e==null){return}var t=C(e);var i=this._commentsMap[t];if(i==null){return}for(var r=0;r<i.length;r++){if(i[r]===e){i.splice(r,1);break}}this._drawComment(t);this._dispatchEvent(new a(y.Event_RemoveComment,this,e))};y.prototype.createComment=function(e){if(e.length===0){return}var t=e[e.length-1].ctx[0];var i=this._getPathInfo(t,this._vizData);var r=new h(i.dimension,i.dimension2,i.series);r.text("");return r};y.prototype.addComment=function(e){if(e==null){return}var t=C(e);if(this._commentsMap[t]==null){this._commentsMap[t]=[]}this._commentsMap[t].push(e);this._drawComment(t)};y.prototype.updateComment=function(e){if(e==null){return}var t=C(e);if(!this._commentsMap[t]){return}this._drawComment(t)};y.prototype.size=function(t){if(t){e("div#comments-parent").css(t);if(this._getConfirmDialog().isVisible()){this._getConfirmDialog().setPos({pageX:e(this._parent).offset().left+e(this._parent).width()/2,pageY:e(this._parent).offset().top+e(this._parent).height()/2})}}};y.prototype.json2CommentsMap=function(e){for(var t in e){if(e.hasOwnProperty(t)){if(this._commentsMap[t]==null){this._commentsMap[t]=[]}var i=e[t];for(var r=0;r<i.length;r++){var n=i[r];var s=new h(n.dimension,n.dimension2,n.series);s.createTime(n.createTime);s.text(n.text);this._commentsMap[t].push(s)}}}this._needConfirm=e["needConfirm"];this._commentsPositionMap=e["commentsPositionMap"]};y.prototype.commentsMap2Json=function(){var e={};for(var t in this._commentsMap){if(this._commentsMap.hasOwnProperty(t)){var i=this._commentsMap[t];e[t]=[];for(var r=0;r<i.length;r++){var n=i[r];e[t].push({dimension:n.dimension(),dimension2:n.dimension2(),series:n.series(),createTime:n.createTime(),text:n.text()})}}}e["needConfirm"]=this._needConfirm;e["commentsPositionMap"]=this._commentsPositionMap;return e};var x={name:"comment",text:"VIZ_CONTEXTMENU_INSERT_COMMENT",icon:{show:"/contextmenu/annotation.png"},supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_column":true,"viz/stacked_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_bar":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};return y});e("sap/viz/controls/annotation/views/CommentEditorView",["sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/annotation/views/DialogEvent","jquery"],function(e,t,i,r,n,s,o){var a=140;var l="";var c=false;var p=function(e){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.views.CommentEditorView";this._div=e;this._comment="";this._visible=false;this._oRichTextDialog=null;this._createChildren()};t.extend(p,r);p.WIDTH=497;p.HEIGHT=213;p.prototype._createChildren=function(){var t=this;this._oRichTextDialog=document.createElement("div");this._oRichTextDialog.id="divRichTextDialog";o(this._oRichTextDialog).addClass(n.ANNOTATION_PREFIX+"richtextdialog");o(document.body).append(this._oRichTextDialog);this.hide();var i=document.createElement("div");i.id="RichTextDialogHeader";o(i).addClass(n.ANNOTATION_PREFIX+"richtextdialog-header");o(this._oRichTextDialog).append(i);var r=document.createElement("span");o(r).addClass(n.ANNOTATION_PREFIX+"richtextdialog-headerleft");o(i).append(r);var p=document.createElement("span");p.id="RichTextDialogHeaderLabel";o(p).addClass(n.ANNOTATION_PREFIX+"richtextdialog-headerleft-label");o(p).text(e.get("VIZ_ANNOTATION_COMMENT"));o(r).append(p);var h=document.createElement("span");o(h).addClass(n.ANNOTATION_PREFIX+"richtextdialog-headerright");o(i).append(h);var d=document.createElement("a");d.id="RichTextDialogHeaderClose";o(d).addClass(n.ANNOTATION_PREFIX+"richtextdialog-headerright-close");o(h).append(d);o(d).click(function(){t.hide()});var u=document.createElement("div");u.id="RichTextDialogContent";o(u).addClass(n.ANNOTATION_PREFIX+"richtextdialog-content");o(this._oRichTextDialog).append(u);var _=document.createElement("textarea");_.id="RichTextDialogContentTextArea";o(_).addClass("mceEditor");o(u).append(_);var v=document.createElement("div");v.id="RichTextDialogFooter";o(v).addClass(n.ANNOTATION_PREFIX+"richtextdialog-footer");o(this._oRichTextDialog).append(v);var f=document.createElement("div");o(f).addClass(n.ANNOTATION_PREFIX+"richtextdialog-footer-buttons");o(v).append(f);var m=document.createElement("button");m.id="RichTextDialogOKButton";o(m).text(e.get("VIZ_COMMON_OK"));o(m).addClass(n.ANNOTATION_PREFIX+"button");o(m).addClass(n.COMMON_PREFIX+"button");o(f).append(m);o(m).click(function(){t.hide();t._comment=tinymce.activeEditor.getContent();t._dispatchEvent(new s(s.OK,t,{userData:t._userData,comment:t._comment}))});var g=document.createElement("button");g.id="RichTextDialogCancelButton";o(g).text(e.get("VIZ_COMMON_CANCEL"));o(g).addClass(n.ANNOTATION_PREFIX+"button");o(g).addClass(n.COMMON_PREFIX+"button");o(f).append(g);o(g).click(function(){t.hide()});if(!c){c=true;tinymce.init({theme:"advanced",mode:"textareas",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,forecolor,backcolor,|,justifyleft,justifycenter,justifyright,justifyfull,|,fontselect,fontsizeselect",theme_advanced_path:false,theme_advanced_font_sizes:"8px,9px,10px,11px,12px,14px,16px,18px,20px,22px,24px,26px,28px,36px,48px,72px",theme_advanced_statusbar_location:"none",editor_selector:"mceEditor",setup:function(e){e.onEvent.add(function(e,t){var i=e.getContent({format:"text"});if(i.length>a){e.setContent(l);e.selection.select(e.getBody(),true);e.selection.collapse(false)}else{l=e.getContent()}})}})}this._blockLayout=document.createElement("div");this._blockLayout.id="blockLayout";o(this._blockLayout).addClass(n.ANNOTATION_PREFIX+"block-layer")};p.prototype.show=function(e){if(e){if(e.hasOwnProperty("userData")){this._userData=e.userData}if(e.hasOwnProperty("comment")&&i.isString(e.comment)){this._comment=e.comment;l=e.comment;if(tinymce.activeEditor){tinymce.activeEditor.setContent(this._comment)}}if(e.hasOwnProperty("position")){this.setPos(e.position)}}this._visible=true;o(document.body).append(this._blockLayout);o(this._oRichTextDialog).show()};p.prototype.hide=function(){this._visible=false;o(this._blockLayout).detach();o(this._oRichTextDialog).hide()};p.prototype.setPos=function(e){o(this._oRichTextDialog).css({position:"absolute",left:e.pageX-p.WIDTH/2,top:e.pageY-p.HEIGHT/2})};p.prototype.isVisible=function(){return this._visible};return p});e("sap/viz/controls/annotation/Annotation",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/annotation/AnnotationConfig","sap/viz/controls/annotation/AnnotationEvent","sap/viz/controls/annotation/views/Comments","sap/viz/controls/annotation/views/DialogEvent","sap/viz/controls/annotation/views/CommentEditorView"],function(e,t,i,r,n,s,o,a,l,c,p,h,d){var u=function(e,t){u.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotation.Annotation";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_annotation_control");this._div=e;this._uiConfig=t?t:l.instance();this._popupLayer=e;this._commentEditor=null;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_annotation_control")};i.extend(u,t);u.prototype._createChildren=function(){this._comments=new p;var e=this._uiConfig.commentsAssetFolderPath;this._comments.assetFolder(e?e:r.defaultAssetsRoot()+"/controls/frame/assets");this._comments.addEventListener(p.Event_EditComment,this._editCommentHandler,this);this._comments.addEventListener(p.Event_RemoveComment,this._removeCommentHandler,this);this._comments.addEventListener(p.Event_DragComment,this._dragCommentHandler,this)};u.prototype._getCommentEditor=function(){if(!this._commentEditor){var t=this._popupLayer;if(t){this._commentEditor=new d(e(t));this._commentEditor.addEventListener(h.OK,this._commentChangedHandler,this)}}return this._commentEditor};u.prototype._editCommentHandler=function(t){var i=t.data;var r=this._getCommentEditor();r.show({userData:{isNew:false,comment:i},comment:i.text(),position:{pageX:e(this._div).offset().left+e(this._div).width()/2,pageY:e(this._div).offset().top+e(this._div).height()/2}})};u.prototype._removeCommentHandler=function(e){var t=e.data;this._dispatchEvent(new s(c.COMMENT_CHANGED_EVENT,this,t))};u.prototype._dragCommentHandler=function(e){var t=e.data;this._dispatchEvent(new s(c.COMMENT_CHANGED_EVENT,this,t))};u.prototype._commentChangedHandler=function(e){var t=e.data.userData.isNew;var i=e.data.userData.comment;var r=e.data.comment;i.createTime((new Date).toLocaleString());i.text(r);if(t){this._comments.addComment(i)}else{this._comments.updateComment(i)}var o={commentChanged:true};this._dispatchEvent(new s(n.VIZ_DEFINITION_CHANGED,this,o));this._dispatchEvent(new s(c.COMMENT_CHANGED_EVENT,this,i))};u.prototype.popupLayer=function(e){if(arguments.length>0){this._popupLayer=e;return this}else{return this._popupLayer}};u.prototype.validateSize=function(t,i){if(this._comments){this._comments.size({width:t,height:i})}if(this._commentEditor&&this._commentEditor.isVisible()){this._commentEditor.setPos({pageX:e(this._div).offset().left+e(this._div).width()/2,pageY:e(this._div).offset().top+e(this._div).height()/2})}};u.prototype.destroy=function(){if(this._commentEditor){this._commentEditor.removeAllEventListeners();this._commentEditor=null}if(this._popupLayer){this._popupLayer=null}e(this._div).remove()};u.prototype.addComment=function(t){var i=this._comments.createComment(t);if(i){var r=this._getCommentEditor();r.show({userData:{isNew:true,comment:i},comment:"",position:{pageX:e(this._div).offset().left+e(this._div).width()/2,pageY:e(this._div).offset().top+e(this._div).height()/2}})}};u.prototype.setChartInfo=function(e){this._comments.setChartInfo(e)};u.prototype.redraw=function(){this._comments.redraw()};u.prototype.clean=function(){this._comments.clean()};u.prototype.feedsChanged=function(){this._comments.feedsChanged()};u.prototype.save=function(){return this._comments.commentsMap2Json()};u.prototype.load=function(e){this._comments.json2CommentsMap(e)};return u});e("sap/viz/controls/annotationcontrol/AnnotationControlConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{allowDataPointValueChange:false,visualStrategies:{indicator:{count:{disabledRules:["SAME_ORIGINAL_VALUE"]}}}}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_ANNOTATIONCONTROL,t);return t});e("sap/viz/controls/annotationcontrol/AnnotationControlEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControlEvent"};e.extend(i,t);i.ANNOTATION_SELECTED_EVENT="annotationSelected";i.ANNOTATION_LAYOUTED_EVENT="annotationLayouted";return i});e("sap/viz/controls/annotationcontrol/AnnotationItem",[],function(){var e=function(e,t,i,r,n){this.__className="sap.viz.controls.annotationcontrol.AnnotationItem";this._id=e;this._type=t;this._dataContext=i;this._style=r;this._contents=n};e.prototype.id=function(e){if(arguments.length>0){this._id=e}else{return this._id}};e.prototype.type=function(e){if(arguments.length>0){this._type=e}else{return this._type}};e.prototype.dataContext=function(e){if(arguments.length>0){this._dataContext=e}else{return this._dataContext}};e.prototype.style=function(e){if(arguments.length>0){this._style=e}else{return this._style}};e.prototype.contents=function(e){if(arguments.length>0){this._contents=e}else{return this._contents}};return e});e("sap/viz/controls/annotationcontrol/Layouter",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(){this.__className="sap.viz.controls.annotationcontrol.Layouter"};return r});e("sap/viz/controls/annotationcontrol/AnnotationControl",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/annotationcontrol/AnnotationControlConfig","sap/viz/controls/annotationcontrol/AnnotationControlEvent","sap/viz/controls/annotationcontrol/AnnotationItem","sap/viz/controls/annotationcontrol/Layouter"],function(e,t,i,r,n,s,o){var a=function(e,t){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.annotationcontrol.AnnotationControl";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_AnnotationControl_control");this._div=e;this._uiConfig=t?t:r.instance();this._annotationItems=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_AnnotationControl_control")};i.extend(a,t);a.prototype._createChildren=function(){this._layouter=new o};a.prototype.annotationItems=function(e){if(arguments.length>0){this._annotationItems=e}else{return this._annotationItems}};a.prototype.showAnnotations=function(){};a.prototype.hideAnnotations=function(){};a.prototype.invalidAnnotations=function(){return[]};a.prototype.getAnnotationPosition=function(e){if(!e||e.length===0){return[]}var t=[];for(var i=0;i<e.length;++i){t[i]=e[i].dataContext().context}return this._vizProxy().getDataPointsPosition(t)};a.prototype.save=function(){return{}};a.prototype.load=function(e){};return a});e("sap/viz/controls/chart/ChartConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{enableTrellis:true,enableMorphing:true,useBuiltInPropertyZoneInteraction:false,useDefaultChartSizeForTrellis:false,defaultLabelFormatString:[["u"]],defaultProperties:{title:{visible:true},tooltip:{visible:true},dataLabel:{visible:false},plotArea:{animation:{dataLoading:false,dataUpdating:false,resizing:false}},legend:{visible:true}},specificProperties:{bar:{xAxis:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true}},background:{border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}}},column:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},stacked_bar:{xAxis:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true}}},stacked_column:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},dual_bar:{xAxis:{title:{visible:true},gridline:{visible:false}},xAxis2:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true}}},dual_column:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}},yAxis2:{title:{visible:true},gridline:{visible:false}}},"3d_column":{xAxis:{title:{visible:true}},yAxis:{title:{visible:true}},zAxis:{title:{visible:true}}},line:{plotArea:{marker:{shape:"circle",size:6,visible:true}},xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},area:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},combination:{plotArea:{line:{marker:{shape:"circle",size:6,visible:true}}},xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},dual_line:{plotArea:{marker:{shape:"circle",size:6,visible:true}},xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}},yAxis2:{title:{visible:true},gridline:{visible:false}}},dual_combination:{plotArea:{line:{marker:{shape:"circle",size:6,visible:true}}},xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}},yAxis2:{title:{visible:true},gridline:{visible:false}}},pie:{},donut:{},pie_with_depth:{},geobubble:{plotArea:{showNegativeValues:false},sizeLegend:{visible:true},geoContainer:{isFixedScale:false,scale:null,center:[]}},choropleth:{geoContainer:{isFixedScale:false,scale:null,center:[]}},geopie:{sizeLegend:{visible:true},geoContainer:{isFixedScale:false,scale:null,center:[]}},scatter:{xAxis:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true},gridline:{visible:false}}},bubble:{plotArea:{showNegativeValues:false},sizeLegend:{visible:true},xAxis:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true},gridline:{visible:false}}},scatter_matrix:{xAxis:{title:{visible:true},gridline:{visible:false}},yAxis:{title:{visible:true},gridline:{visible:false}}},heatmap:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true}}},treemap:{},number:{},boxplot:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}},network:{},radar:{plotArea:{marker:{size:6},valueAxis:{title:{visible:true}},polarAxis:{title:{visible:true}}}},tagcloud:{},tree:{},waterfall:{xAxis:{title:{visible:true}},yAxis:{title:{visible:true},gridline:{visible:false}}}}}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_CHART,t);return t});e("sap/viz/controls/chart/ChartPreHandler",["sap/viz/controls/common/utils/FakeDataUtils","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/managers/LangManager"],function(e,t,i,r,n,s,o,a){var l=function(e){this._useInfoChart=e?e.useInfoChart===true:false};l._toInfoChartOptions=function(e,i){if(t.isInfoChart(e.type)){if(e.feeds&&e.data){var r=e.data.data();l._updateFlatTableDataset(e.feeds,r);e.data=new sap.viz.api.data.FlatTableDataset(r)}return e}if(!i){return e}var n=t.getInfoType(e.type);if(n){var s={};for(var o in e){if(e.hasOwnProperty(o)){s[o]=e[o]}}s.type=n;if(e.data){var a=e.data;var c=e.feeds;if(c){var p=JSON.parse(JSON.stringify(a.data()));l._updateCrossTabDataSet(e.type,c,p);a=new sap.viz.api.data.CrosstableDataset;a.data(p)}s.data=t.buildInfoDataset(a)}s.properties=t.buildInfoProperties(e.type,e.properties);return s}else{return e}};l._updateFlatTableDataset=function(e,t){if(!e||e.length===0){return}if(!t||!t.metadata||!t.metadata.fields||t.metadata.fields.length===0){return}var i={};for(var n=0;n<e.length;n++){var s=e[n].values();if(!s||s.length===0){continue}for(var o=0;o<s.length;o++){var a=s[o];if(a.type()===r.MND){continue}else if(a.type()===r.HIERARCHY){var l=a.hierarchyLevels();for(var c=0;c<l.length;c++){var p=l[c];if(i.hasOwnProperty(p.name())){return}i[p.name()]=p.analysis().id();if(p.selected()){break}}}else{if(i.hasOwnProperty(a.name())){return}i[a.name()]=a.id()}}}var h=t.metadata.fields;for(var d=0;d<h.length;d++){var u=h[d];if(u.name===u.id&&i.hasOwnProperty(u.name)){u.id=i[u.name]}}};l._updateCrossTabDataSet=function(t,i,r){if(!r){return}var n=e.buildFakeData(t,i,JSON.parse(JSON.stringify(r)));var s=n.feeding;if(!s||s.length===0){return}for(var a=0;a<s.length;a++){var c=s[a];var p=o.getFeed(i,c.feedId);var h=c.binding;if(!p||!h||h.length===0){continue}var d=p.values();if(!d||d.length===0){continue}var u=null;for(var _=0;_<h.length;_++){var v=h[_];var f=v.index;if(!v||!r[v.type]){continue}u=r[v.type][f-1];if(u&&u.data){u=u.data;break}}if(!u){continue}l._updateDataID(u,d)}};l._updateDataID=function(e,t){var i=0;for(var n=0;n<t.length;n++){var s=t[n];if(s.type()===r.MND){continue}else if(s.type()===r.HIERARCHY){var o=s.hierarchyLevels();for(var a=0;a<o.length;a++){var l=o[a];if(e[i]&&e[i].name===l.name()){e[i].id=l.id();i++}if(l.selected()){break}}}else{if(e[i]&&e[i].name===s.name()){e[i].id=s.id();i++}}}};l.prototype.preCreateViz=function(e){e=l._toInfoChartOptions(e,this._useInfoChart);if(e.properties){e.properties.title=e.properties.title||{};e.properties.title.text=e.properties.title.text||a.get("IDS_DEFAULTCHARTTITLE")}return e};l.prototype.preVizUpdate=function(e){e=l._toInfoChartOptions(e,this._useInfoChart);return e};l._toInfoFeeding=function(e,s){var a=null;var l=false;if(o.hasMND(s)||o.countAnalyses(s,r.MEASURE)===0){a=s}else{var c=t.getVizType(e);a=n.directFeeding(s,c,[i.genMND()]);l=true}return t.buildInfoFeeding(a,l)};l.prototype.preLoadChart=function(e){var i=e.type;var r=s.fromJSON(e["feedingItems"]);if(t.isInfoChart(i)){if(e.vizInstance&&e.vizInstance.data&&e.vizInstance.data.val){l._updateFlatTableDataset(r,e.vizInstance.data.val)}return e}if(!this._useInfoChart){return e}var n=t.getInfoType(i);if(!n){return e}e.type=n;if(e.vizInstance){e.vizInstance.type=n;e.vizInstance.properties=t.buildInfoProperties(i,e.vizInstance.properties);var o=e.vizInstance.data;if(o&&o.val&&o.type==="Crosstable"){l._updateCrossTabDataSet(i,r,o.val);var a=new sap.viz.api.data.CrosstableDataset;a.data(o.val);var c=t.buildInfoDataset(a);o.type="FlatTable";o.val=c.data()}e.vizInstance.feeding=l._toInfoFeeding(n,r)}return e};return l});e("sap/viz/controls/common/constants/MapProviderConst",[],function(){var e={};e.ESRI="ESRI";e.CVOM="CVOM";e.NAVTEQ="NAVTEQ";return e});e("sap/viz/controls/chart/views/AxisSizeAdjustHelper",[],function(){var e="v-m-main";var t=function(t,r,n){if(!i.isAxis(r)||!t){return null}var s=t.feedingZone();var o;s.forEach(function(e){if(e.name===r){o=e.bound[0]}});var a=t._usrOptions.container.querySelector("."+e).querySelector(".v-bound").getBoundingClientRect();var l,c;if(i.isXAxis(r)){l=a.height;c=o[0][1]-o[2][1]}else{l=a.width;c=o[0][0]-o[2][0]}l=Math.abs(l);c=Math.abs(c);if(l!==0){n=parseFloat(n);if(!isNaN(n)){c+=n}var p={};p[r]={maxSizeRatio:Math.max(0,c/l)};return p}return null};var i={xAxisCandidates:["xAxis","xAxis2"],yAxisCandidates:["yAxis","yAxis2"],isXAxis:function(e){return this.xAxisCandidates.indexOf(e)>-1},isYAxis:function(e){return this.yAxisCandidates.indexOf(e)>-1},isAxis:function(e){return this.isXAxis(e)||this.isYAxis(e)}};return t});e("sap/viz/controls/chart/views/AxisSplitter",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher"],function(e,t,i,r,n,s){var o=function(e,t,i){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.AxisSplitter";this._container=e;this._propertiesProvider=t;this._propertyZoneProvider=i;this._createChildren()};t.extend(o,s);o.AxisSplitChanged="AxisSplitChanged";o.prototype._createChildren=function(){this._div$=e(document.createElement("DIV"));this._resizeHelper$=e(document.createElement("DIV")).addClass(r.CHART_PREFIX+"axissplitter-resizehelper");this._mask$=e(document.createElement("DIV")).addClass(r.CHART_PREFIX+"axissplitter-resizehelper-mask");this._axis$=this._createAxis();this._axis2$=this._createAxis();this._div$.append(this._axis$).append(this._axis2$);this._div$.appendTo(this._container)};o.prototype._updateResizeHelperBound=function(e){var t=e[1][0]-e[0][0];var i=e[2][1]-e[0][1];this._resizeHelper$.css({left:e[0][0],top:e[0][1],width:t,height:i});this._resizeHelper$.appendTo(this._container)};o.prototype._resizeHelper=function(e,t){var i=this._resizeHelper$.position();if(t){this._resizeHelper$.css({top:i.top+e,height:this._resizeHelper$.height()-e})}else{this._resizeHelper$.css({width:this._resizeHelper$.width()+e})}};o.prototype._createAxis=function(){var t=e(document.createElement("DIV")).addClass(r.CHART_PREFIX+"axissplitter-axis");var i=false;var n,s;var o=this;var a=function(r){var n=i?r.clientY-s:r.clientX-s;var a=t.position();if(i){n=Math.max(-a.top,n);n=Math.min(t.data("bottom")-a.top,n);var l=a.top+n;t.css({top:l})}else{n=Math.max(-(a.left-t.data("left")),n);n=Math.min(e(o._container).width()-a.left-6,n);var c=a.left+n;t.css({left:c})}s+=n;o._resizeHelper$.css("cursor",t.css("cursor"));o._resizeHelper(n,i);r.stopPropagation()};var l=function(e){o._mask$.unbind("mousemove",a);o._mask$.unbind("mouseup",l);o._mask$.unbind("mouseout",l);o._mask$.detach();o._resizeHelper$.detach();var r=i?e.clientY:e.clientX;var s=t.data("axis").name;var c=n-r;c=i?c:-c;o._axisMoved(s,c)};t.mousedown(function(e){o._mask$.css("cursor",t.css("cursor"));o._mask$.appendTo(document.body);i=t.data("isHorizontal");n=s=i?e.clientY:e.clientX;o._updateResizeHelperBound(t.data("axis").bound[0]);o._mask$.mousemove(a);o._mask$.mouseup(l);o._mask$.mouseout(l)});return t};o.prototype._axisMoved=function(e,t){var i={axisName:e,offset:t};this._dispatchEvent(new n(o.AxisSplitChanged,this,i))};o.prototype._getAxis=function(){var e=this._propertyZoneProvider();var t=[];if(!e||e.length==0){return t}for(var i=0;i<e.length;++i){for(var r=0;r<this._categoryAxis.length;++r){if(e[i].name===this._categoryAxis[r]){t.push(e[i])}}}return t};o.prototype._layoutAxis=function(e,t){var i=true;if(t.name==="yAxis"||t.name==="yAxis2"){i=false}e.data("isHorizontal",i);e.data("axis",t);if(i){var r=t.bound[0][1][0]-t.bound[0][0][0];e.data("bottom",t.bound[0][2][1]);e.css({left:t.bound[0][0][0],top:t.bound[0][1][1],width:r,height:6,"margin-top":-3,"margin-left":0,cursor:"n-resize"})}else{var n=t.bound[0][2][1]-t.bound[0][0][1];e.data("left",t.bound[0][0][0]);e.css({left:t.bound[0][1][0],top:t.bound[0][0][1],height:n,width:6,"margin-top":0,"margin-left":-3,cursor:"e-resize"})}};o.prototype._layout=function(){var e=this._getAxis();if(!e||e.length===0){return}this._layoutAxis(this._axis$,e[0]);if(e[1]){this._axis2$.css({visibility:""});this._layoutAxis(this._axis2$,e[1])}else{this._axis2$.css({visibility:"hidden"})}};o.prototype.reset=function(){this._div$.css({visibility:"hidden"})};o.prototype.init=function(e){this._categoryAxis=i.getCategoryAxis(e);if(!this._categoryAxis||this._categoryAxis.length==0){this.reset();return}this._layout();this._div$.css({visibility:"visible"})};o.prototype.deactive=function(){this._div$.css({display:"none"})};o.prototype.active=function(){this._div$.css({display:"block"})};return o});e("sap/viz/controls/chart/views/ChartEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ChartEvent"};e.extend(i,t);i.CHANGED_SELECTED_DATA="changeSelectedData";i.TRIGGER_CVOM_EVENT="triggerCVOMEvent";i.CHART_CHANGING="ChartChanging";i.CHART_CHANGED="ChartChanged";i.CVOM_INITIALIZED="CVOMChartInitialized";i.CLICK_FILTER_BUTTON="clickFilterButton";i.CLICK_EXCLUDE_BUTTON="clickExcludeButton";i.CLICK_DRILLDOWN_BUTTON="clickDrillDownButton";i.CHANGE_FEEDING="changeFeeding";i.ANALYSIS_DROPPED="analysisDropped";i.TITLE_CHANGED="TitleChanged";i.VIZTYPE_CHANGED="vizTypeChanged";i.VIZ_VIEW_CHANGED="vizViewChanged";i.SELECT_PROPERTY_ZONE="selectPropertyZone";i.PROPERTY_ZONES_CHANGED="propertyZonesChanged";i.ESRI_CUSTOMIZED_SERVICE_CHANGED="esriCustomizedServiceChanged";return i});e("sap/viz/controls/chart/views/DataPointFinder",["jquery","sap/viz/controls/common/utils/Utils"],function(e,t){var i={};i.findDataPointsPosition=function(e){var t=[];if(!e||e.length===0){return t}for(var r=0;r<e.length;r++){var n=i._findDataPointUI(e[r]);if(n){t[r]=n.getBoundingClientRect()}}return t};i._findDataPointUI=function(e){var i=d3.selectAll(".v-datapoint")[0];for(var r=0;r<i.length;r++){var n=i[r].__data__;if(!n){continue}var s;if(t.isArray(n.ctx)){s=n.ctx[0]}else{s=n.ctx}if(s.path==e.ctx[0]){return i[r]}}return null};return i});e("sap/viz/controls/chart/views/DropZone",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/helpers/Rectangle"],function(e,t,i,r,n,s,o,a,l,c,p,h,d){var u=function(t,i,r){u.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=i;this._feedValidator=r;this._enterDrop=false;this._dragActionArray=[];var s="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=e(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr("style",s);var o=this;this._dom.droppable({accept:e.proxy(function(e){return this._isTriggerAllowed(e)===true},this),activate:function(e,t){o.enterDrop.apply(o,[e,t])},deactivate:function(e,t){n.defer(function(){o.exitDrop.apply(o,[e,t])})}})};r.extend(u,o);u.DROP_ITEM_EVENT="DROP_ITEM_EVENT";var _=8;u.prototype._match=function(e,t){var r=t.type();if(r){r=r.toLowerCase()}var n=t.dataType();if(n){n=n.toLowerCase()}var s=e.feedDef;var o=s[0].id===i.geoFeeds.id?l.GEOGRAPHY:s[0].type;if(s.length===1&&i.feedCompatible(o,r,n)){return true}for(var a=0;a<s.length;a++){o=s[a].id===i.geoFeeds.id?l.GEOGRAPHY:s[a].type;if(i.feedCompatible(o,r,n)&&s[a].id!==i.MultiplierFeedingName){return true}}return false};u.prototype._onDragOver=function(e,t){if(!this._enterDrop){return}var i=e.target.__zone;var r=e.target.__areaIndex;var n=c.instance().getAnalysisToken(t.helper);if(!i){n.currentAction(p.DENY);return}this._hightlight(i,r);if(this._acceptable(i,n.analysisObject)){n.dropTarget(e.target);n.currentAction(p.ACCEPT)}else{n.currentAction(p.DENY)}for(var s in this._dragActionArray){if(this._dragActionArray[s].zoneName===i.name){this._dragActionArray.splice(s,1);break}}this._dragActionArray.push({zoneName:i.name,action:n.currentAction()})};u.prototype._acceptable=function(e,t){var i=this._match(e,t);if(!i){return false}var r=false;var n=e.feedDef;for(var s=0;s<n.length;s++){if(n[s].id!=="r_subtotals"){r=r||this._feedValidator(n[s],t,e.name)}}return i&&r};u.prototype._onDragOut=function(e,t){if(!this._enterDrop){return}var i=e.target.__zone;var r=e.target.__areaIndex;if(i){this._unHightlight(i,r)}var n=c.instance().getAnalysisToken(t.helper);if(n.currentAction()===p.ACCEPT&&n.dropTarget()===e.target){n.currentAction(p.DENY);n.dropTarget(null)}for(var s in this._dragActionArray){if(this._dragActionArray[s].zoneName===i.name){this._dragActionArray.splice(s,1);break}}var o=this._dragActionArray.length;if(o>0){n.currentAction(this._dragActionArray[o-1].action)}};u.prototype._onDragDrop=function(t,i){var r=t.target.__zone;var n=c.instance().getAnalysisToken(i.helper);if(!r||!n){return}var o=this._dragActionArray.length;if(o>0){var a=this._dragActionArray[o-1];if(a.zoneName!==r.name){return}}var l=d.parseDOM(e(this._targetDiv));var h=new d(t.pageX,t.pageY,0,0);if(!l.contains(h)){return}var _=n.analysisObject;if(this._acceptable(r,_)){n.currentAction(p.ACCEPT);this._dispatchEvent(new s(u.DROP_ITEM_EVENT,this,{zone:r,analysisObject:_}))}else{n.currentAction(p.DENY)}n.dropTarget(this._dom)};u.prototype._isTriggerAllowed=function(e){var i=e.hasClass(c.DRAGGABLE_CLASS_ANALYSIS);i=i&&!e.hasClass(t.FEEDINGSHELF_PREFIX+"card");return i};u.prototype._createDiv=function(i,r,n,s){var o=e(document.createElement("DIV"));var a=r[0][0],l=r[0][1],c=r[2][0]-r[0][0],p=r[2][1]-r[0][1];var h="visibility:hidden;left:"+a+"px;top:"+l+"px;width:"+c+"px;height:"+p+"px;";var d=this;o.attr("style",h).droppable({tolerance:"pointer",accept:e.proxy(function(e){return this._isTriggerAllowed(e)===true},this),drop:function(e,t){d._onDragDrop.apply(d,[e,t])},over:function(e,t){d._onDragOver.apply(d,[e,t])},out:function(e,t){d._onDragOut.apply(d,[e,t])}});o.addClass(t.CHART_PREFIX+"drop-zone").appendTo(i);if(n&&n.length>0){h="position:absolute;left:0px;top: 0px;";var u=e(document.createElement("DIV")).attr("style",h).text(n).appendTo(o);var v=u[0].getBoundingClientRect();var f=null;if(s){f="translate("+(c-v.width)/2+"px,"+((v.width-v.height)/2+_)+"px) rotate(-90deg);"}else{f="translate("+_+"px, "+(p-v.height)/2+"px);"}h+="transform: "+f;h+="-webkit-transform: "+f;h+="-ms-transform: "+f;h+="-moz-transform: "+f;u.attr("style",h)}return o};u.prototype.enterDrop=function(e,t){var i=c.instance().getAnalysisToken(t.helper);if(!i){return}if(this._enterDrop){return}this._enterDrop=true;this._targetRect=this._targetDiv.getBoundingClientRect();var r="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr("style",r);var n=this._zoneProvider();if(!n){return}this._dragActionArray=[];for(var s=0;s<n.length;s++){var o=n[s].bound;for(var a=0;a<o.length;a++){var l=this._createDiv(this._dom[0],o[a],n[s].text,n[s].rotate);l[0].__zone=n[s];l[0].__areaIndex=a}}};u.prototype.exitDrop=function(){if(!this._enterDrop){return}this._dom.empty();this._dom.css("visibility","hidden");this._enterDrop=false};u.prototype.size=function(e){if(e){this._dom.css({width:e.width+"px",height:e.height+"px"})}};u.prototype._getDom=function(e,t){var i=this._dom.children();for(var r=0;r<i.length;r++){if(i[r].__zone===e&&i[r].__areaIndex===t){return i[r]}}return null};u.prototype._hightlight=function(t,i){var r=this._getDom(t,i);if(r){e(r).css("visibility","")}};u.prototype._unHightlight=function(t,i){var r=this._getDom(t,i);if(r){e(r).css("visibility","hidden")}};return u});e("sap/viz/controls/chart/views/EditAxisView",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/managers/LangManager"],function(e,t,i,r,n,s,o,a){var l=function(e,t){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.EditAxisView";this._createChildren()};t.extend(l,r);l.AxisScaleChanged="AxisScaleChanged";l.prototype._createChildren=function(){var t=this;this._confirmDialog$=e(document.createElement("div"));this._confirmDialog$.addClass(s.CHART_PREFIX+"editaxis");this._axisContainer=[];this._axisContainer[0]=this._createAxisUI("primaryAxis");this._confirmDialog$.append(this._axisContainer[0]);this._axisContainer[1]=this._createAxisUI("secondaryAxis");this._confirmDialog$.append(this._axisContainer[1]);var i=e(document.createElement("div"));i.addClass(s.CHART_PREFIX+"editaxis-footer");this._confirmDialog$.append(i);var r=e(document.createElement("div"));r.addClass(s.CHART_PREFIX+"editaxis-footer-buttons");i.append(r);var n=e(document.createElement("button"));n.text(a.get("VIZ_COMMON_OK"));n.addClass(s.CHART_PREFIX+"editaxis-footer-button");n.addClass(s.COMMON_PREFIX+"button");r.append(n);n.click(function(){t.hide();t._applyChange()});var o=e(document.createElement("button"));o.text(a.get("VIZ_COMMON_CANCEL"));o.addClass(s.CHART_PREFIX+"editaxis-footer-button");o.addClass(s.COMMON_PREFIX+"button");r.append(o);o.click(function(){t.hide()});this._blockLayout$=e(document.createElement("div"));this._blockLayout$.addClass(s.CHART_PREFIX+"block-layer")};l.prototype._createAxisUI=function(t){var i=this;var r=e(document.createElement("div")).addClass(s.CHART_PREFIX+"editaxis-axiscontainer");var n=e(document.createElement("div")).appendTo(r).addClass(s.CHART_PREFIX+"editaxis-axisname");e(document.createElement("span")).appendTo(n).attr("id","axisName").text("Axis");var o=e(document.createElement("div")).appendTo(r).addClass(s.CHART_PREFIX+"editaxis-separator");var l=e(document.createElement("div")).appendTo(r);l.append('<input type="radio" id="autoRange" value="false" name="'+t+'"></input>');l.find("#autoRange").change(function(){i._updateFixedRangeInput(c.find("#fixedRange")[0],p)});e(document.createElement("span")).appendTo(l).text(a.get("VIZ_CHART_AUTO_RANGE"));var c=e(document.createElement("div")).appendTo(r);c.append('<input type="radio" id="fixedRange" value="true" name="'+t+'"></input>');c.find("#fixedRange").change(function(){i._updateFixedRangeInput(c.find("#fixedRange")[0],p)});e(document.createElement("span")).appendTo(c).text(a.get("VIZ_CHART_FIXED_RANGE"));var p=e(document.createElement("div")).appendTo(r).addClass(s.CHART_PREFIX+"editaxis-inputs");var h=e('<input type="number" id="minValue" style="ime-mode:Disabled" class="'+(s.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');h.on("keypress",function(e){return/[\d.-]/.test(String.fromCharCode(e.keyCode))});p.append(h);e(document.createElement("span")).appendTo(p).text(" - ");var d=e('<input type="number" id="maxValue" style="ime-mode:Disabled" class="'+(s.CHART_PREFIX+"editaxis-inputvalue")+'"></input>');d.on("keypress",function(e){return/[\d.-]/.test(String.fromCharCode(e.keyCode))});p.append(d);return r};l.prototype._updateFixedRangeInput=function(e,t){var i=e.checked?false:true;t.find("input").attr("disabled",i)};l.prototype._propertiesChanged=function(e){for(var t=0;t<this._valueAxis.length;++t){var i=this._valueAxis[t];var r=e[i];var n=this._properties[i];if(r.scale.fixedRange!==n.scale.fixedRange){return true}if(r.scale.fixedRange){if(r.scale.minValue!==n.scale.minValue||r.scale.maxValue!==n.scale.maxValue){return true}}}return false};l.prototype._applyChange=function(){var e={};for(var t=0;t<this._valueAxis.length;++t){var i=this._valueAxis[t];e[i]={scale:{fixedRange:false}};var r=this._axisContainer[t];if(!r){continue}if(r.find("#fixedRange")[0].checked){e[i].scale.fixedRange=true;e[i].scale.minValue=Number(r.find("#minValue").val());e[i].scale.maxValue=Number(r.find("#maxValue").val())}}if(this._propertiesChanged(e)){this._dispatchEvent(new o(l.AxisScaleChanged,this,e))}};l.prototype._getAxisName=function(e,t){var r=i.getValueAxis(e);var s=r?r.length:1;if(s===1||e===n.TYPE_SCATTER||e===n.TYPE_BUBBLE){if(t===n.AXIS_XAXIS){return a.get("VIZ_CHART_XAXIS_RANGE")}else if(t===n.AXIS_YAXIS){return a.get("VIZ_CHART_YAXIS_RANGE")}}else{if(t===n.AXIS_XAXIS){return a.get("VIZ_CHART_XAXIS2_RANGE")}else if(t===n.AXIS_YAXIS){return a.get("VIZ_CHART_YAXIS1_RANGE")}}if(t===n.AXIS_XAXIS2){return a.get("VIZ_CHART_XAXIS1_RANGE")}else if(t===n.AXIS_YAXIS2){return a.get("VIZ_CHART_YAXIS2_RANGE")}return""};l.prototype._updateUI=function(e,t,r){this._properties=t;if(r){this._valueAxis=[r]}else{this._valueAxis=i.getValueAxis(e)}var n=this._valueAxis;if(!n||n.length===0){return}for(var o=0;o<n.length;++o){var r=n[o];var a=t[r];var l=this._axisContainer[o];if(!l){continue}l.css({display:"block"});l.find("#axisName").text(this._getAxisName(e,r));if(a.scale.fixedRange){l.find("#fixedRange")[0].checked=true}else{l.find("#autoRange")[0].checked=true}l.find("#minValue").val(a.scale.minValue);l.find("#maxValue").val(a.scale.maxValue);this._updateFixedRangeInput(l.find("#fixedRange")[0],l.find("."+s.CHART_PREFIX+"editaxis-inputs"))}for(var c=n.length;c<this._axisContainer.length;c++){this._axisContainer[c].css({display:"none"})}};l.prototype.show=function(t,i,r){this._visible=true;var n=this._dom$.offset().left+this._dom$.width()/2;var s=this._dom$.offset().top+this._dom$.height()/2;e(document.body).append(this._blockLayout$);e(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:n-this._confirmDialog$.width()/2,top:s-this._confirmDialog$.height()/2});this._updateUI(t,i,r)};l.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};return l});e("sap/viz/controls/chart/morph/constant/MorphConst",[],function(){var e={};e.SHAPE_DATA="data";e.SHAPE_GLOBAL_TRANSLATE_X="translateX";e.SHAPE_GLOBAL_TRANSLATE_Y="translateY";e.MORPHER_DISABLE_COLOR="MORPHER_DISABLE_COLOR";e.MORPHER_DISABLE_LINE="MORPHER_DISABLE_LINE";e.MORPHER_DISABLE_PATH="MORPHER_DISABLE_PATH";e.MORPHER_DISABLE_RECT="MORPHER_DISABLE_RECT";e.MORPHER_DISABLE_TEXT="MORPHER_DISABLE_TEXT";e.MORPHER_DISABLE_TRANSFORM="MORPHER_DISABLE_TRANSFORM";e.CHART_TYPE_COLUMN="viz/column";e.CHART_TYPE_STACKED_COLUMN="viz/stacked_column";e.CHART_TYPE_100_STACKED_COLUMN="viz/100_stacked_column";e.CHART_TYPE_DUAL_COLUMN="viz/dual_column";e.CHART_TYPE_3D_COLUMN="viz/3d_column";e.CHART_TYPE_BAR="viz/bar";e.CHART_TYPE_STACKED_BAR="viz/stacked_bar";e.CHART_TYPE_100_STACKED_BAR="viz/100_stacked_bar";e.CHART_TYPE_DUAL_BAR="viz/dual_bar";e.CHART_TYPE_3D_BAR="viz/3d_bar";e.CHART_TYPE_LINE="viz/line";e.CHART_TYPE_HORIZONTAL_LINE="viz/horizontal_line";e.CHART_TYPE_DUAL_LINE="viz/dual_line";e.CHART_TYPE_DUAL_HORIZONTAL_LINE="viz/dual_horizontal_line";e.CHART_TYPE_AREA="viz/area";e.CHART_TYPE_HORIZONTAL_AREA="viz/horizontal_area";e.CHART_TYPE_100_AREA="viz/100_area";e.CHART_TYPE_100_HORIZONTAL_AREA="viz/100_horizontal_area";e.CHART_TYPE_COMBINATION="viz/combination";e.CHART_TYPE_HORIZONTAL_COMBINATION="viz/horizontal_combination";e.CHART_TYPE_DUAL_COMBINATION="viz/dual_combination";e.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION="viz/dual_horizontal_combination";e.CHART_TYPE_BOXPLOT="viz/boxplot";e.CHART_TYPE_HORIZONTAL_BOXPLOT="viz/horizontal_boxplot";e.CHART_TYPE_WATERFALL="viz/waterfall";e.CHART_TYPE_HORIZONTAL_WATERFALL="viz/horizontal_waterfall";e.CHART_TYPE_PIE="viz/pie";e.CHART_TYPE_DONUT="viz/donut";e.CHART_TYPE_PIE_WITH_DEPTH="viz/pie_with_depth";e.CHART_TYPE_SCATTER="viz/scatter";e.CHART_TYPE_BUBBLE="viz/bubble";e.CHART_TYPE_SCATTER_MATRIX="viz/scatter_matrix";e.CHART_TYPE_GEO_BUBBLE="viz/geobubble";e.CHART_TYPE_GEO_CHOROPLETH="viz/choropleth";e.CHART_TYPE_GEO_PIE="viz/geopie";e.CHART_TYPE_HEATMAP="viz/heatmap";e.CHART_TYPE_TREEMAP="viz/treemap";e.CHART_TYPE_TABLE="viz/ext/table";e.CHART_TYPE_CROSSTAB="viz/ext/crosstab";e.CHART_TYPE_RADAR="viz/radar";e.CHART_TYPE_TAG_CLOUD="viz/tagcloud";var t={};var i=function(e,i){t[e]=i};i(e.CHART_TYPE_COLUMN,e.CHART_TYPE_BAR);i(e.CHART_TYPE_STACKED_COLUMN,e.CHART_TYPE_STACKED_BAR);i(e.CHART_TYPE_100_STACKED_COLUMN,e.CHART_TYPE_100_STACKED_BAR);i(e.CHART_TYPE_DUAL_COLUMN,e.CHART_TYPE_DUAL_BAR);i(e.CHART_TYPE_3D_COLUMN,e.CHART_TYPE_3D_BAR);i(e.CHART_TYPE_LINE,e.CHART_TYPE_HORIZONTAL_LINE);i(e.CHART_TYPE_DUAL_LINE,e.CHART_TYPE_DUAL_HORIZONTAL_LINE);i(e.CHART_TYPE_AREA,e.CHART_TYPE_HORIZONTAL_AREA);i(e.CHART_TYPE_100_AREA,e.CHART_TYPE_100_HORIZONTAL_AREA);i(e.CHART_TYPE_COMBINATION,e.CHART_TYPE_HORIZONTAL_COMBINATION);i(e.CHART_TYPE_DUAL_COMBINATION,e.CHART_TYPE_DUAL_HORIZONTAL_COMBINATION);i(e.CHART_TYPE_BOXPLOT,e.CHART_TYPE_HORIZONTAL_BOXPLOT);i(e.CHART_TYPE_WATERFALL,e.CHART_TYPE_HORIZONTAL_WATERFALL);e.IS_V_H_MAP=function(e,i){if(t[e]&&t[e]===i){return true}if(t[i]&&t[i]===e){return true}return false};return e});e("sap/viz/controls/chart/morph/utils/Utils",[],function(){var e={};var t=0;e.genUID=function(){if(!t){t=0}return"mgen_"+t++};var i={"[object Boolean]":"boolean","[object Number]":"number","[object String]":"string","[object Function]":"function","[object Array]":"array","[object Date]":"date","[object RegExp]":"regexp","[object Object]":"object"};e.type=function(e){return!e?String(e):i[Object.prototype.toString.call(e)]||"object"};e.isFunction=function(t){return e.type(t)==="function"};e.isBoolean=function(t){return e.type(t)==="boolean"};e.isString=function(t){return e.type(t)==="string"};e.isArray=function(t){return e.type(t)==="array"};e.isNumber=function(t){return e.type(t)==="number"};e.isRegExp=function(t){return e.type(t)==="regexp"};e.sortArrayOn=function(t,i,r){if(e.isArray(t)&&e.isString(i)){t.sort(function(e,t){return r?(e[i]<t[i])-(e[i]>t[i]):(e[i]>t[i])-(e[i]<t[i])})}};e.noop=function(){};return e});e("sap/viz/controls/chart/morph/utils/SVGShapeMetadata",[],function(){var e={};var t="__vizmp__";e.set=function(e,i,r){if(!e[t]){e[t]={}}e[t][i]=r};e.get=function(e,i){if(e&&e[t]!==null&&e[t]!==undefined){return e[t][i]}return undefined};e.clone=function(e,i){e[t]=i[t];return e};return e});e("sap/viz/controls/chart/morph/vo/VizShape",[],function(){var e=function(e,t,i){this.from=e;this.to=t;this.display=i};return e});e("sap/viz/controls/chart/morph/vo/VizShapesHolder",[],function(){var e=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};e.prototype.empty=function(){this.plotShapes=[];this.plotLines=[];this.xAxisLabels=[];this.xAxis2Labels=[];this.yAxisLabels=[];this.yAxis2Labels=[];this.backgrounds=[]};e.prototype.allByOrder=function(){return[].concat(this.backgrounds,this.xAxis2Labels,this.xAxisLabels,this.yAxis2Labels,this.yAxisLabels,this.plotLines,this.plotShapes)};e.prototype.toShapesBySvgType=function(){var e={};var t=[];e["all"]=t;var i=this.allByOrder();for(var r=0;r<i.length;r++){var n=i[r];if(n.to){var s=n.to.localName;var o=e[s];if(!o){e[s]=o=[]}o.push(n);t.push(n)}}return e};return e});e("sap/viz/controls/chart/morph/viz/MpShapesCapturer",["sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/SVGShapeMetadata","sap/viz/controls/chart/morph/vo/VizShape","sap/viz/controls/chart/morph/vo/VizShapesHolder"],function(e,t,i,r){var n={};n.getShapes=function(i){var n=new r;var a=d3.select(i).select(".v-m-root");var l=d3.select(i).select(".v-m-main");var c=a.node();var p=l.node();if(c&&p&&c.offsetHeight>0&&c.offsetWidth>0&&c.getScreenCTM!==undefined&&p.getScreenCTM!==undefined){var h=o(a);var d=c.getScreenCTM();n.plotShapes=s(l,".v-m-plot .v-morphable-datapoint",d,h);n.plotLines=s(l,".v-m-plot .v-morphable-line, "+".v-m-plot .v-morphable-areabg",d,h);n.xAxisLabels=s(l,".v-m-xAxis .v-morphable-label",d);n.xAxis2Labels=s(l,".v-m-xAxis2 .v-morphable-label",d);n.yAxisLabels=s(l,".v-m-yAxis .v-morphable-label",d);n.yAxis2Labels=s(l,".v-m-yAxis2 .v-morphable-label",d);n.backgrounds=s(a,".v-m-background .v-morphable-background",d);for(var u=0;u<n.backgrounds.length;u++){var _=n.backgrounds[u];t.set(_.to,e.MORPHER_DISABLE_RECT,true)}}return n};var s=function(r,n,s,o){var c=r.selectAll(n);var p=[];c.each(function(r,n){if(this.localName==="path"&&String(this.getAttribute("class")).indexOf("v-geo-choropleth-feature")>=0){return}var c=this.cloneNode(true);t.set(c,e.SHAPE_DATA,this.__data__);l(c,this,o);a(this,s,c);p.push(new i(null,c,null))});return p};var o=function(e){var t={};var i=false;var r=e.selectAll("defs");r.each(function(){var e=this;if(e.firstChild){var r=e.childNodes;for(var n=0;n<r.length;n++){var s=r[n];if(s){var o="";var a=[];var l="#000000";if(s.localName==="linearGradient"){o=s.getAttribute("id");a=s.childNodes;if(a.length===2){l=a[1].getAttribute("stop-color")}else if(a.length===4){l=a[3].getAttribute("stop-color")}else{l=a[a.length-1].getAttribute("stop-color")}t[o]=l;i=true}else if(s.localName==="radialGradient"){o=s.getAttribute("id");a=s.childNodes;if(a.length===3){l=a[1].getAttribute("stop-color")}else if(a.length===4){l=a[3].getAttribute("stop-color")}else{l=a[a.length-1].getAttribute("stop-color")}t[o]=l;i=true}}}}});if(i){t["__hasGradientColor"]=true}return t};var a=function(i,r,n){var s=i.getScreenCTM();var o=s.e-r.e;var a=s.f-r.f;n.setAttribute("transform","translate("+o+","+a+")");t.set(n,e.SHAPE_GLOBAL_TRANSLATE_X,o);t.set(n,e.SHAPE_GLOBAL_TRANSLATE_Y,a);return n};var l=function(e,t,i){if(e.localName==="path"&&e.getAttribute("class")&&e.getAttribute("class").indexOf("v-morphable-line")>=0){e.setAttribute("fill-opacity",0)}if(e.localName==="path"&&e.getAttribute("class")&&e.getAttribute("class").indexOf("v-morphable-datapoint")>=0&&e.getAttribute("visibility")==="hidden"){e.setAttribute("visibility","");e.setAttribute("d","M0,0L0,0Z")}if(t.localName==="rect"&&t.getAttribute("opacity")==="0"&&t.parentNode&&t.parentNode.parentNode&&t.parentNode.parentNode.getAttribute("class")&&t.parentNode.parentNode.getAttribute("class").indexOf("v-heatmap")>=0){e.setAttribute("opacity",1)}if(i&&i["__hasGradientColor"]===true&&t.getAttribute("fill")&&t.getAttribute("fill").indexOf("url(#")===0){var r=t.getAttribute("fill");r=r.substring(5,r.length-1);var n=i[r];n=n?n:"#000000";e.setAttribute("fill",n)}};return n});e("sap/viz/controls/chart/morph/utils/SVGShapeReplacer",["sap/viz/controls/chart/morph/utils/SVGShapeMetadata"],function(e){var t={};var i="http://www.w3.org/2000/svg";var r=["x","y","width","height","rx","ry","x1","x2","y1","y2"];var n=function(e,t){var i=parseFloat(e.getAttribute(t));return isNaN(i)?0:i};t.replace=function(t,n,s,o){if(t&&n){var a=document.createElementNS(i,n);if(o){var l=t.attributes;for(var c=0;c<l.length;c++){var p=l[c];if(r.indexOf(p.localName)===-1){a.setAttribute(p.localName,p.value)}}}for(var h in s){if(s.hasOwnProperty(h)){a.setAttribute(h,s[h])}}e.clone(a,t);if(t.parentNode){t.parentNode.replaceChild(a,t)}return a}return null};t.replaceToPath=function(e){if(e){var i=null;switch(e.localName){case"rect":var r=n(e,"x");var s=n(e,"y");var o=n(e,"width");var a=n(e,"height");var l=n(e,"rx");var c=n(e,"ry");i="M"+r+","+s+"L"+(o+r)+","+s+"L"+(o+r)+","+(a+s)+"L"+r+","+(a+s)+"L"+r+","+s+"Z";break;case"line":var p=n(e,"x1");var h=n(e,"y1");var d=n(e,"x2");var u=n(e,"y2");i="M"+p+","+h+"L"+d+","+u;break;default:}if(i){var _={d:i};return t.replace(e,"path",_,true)}}return null};return t});e("sap/viz/controls/chart/morph/viz/MpShapesMapper",["sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/Utils","sap/viz/controls/chart/morph/utils/SVGShapeMetadata","sap/viz/controls/chart/morph/utils/SVGShapeReplacer","sap/viz/controls/chart/morph/vo/VizShape"],function(e,t,i,r,n){var s={};s.map=function(t,i,r,n){c(t.plotShapes,i.plotShapes,o);c(t.plotLines,i.plotLines,o);if(e.IS_V_H_MAP(r,n)){c(t.xAxisLabels,i.yAxisLabels,o);c(t.xAxis2Labels,i.yAxis2Labels,o);c(t.yAxisLabels,i.xAxisLabels,o);c(t.yAxis2Labels,i.xAxis2Labels,o)}else{c(t.xAxisLabels,i.xAxisLabels,o);c(t.xAxis2Labels,i.xAxis2Labels,o);c(t.yAxisLabels,i.yAxisLabels,o);c(t.yAxis2Labels,i.yAxis2Labels,o)}c(t.backgrounds,i.backgrounds,l);return t};var o=function(r,n){if(n&&r&&i.get(n,e.SHAPE_DATA)&&i.get(r,e.SHAPE_DATA)&&i.get(r,e.SHAPE_DATA).ctx){var s=i.get(n,e.SHAPE_DATA).ctx;var o=i.get(r,e.SHAPE_DATA).ctx;if(t.isArray(s)){s=s[0]}if(t.isArray(o)){o=o[0]}if(s&&o){return a(s,o)}}if(n&&r&&t.isArray(i.get(n,e.SHAPE_DATA))&&t.isArray(i.get(r,e.SHAPE_DATA))){var l=i.get(n,e.SHAPE_DATA);var c=i.get(r,e.SHAPE_DATA);if(l.length==c.length&&l.length>0){for(var p=0;p<l.length;p++){if(!l[p]||!c[p]||a(l[p].ctx,c[p].ctx)===false){return false}}return true}}if(n&&r&&n.localName==="g"&&r.localName==="g"&&n.firstChild.localName==="text"&&r.firstChild.localName==="text"&&n.firstChild.textContent==r.firstChild.textContent){return true}return false};var a=function(e,t){if(!e&&!t){return true}if(!e||!t||e.type!==t.type||(!e.path||!t.path)||e.path.dii_a1!=t.path.dii_a1||e.path.dii_a2!=t.path.dii_a2||e.path.mg!=t.path.mg||e.path.mi!=t.path.mi){return false}return true};var l=function(e,t){if(t&&e&&t.localName==e.localName&&t.getAttribute("class")==e.getAttribute("class")){return true}};var c=function(e,t,i,r){var n=[];for(var s=0;s<e.length;s++){var o=e[s];for(var a=0;a<t.length;a++){var l=t[a];if(r||n.indexOf(l)===-1){if(i(o.to,l.display)){var c=p(o.to,l.display);o.to=c.newShape;o.from=c.currentShape;n.push(l);break}}}}};var p=function(e,t){var i={newShape:e,currentShape:t};var n;if(e.localName==="path"&&t.localName!=="path"){n=r.replaceToPath(t);if(n){i.currentShape=n}}if(e.localName!=="path"&&t.localName==="path"){n=r.replaceToPath(e);if(n){i.newShape=n}}return i};return s});e("sap/viz/controls/chart/morph/utils/Cache",[],function(){var e={};var t=function(e,t){for(var i=0,r=e.length;i<r;i++){if(e[i]===t){return e.push(e.splice(i,1)[0])}}};e.func=function(e,i,r){function n(){var s=Array.prototype.slice.call(arguments,0),o=s.join("â"),a=n.cache=n.cache||{},l=n.count=n.count||[];if(a.hasOwnProperty(o)){t(l,o);return r?r(a[o]):a[o]}l.length>=1e3&&delete a[l.shift()];l.push(o);a[o]=e.apply(i,s);return r?r(a[o]):a[o]}return n};return e});e("sap/viz/controls/chart/morph/utils/ColorUtil",["sap/viz/controls/chart/morph/utils/Utils","sap/viz/controls/chart/morph/utils/Cache"],function(e,t){var i={};var r=null;i.parse=function(e){if(!r){r=t.func(RGBColorStatic.parse)}return r(e)};i.numberToHexString=function(e){var t=((e&16711680)>>16).toString(16),i=((e&65280)>>8).toString(16),r=(e&255).toString(16);var n="#"+(t.length===1?"0"+t:t)+(i.length===1?"0"+i:i)+(r.length===1?"0"+r:r);return n};i.hexStringToNumber=function(e){if(!e){return 0}if(e.charAt(0)==="#"){e=e.substr(1)}var t=parseInt(e.substr(0,2),16),i=parseInt(e.substr(2,2),16),r=parseInt(e.substr(4,2),16);var n=Math.max(0,Math.min(255,t))*65536+Math.max(0,Math.min(255,i))*256+Math.max(0,Math.min(255,r));return n};i.numberToRGB=function(e){var t=(e&16711680)>>16,i=(e&65280)>>8,r=e&255;return"rgb("+t+","+i+","+r+")"};i.numberToRGBA=function(e,t){var i=(e&16711680)>>16,r=(e&65280)>>8,n=e&255;if(t===undefined||t<=0||t>1){t=1}return"rgba("+i+","+r+","+n+","+t+")"};i.RGBToNumber=function(e,t,i){var r=Math.max(0,Math.min(255,e))*65536+Math.max(0,Math.min(255,t))*256+Math.max(0,Math.min(255,i));return r};i.getColorMix=function(e,t,r){return i.getPercentageOfColor(e,1-r)+i.getPercentageOfColor(t,r)};i.getPercentageOfColor=function(e,t){t=Math.min(1,Math.max(0,t));var i=(e&16711680)>>16;var r=(e&65280)>>8;var n=e&255;return i*t<<16|r*t<<8|n*t};i.adjustBrightness=function(e,t){var i=Math.min((e>>16&255)+t,255);i=Math.max(i,0);var r=Math.min((e>>8&255)+t,255);r=Math.max(r,0);var n=Math.min((e&255)+t,255);n=Math.max(n,0);return i<<16|r<<8|n};i.adjustBrightness2=function(e,t){var i=NaN,r=NaN,n=NaN;if(t==0){return e}else if(t>0){t/=100;i=e>>16&255;r=e>>8&255;n=e&255;i+=(255-i)*t;r+=(255-r)*t;n+=(255-n)*t;i=Math.min(i,255);r=Math.min(r,255);n=Math.min(n,255)}else{t=(100+t)/100;i=(e>>16&255)*t;r=(e>>8&255)*t;n=(e&255)*t}return i<<16|r<<8|n};i.rgbMultiply=function(e,t){var i=e>>16&255,r=e>>8&255,n=e&255;var s=t>>16&255,o=t>>8&255,a=t&255;return i*s/255<<16|r*o/255<<8|n*a/255};return i});e("sap/viz/controls/chart/morph/morphers/ColorMorpher",["sap/viz/controls/chart/morph/utils/Utils","sap/viz/controls/chart/morph/utils/ColorUtil"],function(e,t){var i={};var r=function(e,t){var i=parseFloat(e.getAttribute(t));return isNaN(i)?1:i};i.getPercentage=function(e,i,r){r=r>100?100:r<0?0:r;var n=t.parse(e);var s=t.parse(i);if(n.length===0&&s.length===0){return""}if(n.length===0&&s.length===3){return"rgb("+s[0]+","+s[1]+","+s[2]+")"}if(n.length===3&&s.length===0){return""}return"rgb("+Math.round(n[0]+(s[0]-n[0])*r/100)+","+Math.round(n[1]+(s[1]-n[1])*r/100)+","+Math.round(n[2]+(s[2]-n[2])*r/100)+")"};i.svg=function(e,t,n,s){if(n&&t){var o=e?e.getAttribute("stroke"):"";var a=t.getAttribute("stroke");var l=e?e.getAttribute("fill"):"";var c=t.getAttribute("fill");if(o===a){n.setAttribute("stroke",a)}else{n.setAttribute("stroke",i.getPercentage(o,a,s))}var p="";if(l===c){p=c;n.setAttribute("fill",p)}else{p=i.getPercentage(l,c,s);n.setAttribute("fill",p)}var h;var d;if(e){if(p===""){n.setAttribute("fill-opacity",0)}else{var u=r(e,"fill-opacity");h=r(t,"fill-opacity");if(u!=h){n.setAttribute("fill-opacity",u+(h-u)*s/100)}}var _=r(e,"stroke-opacity");d=r(t,"stroke-opacity");if(_!=d){n.setAttribute("stroke-opacity",_+(d-_)*s/100)}}else{if(t.getAttribute("fill-opacity")!==""){if(p===""){h=0}else{h=r(t,"fill-opacity")}n.setAttribute("fill-opacity",0+(h-0)*s/100)}else{n.setAttribute("fill-opacity","")}if(t.getAttribute("stroke-opacity")!==""){d=r(t,"stroke-opacity");n.setAttribute("stroke-opacity",0+(d-0)*s/100)}else{n.setAttribute("stroke-opacity","")}}}};return i});e("sap/viz/controls/chart/morph/morphers/RectMorpher",["sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/SVGShapeMetadata"],function(e,t){var i={};i.NO_DEFAULT_DIRECTION=0;i.DEFAULT_DIRECTION_TO_NORTH=1;i.DEFAULT_DIRECTION_TO_SOUTH=2;i.DEFAULT_DIRECTION_TO_EAST=4;i.DEFAULT_DIRECTION_TO_WEST=8;i.getPercentageRect=function(e,t,i){return{w:e.w+(t.w-e.w)*i/100,h:e.h+(t.h-e.h)*i/100,x:e.x+(t.x-e.x)*i/100,y:e.y+(t.y-e.y)*i/100,r:e.r+(t.r-e.r)*i/100}};var r=function(e,t){var i=parseInt(e.getAttribute(t),10);return isNaN(i)?0:i};var n=function(e,t){var i=parseFloat(e.getAttribute(t));return isNaN(i)?0:i};i.svg=function(r,s,o,a,l){if(o&&s&&s.localName==="rect"){var c;var p;var h;var d;var u;var _;if(t.get(s,e.MORPHER_DISABLE_RECT)===true){c=n(s,"x");p=n(s,"rx");h=n(s,"y");d=n(s,"ry");u=n(s,"width");_=n(s,"height");var v=n(o,"x");var f=n(o,"rx");var m=n(o,"y");var g=n(o,"ry");var E=n(o,"width");var y=n(o,"height");if(c!==v){o.setAttribute("x",c)}if(p!==f){o.setAttribute("rx",p)}if(h!==m){o.setAttribute("y",h)}if(d!==g){o.setAttribute("ry",d)}if(u!==E){o.setAttribute("width",u)}if(_!==y){o.setAttribute("height",_)}}else if(r&&r.localName==="rect"){var I=n(r,"x");c=n(s,"x");var C=n(r,"rx");p=n(s,"rx");var T=n(r,"y");h=n(s,"y");var A=n(r,"ry");d=n(s,"ry");var P=n(r,"width");u=n(s,"width");var R=n(r,"height");_=n(s,"height");var z=P>=1&&R>=1;var O=u>=1&&_>=1;if(!z&&!O){a=100}o.setAttribute("x",I+(c-I)*a/100);o.setAttribute("y",T+(h-T)*a/100);o.setAttribute("rx",C+(p-C)*a/100);o.setAttribute("ry",A+(d-A)*a/100);o.setAttribute("width",P+(u-P)*a/100);o.setAttribute("height",R+(_-R)*a/100)}else if(!r){c=n(s,"x");p=n(s,"rx");h=n(s,"y");d=n(s,"ry");u=n(s,"width");_=n(s,"height");if(l==null||l<0){l=i.DEFAULT_DIRECTION_TO_NORTH|i.DEFAULT_DIRECTION_TO_WEST}if(l&i.DEFAULT_DIRECTION_TO_NORTH&&l&i.DEFAULT_DIRECTION_TO_SOUTH){o.setAttribute("y",h+(_-0)*(100-a)/100/2);o.setAttribute("height",0+(_-0)*a/100)}else if(l&i.DEFAULT_DIRECTION_TO_NORTH){o.setAttribute("y",h+(_-0)*(100-a)/100);o.setAttribute("height",0+(_-0)*a/100)}else if(l&i.DEFAULT_DIRECTION_TO_SOUTH){o.setAttribute("y",h);o.setAttribute("height",0+(_-0)*a/100)}else{o.setAttribute("y",h);o.setAttribute("height",_)}if(l&i.DEFAULT_DIRECTION_TO_EAST&&l&i.DEFAULT_DIRECTION_TO_WEST){o.setAttribute("x",c+(u-0)*(100-a)/100/2);o.setAttribute("width",0+(u-0)*a/100)}else if(l&i.DEFAULT_DIRECTION_TO_EAST){o.setAttribute("x",c+(u-0)*(100-a)/100);o.setAttribute("width",0+(u-0)*a/100)}else if(l&i.DEFAULT_DIRECTION_TO_WEST){o.setAttribute("x",c);o.setAttribute("width",0+(u-0)*a/100)}else{o.setAttribute("x",c);o.setAttribute("width",u)}}}};return i});e("sap/viz/controls/chart/morph/morphers/LineMorpher",[],function(){var e={};e.getPercentageLine=function(e,t,i){return{x:e.x+(t.x-e.x)*i/100,y:e.y+(t.y-e.y)*i/100,x2:e.x2+(t.x2-e.x2)*i/100,y2:e.y2+(t.y2-e.y2)*i/100}};var t=function(e,t){var i=parseInt(e.getAttribute(t),10);return isNaN(i)?0:i};var i=function(e,t){var i=parseFloat(e.getAttribute(t));return isNaN(i)?0:i};e.svg=function(e,t,r,n){if(r&&t&&t.localName==="line"){var s;var o;var a;var l;if(e&&e.localName==="rect"){var c=i(e,"x1");s=i(t,"x1");var p=i(e,"x2");o=i(t,"x2");var h=i(e,"y1");a=i(t,"y1");var d=i(e,"y2");l=i(t,"y2");r.setAttribute("x1",c+(s-c)*n/100);r.setAttribute("y1",h+(a-h)*n/100);r.setAttribute("x2",p+(o-p)*n/100);r.setAttribute("y2",d+(l-d)*n/100)}else if(!e){s=i(t,"x1");o=i(t,"x2");a=i(t,"y1");l=i(t,"y2");r.setAttribute("x1",s);r.setAttribute("y1",a);r.setAttribute("x2",0+(o-0)*n/100);r.setAttribute("y2",0+(l-0)*n/100)}}};return e});e("sap/viz/controls/chart/morph/morphers/PathMorpher",["sap/viz/controls/chart/morph/utils/Utils","sap/viz/controls/chart/morph/utils/Cache","sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/SVGShapeMetadata"],function(e,t,i,r){var n="concat",s="apply",o="hasOwnProperty",a="split",l=String.prototype.toLowerCase,c=String.prototype.toUpperCase,p=parseFloat,h=parseInt,d=Math,u=d.max,_=d.min,v=d.abs,f=d.pow,m=d.PI,g="number",E="string",y="array",I="toString";var C=/,?([achlmqrstvxz]),?/gi,T=/([achlmrqstvz])[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029,]*((-?\d*\.?\d*(?:e[\-+]?\d+)?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*)+)/gi,A=/(-?\d*\.?\d*(?:e[\-+]?\d+)?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,?[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*/gi;var P=function(e){return e?e.join(",").replace(C,"$1"):this.join(",").replace(C,"$1")};var R=function(e,t){var i=[];for(var r=0,n=e.length;n-2*!t>r;r+=2){var s=[{x:+e[r-2],y:+e[r-1]},{x:+e[r],y:+e[r+1]},{x:+e[r+2],y:+e[r+3]},{x:+e[r+4],y:+e[r+5]}];if(t){if(!r){s[0]={x:+e[n-2],y:+e[n-1]}}else if(n-4===r){s[3]={x:+e[0],y:+e[1]}}else if(n-2===r){s[2]={x:+e[0],y:+e[1]};s[3]={x:+e[2],y:+e[3]}}}else{if(n-4===r){s[3]=s[2]}else if(!r){s[0]={x:+e[r],y:+e[r+1]}}}i.push(["C",(-s[0].x+6*s[1].x+s[2].x)/6,(-s[0].y+6*s[1].y+s[2].y)/6,(s[1].x+6*s[2].x-s[3].x)/6,(s[1].y+6*s[2].y-s[3].y)/6,s[2].x,s[2].y])}return i};var z=function(e){if(!e){return null}var t={a:7,c:6,h:1,l:2,m:2,r:4,q:4,s:4,t:2,v:1,z:0},i=[];if(!i.length){String(e).replace(T,function(e,r,s){var o=[],a=r.toLowerCase();s.replace(A,function(e,t){t&&o.push(+t)});if(a==="m"&&o.length>2){i.push([r][n](o.splice(0,2)));a="l";r=r==="m"?"l":"L"}if(a==="r"){i.push([r][n](o))}else{while(o.length>=t[a]){i.push([r][n](o.splice(0,t[a])));if(!t[a]){break}}}})}i.toString=P;return i};var O=function(t){if(!e.isArray(t)||!e.isArray(t&&t[0])){t=z(t)}if(!t||!t.length){return[["M",0,0]]}var i=[],r=0,s=0,o=0,a=0,l=0;if(t[0][0]==="M"){r=+t[0][1];s=+t[0][2];o=r;a=s;l++;i[0]=["M",r,s]}var p=t.length===3&&t[0][0]==="M"&&t[1][0].toUpperCase()==="R"&&t[2][0].toUpperCase()==="Z";for(var h,d,u=l,_=t.length;u<_;u++){i.push(h=[]);d=t[u];if(d[0]!=c.call(d[0])){h[0]=c.call(d[0]);switch(h[0]){case"A":h[1]=d[1];h[2]=d[2];h[3]=d[3];h[4]=d[4];h[5]=d[5];h[6]=+(d[6]+r);h[7]=+(d[7]+s);break;case"V":h[1]=+d[1]+s;break;case"H":h[1]=+d[1]+r;break;case"R":var v=[r,s][n](d.slice(1));for(var f=2,m=v.length;f<m;f++){v[f]=+v[f]+r;v[++f]=+v[f]+s}i.pop();i=i[n](R(v,p));break;case"M":o=+d[1]+r;a=+d[2]+s;break;default:for(f=1,m=d.length;f<m;f++){h[f]=+d[f]+(f%2?r:s)}}}else if(d[0]==="R"){v=[r,s][n](d.slice(1));i.pop();i=i[n](R(v,p));h=["R"][n](d.slice(-2))}else{for(var g=0,E=d.length;g<E;g++){h[g]=d[g]}}switch(h[0]){case"Z":r=o;s=a;break;case"H":r=h[1];break;case"V":s=h[1];break;case"M":o=h[h.length-2];a=h[h.length-1];break;default:r=h[h.length-2];s=h[h.length-1]}}i.toString=P;return i};var b=function(e,t,i,r){return[e,t,i,r,i,r]};var S=function(e,t,i,r,n,s){var o=1/3,a=2/3;return[o*e+a*i,o*t+a*r,o*n+a*i,o*s+a*r,n,s]};var x=function(e,i,r,s,o,l,c,p,h,u){var _=m*120/180,f=m/180*(+o||0),g=[],E,y=t.func(function(e,t,i){var r=e*d.cos(i)-t*d.sin(i),n=e*d.sin(i)+t*d.cos(i);return{x:r,y:n}});if(!u){E=y(e,i,-f);e=E.x;i=E.y;E=y(p,h,-f);p=E.x;h=E.y;var I=d.cos(m/180*o),C=d.sin(m/180*o),T=(e-p)/2,A=(i-h)/2;var P=T*T/(r*r)+A*A/(s*s);if(P>1){P=d.sqrt(P);r=P*r;s=P*s}var R=r*r,z=s*s,O=(l==c?-1:1)*d.sqrt(v((R*z-R*A*A-z*T*T)/(R*A*A+z*T*T))),b=O*r*A/s+(e+p)/2,S=O*-s*T/r+(i+h)/2,D=d.asin(((i-S)/s).toFixed(9)),L=d.asin(((h-S)/s).toFixed(9));D=e<b?m-D:D;L=p<b?m-L:L;D<0&&(D=m*2+D);L<0&&(L=m*2+L);if(c&&D>L){D=D-m*2}if(!c&&L>D){L=L-m*2}}else{D=u[0];L=u[1];b=u[2];S=u[3]}var M=L-D;if(v(M)>_){var N=L,w=p,F=h;L=D+_*(c&&L>D?1:-1);p=b+r*d.cos(L);h=S+s*d.sin(L);g=x(p,h,r,s,o,0,c,w,F,[L,N,b,S])}M=L-D;var V=d.cos(D),H=d.sin(D),k=d.cos(L),U=d.sin(L),B=d.tan(M/4),$=4/3*r*B,Y=4/3*s*B,X=[e,i],G=[e+$*H,i-Y*V],Z=[p+$*U,h-Y*k],j=[p,h];G[0]=2*X[0]-G[0];G[1]=2*X[1]-G[1];if(u){return[G,Z,j][n](g)}else{g=[G,Z,j][n](g).join()[a](",");var W=[];for(var q=0,K=g.length;q<K;q++){W[q]=q%2?y(g[q-1],g[q],f).y:y(g[q],g[q+1],f).x}return W}};var D=function(e,t){var i=O(e),r=t&&O(t),o={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},a={x:0,y:0,bx:0,by:0,X:0,Y:0,qx:null,qy:null},l=function(e,t){var i,r;if(!e){return["C",t.x,t.y,t.x,t.y,t.x,t.y]}!(e[0]in{T:1,Q:1})&&(t.qx=t.qy=null);switch(e[0]){case"M":t.X=e[1];t.Y=e[2];break;case"A":e=["C"][n](x[s](0,[t.x,t.y][n](e.slice(1))));break;case"S":i=t.x+(t.x-(t.bx||t.x));r=t.y+(t.y-(t.by||t.y));e=["C",i,r][n](e.slice(1));break;case"T":t.qx=t.x+(t.x-(t.qx||t.x));t.qy=t.y+(t.y-(t.qy||t.y));e=["C"][n](S(t.x,t.y,t.qx,t.qy,e[1],e[2]));break;case"Q":t.qx=e[1];t.qy=e[2];e=["C"][n](S(t.x,t.y,e[1],e[2],e[3],e[4]));break;case"L":e=["C"][n](b(t.x,t.y,e[1],e[2]));break;case"H":e=["C"][n](b(t.x,t.y,e[1],t.y));break;case"V":e=["C"][n](b(t.x,t.y,t.x,e[1]));break;case"Z":e=["C"][n](b(t.x,t.y,t.X,t.Y));break}return e},c=function(e,t){if(e[t].length>7){e[t].shift();var s=e[t];while(s.length){e.splice(t++,0,["C"][n](s.splice(0,6)))}e.splice(t,1);_=u(i.length,r&&r.length||0)}},h=function(e,t,n,s,o){if(e&&t&&e[o][0]==="M"&&t[o][0]!=="M"){t.splice(o,0,["M",s.x,s.y]);n.bx=0;n.by=0;n.x=e[o][1];n.y=e[o][2];_=u(i.length,r&&r.length||0)}};for(var d=0,_=u(i.length,r&&r.length||0);d<_;d++){i[d]=l(i[d],o);c(i,d);r&&(r[d]=l(r[d],a));r&&c(r,d);h(i,r,o,a,d);h(r,i,a,o,d);var v=i[d],f=r&&r[d],m=v.length,g=r&&f.length;o.x=v[m-2];o.y=v[m-1];o.bx=p(v[m-4])||o.x;o.by=p(v[m-3])||o.y;a.bx=r&&(p(f[g-4])||a.x);a.by=r&&(p(f[g-3])||a.y);a.x=r&&f[g-2];a.y=r&&f[g-1]}return r?[i,r]:i};var L=null;var M=function(e,i){if(!L){L=t.func(D)}return L(e,i)};var N={};N.getPercentagePath=function(e,t,i){if(!e||!t){return""}var r=M(String(e),String(t));var n=r[0];var s=r[1];var o=[];for(var a=0,l=n.length;a<l;a++){o[a]=[n[a][0]];for(var c=1,p=n[a].length;c<p;c++){o[a][c]=n[a][c]+(s[a][c]-n[a][c])*i/100}}return P(o)};N.svg=function(e,t,n,s){if(n&&t&&t.localName=="path"&&(!e||e.localName=="path")){var o=t.getAttribute("d");if(o&&o.length>1){var a;if(r.get(t,i.MORPHER_DISABLE_PATH)===true){a=n.getAttribute("d");if(o!==a){n.setAttribute("d",o)}}else{var l="";if(e){l=e.getAttribute("d")}if(!l){var c=o.match(T);if(c.length>0){l=c[0]}else{l="M0,0"}}a=N.getPercentagePath(l,o,s);n.setAttribute("d",a)}}}};return N});e("sap/viz/controls/chart/morph/utils/TransformParser",[],function(){var e={};var t=function(e){return e.replace(/^\s*/,"").replace(/\s*$/,"")};e.parse=function(e){var i=[];var r=[];var n=[];if(e){var s;if(e.indexOf("rotate(")>=0){var o=e.substring(e.indexOf("rotate("));o=o.substring("rotate(".length,o.indexOf(")"));o=t(o);var a=[];if(o.indexOf(",")>0){a=o.split(",")}else{a=o.split(" ")}for(var l=0;l<a.length&&i.length<3;l++){s=t(a[l]);if(s!==""){s=parseFloat(s);if(isNaN(s)){s=0}i.push(s)}}if(i.length<3){i[1]=0;i[2]=0}}if(e.indexOf("translate(")>=0){var c=e.substring(e.indexOf("translate("));c=c.substring("translate(".length,c.indexOf(")"));c=t(c);var p=[];if(c.indexOf(",")>0){p=c.split(",")}else{p=c.split(" ")}for(var h=0;h<p.length&&r.length<2;h++){s=t(p[h]);if(s!==""){s=parseFloat(s);if(isNaN(s)){s=0}r.push(s)}}if(r.length<2){r[1]=0}}if(e.indexOf("scale(")>=0){var d=e.substring(e.indexOf("scale("));d=d.substring("scale(".length,d.indexOf(")"));d=t(d);var u=[];if(d.indexOf(",")>0){u=d.split(",")}else{u=d.split(" ")}for(var _=0;_<u.length&&n.length<2;_++){s=t(u[_]);if(s!==""){s=parseFloat(s);if(isNaN(s)){s=0}n.push(s)}}if(n.length<2){n[1]=0}}}return{rotate:i.length>0?i:null,translate:r.length>0?r:null,scale:n.length>0?n:null}};return e});e("sap/viz/controls/chart/morph/morphers/TransformMorpher",["sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/SVGShapeMetadata","sap/viz/controls/chart/morph/utils/TransformParser"],function(e,t,i){var r={};r.applyTransform=function(e,t,i,r,n){var s=e+(i-e)*n/100;var o=t+(r-t)*n/100;return"translate("+s+","+o+")"};r.svg=function(r,n,s,o,a){if(s&&n){var l="";if(r){var c=i.parse(r.getAttribute("transform"));var p=i.parse(n.getAttribute("transform"));if(a){if(c.translate||p.translate){if(!c.translate){c.translate=[0,0]}if(!p.translate){p.translate=[0,0]}l+=(l?" ":"")+"translate("+(c.translate[0]+(p.translate[0]-c.translate[0])*o/100)+","+(c.translate[1]+(p.translate[1]-c.translate[1])*o/100)+")"}}else{var h=t.get(r,e.SHAPE_GLOBAL_TRANSLATE_X)||0;var d=t.get(r,e.SHAPE_GLOBAL_TRANSLATE_Y)||0;var u=t.get(n,e.SHAPE_GLOBAL_TRANSLATE_X)||0;var _=t.get(n,e.SHAPE_GLOBAL_TRANSLATE_Y)||0;var v=h+(u-h)*o/100;var f=d+(_-d)*o/100;l+=(l?" ":"")+"translate("+v+","+f+")"}if(c.rotate||p.rotate){if(!c.rotate){c.rotate=[0,0,0]}if(!p.rotate){p.rotate=[0,0,0]}l+=(l?" ":"")+"rotate("+(c.rotate[0]+(p.rotate[0]-c.rotate[0])*o/100)+","+(c.rotate[1]+(p.rotate[1]-c.rotate[1])*o/100)+","+(c.rotate[2]+(p.rotate[2]-c.rotate[2])*o/100)+")"}if(c.scale||p.scale){if(!c.scale){c.scale=[0,0]}if(!p.scale){p.scale=[0,0]}l+=(l?" ":"")+"scale("+(c.scale[0]+(p.scale[0]-c.scale[0])*o/100)+","+(c.scale[1]+(p.scale[1]-c.scale[1])*o/100)+")"}s.setAttribute("transform",l)}}};return r});e("sap/viz/controls/chart/morph/morphers/TextMorpher",["sap/viz/controls/chart/morph/morphers/TransformMorpher"],function(e){var t={};var i=function(e,t){var i=parseInt(e.getAttribute(t),10);return isNaN(i)?0:i};var r=function(e,t){var i=parseFloat(e.getAttribute(t));return isNaN(i)?0:i};var n=/(\d+)(in|cm|mm|pt|pc|em|ex|px)/i;var s=function(e,t,i){var r=n.exec(e);if(!r){r=[e,e,""]}var s=parseInt(r[1],10);var o=r[2];var a=n.exec(t);if(!a){a=[t,t,""]}var l=parseInt(a[1],10);var c=a[2];var p=s;switch(o){case"pt":p=p*1.33;break;case"px":p=p;break;default:p=p}switch(c){case"pt":p=p/1.33;break;case"px":p=p;break;default:p=p}return String(Math.round(p+(l-p)*i/100))+c};t.svg=function(t,i,n,o){if(n&&i.localName==="g"&&i.firstChild&&i.firstChild.localName==="text"){if(t&&t.localName==="g"&&t.firstChild&&t.firstChild.localName==="text"){var a=r(t.firstChild,"x");var l=r(i.firstChild,"x");var c=r(t.firstChild,"y");var p=r(i.firstChild,"y");n.firstChild.setAttribute("x",a+(l-a)*o/100);n.firstChild.setAttribute("y",c+(p-c)*o/100);var h=t.getAttribute("font-size");var d=i.getAttribute("font-size");if(h&&d&&h!=d){var u=s(h,d,o);n.setAttribute("font-size",u)}e.svg(t.firstChild,i.firstChild,n.firstChild,o,true)}else if(!t){n.setAttribute("opacity",o/100)}}};return t});e("sap/viz/controls/chart/morph/VizMorpher",["jquery","sap/viz/controls/chart/morph/constant/MorphConst","sap/viz/controls/chart/morph/utils/Utils","sap/viz/controls/chart/morph/utils/SVGShapeMetadata","sap/viz/controls/chart/morph/vo/VizShape","sap/viz/controls/chart/morph/vo/VizShapesHolder","sap/viz/controls/chart/morph/viz/MpShapesCapturer","sap/viz/controls/chart/morph/viz/MpShapesMapper","sap/viz/controls/chart/morph/morphers/ColorMorpher","sap/viz/controls/chart/morph/morphers/RectMorpher","sap/viz/controls/chart/morph/morphers/LineMorpher","sap/viz/controls/chart/morph/morphers/PathMorpher","sap/viz/controls/chart/morph/morphers/TextMorpher","sap/viz/controls/chart/morph/morphers/TransformMorpher"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u){var _=function(e,t){this._vizDiv=e;this._morphDiv=t;this._currentVizType="";this._currentVizShapesHolder=new s;this._tween=null};_.prototype.resetMorphSvg=function(){var e=f(this._vizDiv);var t=e.width();var i=e.height();var r=f(this._morphDiv);r.empty();var n=f(document.createElement("DIV"));n.css("overflow","hidden").appendTo(r).width(t).height(i);var s=e.find("svg");if(s.length>0){n.attr("class","vc-morph-svg-host "+s.parent().attr("class"))}return d3.select(n.get(0)).append("svg").attr("width",t).attr("height",i).node()};_.prototype.getCurrentVizType=function(){return this._currentVizType};_.prototype.isPlaying=function(){return this._tween!==null};_.prototype.showMorphing=function(e,t){var i=f(this._morphDiv);var r=f(this._vizDiv);if(e){i.css("display","")}else{i.css("display","none")}if(t){r.css("visibility","visible")}else{r.css("visibility","hidden")}};_.prototype.morphVizType=function(e,t,r){t=i.isNumber(t)?t:1e3;e=i.isString(e)?e:this.getCurrentVizType();var n=f(this._vizDiv);var s=f(this._morphDiv);if(this._tween){this._tween.stop(true,false);this._tween=null;n.css("visibility","visible");s.css("display","none")}var l=o.getShapes(n.get(0));var c=v(l);var p=c&&t>0;if(c){a.map(l,this._currentVizShapesHolder,e,this._currentVizType);var h=l.allByOrder();var d=this.resetMorphSvg();if(p){n.css("visibility","hidden");s.css("display","");m(d,h,0);var u=this;this._startMorphShapes(h,t,function(){n.css("visibility","visible");s.css("display","none");if(u._tween){u._tween.stop(true,false)}u._tween=null;if(i.isFunction(r)){r.call(null)}})}else{m(d,h,100);this._tween=null;n.css("visibility","visible");s.css("display","none");if(i.isFunction(r)){r.call(null)}}}else{l.empty();this.resetMorphSvg();this._tween=null;n.css("visibility","visible");s.css("display","none");if(i.isFunction(r)){r.call(null)}}this._currentVizType=e;this._currentVizShapesHolder=l};var v=function(e){var t=e.toShapesBySvgType();if(t["all"].length>e.backgrounds.length){if(t["path"]&&t["path"].length>200){return false}if(t["rect"]&&t["rect"].length>300){return false}if(t["all"].length>400){return false}return true}return false};_.prototype._startMorphShapes=function(t,i,r){this._tween=e({percentage:1});this._tween.animate({percentage:100},{duration:i,easing:"swing",step:function(){var e=this.percentage;g(t,e)},complete:function(){r()}})};var f=function(t){if(i.isString(t)){if(t.indexOf("#")!==0){return e("#"+t)}}return e(t)};var m=function(e,t,i){i=i?i:0;for(var n=0;n<t.length;n++){var s=t[n];var o=s.from;var a=s.to;if(a){var l=s.display=a.cloneNode(true);r.clone(l,a);if(i!==100){E(o,a,l,i)}e.appendChild(l)}}};var g=function(e,t){for(var i=0;i<e.length;i++){var r=e[i];var n=r.from;var s=r.to;var o=r.display;E(n,s,o,t)}};var E=function(e,t,i,r){c.svg(e,t,i,r);p.svg(e,t,i,r);h.svg(e,t,i,r);l.svg(e,t,i,r);d.svg(e,t,i,r);u.svg(e,t,i,r)};_.prototype.testDrawShapes=function(e,t){var i=f(this._vizDiv);var r=f(this._morphDiv);var n=o.getShapes(i.get(0));a.map(n,this._currentVizShapesHolder,e,this._currentVizType);var s=n.allByOrder();var l=this.resetMorphSvg();m(l,s,t);this._currentVizType=e;this._currentVizShapesHolder=n};return _});e("sap/viz/controls/chart/views/PropertyZone",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/EventDispatcher"],function(e,t,i,r,n){var s=function(t,i){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.DropZone";this._targetDiv=t;this._zoneProvider=i;this._selectedZone$=null;var r="position:absolute;visibility:hidden;left:0px;top:0px;width:0px;height:0px;";this._dom=e(document.createElement("DIV")).appendTo(this._targetDiv.parentNode).attr("style",r)};i.extend(s,n);s.SELECT_ZONE="SELECT_ZONE_EVENT";s.prototype._createZones=function(){this._targetRect=this._targetDiv.getBoundingClientRect();var e="position:absolute;left:0px;top:0px;width:"+this._targetRect.width+"px;height:"+this._targetRect.height+"px;";this._dom.empty().attr("style",e);var t=this._zoneProvider();for(var i=0;i<t.length;i++){var r=t[i].bound;for(var n=0;n<r.length;n++){this._createZone(this._dom[0],r[n],t[i].name)}}};s.prototype._createZone=function(i,r,n){var s=e(document.createElement("DIV"));var o=r[0][0],a=r[0][1],l=r[2][0]-r[0][0],c=r[2][1]-r[0][1];var p="left:"+o+"px;top:"+a+"px;width:"+l+"px;height:"+c+"px;";s.attr("style",p).addClass(t.CHART_PREFIX+"property-zone").appendTo(i);s.get(0).__name=n;s.click(e.proxy(this._selectZone,this))};s.prototype._selectZone=function(i){var n=e(i.target);if(this._selectedZone$!==n){if(this._selectedZone$){this._selectedZone$.removeClass(t.CHART_PREFIX+"property-zone-selected")}this._selectedZone$=n;this._selectedZone$.addClass(t.CHART_PREFIX+"property-zone-selected");var o={propertyZoneName:this._selectedZone$.get(0).__name};this._dispatchEvent(new r(s.SELECT_ZONE,this,o))}};s.prototype.updateZone=function(e){if(e){this._createZones();this._dom.css("visibility","")}else{this._dom.css("visibility","hidden")}};s.prototype.size=function(e){if(e){this._dom.css({width:e.width+"px",height:e.height+"px"})}};return s});e("sap/viz/controls/LanguageLoader",[],function(){sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_COMMON_BAR_TEXT:"Bar Chart",VIZ_COMMON_COLUMN_TEXT:"Column Chart",VIZ_COMMON_STACKED_BAR_TEXT:"Stacked Bar Chart",VIZ_COMMON_STACKED_COLUMN_TEXT:"Stacked Column Chart",VIZ_COMMON_DUAL_BAR_TEXT:"Bar Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COLUMN_TEXT:"Column Chart With 2 Y-Axes",VIZ_COMMON_3D_BAR_TEXT:"3D Bar Chart",VIZ_COMMON_3D_COLUMN_TEXT:"3D Column Chart",VIZ_COMMON_LINE_TEXT:"Line Chart",VIZ_COMMON_AREA_TEXT:"Area Chart",VIZ_COMMON_COMBINATION_TEXT:"Combined Column Line Chart",VIZ_COMMON_DUAL_LINE_TEXT:"Line Chart With 2 Y-Axes",VIZ_COMMON_DUAL_COMBINATION_TEXT:"Combined Column Line Chart With 2 Y-Axes",VIZ_COMMON_PIE_TEXT:"Pie Chart",VIZ_COMMON_DONUT_TEXT:"Donut Chart",VIZ_COMMON_PIE_WITH_DEPTH_TEXT:"Pie With Variable Slice Depth",VIZ_COMMON_GEOBUBBLE_TEXT:"Geographic Bubble Chart",VIZ_COMMON_CHOROPLETH_TEXT:"Geo Choropleth Chart",VIZ_COMMON_GEOPIE_TEXT:"Geo Pie Chart",VIZ_COMMON_GEOMAP_TEXT:"Geo Map",VIZ_COMMON_SCATTER_TEXT:"Scatter Plot",VIZ_COMMON_BUBBLE_TEXT:"Bubble Chart",VIZ_COMMON_SCATTER_MATRIX_TEXT:"Scatter Matrix Chart",VIZ_COMMON_TREEMAP_TEXT:"Tree Map",VIZ_COMMON_HEATMAP_TEXT:"Heat Map",VIZ_COMMON_TABLE_TEXT:"Table",VIZ_COMMON_CROSSTAB_TEXT:"Crosstab",VIZ_COMMON_RADAR_TEXT:"Radar Chart",VIZ_COMMON_BOXPLOT_TEXT:"Box Plot",VIZ_COMMON_WATERFALL_TEXT:"Waterfall Chart",VIZ_COMMON_TAGCLOUD_TEXT:"Tag Cloud",VIZ_COMMON_MEASURES:"MEASURES",VIZ_COMMON_DIMENSIONS:"DIMENSIONS",VIZ_COMMON_SUBTOTALS:"SUBTOTALS",VIZ_COMMON_ANIMATION:"Animation",VIZ_COMMON_TRELLIS:"TRELLIS",VIZ_COMMON_XAXIS:"X Axis",VIZ_COMMON_YAXIS:"Y Axis",VIZ_COMMON_PRIMARY_YAXIS:"Y Axis1",VIZ_COMMON_SECONDARY_YAXIS:"Y Axis2",VIZ_COMMON_PRIMARY_XAXIS:"X Axis1",VIZ_COMMON_SECONDARY_XAXIS:"X Axis2",VIZ_COMMON_PIE_SECTORS:"Pie Sectors",VIZ_COMMON_PIE_DEPTH:"Pie Depth",VIZ_COMMON_FEATUREVALUES:"Value",VIZ_COMMON_BUBBLE_WIDTH:"Bubble Width",VIZ_COMMON_BUBBLE_HEIGHT:"Bubble Height",VIZ_COMMON_RECTANGLECOLOR:"Area Color",VIZ_COMMON_RECTANGLEWEIGHT:"Area Weight",VIZ_COMMON_REGIONCOLOR:"Legend Color",VIZ_COMMON_GEO_FEATURES:"Geography",VIZ_COMMON_GEO_COLOR:"Color",VIZ_COMMON_FEATUREANALYSIS:"Overlay Data",VIZ_COMMON_REGIONSHAPE:"Legend Shape",VIZ_COMMON_AREANAME:"Area Name",VIZ_COMMON_SECONDARY_AREANAME:"Area Name2",VIZ_COMMON_RADAR_AXES:"Radar Branches",VIZ_COMMON_TAGWEIGHT:"Word Weight",VIZ_COMMON_TAGFAMILY:"Word Color",VIZ_COMMON_TAGNAME:"Word",VIZ_COMMON_COLUMNS:"Columns",VIZ_COMMON_ROWS:"Rows",VIZ_COMMON_TABLE_DIMENSION:"Rows Axis",VIZ_COMMON_TABLE_MEASURE:"Primary Values",VIZ_COMMON_TABLE_ROWS_SUBTOTALS:"Rows Subtotals",VIZ_COMMON_TABLE_COLUMNS_AXIS:"Columns Axis",VIZ_COMMON_TABLE_COLUMNS_SUBTOTALS:"Columns Subtotals",VIZ_COMMON_LEGEND:"Legend",VIZ_COMMON_DIMENSION_LIMITATION_WARN:"You have reached the maximum number of dimension feeds for this visualization.",VIZ_COMMON_CHANGE_CALCULATION:"Change Calculation",VIZ_COMMON_SUM:"Sum",VIZ_COMMON_AVERAGE:"Average",VIZ_COMMON_MIN:"Min",VIZ_COMMON_MAX:"Max",VIZ_COMMON_COUNT_DISTINCT:"Count-Distinct",VIZ_COMMON_COUNT_ALL:"Count-All",VIZ_COMMON_NONE:"None",VIZ_COMMON_SUM_SHORT:"(Sum)",VIZ_COMMON_AVERAGE_SHORT:"(Avg)",VIZ_COMMON_MIN_SHORT:"(Min)",VIZ_COMMON_MAX_SHORT:"(Max)",VIZ_COMMON_COUNT_DISTINCT_SHORT:"(Cnt-Dis)",VIZ_COMMON_COUNT_ALL_SHORT:"(Cnt-All)",VIZ_COMMON_NONE_SHORT:"(None)",VIZ_COMMON_TOTAL_OF:"Total of",VIZ_COMMON_SUM_OF:"Sum of",VIZ_COMMON_AVERAGE_OF:"Average of",VIZ_COMMON_COUNT_OF:"Count of",VIZ_COMMON_MIN_OF:"Minimum of",VIZ_COMMON_MAX_OF:"Maximum of",VIZ_COMMON_EDIT:"Edit",VIZ_COMMON_DELETE:"Delete",VIZ_COMMON_DELETE_COMMENT_MESSAGE:"Are you sure to delete the comment?",VIZ_COMMON_DONT_SHOW_MESSAGE:"Don't show this again",VIZ_COMMON_OK:"OK",VIZ_COMMON_CANCEL:"Cancel",VIZ_COMMON_BETWEEN:"BETWEEN",VIZ_COMMON_SEARCH:"Search",VIZ_COMMON_FAKE_DIMENSION:"Fake Dimension",VIZ_COMMON_FAKE_MEASURE:"Fake Measure",VIZ_COMMON_SERIALIZATION_FAILED:"Serialization error",VIZ_COMMON_INVALID_SERIALIZATION_PACKAGE:"Invalid serialization package",VIZ_COMMON_DEPENDENCY_ERROR:"Please include {0} when use {1}.",VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG:"Please include {0} when use {1} with {2}."}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_BUILDER_CHART:"TYPE:",VIZ_BUILDER_BUILD:"Build"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_ANNOTATION_COMMENT:"Comment"}});sap.viz.extapi.env.Language.register({id:"dev",value:{}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_CHART_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more measures or dimensions.",VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more geography dimensions.",VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more measures.",VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION:"Incomplete chart. Please add more dimensions.",VIZ_CHART_CREATE_CHART_FAILED:"Failed to create chart:",VIZ_CHART_UPDATE_CHART_FAILED:"Failed to update chart:",VIZ_CHART_UPDATE_DATA_FAILED:"Failed to update chart data:",VIZ_CHART_UPDATE_FEEDING_FAILED:"Failed to update chart feeding:",VIZ_CHART_UPDATE_CSS_FAILED:"Failed to update chart css:",VIZ_CHART_UPDATE_PROPERTIES_FAILED:"Failed to update chart properties:",VIZ_CHART_ADD_EVENT_FAILED:"Failed to add chart event callback:",VIZ_CHART_REMOVE_EVENT_FAILED:"Failed to remove chart event callback:",VIZ_CHART_SELECTION_FAILED:"Failed to get/set chart selection:",VIZ_CHART_FEEDINGZONE_FAILED:"Failed to get chart feedingzone:",VIZ_CHART_DESCRIPTION_FAILED:"Failed to get/set chart description:",VIZ_CHART_TRIGGER_ACTION_FAILED:"Failed to trigger chart action:",VIZ_CHART_SERIALIZE_FAILED:"Failed to serialize chart:",VIZ_CHART_VIZINSTANCE_NOT_CREATED:"VizInstance is not created.",VIZ_CHART_INVALID_VIZ_TYPE:"Cannot display this chart: {0}.",VIZ_CHART_TRELLIS_DISABLED_WARN:"The trellis is disabled in either Viz Frame or Feeding Panel.",VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER:"No data matches your filter(s)",VIZ_CHART_NEGATIVE_VALUES_WARN:"Negative values are not shown in this Bubble chart",VIZ_CHART_NEGATIVE_VALUES_INFO:"To display negative values, click the Settings button and select Show Negative Values from the contextual menu.",VIZ_CHART_TITLE_TEXT_JOIN_BY:"{0} by {1}",VIZ_CHART_TITLE_TEXT_JOIN_AND:"and",VIZ_CHART_TITLE_CONTEXT_MENU_EDIT:"Rename",VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE:"Restore Default Title",VIZ_CONTROLS_API_PARAMETER_ERROR:"API parameter error.",VIZ_CHART_EXPORTSVG_FAILED:"Failed to export to svg string.",VIZ_CHART_SET_AXIS_RANGE:"Set axis range",VIZ_CHART_AXIS_ZOOM:"Zoom",VIZ_CHART_XAXIS_RANGE:"X Axis Range",VIZ_CHART_XAXIS1_RANGE:"X Axis1 Range",VIZ_CHART_XAXIS2_RANGE:"X Axis2 Range",VIZ_CHART_YAXIS_RANGE:"Y Axis Range",VIZ_CHART_YAXIS1_RANGE:"Y Axis1 Range",VIZ_CHART_YAXIS2_RANGE:"Y Axis2 Range",VIZ_CHART_AUTO_RANGE:"Automatic",VIZ_CHART_FIXED_RANGE:"Fixed",VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_CHART_NEXT:"Next",VIZ_CHART_SELECT_DATASET:"Select data set",VIZ_CHART_SET_COLOR_LAYER:"Set color to feature layer",VIZ_CHART_RESET:"Reset",VIZ_CHART_SEGMENTED:"Segmented",VIZ_CHART_GRADIENT:"Gradient",VIZ_CHART_BACK:"Back",VIZ_CHART_CONFIRM:"Confirm",VIZ_CHART_ESRI_MAP_LOADING:"Loading Esri Map",VIZ_CHART_ESRI_MAP_LOG_ON:"Logging in to Esri now",VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL:"Esri Authentication Fail",VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE:"An unknown error has occurred while accessing ESRI online services. Check your internet connection",VIZ_CHART_START:"Start",VIZ_CHART_END:"End",VIZ_CHART_NO_ESRI_SERVICE:"No feature service found under your account."}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_CONTEXTMENU_SHOW_LEGEND:"Show Legend",VIZ_CONTEXTMENU_SHOW_DATALABELS:"Show Data Labels",VIZ_CONTEXTMENU_NORMAL_STACKING:"Normal Stacking",VIZ_CONTEXTMENU_FULL_STACKING:"100% Stacking",VIZ_CONTEXTMENU_HORIZONTAL:"Horizontal",VIZ_CONTEXTMENU_VERTICAL:"Vertical",VIZ_CONTEXTMENU_INSERT_COMMENT:"Insert Comment...",VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR:"Choose Legend Item Colors...",VIZ_CONTEXTMENU_MENU_CHART_EDITOR:"Chart Editor...",VIZ_CONTEXTMENU_SHOW_MND:"Use Measures as a Dimension",VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP:"Creates a new dimension with all the measures in the chart. The values are spread on a single axis, or separate charts for a trellis chart.",VIZ_CONTEXTMENU_NO_MENU_ITEMS:"No available items",VIZ_CONTEXTMENU_SHOW_TITLE:"Show Title",VIZ_CONTEXTMENU_SET_AXIS_SCALE:"Set Axis Scale",VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES:"Show Negative Values",VIZ_CONTEXTMENU_CREATE_SUBTOTALS:"Create Subtotals",VIZ_CONTEXTMENU_SHOW_BEFORE_ROWS:"Show Subtotals Below Rows",VIZ_CONTEXTMENU_SHOW_ABOVE_ROWS:"Show Subtotals Above Rows",VIZ_CONTEXTMENU_CALCULATE_ROWS_TOTALS_FIRST:"Calculate Rows Totals First"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_CUSTOMBUTTON_SETTINGS:"Settings",VIZ_CUSTOMBUTTON_MAXIMIZE:"Maximize",VIZ_CUSTOMBUTTON_RESTORE_DOWN:"Restore Down"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_FRAME_FILTERMENU_FILTER:"Filter",VIZ_FRAME_FILTERMENU_EXCLUDE:"Exclude",VIZ_FRAME_FILTERBAR_DESCRIPTION:"Select fields from the Data Set to filter.",VIZ_FRAME_CHART_EDITOR:"Chart Editor"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_MAPBUILDER_VIZ_LAYER_NAME:"Layer",VIZ_MAPBUILDER_BASE_MAP_NAME:"base map",VIZ_MAPBUILDER_ADD_NEW_LAYER:"Add Layer",VIZ_MAPBUILDER_RENAME:"Rename",VIZ_MAPBUILDER_DELETE:"Delete layer",VIZ_MAPBUILDER_HIDE:"Hide",VIZ_MAPBUILDER_SHOW:"Show",VIZ_MAPBUILDER_MOVEUP:"Move up",VIZ_MAPBUILDER_MOVEDOWN:"Move down",VIZ_MAPBUILDER_DELETE_GEO_LAYER:"Delete Geo Layer",VIZ_MAPBUILDER_OK:"Ok",VIZ_MAPBUILDER_CANCEL:"Cancel",VIZ_MAPBUILDER_DATA_POINTS:"Data Point Type",VIZ_MAPBUILDER_CHOROPLETH:"choropleth",VIZ_MAPBUILDER_BUBBLE:"bubble",VIZ_MAPBUILDER_MARKER:"marker",VIZ_MAPBUILDER_TYPE:"type",VIZ_MAPBUILDER_GEO:"Geo Dimension",VIZ_MAPBUILDER_GEO_LOCATION:"Geo Location",VIZ_MAPBUILDER_GEO_COLOR:"Color",VIZ_MAPBUILDER_GEO_SIZE:"Size",VIZ_MAPBUILDER_MEASURES:"Color",VIZ_MAPBUILDER_PROPERTIES:"PROPERTIES",VIZ_MAPBUILDER_SHOW_LEGEND:"show legend",VIZ_MAPBUILDER_MARKER_CLUSTER:"Cluster adjacent markers",VIZ_MAPBUILDER_BUBBLE_CLUSTER:"Cluster adjacent bubbles",VIZ_MAPBUILDER_MAP:"MAP",VIZ_MAPBUILDER_PROVIDERS:"Providers",VIZ_MAPBUILDER_STYLES:"STYLES",VIZ_MAPBUILDER_ESRI_MAP_STYLE_MAP:"Map",VIZ_MAPBUILDER_ESRI_MAP_STYLE_SATELLITE:"Satellite",VIZ_MAPBUILDER_ESRI_MAP_STYLE_TERRAIN:"Terrain",VIZ_MAPBUILDER_ESRI_MAP_STYLE_STREETS:"Streets",VIZ_MAPBUILDER_NOT_SUPPORT_ERROR:"Not Support Yet.",VIZ_MAPBUILDER_IMPORT_ESRI_CUSTOM_SERVICE:"Import Esri Custom Service",VIZ_MAPBUILDER_ESRI_CUSTOM_SERVICE:"Esri Custom Service"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_FILTERBAR_ADD_FILTERS:"Add filters.",VIZ_FILTERBAR_CLEAR_FILTERS:"Clear filters",VIZ_FILTERBAR_READONLY_FILTER:"Read-only filter"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_FILTERBAR_DESCRIPTION:"Add filters.",VIZ_FILTERBAR_GLOBAL_FILTER:"Global Filter:",VIZ_FILTERBAR_ITEMS_EXCLUDED:"items excluded",VIZ_FILTERBAR_ITEMS_INCLUDED:"items included"}});sap.viz.extapi.env.Language.register({id:"dev",value:{}});sap.viz.extapi.env.Language.register({id:"dev",value:{PROPERTY_EDITOR_TITLE_PLACE_HOLDER:"Properties",PROPERTY_EDITOR_TITLE_PREFIX:"Properties of {0}",PROPERTY_EDITOR_GENERAL:"General",PROPERTY_EDITOR_SHOW_LEGEND:"Show Legend",PROPERTY_EDITOR_XAXIS:"X Axis",PROPERTY_EDITOR_SHOW_AXIS:"Show Axis",PROPERTY_EDITOR_SHOW_AXIS_TITLE:"Show Axis Title",PROPERTY_EDITOR_SHOW_AXIS_LABEL:"Show Axis Labels",PROPERTY_EDITOR_XAXIS2:"Secondary X Axis",PROPERTY_EDITOR_YAXIS:"Y Axis",PROPERTY_EDITOR_YAXIS2:"Secondary Y Axis",PROPERTY_EDITOR_ZAXIS:"Z Axis",PROPERTY_EDITOR_VALUE_AXIS:"Value Axis",PROPERTY_EDITOR_POLAR_AXIS:"Polar Axis",PROPERTY_EDITOR_ROW_AXIS:"Row Axis",PROPERTY_EDITOR_COLUMN_AXIS:"Column Axis",PROPERTY_EDITOR_SHOW_AXIS_LINE:"Show Axis Line and Ticker",PROPERTY_EDITOR_SHOW_AXIS_IMAGE:"Show Axis Pictograms",PROPERTY_EDITOR_SIZE_OF_ALL_IMAGES:"Size of All Pictograms",PROPERTY_EDITOR_HEIGHT_OF_AXIS_AREA:"Height of Axis Area",PROPERTY_EDITOR_WIDTH_OF_AXIS_AREA:"Width of Axis Area",PROPERTY_EDITOR_SHAPE_STYLE:"Shape Style",PROPERTY_EDITOR_BACKGROUND_COLOR:"Background Color",PROPERTY_EDITOR_POSITION:"Position",PROPERTY_EDITOR_POSITION_OUTSIDE_END:"Outside End",PROPERTY_EDITOR_POSITION_INSIDE_END:"Inside End",PROPERTY_EDITOR_POSITION_CENTER:"Center",PROPERTY_EDITOR_CHART_AREA:"Chart Area",PROPERTY_EDITOR_CHART_TITLE:"Chart Title",PROPERTY_EDITOR_PLOT_AREA:"Plot Area",PROPERTY_EDITOR_GRID_LINE:"Gridline",PROPERTY_EDITOR_LEGEND:"Legend",PROPERTY_EDITOR_HORIZONTAL_AXIS:"Horizontal Axis",PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE:"Horizontal Axis Title",PROPERTY_EDITOR_VERTICAL_AXIS:"Vertical Axis",PROPERTY_EDITOR_VERTICAL_AXIS_TITLE:"Vertical Axis Title",PROPERTY_EDITOR_COLUMN_DATA_POINT:"Column",PROPERTY_EDITOR_BAR_DATA_POINT:"Bar",PROPERTY_EDITOR_SERIES:"Series",PROPERTY_EDITOR_MARKER:"Marker",PROPERTY_EDITOR_DATA_LABELS:"Data Labels",PROPERTY_EDITOR_DATA_LABEL:"Data Label",PROPERTY_EDITOR_DONUT_INNER_CIRCLE:"Inner Circle",PROPERTY_EDITOR_DONUT_DATA_POINT:"Slice",PROPERTY_EDITOR_DONUT_DATA_POINT_SLICE_COLOR:"Slice Color",PROPERTY_EDITOR_DONUT_DATA_POINT_HIGHLIGHT:"Highlight the Slice",PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_NAME:"Show Name",PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_PERCENTAGE:"Show Percentage",PROPERTY_EDITOR_DONUT_DATA_POINT_OTHER_SLICE_COLOR:"Other Slices' Color",PROPERTY_EDITOR_LINE:"Line",PROPERTY_EDITOR_SHOW_CHART_TITLE:"Show Chart Title",PROPERTY_EDITOR_SHOW_DATA_LABEL:"Show Data Labels",PROPERTY_EDITOR_SHOW_DATA_LABEL_IMAGE:"Show Data Label Pictograms",PROPERTY_EDITOR_DATA_LABEL_IMAGE_SIZE:"Size of All Pictograms",PROPERTY_EDITOR_VALUE_AXIS_MAX_VALUE:"Value Axis Maximum",PROPERTY_EDITOR_SHOW_LEGEND_TITLE:"Show Legend Title",PROPERTY_EDITOR_SHOW_GRIDLINE:"Show Gridlines",PROPERTY_EDITOR_THICKNESS:"Thickness",PROPERTY_EDITOR_COLOR:"Color",PROPERTY_EDITOR_COLORPICKER_MORE:"More...",PROPERTY_EDITOR_COLORPICKER_NOCOLOR:"No Color",PROPERTY_EDITOR_COLORPICKER_RECENTCOLORS:"Recent Colors",PROPERTY_EDITOR_MARKER_SHAPE:"Marker Pictogram",PROPERTY_EDITOR_SIZE_OF_ALL_MARKERS:"Size of All Markers",PROPERTY_EDITOR_TITLE_POSITION:"Position",PROPERTY_EDITOR_TITLE_POSITION_TOP:"Top",PROPERTY_EDITOR_TITLE_POSITION_BOTTOM:"Bottom",PROPERTY_EDITOR_LINE_LINE_COLOR:"Line Color",PROPERTY_EDITOR_LINE_LINE_THICKNESS:"Line Thickness",PROPERTY_EDITOR_LINE_LINE_STYLE:"Line Style",PROPERTY_EDITOR_HEIGHT:"Height",PROPERTY_EDITOR_WIDTH:"Width",PROPERTY_EDITOR_LAYOUT:"Layout",PROPERTY_EDITOR_CLASSIC_LAYOUT:"Classic Layout",PROPERTY_EDITOR_LEAN_LAYOUT:"Lean Layout",FORMAT_PICKER_DECIMAL:"Decimal Places",FORMAT_PICKER_DISPLAY_NUMBER:"Display As Number",FORMAT_PICKER_DISPLAY_PERCENT:"Display As Percentage",FORMAT_PICKER_SHOW_SEP:"Show 1000 Separator (,)",FORMAT_PICKER_SHOW_BY_UNIT:"Show by KMBT",FORMAT_PICKER_UNIT_AUTO:"Auto",FORMAT_PICKER_UNIT_K:"K",FORMAT_PICKER_UNIT_M:"M",FORMAT_PICKER_UNIT_B:"B",FORMAT_PICKER_UNIT_T:"T",NUMBERCHART_SHOW_TITLE:"Show Title",NUMBERCHART_TITLE_NAME:"Title",NUMBERCHART_VALUE_NAME:"Value",PROPERTY_EDITOR_PSPICKER_PREFIX:"Prefix",PROPERTY_EDITOR_PSPICKER_SUFFIX:"Suffix",PROPERTY_EDITOR_AXIS_VALUE_SCALE:"Axis Value Scale"}});sap.viz.extapi.env.Language.register({id:"dev",value:{VIZ_SWITCHBAR_BAR_COLUMN_CHARTS:"Bar & Column Charts",VIZ_SWITCHBAR_COLUMN_CHARTS:"Column Charts",VIZ_SWITCHBAR_LINE_CHARTS:"Line Charts",VIZ_SWITCHBAR_PIE_CHARTS:"Pie Charts",VIZ_SWITCHBAR_GEO_CHARTS:"Geographic Charts",VIZ_SWITCHBAR_SCATTER_CHARTS:"Scatter Charts",VIZ_SWITCHBAR_MAP_CHARTS:"Map Charts",VIZ_SWITCHBAR_TABLES:"Tables",VIZ_SWITCHBAR_OTHER_CHARTS:"Other Charts",VIZ_SWITCHBAR_NUMBER_CHARTS:"Point Charts"}});sap.viz.extapi.env.Language.register({id:"dev",value:{}});sap.viz.extapi.env.Language.register({id:"dev",value:{}})});e("sap/viz/controls/TemplateLoader",[],function(){(function(){var e="#333333";var t={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var r={dataLoading:false,dataUpdating:false,resizing:false};var n={color:e,gridline:{color:e},enableLabelSelection:false};var s={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var o={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var a={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},zAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i,rotate:{enableRotate:false}};var l={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},zAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i,rotate:{enableRotate:false}};var c={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var p={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var h={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:r,tooltipVisble:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var d={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{marker:{visible:false},animation:r},rowAxis:n,columnAxis:n,background:t,interaction:i};var u={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},tooltipVisble:false,animation:r},rowAxis:n,columnAxis:n,background:t,interaction:i};var _={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{line:{marker:{visible:false}},animation:r},rowAxis:n,columnAxis:n,background:t,interaction:i};var v={xAxis:{color:e,label:{visible:true},gridline:{visible:false},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},sizeLegend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var f={xAxis:{color:e,label:{visible:true},gridline:{visible:false},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var m={xAxis:{color:e,label:{visible:true},axisline:{visible:true},gridline:{visible:false},enableLabelSelection:false},plotArea:{animation:r},multiLayout:{plotTitle:{visible:false}},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};var g={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};var E={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};var y={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};var I={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var C={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var T={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i,rotate:{enableRotate:false}};var A={plotArea:{animation:r},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i,rotate:{enableRotate:false}};var P={title:{visible:false},tooltip:{visible:false},legend:{visible:false},plotArea:{polarAxis:{title:{visible:false}},valueAxis:{visible:true},animation:r},rowAxis:n,columnAxis:n,background:t,interaction:i};var R={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var z={yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var O={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var b={yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var S={yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},xAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var x={xAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},plotArea:{animation:r},yAxis:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},yAxis2:{color:e,label:{visible:true},axisline:{visible:true},enableLabelSelection:false},title:{visible:false},tooltip:{visible:false},legend:{visible:false},rowAxis:n,columnAxis:n,background:t,interaction:i};var D={plotArea:{animation:r,draggable:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};var L={plotArea:{animation:r,clickAble:false,label:{visible:false}},title:{visible:false},tooltip:{visible:false},legend:{visible:false},background:t,interaction:i};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",name:"Incomplete Ghost",version:"4.0.0",properties:{"viz/bar":o,"viz/image_bar":o,"viz/multi_bar":o,"viz/dual_bar":o,"viz/multi_dual_bar":o,"viz/column":s,"viz/multi_column":s,"viz/dual_column":s,"viz/multi_dual_column":s,"viz/stacked_bar":c,"viz/multi_stacked_bar":c,"viz/dual_stacked_bar":c,"viz/multi_dual_stacked_bar":c,"viz/100_stacked_bar":c,"viz/multi_100_stacked_bar":c,"viz/100_dual_stacked_bar":c,"viz/multi_100_dual_stacked_bar":c,"viz/stacked_column":p,"viz/multi_stacked_column":p,"viz/dual_stacked_column":p,"viz/multi_dual_stacked_column":p,"viz/100_stacked_column":p,"viz/multi_100_stacked_column":p,"viz/100_dual_stacked_column":p,"viz/multi_100_dual_stacked_column":p,"riv/cbar":s,"viz/stacked_column":p,"viz/multi_stacked_column":p,"viz/3d_bar":a,"viz/3d_column":l,"viz/combination":_,"viz/horizontal_combination":u,"viz/dual_combination":_,"viz/dual_horizontal_combination":u,"viz/boxplot":R,"viz/horizontal_boxplot":z,"viz/waterfall":O,"viz/horizontal_waterfall":b,"viz/stacked_waterfall":O,"viz/horizontal_stacked_waterfall":b,"viz/line":d,"viz/multi_line":d,"viz/dual_line":d,"viz/multi_dual_line":d,"viz/horizontal_line":h,"viz/multi_horizontal_line":h,"viz/dual_horizontal_line":h,"viz/multi_dual_horizontal_line":h,"viz/area":d,"viz/multi_area":d,"viz/100_area":d,"viz/multi_100_area":d,"viz/horizontal_area":h,"viz/multi_horizontal_area":h,"viz/100_horizontal_area":h,"viz/multi_100_horizontal_area":h,"viz/pie":I,"viz/multi_pie":I,"viz/donut":C,"viz/multi_donut":C,"viz/pie_with_depth":T,"viz/donut_with_depth":A,"viz/bubble":v,"viz/multi_bubble":v,"viz/scatter":f,"viz/multi_scatter":f,"viz/scatter_matrix":m,"viz/radar":P,"viz/multi_radar":P,"viz/tagcloud":y,"viz/heatmap":g,"viz/treemap":E,"viz/mekko":S,"viz/100_mekko":S,"viz/horizontal_mekko":x,"viz/100_horizontal_mekko":x,"viz/network":D,"viz/tree":L,"viz/number":{plotArea:{valuePoint:{label:{fontColor:"#000000"}}}}}})})();(function(){var e="#333333";var t={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false};var r={dataLoading:false,dataUpdating:false};var n={color:e,gridline:{color:e},label:{visible:false}};var s={plotArea:{animation:r},title:{visible:false},legend:{visible:false},sizeLegend:{visible:false},background:t,interaction:i,rowAxis:n,columnAxis:n,geoController:{disableInteraction:true}};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/geobubble":s,"viz/geopie":s,"viz/choropleth":s,"viz/multi_geobubble":s,"viz/multi_choropleth":s}})})();var e="#333333";var t={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var r={title:{visible:false},legend:{visible:false},background:t,interaction:i};var n={title:{visible:false},legend:{visible:false},background:t};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":r,"viz/ext/pa/pc":n},css:"\t\t.v-m-main .v-background-body{fill:;}\t\t svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}\t\t.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}\t    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}\t   .axistext{fill: #333333; cursor : move;}\t"});var e="#333333";var t={border:{left:{visible:false},right:{visible:false},top:{visible:false},bottom:{visible:false}}};var i={selectability:{mode:"none"},enableMouseOver:false,enableMouseOut:false,enableMouseMove:false,enableHover:false};var r={title:{visible:false},legend:{visible:false},background:t,interaction:i};var n={title:{visible:false},legend:{visible:false},background:t};sap.viz.extapi.env.Template.register({id:"incomplete_ghost",properties:{"viz/ext/pa/funnel":r,"viz/ext/pa/pc":n},css:"\t\t.v-m-main .v-background-body{fill:;}\t\t svg {font-family:Tahoma,Arial,Helvetica,sans-serif;font-size:12px;}\t\t.axis line{fill: none;stroke: #333333;shape-rendering: crispEdges;}\t    .axis path{fill: none;stroke: #333333;shape-rendering: crispEdges;}\t   .axistext{fill: #333333; cursor : move;}\t"})});e("sap/viz/controls/chart/views/WarningView",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/managers/LangManager"],function(e,t,i,r,n,s,o,a){var l=function(e,t){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.NegativeValuesView";this._createChildren()};t.extend(l,r);l.prototype._createChildren=function(){this._confirmDialog$=e(document.createElement("div"));this._confirmDialog$.addClass(s.CHART_PREFIX+"warning");this._container$=e(document.createElement("div"));e(document.createElement("div")).appendTo(this._container$).addClass(s.CHART_PREFIX+"warning-separator");var t=e(document.createElement("div")).appendTo(this._container$).addClass(s.CHART_PREFIX+"warning-title");var i=e(document.createElement("div")).appendTo(t);i.addClass(s.CHART_PREFIX+"warning-title-icon");var r=e(document.createElement("span")).appendTo(t).text(a.get("VIZ_CHART_NEGATIVE_VALUES_WARN"));r.addClass(s.CHART_PREFIX+"warning-title-text");var n=e(document.createElement("div")).appendTo(this._container$).addClass(s.CHART_PREFIX+"warning-info");var o=e(document.createElement("span")).appendTo(n).text(a.get("VIZ_CHART_NEGATIVE_VALUES_INFO"));o.addClass(s.CHART_PREFIX+"warning-info-text");var l=e(document.createElement("div")).appendTo(this._container$);l.addClass(s.CHART_PREFIX+"warning-delete-icon");l.addClass(s.COMMON_PREFIX+"UVBSharedSprite");l.click(e.proxy(function(e){this.hide()},this));this._confirmDialog$.append(this._container$);this._blockLayout$=e(document.createElement("div"));this._blockLayout$.addClass(s.CHART_PREFIX+"block-layer")};l.prototype.show=function(t,i,r){this._visible=true;var n=this._dom$.offset().left+this._dom$.width()/2;var s=this._dom$.offset().top+this._dom$.height()/2;e(document.body).append(this._blockLayout$);e(document.body).append(this._confirmDialog$);this._confirmDialog$.css({position:"absolute",left:n-this._confirmDialog$.width()/2,top:s-this._confirmDialog$.height()/2});this._container$.css({display:"block"})};l.prototype.hide=function(){this._visible=false;this._blockLayout$.detach();this._confirmDialog$.detach()};return l});e("sap/viz/controls/chart/views/View",["jquery","sap/viz/controls/LanguageLoader","sap/viz/controls/TemplateLoader","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/MapProviderConst","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/DatasetUtil","sap/viz/controls/common/utils/TrellisUtils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/UIControl","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/DropZone","sap/viz/controls/chart/views/WarningView","sap/viz/controls/chart/ChartConfig","sap/viz/controls/common/utils/IncompleteGhost","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/AnalyticalType"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T){var A=function(t,i,r,n,s){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.View";this._div=t;this._chartHolder$=null;this._chartLayer$=null;this._descriptionLayer$=null;this._loadingIcon$=null;this._chartModelProvider=n;this._helper=s;this._options=i;this._cssCache=null;this._libFolderPath=r;var o=sap.viz.api.env.Resource.path("sap.viz.geo.geographicInfo.localStorage.resourcePath");this._geoResourcePath=o?o:this._libFolderPath+"/sap.viz.geo/geocharts/resources/data/geo/";this._enableTrellis=true;this._enableMorphing=true;this._enablePropertyZone=false;this._hasChartInstance=false;this._size={width:A.DEFAULT_VIZ_WIDTH,height:A.DEFAULT_VIZ_HEIGHT};this._padding=24;this._chart=null;this._onEventMap={};this._isFeedsValid=false;this._templateId=A.TEMPLATE_DEFAULT;this._mouseDownHandler=e.proxy(function(t){if(document.activeElement&&document.activeElement.tagName&&document.activeElement.tagName.toLowerCase()!="body"&&!e.contains(this._dom$[0],document.activeElement)&&e.contains(this._dom$.parent()[0],t.target)){document.activeElement.blur()}},this);e(document).on("mousedown",this._mouseDownHandler);this._changeTemplateFunc=e.proxy(this.changeTemplate,this);sap.viz.extapi.env.Template.addListener(this._changeTemplateFunc)};c.extend(A,f);A.DEFAULT_VIZ_WIDTH=380;A.DEFAULT_VIZ_HEIGHT=280;A.TEMPLATE_DEFAULT="default";A.TEMPLATE_INCOMPLETE="incomplete_ghost";A.TEMPLATE_EMPTY="empty_ghost";A.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog()};A.prototype._createChartHolder=function(){this._chartHolder$=e(document.createElement("div")).addClass([v.PREFIX+"chart-holder",v.COMMON_PREFIX+"scrollable"].join(" "));this._chartHolder$.appendTo(e(this._div));this._chartHolder$.css({position:"relative"})};A.prototype._createChartLayer=function(){this._chartLayer$=e(document.createElement("div")).addClass(v.PREFIX+"chart-layer");this._chartLayer$.appendTo(this._chartHolder$);this._chartLayer$.css({position:"absolute"})};A.prototype._createDescriptionLayer=function(){this._descriptionLayer$=e(document.createElement("div")).addClass(v.PREFIX+"chart-description");this._descriptionLayer$.css({position:"absolute"});this._descriptionLayer$.appendTo(this._chartHolder$)};A.prototype._createLoadingIcon=function(){this._loadingIcon$=e(document.createElement("div")).addClass(v.CHART_PREFIX+"loading-icon");this._loadingIcon$.appendTo(this._chartHolder$);this._loadingIcon$.css({width:this._chartHolder$.width()+"px",height:this._chartHolder$.height()+"px"})};A.prototype._createWarningDialog=function(){this._warningView=new E(this._chartHolder$.get(0),null)};A.prototype._showWarningDialog=function(){this._warningView.show()};A.prototype._createDropZone=function(){var t=this._chartLayer$;this._dropZone=new g(t.get(0),e.proxy(this._getFeedingZone,this),e.proxy(this._dropZoneFeedValidator,this));this._dropZone.addEventListener(g.DROP_ITEM_EVENT,this._dropItemHandler,this)};A.prototype._getFeedingZone=function(){if(!this._chart){return[]}try{return this._chart.feedingZone()}catch(e){return[]}};A.prototype._dropZoneFeedValidator=function(e,t,i){var r=this._chartModelProvider().explicitFeedingItems();var n=e.id===a.MultiplierFeedingName;if(n){var s=this._chartModelProvider().type();if(!h.isMultipleChart(s)&&h.supportMultiChart(s)){var o=h.toMultiChartType(s);var l=a.getManifestFeedsMap(o);var c=a.supportMultiChart(r,l);if(!c){return false}}}return a.canAddFeed(r,e,t,i)};A.prototype._dropItemHandler=function(e){this._dispatchEvent(new m(m.ANALYSIS_DROPPED,this,e.data))};A.DISPATCH_PROPERTY_EVENT="dispatchPropertyEvent";A.prototype.modelChanged=function(e,t){};A.prototype._getMinSize=function(){return this._size};A.prototype._setChartSize=function(e,t){if(this._chart){this._chart.size({width:e,height:t})}};A.prototype._updateChartSize=function(e){var t=this._getMinSize();var i=t.width;var r=t.height;var n={width:this._size.width+"px",height:this._size.height+"px","overflow-x":t["overflow-x"]||"","overflow-y":t["overflow-y"]||""};if(e){this._setChartSize(i,r)}this._chartLayer$.css({width:i+"px",height:r+"px",visibility:"visible",display:""});this._chartHolder$.css(n);return t};A.prototype.updateDescription=function(e){this._destroyChartInstance();this._updateDescription(e,true)};A.prototype._updateDescription=function(e,t){if(arguments.length<=0){var i=this._options.type;var r=this._options.feeding;if(!this._enableTrellis&&h.isMultipleChart(i)){e=l.get("VIZ_CHART_TRELLIS_DISABLED_WARN")}else if(!this._isFeedsValid){e=R(i,r,this._chartModelProvider().feedingItems())}}if(e){if(this._descriptionLayer$){this._descriptionLayer$.show();this._descriptionLayer$.text(e)}this._showDescription()}else{if(this._descriptionLayer$){this._descriptionLayer$.hide();this._descriptionLayer$.text("")}this._chartHolder$.css({opacity:""})}this.hideLoadingIcon()};function P(e,t,i,r){for(var n=0;n<t.length;n++){if(t[n].type()===i){for(var s=0;s<e.length;s++){if(t[n].id()===e[s].id){if(t[n].id()!=="geoFeatures"&&!r||t[n].id()==="geoFeatures"&&r){if(!e[s].minStackedDims){if(t[n].values().length<e[s].min){return false}}else{if(t[n].values().length<e[s].minStackedDims){return false}}}}}}}return true}function R(e,t,i){var r=l.get("VIZ_CHART_INCOMPLETE_DESCRIPTION");var n=a.getVizFeeds(e);var s=true;var c=true;var p;for(p=0;p<n.length;p++){if(!c&&!s){break}if(c&&n[p].type===o.DIMENSION){c=false;continue}if(s&&n[p].type===o.MEASURE){s=false}}if(s){r=l.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION");return r}if(c){r=l.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION");return r}if(!t){return r}var h=P(n,i,o.MEASURE,false);var d=P(n,i,o.DIMENSION,false);var u=P(n,i,o.DIMENSION,true);if(u){if(!h&&d){r=l.get("VIZ_CHART_MEASURE_INCOMPLETE_DESCRIPTION")}if(h&&!d){r=l.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION")}}else{if(h&&d){r=l.get("VIZ_CHART_GEO_INCOMPLETE_DESCRIPTION")}if(h&&!d){r=l.get("VIZ_CHART_DIMENSION_INCOMPLETE_DESCRIPTION")}}return r}A.prototype._showDescription=function(){this._chartHolder$.css({opacity:".3"});if(this._descriptionLayer$){this._descriptionLayer$.css({width:this._size.width+"px",height:this._size.height/2+50+"px",color:"black","font-size":"28px","text-align":"center",top:this._size.height/2-50+"px","word-wrap":"break-word"})}};A.prototype._destroyChartInstance=function(){if(this._chart){this._offEvent();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:destroy_cvom_chart_instance");this._chart.destroy();this._chart=null;this._hasChartInstance=false;sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:destroy_cvom_chart_instance")}};A.prototype._updateDescriptionByOptions=function(e){if(h.isEmptyData(e.type,e.data)){var t=l.get("VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER");this._updateDescription(t);e.data=I.getDataset(e.type);this._chartLayer$.css("opacity","0")}else{this._updateDescription();this._updateChartSize(false);this._chartLayer$.css("opacity","")}};A.prototype._createChartInstance=function(){};A.prototype.getTemplateId=function(e){if(arguments.length>0){return this._templateId}else{return sap.viz.api.env.Template.get()}};A.prototype._getTemplateId=function(e){var t=sap.viz.api.env.Template.get();if(t!==A.TEMPLATE_INCOMPLETE&&t!==A.TEMPLATE_EMPTY){this._templateId=t}this._isFeedsValid=!_.hasFakeData(e);t=this._isFeedsValid?this._templateId:A.TEMPLATE_INCOMPLETE;return t};A.prototype.showLoadingIcon=function(){};A.prototype.hideLoadingIcon=function(){this._loadingIcon$.css({display:""})};A.prototype.hasChartInstance=function(){return this._hasChartInstance};A.prototype.exportable=function(){return false};A.prototype.size=function(e){if(arguments.length>0){this._size={width:e.width,height:e.height};this._updateChartSize(true);var t=this._descriptionLayer$;if(t!==null&&t.length>0){t.css({width:this._size.width+"px",height:this._size.height/2+50+"px",top:this._size.height/2-50+"px"})}this._loadingIcon$.css({width:this._size.width+"px",height:this._size.height+"px"});return this}return{width:this._size.width,height:this._size.height}};A.prototype.changeTemplate=function(){var e=sap.viz.api.env.Template.get();if(e!==A.TEMPLATE_INCOMPLETE&&e!==A.TEMPLATE_EMPTY&&e!==this._templateId){var t=this._getTemplateId(this._options.data);if(t===e){this._requestMorphing=true;this._createChartInstance();this._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this))}}};A.prototype.create=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-create");if(e){this._options=e;this._requestMorphing=true;var t=this._getTemplateId(e.data);this.__templateId=t;var i=this;sap.viz.api.env.Template.set(t,function(){if(i.__templateId===t){i._createChartInstance()}});this._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this))}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-create")};A.prototype.destroy=function(){e(document).off("mousedown",this._mouseDownHandler);this.removeAllEventListeners();this._onEventMap={};if(this._chart){this._chart.destroy();this._chart=null}e(this._div).empty();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc)};A.prototype.data=function(e){var t;try{if(arguments.length>0){this._options.data=e;if(this._chart){if(h.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new m(m.CHART_CHANGING,this));this._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this));t=l.get("VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER");this._updateDescription(t);this._requestMorphing=false;this._options.data=I.getDataset(this._options.type);this._chartLayer$.css("opacity","0")}else{this._updateDescription();this._chartLayer$.css("opacity","")}this._chart.data(this._options.data);return this}else{t=l.get("VIZ_CHART_UPDATE_CHART_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED");this._updateDescription(t);throw t}}else{if(this._chart){return this._chart.data()}else{return this._options.data}}}catch(e){t=l.get("VIZ_CHART_UPDATE_CHART_FAILED")+e;this._updateDescription(t);throw t}};A.prototype.feeding=function(e){if(arguments.length>0){this._options.feeding=e;return this}else{return this._options.feeding}};A.prototype.css=function(e){if(arguments.length>0){this._options.css=e;return this}else{return this._options.css}};A.prototype.getValidProperties=function(e,t){return _.getValidProperties(e,t)};A.prototype.properties=function(e){if(arguments.length>0){this._options.properties=e;return this}else{return this._options.properties}};A.prototype.update=function(e,t){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-update");if(!e){return}if(!t){this._requestMorphing=true}if(e.css){this._updateCssCacheByNewCss(e.css);this._options.css=e.css}if(e.feeding){this._options.feeding=e.feeding}if(e.data){this._options.data=e.data}if(e.properties){this._options.properties=e.properties}var i;try{if(this._chart){var r=false;if(e.properties&&e.properties.plotArea&&e.properties.plotArea.showNegativeValues===true){r=true}if(!r&&this._chart.type&&d.hasNegativeMeasureValue(e.data,this._chart.type)){this._showWarningDialog()}this._updateDescription();if(h.isEmptyData(this._options.type,this._options.data)){this._dispatchEvent(new m(m.CHART_CHANGING,this));this._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this));i=l.get("VIZ_CHART_NO_DATA_MATCHES_YOUR_FILTER");this._updateDescription(i);this._requestMorphing=false;e.data=I.getDataset(this._options.type);e.feeding=null;this._chartLayer$.css("opacity","0")}else{this._chartLayer$.css("opacity","")}this._updateChartSize(true);this._chart.update(e);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-update");return this}else{i=l.get("VIZ_CHART_UPDATE_CHART_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED");this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-update");throw i}}catch(e){i=l.get("VIZ_CHART_UPDATE_CHART_FAILED")+e;this._updateDescription(i);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-update");throw i}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-update")};A.prototype.on=function(e,t){try{if(this._chart){if(arguments.length>0){this._chart.on(e,t)}}this._onEventMap[e]=t;return this}catch(e){throw l.get("VIZ_CHART_ADD_EVENT_FAILED")+e}};A.prototype.off=function(e){try{if(this._chart){if(arguments.length>0){this._chart.off(e)}}delete this._onEventMap[e];return this}catch(e){throw l.get("VIZ_CHART_REMOVE_EVENT_FAILED")+e}};A.prototype.selection=function(e,t){try{if(this._chart){if(this._options.type===n.TYPE_TREE||this._options.type===n.TYPE_TABLE||this._options.type===n.TYPE_CROSSTAB){return null}if(arguments.length>=2){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView_selection-set");this._chart.selection(e,t);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView_selection-set");return this}else if(arguments.length===1){if(p.isArray(arguments[0])){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView_selection-set");this._chart.selection(arguments[0]);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView_selection-set");return this}else{return this._chart.selection(arguments[0])}}else{return this._chart.selection()}}else{if(arguments.length>=2){throw l.get("VIZ_CHART_SELECTION_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}else if(arguments.length===1){if(p.isArray(arguments[0])){throw l.get("VIZ_CHART_SELECTION_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}else{return null}}else{return null}}}catch(e){throw l.get("VIZ_CHART_SELECTION_FAILED")+e}};A.prototype.feedingZone=function(){return[]};A.prototype.description=function(e){try{if(arguments.length>0){if(this._chart){this._chart.description(e);return this}else{throw l.get("VIZ_CHART_DESCRIPTION_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.description()}else{return null}}}catch(e){throw l.get("VIZ_CHART_DESCRIPTION_FAILED")+e}};A.prototype.action=function(e,t){try{if(this._chart){if(arguments.length>0){return this._chart.action(e,t)}}else{throw l.get("VIZ_CHART_TRIGGER_ACTION_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw l.get("VIZ_CHART_TRIGGER_ACTION_FAILED")+e}};A.prototype.exportViz=function(e){if(this._chart){var t=this._chart.toJSON(e);if(t){t.properties=this._options.properties;this._updateCssOfOptions();t.css=this._options.css}return t}else{throw l.get("VIZ_CHART_SERIALIZE_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};A.prototype.loadViz=function(e){this.create(e)};A.prototype.enableTrellis=function(e){if(arguments.length>0){this._enableTrellis=e!==false;return this}else{return this._enableTrellis}};A.prototype.enableMorphing=function(e){if(arguments.length>0){this._enableMorphing=e!==false;return this}else{return this._enableMorphing}};A.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._enablePropertyZone!==e){this._enablePropertyZone=e===true}return this}else{return this._enablePropertyZone}};A.prototype.getTitleByFeeding=function(){var e="";var t=[];var i=[];var r=this._chartModelProvider().feedingItems();for(var n=0;n<r.length;n++){var s=r[n];if(s._id===o.ROW_SUBTOTALS||s._id===o.COLUMNS_SUBTOTALS){continue}var a=s.values();var c=s.type()===o.MEASURE?t:i;for(var h=0;h<a.length;h++){var d=a[h];if(d.id()===T.MND){continue}var u=d.selectedHierarchyLevel();var _=u?u.name():d.name();c.push(_)}}var v=A._getNames(t);var f=A._getNames(i);if(v!==""&&f!==""){e=p.substitute(l.get("VIZ_CHART_TITLE_TEXT_JOIN_BY"),v,f)}else if(v!==""){e=v}else if(f!==""){e=f}if(e==""){e=" "}return e};A._getNames=function(e){var t="";for(var i=0;i<e.length;i++){var r=e[i];t+=r;if(i+2===e.length){t+=" "+l.get("VIZ_CHART_TITLE_TEXT_JOIN_AND")+" "}else if(i+2<e.length){t+=", "}}return t};A.prototype.resetProperties=function(e,t){return e};A.prototype.copyData=function(e,t){return p.clone(t)};A.prototype.buildFeedings=function(e,t,i){return null};A.prototype.supportUpdate=function(e){return true};A.prototype.setPropertyZones=function(e){};A.prototype.FeedsToJSON=function(e){return C.toJSON(e)};A.prototype.save=function(){};A.prototype.load=function(e,t){};A.prototype.FeedsFromJSON=function(e){var t=C.fromJSON(e);return t};A.prototype.exportToSVGString=function(e){if(this._chart){return this._chart.exportToSVGString(e)}else{throw l.get("VIZ_CHART_EXPORTSVG_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};A.prototype.supportExportToSVG=function(){if(this._chart){return this._chart.supportExportToSVG()}else{throw l.get("VIZ_CHART_EXPORTSVG_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};A.prototype.getPropertyZones=function(){return[]};A.prototype.getZoneName=function(e){};A.prototype.setAxisScale=function(e){};A.prototype.getDataPointsPosition=function(e){return[]};A.prototype.updateProperties=function(e){};A.prototype._updateCssCache=function(e,t,i){if(!this._cssCache){this._updateCssCacheByOptions()}this._cssCache=this._cssCache||{};this._cssCache[e]=this._cssCache[e]||{};this._cssCache[e][t]=i};A.prototype._updateCssCacheByOptions=function(){if(this._options&&this._options.css){this._updateCssCacheByCssString(this._options.css)}};A.prototype._updateCssCacheByNewCss=function(e){if(!this._cssCache){this._updateCssCacheByOptions()}this._updateCssCacheByCssString(e)};A.prototype._updateCssCacheByCssString=function(e){if(!e){return}this._cssCache=this._cssCache||{};var t=e.split("}");var i,r,n,s=[],o,a,l,c,p,h,d;for(i=0;i<t.length;i++){n=t[i];s=n.split("{");if(s.length===2){o=s[0].trim();a=s[1];l=a.split(";");this._cssCache[o]=this._cssCache[o]||{};for(r=0;r<l.length;r++){c=l[r];p=c.split(":");if(p.length===2){h=p[0].trim();d=p[1];this._cssCache[o][h]=d}}}}};A.prototype._updateCssOfOptions=function(){if(!this._cssCache){return}var e="",t,i,r;for(t in this._cssCache){if(this._cssCache.hasOwnProperty(t)){e+=" "+t+"{";for(i in this._cssCache[t]){if(this._cssCache[t].hasOwnProperty(i)){e+=i+":"+this._cssCache[t][i]+";"}}e+="}"}}if(e!==""){this._options.css=this._options.css?this._options.css+e:e}};A.prototype.cssProperty=function(e,t,i){if(this._chart){if(arguments.length>2){this._updateCssCache(e,t,i);return this._chart.cssProperty(e,t,i)}else if(arguments.length===2){return this._chart.cssProperty(e,t)}}return this};A.prototype.selectedPropertyZone=function(e){if(this._chart){if(arguments.length>0){return this._chart.selectedPropertyZone(e)}else{return this._chart.selectedPropertyZone()}}return this};A.prototype.onEventMap=function(e){if(arguments.length>0){this._onEventMap=e;return this}else{return this._onEventMap}};A.prototype._postVizProcess=function(t){if(!!this._chart.on){Object.keys(this._onEventMap).forEach(e.proxy(function(e){var t=this._onEventMap[e];this._chart.on(e,t)},this))}};A.prototype._offEvent=function(){if(!!this._chart.off){Object.keys(this._onEventMap).forEach(e.proxy(function(e){var t=this._onEventMap[e];this._chart.off(e,t)},this))}};A.prototype._getCssProperties=function(e,t){var i=null;for(var r=0;r<t.length;++r){var n=this._chart.cssProperty(e,t[r]);if(n!=null){i=i||{};i[t[r]]=n}}return i};A.prototype.queryProperties=function(e){if(!e||!e.css){return this.properties()}var t=e.css.properties;var i=e.css.selector;var r=null;if(p.isArray(i)){for(var n=0;n<i.length;++n){r=this._getCssProperties(i[n],t);if(r){break}}}else{r=this._getCssProperties(i,t)}return r};A.prototype.updateProperties=function(e){if(!e){return}if(e.css&&e.css.selector){var t;var i=e.css.selector;var r=e.css.value;var n=r.split("font-size");if(n.length===2){n[1]=n[1].replace(/;/,"!important;");r=n.join("font-size")}if(p.isArray(i)){t="";for(var s=0;s<i.length;++s){t+=i[s]+r}}else{t=i+r}this._helper.vizCss(t)}else if(e.hasOwnProperty("properties")){this._helper.vizProperties(e.properties)}};return A});e("sap/viz/controls/common/property/VizPropertyZone",["sap/viz/controls/common/utils/Utils"],function(e){var t=function(t,i,r,n){this._type=t;this._context=i;this._extraContext=r;this._measureNames=n;if(e.isArray(n)){this._dimensionContext=this._filterDimensionContext(n.concat("_id"))}};t.CHART_AREA="CHART_AREA";t.CHART_TITLE="CHART_TITLE";t.PLOT_AREA="PLOT_AREA";t.GRID_LINE="GRID_LINE";t.LEGEND="LEGEND";t.X_AXIS="X_AXIS";t.X_AXIS_TITLE="X_AXIS_TITLE";t.Y_AXIS="Y_AXIS";t.Y_AXIS_TITLE="Y_AXIS_TITLE";t.DATA_POINT="DATA_POINT";t.DATA_LABEL="DATA_LABEL";t.LINE="LINE";t.prototype.type=function(e){if(arguments.length>0){this._type=e;return this}else{return this._type}};t.prototype.context=function(t){if(arguments.length>0){this._context=t;if(e.isArray(this._measureNames)){this._dimensionContext=this._filterDimensionContext(this._measureNames.concat("_id"))}return this}else{return this._context}};t.prototype.getDimensionContext=function(){if(this._selectAllData){return undefined}if(this._seriesData){for(var e in this._seriesData){if(this._seriesData.hasOwnProperty(e)){return this._seriesData}}return undefined}return this._dimensionContext};t.prototype._filterDimensionContext=function(e){var t;for(var i in this._context){if(!t){t={}}var r=true;for(var n=0;n<e.length;n++){if(i===e[n]){e.splice(n,1);r=false;break}}if(!r){continue}t[i]=this._context[i]}return t};t.prototype.extraContext=function(e){if(arguments.length>0){this._extraContext=e;return this}else{return this._extraContext}};t.prototype.stackContext=function(e){if(arguments.length>0){this._stackContext=e;return this}else{return this._stackContext}};t.prototype.seriesContext=function(e){if(arguments.length>0){this._seriesData=e;return this}else{return this._seriesData}};t.prototype.selectAllData=function(e){if(arguments.length>0){this._selectAllData=e;return this}else{return this._selectAllData}};return t});e("sap/viz/controls/chart/views/ChartView",["jquery","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/MapProviderConst","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/DatasetUtil","sap/viz/controls/common/utils/TrellisUtils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/chart/views/AxisSizeAdjustHelper","sap/viz/controls/chart/views/AxisSplitter","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/DataPointFinder","sap/viz/controls/chart/views/DropZone","sap/viz/controls/chart/views/EditAxisView","sap/viz/controls/chart/morph/VizMorpher","sap/viz/controls/chart/ChartConfig","sap/viz/controls/chart/views/PropertyZone","sap/viz/controls/chart/views/View","sap/viz/controls/common/utils/IncompleteGhost","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/property/VizPropertyZone"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A,P,R){var z=function(e,t,i,r){z.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.ChartView";this._morphingLayer$=null;this._supportMorphing=true;this._requestMorphing=false;this._vizMorpher=null;t=t||{};this._enablePropertyZone=false;this._useBuiltInPropertyZoneInteraction=t.useBuiltInPropertyZoneInteraction;this._useDefaultChartSizeForTrellis=t.useDefaultChartSizeForTrellis;this._createChildren()};a.extend(z,T);var O=["legend","sizeLegend"];z.prototype._createChildren=function(){this._createChartHolder();this._createChartLayer();this._editAxisView=new E(this._chartHolder$.get(0),null);this._editAxisView.addEventListener(E.AxisScaleChanged,this._axisScalerChangedHandler,this);this._axisSplitter=new v(this._chartHolder$.get(0),e.proxy(this.properties,this),e.proxy(this._getPropertyZone,this));this._axisSplitter.addEventListener(v.AxisSplitChanged,this._axisSplitChangedHandler,this);this._morphingLayer$=e(document.createElement("div")).addClass(u.PREFIX+"morphing-layer");this._morphingLayer$.appendTo(this._chartHolder$);this._morphingLayer$.css({position:"absolute"});this._createDescriptionLayer();this._createLoadingIcon();this._createWarningDialog();this._createDropZone();var t=this._chartLayer$;this._propertyZone=new C(t.get(0),e.proxy(this._getPropertyZone,this));this._propertyZone.addEventListener(C.SELECT_ZONE,e.proxy(function(e){this._dispatchEvent(new f(f.SELECT_PROPERTY_ZONE,this,e.data))},this));this._uxScaleIndex=null};z.prototype.getZoneName=function(e){if(!e||!this._chart){return null}var t=this._getZoneName(e);if(t){if(d.isValueAxis(this._chart.type,t)){return t}else{for(var i=0;i<O.length;i++){if(O[i]===t){return t}}}}return null};z.prototype._getZoneName=function(e){var t=this._getPropertyZone();for(var i=0;i<t.length;i++){var r=t[i].bound;var n=t[i].name;for(var s=0;s<r.length;s++){if(r[s][0][0]<e.x&&r[s][1][0]>e.x&&r[s][1][1]<e.y&&r[s][2][1]>e.y){return n}}}return null};z.prototype.setAxisScale=function(e){if(this._chart){var t=this._chart.type;this._editAxisView.show(t,this._chart.properties(),e)}};z.prototype._axisScalerChangedHandler=function(e){if(!this._chart){return}this._helper.vizProperties(e.data)};z.prototype._axisSplitChangedHandler=function(e){var t=_(this._chart,e.data.axisName,e.data.offset);if(t){this._helper.vizProperties(t)}};z.prototype._titleText=function(e){try{if(this._chart){if(!this.properties().title){return this}if(arguments.length>0){if(e!=this.properties().title.text)this._dispatchEvent(new f(f.TITLE_CHANGED,this,{text:e}));return this}else{var t=this.properties().title.text;return t}}else{throw o.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+o.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw o.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+e}};z._ZoneMap={xAxis:{text:"VIZ_COMMON_XAXIS"},xAxis2:{text:"VIZ_COMMON_XAXIS"},yAxis:{text:"VIZ_COMMON_YAXIS",rotate:true},yAxis2:{text:"VIZ_COMMON_YAXIS",rotate:true}};z._ZoneMap[s.trillisFeeds.column.id]={text:"VIZ_COMMON_COLUMNS"};z._ZoneMap[s.trillisFeeds.row.id]={text:"VIZ_COMMON_ROWS",rotate:true};z.prototype._isEmptyZone=function(e){if(!e||!e.bound){return true}var t=e.bound[0];if(!t){return true}var i=t[2][0]-t[0][0];var r=t[2][1]-t[0][1];if(i<1||r<1){return true}return false};z.prototype._updateTextInfo=function(e){if(!e){return}for(var t=0;t<e.length;t++){var i=z._ZoneMap[e[t].name];if(i){e[t].text=o.get(i.text);e[t].rotate=i.rotate}}};z.prototype.getTitleZone=function(){if(!this._chart){return[]}var e=this._chart.type;var t;try{t=this._chart.propertyZone()}catch(e){return[]}var i=[];for(var r=0;r<t.length;r++){if(t[r].name=="title"){i=t[r].bound[0];break}}return i};z.prototype._getFeedingZone=function(){if(!this._chart){return[]}var e=this._chart.type;var t;try{t=this._chart.feedingZone()}catch(e){return[]}if(!c.supportMultiChart(e)){this._updateTextInfo(t);return t}var i=c.isMultipleChart(e);var r=null;var o=null;if(i){for(var a=t.length-1;a>=0;a--){var l=t[a].name;if(l===s.MultiplierFeedingName){r={name:s.ColumnsFeedingName,bound:[t[a].bound[0]],feedDef:t[a].feedDef};o={name:s.RowsFeedingName,bound:[t[a].bound[1]],feedDef:t[a].feedDef};t.splice(a,1)}else if(l!=="mainPlot"&&l!=="legend"){if(h.providerName(e)===h.MULTIPLE){t.splice(a,1)}}}}if(!this._enableTrellis){this._updateTextInfo(t);return t}if(this._isEmptyZone(r)){r=null}if(this._isEmptyZone(o)){o=null}var p=this._padding;var d={id:s.MultiplierFeedingName,name:"ChartView Multiplier",type:n.DIMENSION,min:1,max:1,aaIndex:1,acceptMND:0};var u;if(!r){u=[[[p,0],[this._size.width-p,0],[this._size.width-p,p],[0,p]]];r={name:s.ColumnsFeedingName,feedDef:[d],bound:u}}if(!o){u=[[[0,p],[p,p],[p,this._size.height-p],[0,this._size.height-p]]];o={name:s.RowsFeedingName,feedDef:[d],bound:u}}t.push(r,o);this._updateTextInfo(t);return t};z.prototype._updateMorphingSnapshot=function(){if(this._canMorphing()&&this._hasChartInstance&&this._vizMorpher&&!this._vizMorpher.isPlaying()){this._vizMorpher.morphVizType(null,-1)}};z.prototype._setDefaultValue=function(e,t,i,r){var n=t.split(".");var s=e;for(var o=0;o<n.length;o++){s[n[o]]=s[n[o]]||{};s=s[n[o]]}if(!s.hasOwnProperty(i)){s[i]=r}};z.prototype._applyDefaultProperties=function(e){e=e||{};e.properties=e.properties||{};this._setDefaultValue(e.properties,"background.border.left","visible",false);this._setDefaultValue(e.properties,"background.border.top","visible",false);this._setDefaultValue(e.properties,"background.border.right","visible",false);this._setDefaultValue(e.properties,"background.border.bottom","visible",false);return e};function b(e,t,i){if(t==null||t.length==0){return 1}var r=[];var n=1;var s=0;var o=false;for(var a=0;a<t.length;a++){if(t[a].type()===P.HIERARCHY){var l=t[a].hierarchyLevels();for(var c=0;c<l.length;c++){if(l[c].selected()){break}s++}}else if(t[a].type()===P.MND){o=true;continue}if(s<e.length){var p=e[s].values;r[a]={};var h=0;for(var d=0;d<p.length;d++){if(!r[a].hasOwnProperty(p[d])){r[a][p[d]]=true;h++}}n*=h;s++}}if(o){n*=i}return n}z.prototype._getRowColumn=function(e,t){var i={row:1,column:1};if(!e||e.length===0){return i}var r=e[0].data;if(!r||r.length===0){return i}var n=0;var o=null;var a=null;var l=this._chartModelProvider().feedingItems();for(var c=0;c<l.length;c++){if(l[c].id()===s.RowsFeedingName){o=l[c].values();for(var p=0;p<o.length;p++){if(o[p].type()===P.HIERARCHY){var h=o[p].hierarchyLevels();for(var d=0;d<h.length;d++){n++;if(h[d].selected()){break}}}else if(o[p].type()!==P.MND){n++}}}else if(l[c].id()===s.ColumnsFeedingName){a=l[c].values()}}i.row=b(r.slice(0,n),o,t);i.column=b(r.slice(n),a,t);return i};z.prototype._getMinSize=function(){var e=this._size.width;var t=this._size.height;var i=this._options;var r={width:e,height:t};if(!this._useDefaultChartSizeForTrellis&&c.isMultipleChart(i.type)&&h.providerName(i.type)===h.MULTIPLE){if(!i.data||!i.data.data()){return r}var n=i.data.data().measureValuesGroup;var s=0;for(var o=0;o<n.length;o++){s+=n[o].data.length}var a=this._getRowColumn(i.data.data().analysisAxis,s);var l=a.column*200;var p=a.row*200;if(e<l){e=l;r["overflow-x"]="auto"}if(t<p){t=p;r["overflow-y"]="auto"}}r.width=e;r.height=t;return r};z.prototype._updateChartSize=function(e){var t=z.superclass._updateChartSize.apply(this,arguments);var i=t.width;var r=t.height;this._morphingLayer$.css({width:i+"px",height:r+"px",display:"none"});this._updateUXScale();return t};z.prototype.updateDescription=function(e){z.superclass.updateDescription.apply(this,arguments);if(this._vizMorpher){this._vizMorpher.showMorphing(false,true)}};z.prototype._destroyChartInstance=function(){z.superclass._destroyChartInstance.apply(this,arguments);this._axisSplitter.reset()};z.prototype._createChartInstance=function(){this._hasChartInstance=false;var e=this._options;e=this._applyDefaultProperties(e);if(this._useBuiltInPropertyZoneInteraction===true){e.properties=e.properties||{};e.properties.interaction=e.properties.interaction||{};e.properties.interaction.selectability=e.properties.interaction.selectability||{};e.properties.interaction.selectability.plotLassoSelection=false;e.properties.interaction.selectability.mode="none";e.properties.tooltip=e.properties.tooltip||{};e.properties.tooltip.visible=false}var t=this._chartLayer$;var r=this._morphingLayer$;var n=this._descriptionLayer$;var a=this._chartHolder$;var h=e.type;if(h===i.TYPE_TREE||h===i.TYPE_NETWORK||h===i.TYPE_FUNNEL||h===i.TYPE_PC||c.supportAnimation(h)){this._supportMorphing=false}else if(!c.isBuildInType(h)){this._supportMorphing=false}else{this._supportMorphing=true}if(c.isEmptyData(h,e.data)){this._requestMorphing=false}if(this._canMorphing()&&!this._vizMorpher){this._vizMorpher=new y(t.get(0),r.get(0))}this._updateMorphingSnapshot();this._destroyChartInstance();if(e.data===null||e.data===undefined){if(this._canMorphing()&&this._vizMorpher){this._vizMorpher.morphVizType(null,-1)}return}var d=false;if(e.properties&&e.properties.plotArea&&e.properties.plotArea.showNegativeValues===true){d=true}if(!d&&p.hasNegativeMeasureValue(e.data,h)){this._showWarningDialog()}if(!e.properties){e.properties={}}if(this._canMorphing()===true){if(!e.properties.plotArea){e.properties.plotArea={}}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={}}e.properties.plotArea.animation.dataLoading=false;e.properties.plotArea.animation.dataUpdating=false;e.properties.plotArea.animation.resizing=false}try{if(!this._enableTrellis&&c.isMultipleChart(h)){this._propertyZone.updateZone(false);return}if(c.supportAnimation(h)){if(!e.properties.plotArea){e.properties.plotArea={}}if(!e.properties.plotArea.animation){e.properties.plotArea.animation={}}e.properties.plotArea.animation.dataLoading=e.properties.plotArea.animation.dataLoading===false?false:true;e.properties.plotArea.animation.dataUpdating=e.properties.plotArea.animation.dataUpdating===false?false:true;e.properties.plotArea.animation.resizing=e.properties.plotArea.animation.resizing===false?false:true;if(!e.properties.geoContainer){e.properties.geoContainer={}}}this._dispatchEvent(new f(f.CHART_CHANGING,this,h));this._updateDescriptionByOptions(e);var u=e.properties;this._chart=sap.viz.api.core.createViz({type:h,data:e.data,feeding:e.feeding,properties:u,css:e.css,events:e.events,container:t.get(0)});this._postVizProcess(e)}catch(e){var _=o.get("VIZ_CHART_CREATE_CHART_FAILED")+e;this._propertyZone.updateZone(false);if(!s.getVizFeeds(h)){this._updateDescription(l.substitute(o.get("VIZ_CHART_INVALID_VIZ_TYPE"),h))}else{this._updateDescription(_)}t.html("");this._chart=null;this._hasChartInstance=false;throw _}};z.prototype._postVizProcess=function(t){z.superclass._postVizProcess.apply(this,arguments);var r=e.proxy(function(e,t){this._dispatchEvent(new f(f.TRIGGER_CVOM_EVENT,this,{type:e,data:t}))},this);if(this._canMorphing()&&this._vizMorpher&&this._requestMorphing){this._vizMorpher.showMorphing(true,false)}this._chart.on("lassoStart.chartview",e.proxy(function(){this._axisSplitter.deactive()},this));this._chart.on("lassoEnd.chartview",e.proxy(function(){this._axisSplitter.active()},this));this._chart.on("initialized.chartview",e.proxy(function(e){if(this._canMorphing()&&this._requestMorphing&&this._hasChartInstance&&this._vizMorpher){this._requestMorphing=false;sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:morphing");this._vizMorpher.morphVizType(t.type,800,function(){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:morphing")})}if(this._isFeedsValid){this._axisSplitter.init(t.type)}var i=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(i);r("initialized",e)},this));var n=this;this._chart.on("selectData.chartview",function(e){if(n._options.type!==i.TYPE_NETWORK){n._dispatchEvent(new f(f.CHANGED_SELECTED_DATA,this));r("selectData",e)}});this._chart.on("deselectData.chartview",function(e){if(n._options.type!==i.TYPE_NETWORK&&n._options.type!==i.TYPE_TREE){n._dispatchEvent(new f(f.CHANGED_SELECTED_DATA,this));r("deselectData",e)}});this._chart.on("showTooltip.chartview",function(e){r("showTooltip",e)});this._chart.on("hideTooltip.chartview",function(e){r("hideTooltip",e)});this._hasChartInstance=true;this._uxScaleIndex=null;this._updateUXScale();this._dispatchEvent(new f(f.CHART_CHANGED,this,this._chart))};z.prototype.getTemplateId=function(e){var t=e||this.data();if(d.hasFakeData(t)){return T.TEMPLATE_INCOMPLETE}else{return this._templateId}};z.prototype.size=function(t){if(arguments.length>0){z.superclass.size.apply(this,arguments);if(this._dropZone){this._dropZone.size(this._size)}this._propertyZone.size(this._size);setTimeout(e.proxy(this._updateMorphingSnapshot,this),500);return this}else{return z.superclass.size.apply(this,arguments)}};z.prototype.data=function(e,t){if(arguments.length>0){if(!t){this._requestMorphing=true}}return z.superclass.data.apply(this,arguments)};z.prototype.feeding=function(e,t){try{if(this._chart){if(arguments.length>0){if(!t){this._requestMorphing=true}this._chart.feeding(e);return this}else{return this._chart.feeding()}}else{throw o.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+o.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw o.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+e}};z.prototype.css=function(e,t){try{if(arguments.length>0){if(!t){this._requestMorphing=true}this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chart.css(e);return this}else{throw o.get("VIZ_CHART_UPDATE_CSS_FAILED")+o.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.css()}else{return this._options.css}}}catch(e){throw o.get("VIZ_CHART_UPDATE_CSS_FAILED")+e}};z.prototype.properties=function(e,t){try{if(arguments.length>0){if(!t){this._requestMorphing=true}this._options.properties=e;if(this._chart){this._chart.properties(e);return this}else{throw o.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+o.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.properties()}else{return this._options.properties}}}catch(e){throw o.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+e}};z.prototype.update=function(e,t){if(!t){this._requestMorphing=true}return z.superclass.update.apply(this,arguments)};z.prototype.feedingZone=function(){try{if(this._chart){return this._chart.feedingZone()}else{throw o.get("VIZ_CHART_FEEDINGZONE_FAILED")+o.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw o.get("VIZ_CHART_FEEDINGZONE_FAILED")+e}};z.prototype._canMorphing=function(){return this._enableMorphing&&this._supportMorphing};z.prototype._getPropertyZone=function(){if(!this._chart){return[]}var e;try{e=this._chart.propertyZone()}catch(e){return[]}return e};z.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._enablePropertyZone!==e){this._enablePropertyZone=e===true;var t=this._enablePropertyZone&&this._isFeedsValid;this._propertyZone.updateZone(t)}return this}else{return this._enablePropertyZone}};z.prototype._getCategoryAxisScale=function(e){var t=null;var i=d.getCategoryAxis(e);if(i){t=[];for(var r=0;r<i.length;r++){t.push(i[r]+".maxSizeRatio")}}return t};z.prototype.resetProperties=function(e,t){if(this._options&&this._options.type){var i=this._options.type;d.convertValueAxisScale(e,i,t);var r=this._getCategoryAxisScale(i);if(r&&r.length>0){d.removeProperties(e,r)}}return e};z.prototype.copyData=function(e,t){var i=new sap.viz.api.data.CrosstableDataset;i.data(l.clone(t.data()));i.info(l.clone(t.info("additionalData")));return i};z.prototype.buildFeedings=function(e,t,i){var r=null;if(!t||c.isEmptyData(e,t)){return r}if(!d.hasFakeData(t)&&!c.isEmptyData(e,t)&&!s.isEmptyFeeds(i)){r=s.buildFeedings(e,i,t)}else{r=s.buildFeedingsWithFakeData(e,i,t);r=s.buildMNDFeedings(r,e)}return r};z.prototype.getDataPointsPosition=function(e){return m.findDataPointsPosition(e)};z.prototype.getPropertyZones=function(){return[new R(R.CHART_AREA)]};var S={padding:["24px","16px","9px","2px"],font_size_1:["16px","15px","14px","13px"],font_size_2:["14px","13px","12px","11px"],font_size_3:["13px","12px","11px","10px"],font_size_4:["12px","11px","10px","9px"]};z.prototype._updateUXScale=function(){var e=this.size();var t=e.width,i=e.height;var r=0;if(t<160||i<160){r=3}else if(t<260||i<260){r=2}else if(t<360||i<360){r=1}if(this._uxScaleIndex!==r&&this._chart){var n=this._uxScaleIndex=r;this._chart.update({properties:{general:{layout:{padding:parseInt(S.padding[n])}}},css:".v-m-root .v-m-title .v-title {font-size:"+S.font_size_1[n]+";}"+".v-m-root .v-m-main .v-m-yAxis .v-title {font-size:"+S.font_size_2[n]+";}"+".v-m-root .v-m-main .v-m-xAxis .v-title {font-size:"+S.font_size_2[n]+";}"+".v-m-tooltip .v-body-dimension-value {font-size:"+S.font_size_3[n]+"!important;}"+".v-m-tooltip .v-body-measure-value {font-size:"+S.font_size_3[n]+"!important;}"+".v-m-tooltip .v-body-dimension-label {font-size:"+S.font_size_4[n]+"!important;}"+".v-m-tooltip .v-body-measure-label {font-size:"+S.font_size_4[n]+"!important;}"+".v-m-tooltip .v-footer-label {font-size:"+S.font_size_4[n]+"!important;}"+".v-m-root .v-m-main .v-m-yAxis .v-label {font-size:"+S.font_size_4[n]+";}"+".v-m-root .v-m-main .v-m-xAxis .v-label {font-size:"+S.font_size_4[n]+";}"+".v-m-root .v-m-main .v-m-datalabel .v-datalabel {font-size:"+S.font_size_4[n]+";}"+".v-m-root .v-m-legends .v-m-legend .v-label {font-size:"+S.font_size_4[n]+";}"})}};return z});e("sap/viz/controls/chart/adapters/InteractionAdapter",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/chart/views/ChartEvent"],function(e,t,i,r,n){var s=function(e){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.adapters.InteractionAdapter";this._helper=e;var i=true;this._helper.vizOn("selectPropertyZone",$.proxy(function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:interaction_select");i=true;this._selectPropertyZoneHandler(e)},this));this._helper.vizOn("deselectPropertyZone",$.proxy(function(e){i=false;t.defer($.proxy(function(){if(!i){this._selectPropertyZoneHandler(e)}},this))},this));this._propertyZones=null};e.extend(s,i);var o={dataPoint:r.DATA_POINT,title:r.CHART_TITLE,plotArea:r.PLOT_AREA,legend:r.LEGEND,"axis.x":r.X_AXIS,"axisTitle.x":r.X_AXIS_TITLE,"axis.y":r.Y_AXIS,"axisTitle.y":r.Y_AXIS_TITLE,chart:r.CHART_AREA,dataLabel:r.DATA_LABEL,dataLine:r.LINE,gridline:r.GRID_LINE};var a=t.invert(o);s.prototype._getPropertyZones=function(){var e=this._helper.selectedPropertyZone();if(!e){return[]}var t=e.type;if(t==="axisItem"){t="axis"}var i=null;var n=t+(e.subType?"."+e.subType:"");if(o[n]){i=o[n]}else{}var s=[];var a=this._helper.vizData().measures();if(e.data&&e.data.length>0){e.data.forEach(function(t,n){var o=new r(i,t,e.extraData?e.extraData[n]:undefined,a);var l=e.stackData?e.stackData[n]:null;if(l){o.stackContext(l)}var c=e.seriesData?e.seriesData:null;if(c){o.seriesContext(c)}if(e.selectAllData){o.selectAllData(e.selectAllData)}s.push(o)})}else{s.push(new r(i))}return s};s.prototype._selectPropertyZoneHandler=function(e){this._propertyZones=this._getPropertyZones();t.defer(function(){this._dispatchEvent(new n(n.PROPERTY_ZONES_CHANGED,this,{propertyZones:this._propertyZones}))}.bind(this))};s.prototype.propertyZones=function(e){if(arguments.length>0){this._propertyZones=e;var t=null;e=e||[];e.forEach(function(e){var i=a[e.type()];if(!i){return}t=t||{};t.data=t.data||[];var r=i.split(".");t.type=r[0];if(r.length>1){t.subType=r[1]}if(e.context()){t.data.push(e.context())}});if(t){this._helper.selectedPropertyZone(t)}else{this._helper.selectedPropertyZone(null)}return this}else{if(this._helper.vizType()==="info/donut"&&this._propertyZones&&this._propertyZones[0]&&this._propertyZones[0].type()===r.DATA_POINT){return this._propertyZones}else{var i=this._getPropertyZones();if(!i||i.length===0){return this._propertyZones}else{return i}}}};return s});e("sap/viz/controls/chart/adapters/renderer/RendererInfoBase",["require","sap/viz/controls/common/utils/Utils"],function(e,t){var i=e||i;var r=function(e,t){this.implClassPath="sap/viz/controls/chart/adapters/renderer/RendererInfoBase";this.id=e;this.vizPath=t;this.generator=null;this._parameters=[];this._fallbackParas=null};r.prototype.parameters=function(e){if(arguments.length>0){this._parameters=e;return this}else{return this._parameters}};r.prototype.fallbackParas=function(){return this._fallbackParas};r.prototype.simplify=function(){var e=[];var t=false;this._iterate("general",$.proxy(function(i){if(this._renderGeneral(i.paras)){t=true;e.push(i)}else{this._fallbackParas=i.paras}},this));this._iterate("specified",$.proxy(function(i){if(t||this._renderSpecified(i.paras)){e.push(i)}},this));return e};r.prototype._updatePropsAll=function(e,i,r){var n=this._parameters,s;for(var o=0;o<n.length;o++){if(t.deepEqual(n[o].ctx,e)){n[o].paras[i]=r;s=true}}return s};r.prototype._updatePropsGeneral=function(e,i,n){var s;if(e){var o=this._parameters,a,l=-1,c=0,p;for(var h=0;h<o.length;h++){if(!o[h].ctx){p=h}else if(r._compareCtx(o[h].ctx,e)){for(var d in o[h].ctx){c++}if(l<c){l=c;p=h}}}if(o[p]){s=t.clone(o[p]).paras}}s=s||{};s[i]=n;this._parameters.push({ctx:e,paras:s});a=true};r.prototype._updatePropsSpecified=function(e,i,n){var s=this._parameters;for(var o=0;o<s.length;o++){if(!t.deepEqual(s[o].ctx,e)&&r._compareCtx(e,s[o].ctx)){s[o].paras[i]=n}}if(!e){for(var o=0;o<s.length;o++){s[o].paras[i]=n}}};r.prototype._mergeAndAddSeriesProps=function(e,i,n){var s=this._parameters,o,a;for(var l=0;l<s.length;l++){if(!r._compareCtx(e,s[l].ctx)&&!r._compareCtx(s[l].ctx,e)&&t.hasCommonKeyValue(e,s[l].ctx)){o=t.updateJSON(s[l].ctx,e);var c=r._contextLength(o);if(c>r._contextLength(e)&&c>r._contextLength(s[l].ctx)){var p={};p[i]=n;a=t.updateJSON(s[l].paras,p);this._parameters.push({ctx:o,paras:a})}}}};r._contextLength=function(e){var t=0;if(e){for(var i in e){if(e.hasOwnProperty(i)){t++}}}return t};r.prototype.setProperty=function(e,t,i){var r=false;r=this._updatePropsAll(e,t,i);if(!r){this._updatePropsGeneral(e,t,i)}this._updatePropsSpecified(e,t,i);this._mergeAndAddSeriesProps(e,t,i)};r.prototype.getProperty=function(e,i){var n;var s=this._parameters;for(var o=0;o<s.length;o++){if(!s[o].ctx){n=s[o].paras[i]}else if(t.deepEqual(e,s[o].ctx)){n=s[o].paras[i];break}}var a=-1,l=0,c=-1,p=0;for(var o=0;o<s.length;o++){if((r._compareCtx(e,s[o].ctx)||e===undefined)&&!t.deepEqual(s[o].paras[i],n)){if(n!==null&&n!==undefined){return null}else{n=s[o].paras[i]}p++}else if(r._compareCtx(s[o].ctx,e)){l=0;for(var h in s[o].ctx){l++}if(a<l){a=l;c=o}}}if(p===1){return null}if(c>-1){n=s[c].paras[i]}return n};r.prototype.toJSON=function(){return{id:this.id,vizPath:this.vizPath,generator:this.generator,parameters:this._parameters,implClassPath:this.implClassPath}};r.fromJSON=function(e){var t=i(e.implClassPath);return new t(e.id,e.vizPath).parameters(e.parameters)};r.prototype._renderGeneral=function(e){return true};r.prototype._renderSpecified=function(e){return true};r.prototype._iterate=function(e,t,i){this._parameters.forEach(function(n,s,o){if(e==="all"){t(n)}else if(e==="general"){if(!n.ctx||r._compareCtx(n.ctx,i)){t(n)}}else if(e==="specified"&&n.ctx){t(n)}})};r._compareCtx=function(e,t){if(e instanceof Object&&t instanceof Object){var i=Object.keys(e);var n=Object.keys(t);return n.length>0&&i.every(function(i){return r._compareCtx(e[i],t[i])})}else{return e===t}};r.prototype.isConflict=function(e,t,i){var r=false;var n=this;this._iterate("all",function(s){if(n._ignoreKey(t,s.paras,e)){return}else{if(s.paras[i]!==e[t]){r=true}}});return r};r.prototype._ignoreKey=function(e,t,i){return false};return r});e("sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo";this.generator="dataLabelRenderer"};e.extend(i,t);i.prototype._renderSpecified=function(e){if(e.iconVisible===true||e.textVisible===false){return true}else{return e.fontFamily!==undefined||e.fontSize!==undefined||e.fontWeight!==undefined||e.fontColor!==undefined||e.fontStyle!==undefined}};i.prototype._ignoreKey=function(e,t,i){switch(e){case"textVisible":if(i.textVisible===undefined){if(t.textVisible===i.dataLabelVisible){return true}}break;case"iconVisible":if(i.iconVisible===undefined){return true}break;case"fontFamily":if(t.fontFamily===undefined){return true}break;case"fontSize":if(t.fontSize===undefined){return true}break;case"fontWeight":if(t.fontWeight===undefined){return true}break;case"fontColor":if(t.fontColor===undefined){return true}break;case"fontStyle":if(t.fontStyle===undefined){return true}break}return false};return i});e("sap/viz/controls/chart/adapters/config/DataLabelPropConfig",["sap/viz/controls/chart/adapters/renderer/DataLabelRendererInfo"],function(e){var t={};var i=function(t){return{id:"plotArea.dataLabel.renderer",infoClass:e,vizPath:"plotArea.dataLabel.renderer",paraName:t}};t.instance=function(){return{dataLabelVisible:{vizPath:"plotArea.dataLabel.visible"},textVisible:{renderer:i("textVisible")},fontFamily:{renderer:i("fontFamily"),vizPath:"plotArea.dataLabel.style.fontFamily"},fontSize:{renderer:i("fontSize"),vizPath:"plotArea.dataLabel.style.fontSize"},fontWeight:{renderer:i("fontWeight"),vizPath:"plotArea.dataLabel.style.fontWeight"},fontColor:{renderer:i("fontColor"),vizPath:"plotArea.dataLabel.style.color"},fontStyle:{renderer:i("fontStyle"),vizPath:"plotArea.dataLabel.style.fontStyle"},iconVisible:{renderer:i("iconVisible")},iconSVG:{renderer:i("iconSVG")},iconColor:{renderer:i("iconColor")},iconSize:{renderer:i("iconSize")}}};return t});e("sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo";this.generator="stackDecorator"};e.extend(i,t);i.prototype._renderSpecified=function(e){if(e.stackShape){return true}else{return false}};return i});e("sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo";this.generator="barShapeRenderer"};e.extend(i,t);i.prototype._renderGeneral=function(e){if(e.dataPointShape||e.dataPointShapeFill){return true}else{return false}};i.prototype._renderSpecified=function(e){if(e.dataPointShape||e.dataPointShapeFill){return true}else{return false}};return i});e("sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo";this.generator="pieSliceRenderer"};e.extend(i,t);i.prototype._renderGeneral=function(e){if(e.sliceShape){return true}else{return false}};i.prototype._renderSpecified=function(e){if(e.sliceShape){return true}else{return false}};return i});e("sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo";this.generator="lineMarkerRenderer"};e.extend(i,t);i.prototype._renderGeneral=function(e){if(e.iconSVG||e.iconColor||e.iconSize){return true}else{return false}};i.prototype._renderSpecified=function(e){if(e.iconSVG||e.iconColor||e.iconSize){return true}else{return false}};return i});e("sap/viz/controls/chart/adapters/config/DataPointPropConfig",["sap/viz/controls/chart/adapters/renderer/StackDecoratorInfo","sap/viz/controls/chart/adapters/renderer/BarShapeRendererInfo","sap/viz/controls/chart/adapters/renderer/PieDataPointRendererInfo","sap/viz/controls/chart/adapters/renderer/LineDataPointRendererInfo"],function(e,t,i,r){var n={};var s=function(e){return{id:"plotArea.markerRenderer.barShapeRenderer",infoClass:t,vizPath:"plotArea.markerRenderer",paraName:e}};var o=function(t){return{id:"plotArea.stackDecorator.stackDecorator",infoClass:e,vizPath:"plotArea.stackDecorator",useStackContext:true,paraName:t}};var a=function(e){return{id:"plotArea.sliceRenderer.pieSliceRenderer",infoClass:i,vizPath:"plotArea.sliceRenderer",paraName:e}};var l=function(e){return{id:"plotArea.markerRenderer.lineMarkerRenderer",infoClass:r,vizPath:"plotArea.markerRenderer",paraName:e}};n.instance=function(){return{"line.iconSVG":{renderer:l("iconSVG")},"line.iconColor":{renderer:l("iconColor")},"line.iconSize":{renderer:l("iconSize")},dataPointShape:{renderer:s("dataPointShape")},stackShape:{renderer:o("stackShape")},dataPointShapeFill:{renderer:s("dataPointShapeFill")},sliceShape:{renderer:a("sliceShape")},sliceShapeFill:{renderer:a("sliceShapeFill")},"centerName.fontFamily":{vizPath:"plotArea.highlight.centerName.style.fontFamily"},"centerName.fontSize":{vizPath:"plotArea.highlight.centerName.style.fontSize"},"centerName.fontWeight":{vizPath:"plotArea.highlight.centerName.style.fontWeight"},"centerName.fontColor":{vizPath:"plotArea.highlight.centerName.style.color"},"centerName.fontStyle":{vizPath:"plotArea.highlight.centerName.style.fontStyle"},"centerValue.fontFamily":{vizPath:"plotArea.highlight.centerValue.style.fontFamily"},"centerValue.fontSize":{vizPath:"plotArea.highlight.centerValue.style.fontSize"},"centerValue.fontWeight":{vizPath:"plotArea.highlight.centerValue.style.fontWeight"},"centerValue.fontColor":{vizPath:"plotArea.highlight.centerValue.style.color"},"centerValue.fontStyle":{vizPath:"plotArea.highlight.centerValue.style.fontStyle"}}};return n});e("sap/viz/controls/chart/adapters/config/ValueAxisPropConfig",[],function(){var e={};e.instance=function(){return{fontFamily:{vizPath:"valueAxis.label.style.fontFamily"},fontSize:{vizPath:"valueAxis.label.style.fontSize"},fontWeight:{vizPath:"valueAxis.label.style.fontWeight"},fontColor:{vizPath:"valueAxis.label.style.color"},fontStyle:{vizPath:"valueAxis.label.style.fontStyle"}}};return e});e("sap/viz/controls/chart/adapters/config/ChartTitlePropConfig",[],function(){var e={};e.instance=function(){return{fontFamily:{vizPath:"title.style.fontFamily"},fontSize:{vizPath:"title.style.fontSize"},fontWeight:{vizPath:"title.style.fontWeight"},fontColor:{vizPath:"title.style.color"},fontStyle:{vizPath:"title.style.fontStyle"}}};return e});e("sap/viz/controls/chart/adapters/config/ChartAreaPropConfig",[],function(){var e={};e.instance=function(){return{fill:{vizPath:"general.background.color"}}};return e});e("sap/viz/controls/chart/adapters/config/PlotAreaPropConfig",[],function(){var e={};e.instance=function(){return{fill:{vizPath:"plotArea.background.color"}}};return e});e("sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig",[],function(e){var t={};t.instance=function(){return{fontFamily:{vizPath:"categoryAxis.title.style.fontFamily"},fontSize:{vizPath:"categoryAxis.title.style.fontSize"},fontWeight:{vizPath:"categoryAxis.title.style.fontWeight"},fontColor:{vizPath:"categoryAxis.title.style.color"},fontStyle:{vizPath:"categoryAxis.title.style.fontStyle"}}};return t});e("sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig",[],function(e){var t={};t.instance=function(){return{fontFamily:{vizPath:"valueAxis.title.style.fontFamily"},fontSize:{vizPath:"valueAxis.title.style.fontSize"},fontWeight:{vizPath:"valueAxis.title.style.fontWeight"},fontColor:{vizPath:"valueAxis.title.style.color"},fontStyle:{vizPath:"valueAxis.title.style.fontStyle"}}};return t});e("sap/viz/controls/chart/adapters/config/LegendPropConfig",[],function(){var e={};e.instance=function(){return{fontFamily:{vizPath:"legend.label.style.fontFamily"},fontSize:{vizPath:"legend.label.style.fontSize"},fontWeight:{vizPath:"legend.label.style.fontWeight"},fontColor:{vizPath:"legend.label.style.color"},fontStyle:{vizPath:"legend.label.style.fontStyle"},"title-fontFamily":{vizPath:"legend.title.style.fontFamily"},"title-fontSize":{vizPath:"legend.title.style.fontSize"},"title-fontWeight":{vizPath:"legend.title.style.fontWeight"},"title-fontColor":{vizPath:"legend.title.style.color"},"title-fontStyle":{vizPath:"legend.title.style.fontStyle"}}};return e});e("sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo";this.generator="categoryAxisLabelRenderer"};e.extend(i,t);i.prototype._renderGeneral=function(e){if(e.iconVisible===true||e.textVisible===false){return true}else{return false}};i.prototype._renderSpecified=function(e){if(e.iconVisible===true||e.textVisible===false){return true}else{return e.fontFamily!==undefined||e.fontSize!==undefined||e.fontWeight!==undefined||e.fontColor!==undefined||e.fontStyle!==undefined}};i.prototype._ignoreKey=function(e,t,i){switch(e){case"fontFamily":if(t.fontFamily===undefined){return true}break;case"fontSize":if(t.fontSize===undefined){return true}break;case"fontWeight":if(t.fontWeight===undefined){return true}break;case"fontColor":if(t.fontColor===undefined){return true}break;case"fontStyle":if(t.fontStyle===undefined){return true}break}return false};return i});e("sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig",["sap/viz/controls/chart/adapters/renderer/CategoryAxisLabelRendererInfo"],function(e){var t={};var i=function(t){return{id:"categoryAxis.labelRenderer.categoryAxisLabelRenderer",infoClass:e,vizPath:"categoryAxis.labelRenderer",paraName:t}};t.instance=function(){return{textVisible:{renderer:i("textVisible")},iconSVG:{renderer:i("iconSVG")},iconColor:{renderer:i("iconColor")},iconSize:{renderer:i("iconSize")},iconVisible:{renderer:i("iconVisible")},fontFamily:{renderer:i("fontFamily"),vizPath:"categoryAxis.label.style.fontFamily"},fontSize:{renderer:i("fontSize"),vizPath:"categoryAxis.label.style.fontSize"},fontWeight:{renderer:i("fontWeight"),vizPath:"categoryAxis.label.style.fontWeight"},fontColor:{renderer:i("fontColor"),vizPath:"categoryAxis.label.style.color"},fontStyle:{renderer:i("fontStyle"),vizPath:"categoryAxis.label.style.fontStyle"}}};return t});e("sap/viz/controls/chart/adapters/renderer/LineRendererInfo",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/chart/adapters/renderer/RendererInfoBase"],function(e,t){var i=function(e,t){i.superclass.constructor.apply(this,arguments);this.implClassPath="sap/viz/controls/chart/adapters/renderer/LineRendererInfo";this.generator="lineRenderer"};e.extend(i,t);i.prototype._renderGeneral=function(e){if(e.dash||e.color){return true}else{return false}};i.prototype._renderSpecified=function(e){if(e.dash||e.color||e.width){return true}else{return false}};return i});e("sap/viz/controls/chart/adapters/config/LinePropConfig",["sap/viz/controls/chart/adapters/renderer/LineRendererInfo"],function(e){var t={};var i=function(t){return{id:"plotArea.lineRenderer",infoClass:e,vizPath:"plotArea.lineRenderer",paraName:t}};t.instance=function(){return{lineFill:{renderer:i("color")},lineStyle:{renderer:i("dash")},"plotArea.width":{renderer:i("width"),vizPath:"plotArea.width"}}};return t});e("sap/viz/controls/chart/adapters/PropertyMap",["sap/viz/controls/chart/adapters/config/DataLabelPropConfig","sap/viz/controls/chart/adapters/config/DataPointPropConfig","sap/viz/controls/chart/adapters/config/ValueAxisPropConfig","sap/viz/controls/chart/adapters/config/ChartTitlePropConfig","sap/viz/controls/chart/adapters/config/ChartAreaPropConfig","sap/viz/controls/chart/adapters/config/PlotAreaPropConfig","sap/viz/controls/chart/adapters/config/CategoryAxisTitlePropConfig","sap/viz/controls/chart/adapters/config/ValueAxisTitlePropConfig","sap/viz/controls/chart/adapters/config/LegendPropConfig","sap/viz/controls/chart/adapters/config/CategoryAxisPropConfig","sap/viz/controls/chart/adapters/config/LinePropConfig","sap/viz/controls/common/property/VizPropertyZone"],function(e,t,i,r,n,s,o,a,l,c,p,h){var d={};d.getPropConfig=function(d,u){switch(d){case h.DATA_LABEL:return e.instance();break;case h.DATA_POINT:return t.instance();break;case h.X_AXIS:if(u){return i.instance()}else{return c.instance()}break;case h.CHART_TITLE:return r.instance();break;case h.CHART_AREA:return n.instance();break;case h.PLOT_AREA:return s.instance();break;case h.X_AXIS_TITLE:if(u){return a.instance()}else{return o.instance()}break;case h.Y_AXIS_TITLE:if(u){return o.instance()}else{return a.instance()}break;case h.LEGEND:return l.instance();break;case h.Y_AXIS:if(u){return c.instance()}else{return i.instance()}break;case h.LINE:return p.instance();break}};return d});e("sap/viz/controls/chart/adapters/PropFnGenerator",[],function(){var e=function(e,t){this.__className="sap.viz.controls.chart.adapters.PropFnGenerator";this._name=e;this._fn=t};prototype=e.prototype;prototype.generateFn=function(e){return this._fn.apply(null,[e])};prototype.getName=function(){return this._name};return e});e("sap/viz/controls/chart/adapters/PropFnGeneratorRegistry",["sap/viz/controls/chart/adapters/PropFnGenerator"],function(e){var t={};var i={};t.register=function(t,r){var n=i;if(n.hasOwnProperty(t)){throw"PropFnGenerator '"+t+"' exists."}n[t]=new e(t,r)};t.unregister=function(e){delete i[e]};t.get=function(e){return i[e]};return t});e("sap/viz/controls/chart/adapters/PropertyAdapter",["require","jquery","sap/viz/controls/chart/adapters/PropertyMap","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/chart/adapters/PropFnGeneratorRegistry","sap/viz/controls/chart/adapters/renderer/RendererInfoBase","sap/viz/controls/common/utils/ChartTypeUtil"],function(e,t,i,r,n,s,o,a,l,c){var p=e||p;var h=function(e,t){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.adapters.PropertyAdapter";this._helper=e;this._rendererInfo={};if(t){this._loadRendererInfo(t)}};s.extend(h,r);h.prototype.query=function(e){if(e&&e.propertyZones){var t=e.propertyZones;var r=e.propertyFields;var n=e.chartType;var s;for(var a in t){var l={};for(var p in r){if(r[p]===true){var h=t[a];var d=i.getPropConfig(h.type(),c.isHorizontal(n));if(d&&d[p]){var u=d[p];u.vizPath=u.vizPath||p;if(u.vizPath){l[p]=this._getVizProp(u.vizPath)}if(u.renderer){u.renderer.paraName=u.renderer.paraName||p;var _=this._rendererInfo[u.renderer.id];if(_){var v=h.getDimensionContext();if(u.renderer.useStackContext){v=h.stackContext()}var f=_.getProperty(v,u.renderer.paraName);if(f!==undefined){l[p]=f}}}}else{l[p]=this._getVizProp(p)}}}if(!s){s=l}else{for(var p in l){if(!o.deepEqual(s[p],l[p])){s[p]=null}}}}return s}return null};h.prototype._getCfg=function(e,t){for(var i in e){if(e&&e[i]&&e[i].renderer&&e[i].renderer.paraName===t){return e[i]}}return null};h.prototype.update=function(e){if(!e||!e.propertyZones){return}var t=e.propertyZones;var r=e.properties;var n=e.chartType;var s={};var o={};for(var a in t){var l=t[a];var p=i.getPropConfig(l.type(),c.isHorizontal(n));var d={};for(var u in r){var _=r[u];if(p&&p[u]){var v=p[u];if(v.renderer){var f=v.renderer;if(!this._rendererInfo[f.id]){this._rendererInfo[f.id]=new f.infoClass(f.id,f.vizPath)}d[f.id]=this._rendererInfo[f.id];var m=l.getDimensionContext();if(f.useStackContext===true){m=l.stackContext()}this._rendererInfo[f.id].setProperty(m,f.paraName,_)}else if(v.vizPath){o[v.vizPath]=_}}else{o[u]=_}}for(var g in d){var E=d[g];if(E.simplify().length>0){s[E.vizPath]=E}else{s[E.vizPath]=undefined}if(E.fallbackParas()){var y=E.fallbackParas();for(var I in y){var C=y[I];var v=this._getCfg(p,I);if(v&&v.vizPath){o[v.vizPath]=C}}}}}var r={};for(var T in s){var E=s[T];if(E){h._parseVizPath(T,h._getRenderer(E.generator,E.parameters()),r)}else{h._parseVizPath(T,null,r)}}for(var T in o){h._parseVizPath(T,o[T],r)}this._helper.vizProperties(r)};h.prototype._getVizProp=function(e){var t=this._helper.vizProperties();try{var i=e.split(".");for(var r in i){t=t[i[r]]}}catch(e){return undefined}return t};h.prototype.saveRendererInfo=function(){var e={};for(var t in this._rendererInfo){e[t]=this._rendererInfo[t].toJSON()}return e};h.parseRendererInfo=function(e,t){t=t||{};for(var i in e){var r=e[i];h._parseVizPath(r.vizPath,h._getRenderer(r.generator,r.parameters),t)}return t};h.prototype._loadRendererInfo=function(e){var t=[];for(var i in e){var r=e[i];t.push(r.implClassPath)}for(var i in e){this._rendererInfo[i]=l.fromJSON(e[i])}};h._getRenderer=function(e,t){var i=a.get(e);return i?i.generateFn(t):null};h._parseVizPath=function(e,t,i){var r=e.split(".");if(r.length>0){var n=i;for(var s=0;s<r.length;s++){if(s===r.length-1){n[r[s]]=t;break}n[r[s]]=n[r[s]]||{};n=n[r[s]]}}return i};return h});e("sap/viz/controls/chart/views/InfoChartView",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/chart/adapters/InteractionAdapter","sap/viz/controls/chart/adapters/PropertyAdapter","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/View"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_){var v=function(e,t,i,r){v.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.InfoChartView";this._useBuiltInPropertyZoneInteraction=t.useBuiltInPropertyZoneInteraction;this._iAdapter=null;this._pAdapter=null;this._rendererInfo=null;this._createChildren()};t.extend(v,_);v.prototype._createChartInstance=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-create");if(!this._options){return}var t=this._options;if(this._useBuiltInPropertyZoneInteraction===true){t.properties=t.properties||{};t.properties.interaction={behaviorType:"DesignTimeBehavior"}}this._destroyChartInstance();this._updateDescription();this._chart=sap.viz.api.core.createViz({type:t.type,data:t.data,feeding:t.feeding,properties:t.properties,css:t.css,events:t.events,container:this._chartLayer$.get(0)});this._postVizProcess(t);this._chart.on("initialized.create",e.proxy(function(){if(!this._chart){return}this._chart.off("initialized.create");if(!this._iAdapter){this._iAdapter=new h(this._helper);this._iAdapter.addEventListener(u.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new u(u.PROPERTY_ZONES_CHANGED,this,e.data))},this)}if(!this._pAdapter){this._pAdapter=new d(this._helper,this._rendererInfo);this._pAdapter._ownerDom$=this._dom$}this._dispatchEvent(new u(u.PROPERTY_ZONES_CHANGED,this,{propertyZones:[new c(c.CHART_AREA)]}))},this));sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_chartView-create")};v.prototype.hasChartInstance=function(){return this._chart!==null};v.prototype.properties=function(e){if(arguments.length>0){this._options.properties=e;if(this._chart){this._chart.properties(e);return this}else{throw n.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+n.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.properties()}else{return this._options.properties}}};v.prototype.copyData=function(e,t){var i=t.data();var r=new sap.viz.api.data.FlatTableDataset(i);return r};v.prototype.buildFeedings=function(e,t,i){var r=null;var n=false;if(l.hasMND(i)||l.countAnalyses(i,o.MEASURE)===0){r=i}else{var c=p.getVizType(e);r=a.directFeeding(i,c,[s.genMND()]);n=true}return p.buildInfoFeeding(r,n)};v.prototype.feeding=function(e){try{if(this._chart){if(arguments.length>0){this._chart.feeding(e);return this}else{return this._chart.feeding()}}else{throw n.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+n.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw n.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+e}};v.prototype.getPropertyZones=function(){if(this._iAdapter){return this._iAdapter.propertyZones()}else{return[]}};v.prototype.setPropertyZones=function(e){if(this._iAdapter){this._iAdapter.propertyZones(e)}};v.prototype.queryProperties=function(e){return this._pAdapter?this._pAdapter.query(e):{}};v.prototype.updateProperties=function(e){if(this._pAdapter){this._pAdapter.update(e)}};v.prototype.save=function(){if(this._pAdapter){return{pAdapter:{rendererInfo:this._pAdapter.saveRendererInfo()}}}else{return{}}};v._migrateRenderInfo=function(e){var t="categoryAxis.labelRenderer.categoryAxisLabelRenderer";if(!e||e[t]){return}var i;var r="xAxis.labelRenderer.categoryAxisLabelRenderer";var n="yAxis.labelRenderer.categoryAxisLabelRenderer";if(e[r]){i=e[r];delete e[r]}else if(e[n]){i=e[n];delete e[n]}if(i){e[t]=i;i.id=t;i.vizPath="categoryAxis.labelRenderer"}};v.prototype.load=function(e,t){if(e&&e.pAdapter){v._migrateRenderInfo(e.pAdapter.rendererInfo);this._rendererInfo=e.pAdapter.rendererInfo;d.parseRendererInfo(e.pAdapter.rendererInfo,t)}};v.prototype.css=function(e){try{if(arguments.length>0){this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chart.css(e);return this}else{throw n.get("VIZ_CHART_UPDATE_CSS_FAILED")+n.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.css()}else{return this._options.css}}}catch(e){throw n.get("VIZ_CHART_UPDATE_CSS_FAILED")+e}};v.prototype.data=function(e){if(this._chart){try{if(arguments.length>0){this._chart.app.setDataset(e)}else{return this._chart.app.getDataset()}}catch(e){errorMsg=n.get("VIZ_CHART_UPDATE_CHART_FAILED")+e;this._updateDescription(errorMsg);throw errorMsg}}else{return v.superclass.data.apply(this,arguments)}};v.prototype.exportViz=function(e){if(this._chart){var t=this._chart.toJSON(e);if(t){t.properties=this._options.properties;delete t.css}return t}else{throw n.get("VIZ_CHART_SERIALIZE_FAILED")+n.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};return v});e("sap/viz/controls/chart/views/ESRIServicePanel",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/managers/LangManager","sap/viz/controls/chart/views/ChartEvent"],function(e,t,i,r,n,s){var o=function(e,t){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServicePanel";this._uiconfig=t;this._div=e;this._serviceGallery$=null;this.createChildren()};i.extend(o,r);o.prototype.createChildren=function(){this._serviceGallery$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-gallery").appendTo(this._div)};o.prototype.init=function(i,r,n){var o=this;var a=function(){e("."+t.CHART_PREFIX+"map-service-selector-services-item-icon").removeClass(t.CHART_PREFIX+"map-service-selector-services-item-icon-selected");e(this).addClass(t.CHART_PREFIX+"map-service-selector-services-item-icon-selected");o._dispatchEvent(new s(s.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:e("."+t.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId")}))};this._serviceGallery$.empty();if(i&&i.length>0){var l,c,p,h;for(var d=0;d<i.length;d++){l=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-item").appendTo(this._serviceGallery$);c=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-item-icon").appendTo(l);c.attr("title",i[d].description);c.data("__serviceId",i[d].id);c.data("__serviceUrl",i[d].url);c.on("click",a);p=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-item-title").appendTo(l);p.html(i[d].title);h="url(https://www.arcgis.com/sharing/rest/content/items/"+i[d].id+"/info/"+i[d].thumbnail+"?token="+r+")";c.css({"background-image":h});if(n&&n===i[d].id){c.addClass(t.CHART_PREFIX+"map-service-selector-services-item-icon-selected")}}}};o.prototype.getSelectedService=function(){return{id:e("."+t.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceId"),url:e("."+t.CHART_PREFIX+"map-service-selector-services-item-icon-selected").data("__serviceUrl")}};o.prototype.show=function(){this._serviceGallery$.show()};o.prototype.hide=function(){this._serviceGallery$.hide()};return o});e("sap/viz/controls/chart/views/ESRIServiceColor",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/managers/LangManager","sap/viz/controls/chart/views/ChartEvent"],function(e,t,i,r,n,s){var o=function(e,t){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIServiceColor";this._uiconfig=t;this._div=e;this._serviceColor$=null;this._fieldsSelector$=null;this._startVal$=null;this._startColor$=null;this._endVal$=null;this._endColor$=null;this.createChildren()};i.extend(o,r);o.prototype.createChildren=function(){this._serviceColor$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-panel").appendTo(this._div);e(document.createElement("div")).html(n.get("VIZ_CHART_SELECT_DATASET")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-title").appendTo(this._serviceColor$);this._fieldsSelector$=e(document.createElement("select")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-selector").appendTo(this._serviceColor$);this.createGradient()};o.prototype.createGradient=function(){var i=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-title-group").appendTo(this._serviceColor$);e(document.createElement("div")).html(n.get("VIZ_CHART_SET_COLOR_LAYER")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-title-label").appendTo(i);this._reset$=e(document.createElement("div")).html(n.get("VIZ_CHART_RESET")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-reset").on("click",function(){this._startVal$.val(this._startVal$.prop("defaultValue"));this._endVal$.val(this._endVal$.prop("defaultValue"))}.bind(this)).appendTo(i);var r=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient").appendTo(this._serviceColor$);e(document.createElement("div")).html(n.get("VIZ_CHART_START")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-start").appendTo(r);var s=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-value-group1").appendTo(r);this._startVal$=e(document.createElement("input")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-value").attr("value","0").appendTo(s);this._startColor$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-colorpicker").css("background-color","#c2e3a9").appendTo(s);e(document.createElement("div")).html(n.get("VIZ_CHART_END")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-end").appendTo(r);s=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-value-group2").appendTo(r);this._endVal$=e(document.createElement("input")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-value").attr("value","100").appendTo(s);this._endColor$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-color-field-gradient-colorpicker").css("background-color","#35581C").appendTo(s)};o.prototype.init=function(t,i){e.ajax({url:t,data:{f:"json"},dataType:"json",type:"POST",success:function(t){this._fieldsSelector$.empty();var i=t.fields.filter(function(e){return e.type==="esriFieldTypeSmallInteger"||e.type==="esriFieldTypeInteger"||e.type==="esriFieldTypeSingle"||e.type==="esriFieldTypeDouble"});for(var r=0;r<i.length;r++){e(document.createElement("option")).attr("value",i[r].name).html(i[r].name).appendTo(this._fieldsSelector$)}}.bind(this)})};o.prototype.show=function(){this._serviceColor$.show()};o.prototype.hide=function(){this._serviceColor$.hide()};o.prototype.getColor=function(){return{type:"gradient",bindedField:this._fieldsSelector$.val(),start:{val:this._startVal$.val(),color:this._startColor$.css("background-color")},end:{val:this._endVal$.val(),color:this._endColor$.css("background-color")}}};return o});e("sap/viz/controls/chart/views/ESRIServiceSelector",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/managers/LangManager","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/ESRIServicePanel","sap/viz/controls/chart/views/ESRIServiceColor"],function(e,t,i,r,n,s,o,a){var l=function(e,t){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.ESRIMapServiceSelector";this._uiconfig=t;this._div=e;this._titleDiv$=null;this._footerDiv$=null;this._servicesDiv$=null;this._servicePanel=null;this._serviceColor=null;this._btnDone$=null;this._btnLayer$=null;this._btnConfirm$=null;this.createChildren()};i.extend(l,r);l.prototype.createChildren=function(){this._titleDiv$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-title").html(n.get("VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE")).appendTo(e(this._div));this._servicesDiv$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-panel").appendTo(e(this._div));this._servicePanel=new o(this._servicesDiv$);this._serviceColor=new a(this._servicesDiv$);e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-services-gallery-close").on("click",function(){this.hide()}.bind(this)).appendTo(e(this._div));this._servicePanel.addEventListener(s.ESRI_CUSTOMIZED_SERVICE_CHANGED,function(e){if(e.data.serviceId){this._btnConfirm$.show();this._btnDone$.hide()}else{this._btnConfirm$.hide();this._btnDone$.show()}}.bind(this));this._footerDiv$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-footer").appendTo(e(this._div));this._btnDone$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-button-done").html(n.get("VIZ_CHART_CONFIRM")).on("click",function(){this.hide();this._dispatchEvent(new s(s.ESRI_CUSTOMIZED_SERVICE_CHANGED,this,{serviceId:this._servicePanel.getSelectedService().id,color:this._serviceColor.getColor()}))}.bind(this)).appendTo(this._footerDiv$);this._btnConfirm$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-button-confirm").html(n.get("VIZ_CHART_NEXT")).on("click",function(){this._btnConfirm$.hide();this._btnDone$.show();this._btnLayer$.show();this._servicePanel.hide();this._serviceColor.init(this._servicePanel.getSelectedService().url);this._serviceColor.show()}.bind(this)).appendTo(this._footerDiv$);this._btnLayer$=e(document.createElement("div")).addClass(t.CHART_PREFIX+"map-service-selector-button-layer").html(n.get("VIZ_CHART_BACK")).on("click",function(){this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide()}.bind(this)).appendTo(this._footerDiv$);this._servicePanel.show();this._serviceColor.hide();this._btnConfirm$.show();this._btnLayer$.hide();this._btnDone$.hide()};l.prototype.show=function(t,i,r){this._servicePanel.init(t,i,r);if(!r){this._btnConfirm$.hide();this._btnDone$.show()}else{this._btnLayer$.hide();this._btnDone$.hide();this._btnConfirm$.show()}this._servicePanel.show();this._serviceColor.hide();e(this._div).show()};l.prototype.hide=function(){e(this._div).hide()};return l});e("sap/viz/controls/chart/views/EsriNoService",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager"],function e(t,i,r){var n=function(e){this.__className="sap.viz.controls.chart.views.EsriNoSerive";this._div=e;this._titleDiv$=t(document.createElement("div")).addClass(i.CHART_PREFIX+"map-service-no-service-title").html(r.get("VIZ_CHART_IMPORT_ESRI_CUSTOM_SERVICE")).appendTo(t(this._div));this._messageDiv$=t(document.createElement("div")).addClass(i.CHART_PREFIX+"map-service-no-serive-message").html(r.get("VIZ_CHART_NO_ESRI_SERVICE")).appendTo(t(this._div));t(document.createElement("div")).addClass(i.CHART_PREFIX+"map-service-selector-services-gallery-close").on("click",function(){this.hide()}.bind(this)).appendTo(t(this._div))};n.prototype.hide=function(){t(this._div).hide()};n.prototype.show=function(){t(this._div).show()};return n});e("sap/viz/controls/chart/views/MapView",["require","jquery","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/DatasetTypeConst","sap/viz/controls/common/constants/MapProviderConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/TrellisUtils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/ChartConfig","sap/viz/controls/chart/views/View","sap/viz/controls/common/utils/IncompleteGhost","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/chart/views/ESRIServiceSelector","sap/viz/controls/chart/views/EsriNoService"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A){var P=e||P;var R=function(e,t,i){e.splice(i,0,e.splice(t,1)[0])};var z=function(e,t,i,r){z.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.MapView";this._mapselector$=null;this._mapNoService$=null;this._mapNoService=null;this._mapServiceSelector=null;this._esriservices=null;this._selectedServiceId=undefined;this._loadedViz=null;this._mapInitialized=false;this._updateCache=null;this._createChildren();sap.viz.extapi.env.Template.removeListener(this._changeTemplateFunc)};h.extend(z,E);z.prototype._createChildren=function(){z.superclass._createChildren.apply(this,arguments);this._createESRIMapServiceSelector()};z.prototype._createESRIMapServiceSelector=function(){this._mapselector$=t(document.createElement("div")).addClass(f.CHART_PREFIX+"map-service-selector").appendTo(t(this._div));this._mapNoService$=t(document.createElement("div")).addClass(f.CHART_PREFIX+"map-no-service").appendTo(t(this._div));this._mapNoService=new A(this._mapNoService$);this._mapNoService.hide();this._mapServiceSelector=new T(this._mapselector$);this._mapServiceSelector.addEventListener(m.ESRI_CUSTOMIZED_SERVICE_CHANGED,this._esriServiceChanged.bind(this));this._mapServiceSelector.hide()};z.prototype._esriServiceChanged=function(e){var t=e.data.serviceId;this._selectedServiceColor=e.data.color;this._enableService=true;if(!this._selectedServiceId){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:this._enableService}}})}this._selectedServiceId=t;this._changeBaseMap({serviceId:t,color:this._selectedServiceColor})};z.prototype._changeBaseMap=function(e){var t=e.serviceId;var i=e.color;var r;if(!t){r=new sap.viz.geo.basemap.esri.Provider({basemap:this._chart.baseMap().toJSON().options.basemap})}else{var n=this._esriservices.filter(function(e){return e.id===t});var s=[{}];s[0].type=sap.viz.geo.basemap.esri.Provider.ARCGIS_SERVICE_TYPE_FEATURE;s[0].url=n[0].url;s[0].options={outFields:["*"]};s[0].color=i;r=new sap.viz.geo.basemap.esri.Provider({extent:new esri.geometry.Extent(-115,-34,115,7),basemap:this._chart.baseMap().toJSON().options.basemap},s)}this._chart.baseMap(r)};z.prototype._showRefreshButton=function(){this._refresh$.css({left:t(this._div).width()/2-this._refresh$.width()/2});this._refresh$.css({top:t(this._div).height()/2-this._refresh$.height()/2+40});this._refresh$.show()};z.prototype.modelChanged=function(e,t){if(t.vizTypeChanged){this.showLoadingIcon()}if(t.feedingItemsChanged&&t.feedsChangedInfo&&t.feedsChangedInfo.items){var i=t.feedsChangedInfo.items[0];var r=e.feedingItems()[i];var s=new a(a.FEEDS_CHANGED,this,{datasetType:n.FlatTableDataset,feeds:r,layerIdx:i});this._dispatchEvent(new o(E.DISPATCH_PROPERTY_EVENT,this,s))}if(t.extensionValuesChanged){var c=e.extensionValues();if(c.mapBuilder){var p=c.mapBuilder;var h=this._chart;if(p&&h){if(p.layer){var d=p.layer.action;var i=p.layer.idx;var u=p.layer.from;var _=p.layer.to;if(d==="add"){h.addLayer(new sap.viz.geo.dataviz.Layer({viz:new sap.viz.geo.dataviz.Choropleth,legendVisible:true}),true);var v=e.feedingItems();v.push(p.layer.feeds);e.feedingItems(v,false)}else if(d==="delete"&&i>=0){h.removeLayer(h.getLayer(i));var v=e.feedingItems();v.splice(i,1);e.feedingItems(v,false)}else if(d==="reorder"&&u>=0&&_>=0){h.reorderLayer(h.getLayer(u),_);var f=e.feedingItems();R(f,u,_);e.feedingItems(f,false)}else if(d==="show"&&i>=0){var m=h.getLayer(i);m.visibility(true)}else if(d==="hide"&&i>=0){var m=h.getLayer(i);m.visibility(false)}else if(d==="changeVizType"&&i>=0){var m=h.getLayer(i);var g=p.layer.vizType;var y=p.layer.feeding;var I,C,T,A,P,z;if(y!==null){for(var O=0;O<y.length;O++){C=y[O];if(C){for(var b=0;b<C.values().length;b++){var S=C.values()[b].id();if(C.id()==="location"){T=S}else if(C.id()==="color"){A=S;P=C.type()}else if(C.id()==="size"){z=S}}}}m.data(null)}if(g==="choropleth"){if(y!==null){I={};if(T){I.location=T}if(P===l.MEASURE&&A){I.color=A}m.viz(new sap.viz.geo.dataviz.Choropleth,I)}else{m.viz(new sap.viz.geo.dataviz.Choropleth)}}else if(g==="bubble"){if(y!==null){I={};if(T){I.location=T}if(z){I.size=z}if(P===l.DIMENSION&&A){I.color=A}m.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}),I)}else{m.viz(new sap.viz.geo.dataviz.Bubble({cluster:{enabled:false}}))}}else if(g==="marker"){if(y!==null){I={};if(T){I.location=T}m.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}),I)}else{m.viz(new sap.viz.geo.dataviz.Marker({width:12,height:20,xoffset:-6,yoffset:-20,cluster:{enabled:false}}))}}}else if(d==="changeProperties"&&i>=0){var m=h.getLayer(i);var x=p.layer.propKey;var D=p.layer.propValue;if(x==="markerCluster"||x==="bubbleCluster"){m.viz().properties({cluster:{enabled:D}})}}}else if(p.mapservice){if(p.mapservice.action==="choose"){this._chooseMapServiceAsBaseMap()}else if(p.mapservice.action==="enable"){this._enableService=true;this._changeBaseMap({serviceId:this._selectedServiceId,color:this._selectedServiceColor})}else if(p.mapservice.action==="disable"){this._mapServiceSelector.hide();this._enableService=false;this._changeBaseMap({})}}}}}};z.prototype.data=function(e){try{if(arguments.length>0){if(this._chart){if(!e.length){return this}var t=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var i=t.length>e.length?e.length:t.length;for(var r=0;r<i;++r){if(e[r]){t[r].data(e[r])}}return this}else{throw p.get("VIZ_CHART_UPDATE_DATA_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{var n=[];if(this._chart){var t=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var r=0;r<t.length;++r){n.push(t[r].data())}}return n}}catch(e){throw p.get("VIZ_CHART_UPDATE_DATA_FAILED")+e}};z.prototype.action=function(e,t){if(this._chart){if(this._chart.__instance){return this._chart.__instance.action(e,t)}else{return this._chart}}else{throw p.get("VIZ_CHART_TRIGGER_ACTION_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};z.prototype.exportViz=function(e){if(!this._isMapInitialized()&&this._loadedViz){return this._loadedViz}if(this._chart){var t=this._chart.toJSON(e);t.esriServices=[this._exportEsriService()];return t}else{throw p.get("VIZ_CHART_SERIALIZE_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};z.prototype._exportEsriService=function(){return{serivceId:this._selectedServiceId,color:this._selectedServiceColor,enableService:!!this._enableService}};z.prototype._loadEsriService=function(e){if(e.esriServices&&e.esriServices.length>0){this._selectedServiceId=e.esriServices[0].serivceId;this._selectedServiceColor=e.esriServices[0].color;this._enableService=e.esriServices[0].enableService}};z.prototype.loadViz=function(e){this._destroyChartInstance();if(!e.baseMap){this._createChartInstance();return}this._loadedViz=d.clone(e);this._loadEsriService(this._loadedViz);this._hasChartInstance=true;this._mapInitialized=false;this._dispatchEvent(new m(m.CHART_CHANGING,this,e.type));this._updateDescription();this.showLoadingIcon();var t={};if(e.properties&&e.properties.tooltip){t.tooltip=e.properties.tooltip}var i=this._chartLayer$;var r=sap.viz.api.core.createViz({type:e.type,container:i.get(0),options:t});this._chart=r.action("getMap");this._chart.__instance=r;this._bindExternalEventListener();if(e.baseMap.id.indexOf("esri")!==-1){this._logonESRI(function(){sap.viz.geo.LocationRepository.useLocal({resourcePath:this._geoResourcePath});this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_LOADING"));this._chart.fromJSON(e);this._postVizProcess(this._options)}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized")}}.bind(this))}else if(e.baseMap.id.indexOf("cvom")!==-1){sap.viz.geo.LocationRepository.useLocal({resourcePath:this._geoResourcePath});this._chart.fromJSON(e);this._postVizProcess(this._options)}else if(e.baseMap.id.indexOf("navtaq")){this._chart.fromJSON(e);this._postVizProcess(this._options)}};z.prototype._setChartSize=function(e,t){if(this._chart&&this._chart.__instance){this._chart.__instance.size({width:e,height:t})}};z.prototype._updateDescription=function(e){if(e){this._descriptionLayer$.show();this._descriptionLayer$.text(e);this._showDescription()}else{this._descriptionLayer$.hide();this._chartHolder$.css({opacity:""})}this.hideLoadingIcon()};z.prototype.getTitleByFeeding=function(){return""};z.prototype._logonESRI=function(e,t){var i=sap.viz.geo.basemap.esri.Authentication.credential().disabled;if(i){this._updateDescription(sap.viz.geo.basemap.esri.Authentication.credential().description);t.call(this);return}var r=sap.viz.geo.basemap.esri.Authentication.credential().accessToken;if(!r){this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_LOG_ON"));sap.viz.geo.basemap.esri.Authentication.login({credential:{}},function(){this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_LOADING"));e.call(this)}.bind(this),function(e){if(e===null||e===undefined||e===""){this._updateDescription(p.get("VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE"))}else{this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL")+": "+e)}t.call(this)}.bind(this))}else{this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_LOG_ON"));sap.viz.geo.basemap.esri.Authentication.checkLoginStatus(r,function(){e.call(this)}.bind(this),function(e){if(e===null||e===undefined||e===""){this._updateDescription(p.get("VIZ_CHART_ESRI_SERVICES_UNACCESSIBLE"))}else{this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_AUTHENTICATION_FAIL")+": "+e)}t.call(this)}.bind(this))}};z.prototype._createChartInstance=function(){var e=this._options;var t=this._chartLayer$;var i=this._descriptionLayer$;var n=this._chartHolder$;var o=r.TYPE_GEO_MAP;this._destroyChartInstance();try{this._dispatchEvent(new m(m.CHART_CHANGING,this,o));var a=sap.viz.api.core.createViz({type:o,container:t.get(0),options:{tooltip:this.properties().tooltip}});this._chart=a.action("getMap");this._chart.__instance=a;this._bindExternalEventListener();this._hasChartInstance=true;this._mapInitialized=false;var l=s.ESRI;if(l===s.ESRI){this._logonESRI(function(){this._updateDescription(p.get("VIZ_CHART_ESRI_MAP_LOADING"));var t=this.createBaseMap(l,{});this._chart.baseMap(t,this._afterMapInitialized.bind(this));this._postVizProcess(e)}.bind(this),function(){this._hasChartInstance=false;this._chartModelProvider().extensionValues({map:{logOnFail:true}});if(this._chart){this._chart._fireEvent("initialized")}}.bind(this))}else{var h=this.createBaseMap(l,{});this._chart.baseMap(h,this._afterMapInitialized.bind(this));this._postVizProcess(e)}}catch(e){var u=p.get("VIZ_CHART_CREATE_CHART_FAILED")+e;if(!c.getVizFeeds(o)){this._updateDescription(d.substitute(p.get("VIZ_CHART_INVALID_VIZ_TYPE"),o))}else{this._updateDescription(u)}t.html("");this._chart=null;this._hasChartInstance=false;throw u}};z.prototype._afterMapInitialized=function(e){var i=t.proxy(function(e,t){this._dispatchEvent(new m(m.TRIGGER_CVOM_EVENT,this,{type:e,data:t}))},this);this.hideLoadingIcon();this._updateDescription();var r=this._chartModelProvider();i("initialized",e);if(!this._loadedViz&&this._isMapInitialized()===false){this._chartModelProvider().extensionValues({map:{created:true}})}else if(this._loadedViz){this._restoreMapBuilder()}this._mapInitialized=true;if(this._updateCache){this.update(this._updateCache);this._updateCache=null}};z.prototype._bindExternalEventListener=function(){if(this._chart){Object.keys(this._onEventMap).forEach(t.proxy(function(e){var t=this._onEventMap[e];this._chart.on(e,t)},this))}};z.prototype._postVizProcess=function(e){var i=t.proxy(function(e,t){this._dispatchEvent(new m(m.TRIGGER_CVOM_EVENT,this,{type:e,data:t}))},this);this._chart.on("initialized.chartview",this._afterMapInitialized.bind(this));this._chart.on("mapChanged.chartview",function(){this._chartModelProvider().extensionValues({})}.bind(this));var r=this;this._chart.on("selectData.chartview",function(e){r._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this));i("selectData",e)});this._chart.on("deselectData.chartview",function(e){r._dispatchEvent(new m(m.CHANGED_SELECTED_DATA,this));i("deselectData",e)});this._chart.on("showTooltip.chartview",function(e){i("showTooltip",e)});this._chart.on("hideTooltip.chartview",function(e){i("hideTooltip",e)});this._hasChartInstance=true;this._dispatchEvent(new m(m.CHART_CHANGED,this,this._chart))};z.prototype.getTemplateId=function(e){return this._templateId};z.prototype._isMapInitialized=function(){return this._mapInitialized};z.prototype.update=function(e){if(this._isMapInitialized()){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_mapView-update");var t;try{if(e.data){this._options.data=e.data}var i=e.properties;if(i){this._options.properties=i}if(!this._chart){t=p.get("VIZ_CHART_UPDATE_CHART_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED");this._updateDescription(t);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_mapView-update");throw t}this._updateDescription();this._chartLayer$.css("opacity","");var r=this._chart;if(r){if(e.data){for(var n=0;n<e.data.length;n++){if(e.data[n]||e.data[n]===null){var s=r.getLayer(n);var o=e.feeding?e.feeding[n]:null;if(s){s.data(e.data[n],o,true)}}}}if(i){var a=i.layers;if(a){a.forEach(function(e,t){if(e){b(r.getLayer(t),e.formats)}})}}}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_mapView-update");return this}catch(e){t=p.get("VIZ_CHART_UPDATE_CHART_FAILED")+e;this._updateDescription(t);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_mapView-update");throw t}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_mapView-update")}else{this._updateCache=e}};var O={bubble:{measureFeedId:"size",legendPropName:"sizeLegend"},choropleth:{measureFeedId:"color",legendPropName:"mbcLegend"}};function b(e,t){if(e&&t){var i=e.viz();var r;if(i instanceof sap.viz.geo.dataviz.Marker){r="marker"}else if(i instanceof sap.viz.geo.dataviz.Bubble){r="bubble"}else if(i instanceof sap.viz.geo.dataviz.Choropleth){r="choropleth"}if(r){var n=O[r];if(n){var s=n.measureFeedId;function o(e){var i=t[e];if(i){i=i[s];i=i&&i[0]}return i}var a=o("viz");if(a){var l={};l[n.legendPropName]={formatString:a};i.properties(l)}var c=o("tooltip")||a;if(c){e.tooltipFormat(c)}}}}}z.prototype.feeding=function(e,t){try{if(this._chart){if(arguments.length>0&&e.length>0){var i=this._chart.getLayers?this._chart.getLayers():this._chart._layers;var r=i.length>e.length?e.length:i.length;for(var n=0;n<r;++n){if(e[n]){i[n].feeding(e[n])}}return this}else{var s=[];var i=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var n=0;n<i.length;++n){var o=i[n].feeding();s.push(o)}return s}}else{throw p.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}catch(e){throw p.get("VIZ_CHART_UPDATE_FEEDING_FAILED")+e}};z.prototype.getValidProperties=function(e,t){if(t===r.TYPE_GEO_MAP){return e}return v.getValidProperties(e,t)};z.prototype.properties=function(e){try{if(arguments.length>0){this._options.properties=e;if(this._chart){var t=this._chart;var i=this._chart.getLayers?this._chart.getLayers():this._chart._layers;for(var r=0;r<i.length;r++){var n=i[r];if(n&&e.legend){n.legendVisibility(e.legend.visible)}}return this}else{throw p.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+p.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{return this._options.properties}}catch(e){throw p.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+e}};z.prototype.copyData=function(e,t){if(t&&t.length>0){var i=[];for(var r=0;r<t.length;r++){if(t[r]&&t[r].id&&t[r].id==="sap.viz.data.FlatTableDataset"){var n=sap.viz.api.data.FlatTableDataset.fromJSON(t[r]);i.push(n)}else i.push(t[r])}return i}else{return t}};z.prototype.buildFeedings=function(e,t,i){var r=[];for(var n=0;n<i.length;n++){r[n]={};if(!i[n]||i[n].length===0){continue}i[n].forEach(function(e){if(e._values&&e._values.length){if(e._values[0].type()===I.HIERARCHY){for(var t=0;t<e._values[0].hierarchyLevels().length;t++){var i=e._values[0].hierarchyLevels()[t];if(i.selected()){r[n][e._id]=i._id;break}}}else{r[n][e._id]=e._values[0]._id}}})}return r};z.prototype.createBaseMap=function(e,t){var i=null;if(e===s.ESRI){sap.viz.geo.LocationRepository.useLocal({resourcePath:this._geoResourcePath});var r="topo";if(t&&t.type){r=t.type}return new sap.viz.geo.basemap.esri.Provider({basemap:r})}else if(e===s.NAVTEQ){var n={center:[40.72,-84],zoomLevel:5};return new sap.viz.geo.basemap.navteq.Provider(n)}else{sap.viz.geo.LocationRepository.useLocal({resourcePath:this._geoResourcePath});var n={center:[-84,40.72],scale:6e3};return new sap.viz.geo.basemap.cvom.Provider(t)}};z.prototype.FeedsToJSON=function(e){var t=[];for(var i=0;i<e.length;i++){t[i]=C.toJSON(e[i])}return t};z.prototype.FeedsFromJSON=function(e){var t=[];for(var i=0;i<e.length;i++){t[i]=C.fromJSON(e[i])}return t};z.prototype._queryEsriServices=function(e){var i=sap.viz.geo.basemap.esri.Authentication.credential();if(i!=null){var r="https://www.arcgis.com/sharing/rest/content/users/"+i.username;t.ajax({url:r,data:{token:i.accessToken,f:"json"},dataType:"json",type:"POST",success:function(t){if(t.items){this._esriservices=t.items.filter(function(e){return e.type==="Feature Service"});e()}}.bind(this)})}};z.prototype._chooseMapServiceAsBaseMap=function(){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){var e=t(this._div).height()/2-this._mapselector$.height()/2;var i=t(this._div).width()/2-this._mapselector$.width()/2;this._mapselector$.css({top:e,left:i});this._mapServiceSelector.show(this._esriservices,sap.viz.geo.basemap.esri.Authentication.credential().accessToken,this._selectedServiceId)}else{var e=t(this._div).height()/2-this._mapNoService$.height()/2;var i=t(this._div).width()/2-this._mapNoService$.width()/2;this._mapNoService$.css({top:e,left:i});this._mapNoService.show()}}.bind(this))};z.prototype._getVizTypeByVizId=function(e){if(e==="sap.viz.geo.dataviz.Bubble"){return"bubble"}else if(e==="sap.viz.geo.dataviz.Marker"){return"marker"}else{return"choropleth"}};z.prototype._restoreMapBuilder=function(e){if(this._loadedViz&&this._loadedViz.layers.length>0){var t=[];var i=this._chartModelProvider().feedingItems();for(var r=0;r<this._loadedViz.layers.length;r++){var n=this._getVizTypeByVizId(this._loadedViz.vizs[this._loadedViz.layers[r].vizIndex].id);var s="";if(i[r].length>0){if(i[r][0].values().length>0){s=i[r][0].values()[0].name()}}var o=false;if(n==="bubble"||n==="marker"){o=this._loadedViz.vizs[this._loadedViz.layers[r].vizIndex].options.cluster.enabled}var a={checked:this._loadedViz.layers[r].options.visible,feeding:{feeding:this.FeedsToJSON(i[r])},title:s,titleText:n,vizType:n,sortable:true,clusterChecked:o};t.push(a)}this._chartModelProvider().extensionValues({mapBuilder:{status:t}})}if(this._loadedViz&&this._selectedServiceId){this._queryEsriServices(function(){if(this._esriservices&&this._esriservices.length>0){this._chartModelProvider().extensionValues({mapBuilder:{mapservice:{showRadio:true,checked:!!this._enableService}}})}}.bind(this))}this._loadedViz=null};z.prototype.exportable=function(){return this._chart!=null};z.prototype.exportToSVGString=function(e){return""};z.prototype.queryProperties=function(e){return{}};z.prototype.updateProperties=function(e){};z.prototype.selectedPropertyZone=function(){if(arguments.length){return this}return null};return z});e("sap/viz/controls/chart/views/TableView",["jquery","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/DatasetTypeConst","sap/viz/controls/common/constants/MapProviderConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/TrellisUtils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/ChartConfig","sap/viz/controls/chart/views/View","sap/viz/controls/common/utils/IncompleteGhost"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g){var E=function(t,i,r,n){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.view.TableView";this._createChildren();sap.viz.extapi.env.Template.addListener(e.proxy(this.changeTemplate,this))};c.extend(E,m);E.prototype._createChildren=function(){E.superclass._createChildren.apply(this,arguments);this._createDropZone()};E.prototype.getTitleZone=function(){if(!this._chart){return[]}var e=this._chart.type;var t;try{t=this._chart.propertyZone()}catch(e){return[]}var i=[];for(var r=0;r<t.length;r++){if(t[r].name=="title"){i=t[r].bound[0];break}}return i};E.prototype.properties=function(e,t){try{if(!t){this._requestMorphing=true}if(arguments.length>0){this._options.properties=e;if(this._chart){this._chart.properties(e);return this}else{throw l.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.properties()}else{return this._options.properties}}}catch(e){throw l.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+e}};E.prototype.css=function(e){try{if(arguments.length>0){this._updateCssCacheByNewCss(e);this._options.css=e;if(this._chart){this._chart.css(e);return this}else{throw l.get("VIZ_CHART_UPDATE_CSS_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._chart){return this._chart.css()}else{return this._options.css}}}catch(e){throw l.get("VIZ_CHART_UPDATE_CSS_FAILED")+e}};E.prototype._createChartInstance=function(){this._hasChartInstance=false;var e=this._options;var t=this._chartLayer$;var i=this._descriptionLayer$;var r=this._chartHolder$;var n=e.type;this._supportMorphing=false;this._destroyChartInstance();try{this._dispatchEvent(new v(v.CHART_CHANGING,this,n));this._updateDescriptionByOptions(e);this._chart=sap.viz.api.core.createViz({type:n,data:e.data,feeding:e.feeding,properties:e.properties,css:e.css,events:e.events,container:t.get(0)});this._postVizProcess(e)}catch(e){var s=l.get("VIZ_CHART_CREATE_CHART_FAILED")+e;if(!a.getVizFeeds(n)){this._updateDescription(p.substitute(l.get("VIZ_CHART_INVALID_VIZ_TYPE"),n))}else{this._updateDescription(s)}t.html("");this._chart=null;this._hasChartInstance=false;throw s}};E.prototype._postVizProcess=function(t){Object.keys(this._onEventMap).forEach(e.proxy(function(e){var t=this._onEventMap[e];this._chart.on(e,t)},this));this._hasChartInstance=true;this._dispatchEvent(new v(v.CHART_CHANGED,this,this._chart))};E.prototype.buildFeedings=function(e,t,i){var r=null;if(!t||h.isEmptyData(e,t)){return r}if(!u.hasFakeData(t)&&!h.isEmptyData(e,t)&&!a.isEmptyFeeds(i)){r=[];i.forEach(function(e){var t=e.id();r[t]=[];e.values().forEach(function(e){var i={id:e.id(),name:e.name(),type:e.type()};r[t].push(i)})})}return r};E.prototype.exportViz=function(e){if(this._chart){var t=this._chart.toJSON(e);return t}else{throw l.get("VIZ_CHART_SERIALIZE_FAILED")+l.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};return E});e("sap/viz/controls/chart/ViewManager",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/chart/views/ChartView","sap/viz/controls/chart/views/InfoChartView","sap/viz/controls/chart/views/MapView","sap/viz/controls/chart/views/TableView"],function(e,t,i,r,n,s){var o={};var a={};a._register=function(e,t){if(e&&t){o[e]=t}};a._getViewClass=function(e){if(o.hasOwnProperty(e)){return o[e]}else if(t.isInfoChart(e)){return r}else{return i}};a.getViewClass=function(e){return a._getViewClass(e)};a._register(e.TYPE_GEO_MAP,n);a._register(e.TYPE_TABLE,s);a._register(e.TYPE_CROSSTAB,s);return a});e("sap/viz/controls/chart/VizProxyHandler",["sap/viz/controls/runtime/VizProxy","sap/viz/controls/chart/views/ChartEvent"],function(e,t){var i=function(e){this.__className="sap.viz.controls.chart.VizProxyHandler";this._chart=e;this._init()};i.prototype._init=function(){this._operationMap={};this._operationMap[e.GetTitleZoneOperation]=this._getTitleZone;this._operationMap[e.GetTitleTextOperation]=this._getTitleText;this._operationMap[e.SetTitleTextOperation]=this._setTitleText;this._operationMap[e.GetTitleTextByFeedingOperation]=this._getTitleTextByFeeding;this._operationMap[e.RestoreTitleTextOperation]=this._restoreTitleText;this._operationMap[e.SetTitleModeOperation]=this._setTitleMode;this._operationMap[e.IsFakeChartOperation]=this._isFakeChart;this._operationMap[e.IsTitleCustomizedOperation]=this._isTitleCustomized;this._operationMap[e.GetPropertiesOperation]=this._getProperties;this._operationMap[e.SetPropertiesOperation]=this._setProperties;this._operationMap[e.GetSelectionOperation]=this._getSelection;this._operationMap[e.SetDatasetOperation]=this._setDataset;this._operationMap[e.GetPropertyZonesOperation]=this._getPropertyZones;this._operationMap[e.SetPropertyZonesOperation]=this._setPropertyZones;this._operationMap[e.QueryPropertiesOperation]=this._queryProperties;this._operationMap[e.UpdatePropertiesOperation]=this._updateProperties;this._operationMap[e.GetDatasetOperation]=this._getDataset;this._operationMap[e.AddEventListenerOperation]=this._addEventListener;this._operationMap[e.RemoveEventListenerOperation]=this._removeEventListener;this._operationMap[e.SetAxisScaleOperation]=this._setAxisScaleListener;this._operationMap[e.GetDataPointsPosition]=this._getDataPointsPosition;this._operationMap[e.GetTypeOperation]=this._getType;this._operationMap[e.OnOperation]=this._on;this._operationMap[e.OffOperation]=this._off;this._operationMap[e.GetSizeOperation]=this._getSize;this._operationMap[e.SetSizeOperation]=this._setSize;this._operationMap[e.GetVizFeedingOperation]=this._getVizFeeding};i.prototype.response=function(e){var t=e.operation;var i=e.args;e.result=this._operationMap[t].apply(this,i)};i.prototype._getTitleZone=function(){return this._chart.getTitleZone()};i.prototype._getTitleText=function(){return this._chart.vizTitle()};i.prototype._setTitleText=function(e){this._chart.vizTitle(e)};i.prototype._getTitleTextByFeeding=function(){return this._chart.getTitleTextByFeeding()};i.prototype._restoreTitleText=function(){this._chart.restoreTitleText()};i.prototype._setTitleMode=function(e){this._chart.vizTitleMode(e)};i.prototype._isFakeChart=function(){return this._chart.isFake()};i.prototype._isTitleCustomized=function(){return this._chart.isTitleCustomized()};i.prototype._getProperties=function(){return this._chart.vizProperties()};i.prototype._setProperties=function(e){this._chart.vizProperties(e)};i.prototype._setDataset=function(e){this._chart.vizUpdate({data:e})};i.prototype._getSelection=function(){return this._chart.vizSelection()};i.prototype._getType=function(){return this._chart.vizType()};i.prototype._getPropertyZones=function(){return this._chart.getPropertyZones()};i.prototype._setPropertyZones=function(e){this._chart.setPropertyZones(e)};i.prototype._queryProperties=function(e){return this._chart.queryProperties(e)};i.prototype._updateProperties=function(e){this._chart.updateProperties(e)};i.prototype._getDataset=function(){return this._chart.vizData()};i.prototype._addEventListener=function(e,t,i,r){this._chart.addEventListener(e,t,i,r)};i.prototype._removeEventListener=function(e,t,i){this._chart.removeEventListener(e,t,i)};i.prototype._setAxisScaleListener=function(e){return this._chart.setAxisScale.apply(this._chart,arguments)};i.prototype._getDataPointsPosition=function(e){return this._chart.getDataPointsPosition.apply(this._chart,arguments)};i.prototype._on=function(e,t){return this._chart.vizOn.apply(this._chart,arguments)};i.prototype._off=function(e){return this._chart.vizOff.apply(this._chart,arguments)};i.prototype._getSize=function(){return this._chart.size()};i.prototype._setSize=function(e){if(e){this._chart.size(e);this._chart._dom$.parent().width(e.width);this._chart._dom$.parent().height(e.height)}};i.prototype._getVizFeeding=function(){return this._chart.getFeeding()};return i});e("sap/viz/controls/chart/Chart",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/DatasetTypeConst","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/chart/ChartConfig","sap/viz/controls/chart/ChartPreHandler","sap/viz/controls/common/utils/IncompleteGhost","sap/viz/controls/chart/views/ChartView","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/View","sap/viz/controls/chart/views/InfoChartView","sap/viz/controls/chart/ViewManager","sap/viz/controls/runtime/RuntimeManager","sap/viz/controls/common/services/BVRService","sap/viz/controls/runtime/VizProxy","sap/viz/controls/chart/VizProxyHandler"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A,P,R,z,O){var b=function e(t,r){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.Chart";this._div=t;this._uiConfig=r?r:m.instance();this._uiConfig.libFolderPath=i.defaultAssetsRoot()+"/common/libs";this._layout=null;this._chartViewInstance=null;this._type=null;this._data=null;this._properties=null;this._categoryAxis=[];this._valueAxis=[];this._labelFormats=null;this._css=null;this._description=null;this._vizCreated=false;this._enableVizDefChangedEvent=true;this._loadingModel=false;this._loadingInstance=false;this._titleMode=e.VIZ_TITLE_MODE.auto;this._titleGeneratorFunc=null;this._enableTrellis=this._uiConfig.enableTrellis!==false;this._enableMorphing=this._uiConfig.enableMorphing!==false;P.getRuntime().registerModel(this._uid,this._vizModel());this._vizProxyHandler=new O(this);this._vizModel().addEventListener(z.VizProxyEvent,function(e){this._vizProxyHandler.response(e.data)},this);this._chartPreHandler=new g({useInfoChart:this._uiConfig.useInfoChart});this._createChildren();this._onEventMap={}};u.extend(b,t);b.VIZ_TITLE_MODE={manual:"manual",auto:"auto"};b.prototype.vizType=function(e){if(arguments.length>0){if(!_.isString(e)){return}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizType()_set");this._beginUpdateProperty();this._vizType=e;this._vizModel().type(this._vizType);this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizType()_set");return this}else{return this._vizModel().type()}};b.prototype.vizTitle=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizTitle()_set");if(v.hasFakeData(this._data)){e=" "}var t=this.vizProperties()?this.vizProperties().title:null;if(!t||e!==t.text){if(!t){t={}}t.text=e;this.vizProperties({title:t})}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizTitle()_set");return this}else{var e=this.vizProperties()?this.vizProperties().title:null;return e?e.text:null}};b.prototype.clearSelectedPropertyZone=function(){this._chartViewInstance.selectedPropertyZone(null)};b.prototype.isFake=function(){return v.hasFakeData(this._data)};b.prototype.setTitleGeneratorFunc=function(e){if(e!==null&&e!==undefined&&!_.isFunction(e)){return}this._titleGeneratorFunc=e};b.prototype.vizTitleMode=function(e){if(arguments.length>0){if(e==b.VIZ_TITLE_MODE.auto||e==b.VIZ_TITLE_MODE.manual){this._titleMode=e}}else{return this._titleMode}};b.prototype.isTitleCustomized=function(){return this._titleMode===b.VIZ_TITLE_MODE.manual};b.prototype.getTitleZone=function(){if(this._chartView().getTitleZone){return this._chartView().getTitleZone()}else{return[]}};b.prototype.getTitleTextByFeeding=function(){if(this._titleGeneratorFunc){var e=[this.vizUid()];return this._titleGeneratorFunc.apply(null,e)}return this._chartView().getTitleByFeeding()};b.prototype.restoreTitleText=function(){this.vizTitle(this.getTitleTextByFeeding())};b.prototype._titleChangedHandler=function(e){var t=e.data.text;this.vizTitle(t)};b.prototype.destroy=function(){this._destroyViz();b.superclass.destroy.apply(this,arguments)};b.prototype.feedAnalysisObjects=function(e,t){this._beginUpdateProperty();var i=this._vizModel();var r;if(t===true){r=R.suggestFeeds(i.type(),i.explicitFeedingItems(),e)}else{r=R.suggestFeeds(i.type(),e)}var n=i.explicitFeedingItems();if(r){if(h.equal(n,r.feeds)){for(var s in e){var o=h.getVizFeeds(i.type());for(var a in o){if(h.canAddFeed(n,o[a],e[s])){x(this._vizModel().type(),n,e[s])}}}}else{n=r.feeds}i.feedingItems(n)}this._endUpdateProperty();return n};b.prototype.getDefaultIncompleteOptions=function(e){if(!_.isString(e)){return}var t=this._getDefaultProperties(e);return{type:e,properties:t,data:E.getDataset(e)}};b.prototype._updateColumnDimCount=function(){if(d.isMultipleChart(this._vizModel().type())){var e=h.getNumberOfDimensionsInColumn(this._vizModel().feedingItems());this._properties=this._properties||{};this._properties.multiLayout=this._properties.multiLayout||{};this._properties.multiLayout.numberOfDimensionsInColumn=e}};b.prototype._dispatchVizDefChangedEvent=function(e){var t={vizTypeChanged:e.vizTypeChanged===true,vizPropertiesChanged:e.vizPropertiesChanged===true,vizCssChanged:e.vizCssChanged===true,feedingItemsChanged:e.feedingItemsChanged===true,filterChanged:e.filterChanged===true,vizTitleChanged:e.vizTitleChanged===true};if(this._vizDefChangedData){for(var i in this._vizDefChangedData){if(this._vizDefChangedData.hasOwnProperty(i)){t[i]=t[i]||this._vizDefChangedData[i]}}this._vizDefChangedData=null}if(this._enableVizDefChangedEvent){this._dispatchEvent(new o(s.VIZ_DEFINITION_CHANGED,this,t))}else{this._vizDefChangedData=t}};b.prototype._updateView=function(t){var i=A.getViewClass(t);if(this._chartViewInstance instanceof i){return}if(this._chartViewInstance){this._chartViewInstance.destroy();this._chartViewInstance=null;this._data=null}this._createChartView(i);this._chartView().onEventMap(this._onEventMap);var r={width:e(this._div).width(),height:e(this._div).height()};this._chartView().size(r);if(d.isTable(t)){this._data=E.getDataset(t)}var n={type:t};this._dispatchEvent(new I(I.VIZ_VIEW_CHANGED,this,n))};b.prototype._onVizModelChanged=function(e){this._dispatchVizDefChangedEvent(e.data);var t=this._vizModel().type();if(e.data.vizTypeChanged){this._updateView(t)}if(this._loadingModel){return}if(e.data.vizTypeChanged){if(!this._inUpdatingProperty()){this._properties=this._chartView().resetProperties(this._properties,t)}this._updateAxisProperties(t);this._updateLabelFormats(t);this._dispatchPropertyEvent(new I(I.VIZTYPE_CHANGED,this,{type:t}))}if(!this._chartView()){return}if(e.data.feedingItemsChanged&&!d.isGeo(t)){this._updateColumnDimCount();if(!this._inUpdatingProperty()){this._updateTitle();this.showLoadingIcon();var i=d.getDatasetType(t);this._dispatchPropertyEvent(new a(a.FEEDS_CHANGED,this,{datasetType:i,feeds:this.feeds()}));return}}this._chartView().modelChanged(this._vizModel(),e.data);if(e.data.extensionValuesChanged){var r=this._vizModel().extensionValues();if(r.feedingPanel&&this._enableTrellis!==r.feedingPanel.enableTrellis){this._enableTrellis=r.feedingPanel.enableTrellis;this._chartView().enableTrellis(this._enableTrellis)}}if(this._needCreateViz(t,false)&&(e.data.vizTypeChanged||e.data.feedingItemsChanged)){this._createVizInstance()}};function S(e,t,i){if(t&&i){var r,n,s;for(r=0;r<t.length;r++){n=t[r];if(i.length>r){s=i[r];e[n]=_.clone(i[r])}}}}b.prototype._updateAxisProperties=function(e){if(this._properties){var t=v.getCategoryAxis(e);S(this._properties,t,this._categoryAxis);var i=v.getValueAxis(e);S(this._properties,i,this._valueAxis)}};b.prototype._updateLabelFormats=function(e){var t=["xAxis","xAxis2","yAxis","yAxis2","valueAxis"];var i={xAxis:"yAxis",xAxis2:"yAxis2",yAxis:"xAxis",yAxis2:"xAxis2"};var r,n;if(!this._labelFormats&&this._properties){for(r=0;r<t.length;r++){n=t[r];var s;if(n==="valueAxis"){s=this._properties.plotArea?this._properties.plotArea.valueAxis:null}else{s=this._properties[n]}var o=s&&s.label&&s.label.hasOwnProperty("formatString")?true:false;if(o){this._labelFormats=this._labelFormats||{};this._labelFormats[n]=s.label.formatString}}}var a=sap.viz.api.manifest.Viz.get(e)[0].allProperties();if(!a){return}var l;for(r=0;r<t.length;r++){n=t[r];var c;if(n==="valueAxis"){if(a.plotArea&&a.plotArea.valueAxis){c=a.plotArea.valueAxis.supportedValues}}else{c=a[n]}var p=c&&c.label&&c.label.supportedValues&&c.label.supportedValues.hasOwnProperty("formatString")?true:false;if(p){var h;if(this._properties){var d;if(n==="valueAxis"){if(this._properties.plotArea&&this._properties.plotArea.valueAxis){d=this._properties.plotArea.valueAxis;if(d&&d.label&&d.label.hasOwnProperty("formatString")){h=d.label.formatString}}}else{d=_.clone(this._properties[n]);if(d&&d.label&&d.label.hasOwnProperty("formatString")){h=d.label.formatString}}}if(h===undefined&&this._labelFormats){h=this._labelFormats[n];if(h===undefined&&n!=="valueAxis"){var u=i[n];if(u){h=this._labelFormats[u]}}}if(h===undefined){h=this._uiConfig.defaultLabelFormatString}if(h!==undefined){this._properties=this._properties||{};if(n==="valueAxis"){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.valueAxis=this._properties.plotArea.valueAxis||{};this._properties.plotArea.valueAxis.label={formatString:h}}else{this._properties[n]=this._properties[n]||{};this._properties[n].label={formatString:h}}}}else{l=l||[];l.push(n)}}if(l&&this._properties){for(r=0;r<l.length;r++){n=l[r];if(n==="valueAxis"){if(this._properties.plotArea&&this._properties.plotArea.valueAxis&&this._properties.plotArea.valueAxis.label){delete this._properties.plotArea.valueAxis.label.formatString}}else{if(this._properties[n]&&this._properties[n].label){delete this._properties[n].label.formatString}}}}};b.prototype._createChartView=function(t){var i=this._chartViewInstance=new t(e(this._div),{type:this._vizModel().type(),useBuiltInPropertyZoneInteraction:this._uiConfig.useBuiltInPropertyZoneInteraction,useDefaultChartSizeForTrellis:this._uiConfig.useDefaultChartSizeForTrellis},this._uiConfig.libFolderPath,e.proxy(this._vizModel,this),{vizProperties:e.proxy(this.vizProperties,this),vizCss:e.proxy(this.vizCss,this),vizCssProperty:e.proxy(this.vizCssProperty,this),vizOn:e.proxy(this.vizOn,this),vizType:e.proxy(this.vizType,this),selectedPropertyZone:e.proxy(this.selectedPropertyZone,this),vizData:e.proxy(this.vizData,this)});i.enableTrellis(this._enableTrellis);i.enableMorphing(this._enableMorphing);i.addEventListener(I.TITLE_CHANGED,this._titleChangedHandler,this);i.addEventListener(I.ANALYSIS_DROPPED,this._analysisDroppedHandler,this);i.addEventListener(I.CHART_CHANGED,function(e){this._dispatchEvent(e)},this);i.addEventListener(I.CHART_CHANGING,function(e){this._dispatchEvent(e)},this);i.addEventListener(I.CHANGED_SELECTED_DATA,function(e){this._dispatchEvent(new I(I.CHANGED_SELECTED_DATA,this,e.data))},this);i.addEventListener(I.SELECT_PROPERTY_ZONE,function(e){this._dispatchEvent(new I(I.SELECT_PROPERTY_ZONE,this,e.data))},this);i.addEventListener(C.DISPATCH_PROPERTY_EVENT,function(e){var t=e.data;this._dispatchPropertyEvent(t)},this);i.addEventListener(I.PROPERTY_ZONES_CHANGED,function(e){this._dispatchEvent(new I(I.PROPERTY_ZONES_CHANGED,this,e.data))},this)};b.prototype._createChildren=function(){this._validateSize();this._createChartView(y)};b.prototype._analysisDroppedHandler=function(e){var t;var i=this._vizModel();var r=i.explicitFeedingItems();var n;var s=e.data.zone;var o=e.data.analysisObject;if(s.feedDef.length===1){var a=s.feedDef[0];var l=a.id;if(s.name===h.RowsFeedingName||s.name===h.ColumnsFeedingName){l=s.name}n=h.getFeed(r,l);if(!n){n=new c(l,a.type,[]);r.push(n)}var d=a.type===p.MEASURE?a.max:a.maxStackedDims;if(d===null||d===undefined){d=Number.MAX_VALUE}if(n.values().length===d){n.values().splice(0,1)}n.values().push(o)}else{var u=[];for(t=0;t<s.feedDef.length;t++){if(s.feedDef[t].id===h.MultiplierFeedingName){u.push(h.RowsFeedingName);u.push(h.ColumnsFeedingName)}else{u.push(s.feedDef[t].id)}}var _=R.suggestFeeds(i.type(),r,[o],u);if(_){if(h.equal(r,_.feeds)){x(this._vizModel().type(),r,o)}else{r=_.feeds}}}i.feedingItems(r,this._enableTrellis)};function x(e,t,i){var r=R.suggestFeeds(e,[i]);var n,s,o;for(s=0;s<r.feeds.length;s++){o=r.feeds[s];if(o.values().length===1){n=o.id();break}}for(s=0;s<t.length;s++){o=t[s];if(o.id()===n){var a=false;var l=o.values();for(var c in l){if(l[c].id()===i.id()){a=true;break}}if(!a&&o.values().length>0){o.values().splice(0,1);o.values().push(i)}}}}b.prototype._validateSize=function(){var t=e(this._div).width();var i=e(this._div).height();e(this._layout).css({width:t+"px",height:i+"px",visibility:"visible",display:""});if(this._chartView()){this._chartView().size({width:t,height:i})}};b.prototype._updateData=function(e,t){this._data=this._chartViewInstance.copyData(e,t)};b.prototype._chartView=function(){return this._chartViewInstance};b.prototype._needCreateViz=function(e,t){if(t===true){return true}var i=false;if(d.isTable(e)){i=true}else{if(e!==this._type){i=true}}if(!this._chartView().hasChartInstance()){i=true}return i};b.prototype._needChangeTemplate=function(e,t){var i=this._chartViewInstance.getTemplateId();var r=this._chartViewInstance.getTemplateId(t);return i!==r};b.prototype.showLoadingIcon=function(){this._chartView().showLoadingIcon()};b.prototype.connect=function(e){};b.prototype.disconnect=function(){};b.prototype.chartModel=function(){return this._vizModel()};b.prototype.vizUid=function(){return this._uid};b.prototype.vizData=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizData_set");var t=this._vizModel().type();this._updateData(t,e);if(this._vizCreated){var i=this._needChangeTemplate(t,e);if(i||d.isTable(t)){this._createVizInstance()}else{this._chartView().data(this._data)}}else{throw f.get("VIZ_CHART_UPDATE_DATA_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizData_set");return this}else{if(this._chartView()){return this._chartView().data()}return null}};b.prototype.vizCss=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizCss_set");this._css=e;if(this._vizCreated){this._chartView().css(this._css);this._css=this._chartView().css()}else{throw f.get("VIZ_CHART_UPDATE_CSS_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}this._dispatchVizDefChangedEvent({vizCssChanged:true});sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizCss_set");return this}else{return this._chartView().css()}};b.prototype.vizProperties=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizProperties_set");this._enableVizDefChangedEvent=false;var t=this._vizModel().type();var i=this._initOptions({properties:e});this._labelFormats=null;if(i!==t){this._vizModel().type(i);if(this._vizCreated){this._createVizInstance()}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizProperties_set");throw f.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}else{if(this._vizCreated){if(this._chartView().hasChartInstance()){var e=this._chartView().getValidProperties(this._properties,i);this._chartView().properties(e)}}else{this._enableVizDefChangedEvent=true;sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizProperties_set");throw f.get("VIZ_CHART_UPDATE_PROPERTIES_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}}var r={vizPropertiesChanged:true};if(e.hasOwnProperty("title")){r.vizTitleChanged=true}this._enableVizDefChangedEvent=true;this._dispatchVizDefChangedEvent(r);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizProperties_set");return this}else{return this._chartView().properties()}};b.prototype.vizDescription=function(){return this._chartView().description()};b.prototype.vizUpdate=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizUpdate");if(!e){return}e=this._chartPreHandler.preVizUpdate(e);this._beginUpdateProperty();var t=false;var i=e.type||this._vizModel().type();if(e.hasOwnProperty("type")){this._updateView(e.type)}if(e.hasOwnProperty("data")){t=this._needChangeTemplate(i,e.data)}i=this._initOptions(e);var r=i!==this._vizModel().type();if(!d.isGeo(i)&&e.data===null){t=true;this._updateData(i,E.getDataset(i))}var n=null;var s=e.feeds;if(s){n=s.value?s.value:s}else if(s===null){n=[]}var o;if(r){o={type:i};if(n){o["feedingItems"]=n}this._vizModel().vizModelChanged(o)}else{if(n){o={feedingItems:n};this._vizModel().vizModelChanged(o)}if(this._vizCreated){try{if(this._needCreateViz(i,t)||!this._chartView().supportUpdate(i)){this._createVizInstance()}else{this._updateVizInstance()}}catch(e){this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizUpdate");throw e}}else{}}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_vizUpdate");return this};b.prototype.vizOn=function(e,t){if(arguments.length>0){if(!_.isString(e)||!_.isFunction(t)){return}this._chartView().on(e,t);this._onEventMap[e]=t;return this}};b.prototype.vizOff=function(e){if(arguments.length>0){if(!_.isString(e)){return}this._chartView().off(e);delete this._onEventMap[e];return this}};b.prototype.vizAction=function(e,t){if(arguments.length>0){if(this._vizCreated){return this._chartView().action(e,t)}else{throw f.get("VIZ_CHART_TRIGGER_ACTION_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}return this}};b.prototype.vizSelection=function(e,t){if(this._vizCreated){var i=this._chartView().selection.apply(this._chartView(),arguments);return i}else{throw f.get("VIZ_CHART_SELECTION_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};b.prototype.vizFeedingZone=function(){if(this._vizCreated){try{return this._chartView().feedingZone()}catch(e){return[]}}else{throw f.get("VIZ_CHART_FEEDINGZONE_FAILED")+f.get("VIZ_CHART_VIZINSTANCE_NOT_CREATED")}};b.prototype.changeTemplate=function(){return this._chartView().changeTemplate.apply(this._chartView())};b.prototype._initOptions=function(e){if(!e){return}var t=e.type||this._vizModel().type();if(e.hasOwnProperty("css")){this._css=e.css}if(e.properties){var i=_.clone(e.properties);t=d.updateType(t,i);this._updateAxisCache(t,i);this._properties=this._properties||{};if(i.title&&i.title.text){i.title.text=i.title.text.trim()}this._properties=_.updateJSON(this._properties,i)}if(e.data){this._updateView(t);this._updateData(t,e.data)}return t};b.prototype._updateAxis=function(e,t,i){var r,n,s,o;if(e){for(r=0;r<e.length;r++){n=e[r];if(i.hasOwnProperty(n)){o=_.clone(i[n]);if(t.length>r){s=t[r];t[r]=_.updateJSON(s,o)}else{if(this._properties.hasOwnProperty(n)){t.push(_.updateJSON(this._properties[n],o))}else{t.push(o)}}}}}};b.prototype._updateAxisCache=function(e,t){if(t){var i=v.getCategoryAxis(e);this._updateAxis(i,this._categoryAxis,t);var r=v.getValueAxis(e);this._updateAxis(r,this._valueAxis,t)}};b.prototype._clearAxisCache=function(){if(this._categoryAxis){this._categoryAxis.length=0}if(this._valueAxis){this._valueAxis.length=0}};b.prototype._saveAxisCache=function(){var e={};e["categoryAxis"]=this._categoryAxis;e["valueAxis"]=this._valueAxis;return e};b.prototype._loadAxisCache=function(e){if(e["categoryAxis"]){this._categoryAxis=e["categoryAxis"]}if(e["valueAxis"]){this._valueAxis=e["valueAxis"]}};b.prototype.createViz=function(e){if(arguments.length>0){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_createViz");e=this._chartPreHandler.preCreateViz(e);this._beginUpdateProperty();this._type=null;this._vizModel().type(null);this._data=null;this._css=null;this._properties={};if(e.hasOwnProperty("type")){this._updateView(e.type)}var t=this._initOptions(e);var i=null;var r=e.feeds;if(r){i=r.value?r.value:r}else if(r===null){i=[]}this._vizCreated=true;try{this._vizModel().vizModelChanged({type:t,feedingItems:i})}finally{this._endUpdateProperty()}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_createViz")}};b.prototype._destroyViz=function(){this._data=null;this._vizModel().type(null);this._properties=null;this._css=null;this._onEventMap={};this._chartView().destroy();this._vizCreated=false};b.prototype.exportViz=function(e){return this._chartView().hasChartInstance()||this._chartView().exportable()?this._chartView().exportViz(e):null};b.prototype.loadViz=function(e){if(arguments.length===1){e=sap.viz.api.serialization.migrate(e);var t=e.type;if(e.data&&e.data.type){if(e.data.type==="Crosstable"){var i=new sap.viz.api.data.CrosstableDataset;i.data(e.data.val);if(e.data.val.infos){i.info([{type:"additionalData",info:e.data.val.infos}])}e.data=i}else if(e.data.type==="FlatTable"){e.data=new sap.viz.api.data.FlatTableDataset(e.data.val)}else{e.data=e.data.val}}if(t!==this._vizModel().type()){this._loadingModel=true;this._vizModel().vizModelChanged({type:t});this._loadingModel=false}this._properties={};e.properties=e.properties||{};this._applyLeanLayout(e);this._initOptions(e);var r=this._getDefaultProperties(t);e.properties=_.updateJSON(r,e.properties);e.properties=this._chartView().getValidProperties(e.properties,t);this._clearAxisCache();this._type=t;this._vizCreated=true;this._updateFeeding(e,t);this._chartViewInstance.loadViz(e)}};b.prototype._applyLeanLayout=function(e){if(this._chartViewInstance instanceof T&&this._uiConfig.forceLeanLayout===true){this._properties.title=this._properties.title||{};this._properties.title.visible=false;this._properties.legend=this._properties.legend||{};this._properties.legend.visible=false;this._properties.categoryAxis=this._properties.categoryAxis||{};this._properties.categoryAxis.title=this._properties.categoryAxis.title||{};this._properties.categoryAxis.title.visible=false;this._properties.categoryAxis2=this._properties.categoryAxis2||{};this._properties.categoryAxis2.title=this._properties.categoryAxis2.title||{};this._properties.categoryAxis2.title.visible=false;this._properties.valueAxis=this._properties.valueAxis||{};this._properties.valueAxis.title=this._properties.valueAxis.title||{};this._properties.valueAxis.title.visible=false;this._properties.valueAxis2=this._properties.valueAxis2||{};this._properties.valueAxis2.title=this._properties.valueAxis2.title||{};this._properties.valueAxis2.title.visible=false;e.properties=e.properties||{};e.properties=_.updateJSON(e.properties,this._properties)}};b.prototype._updateVizInstance=function(){var e=this._vizModel().type();var t=this.feeds({withMND:true});var i=this._chartView().getValidProperties(this._properties,e);var r={properties:i,css:this._css,data:this._data};this._updateFeeding(r,e);this._data=r.data;this._chartView().update(r)};b.prototype._createVizInstance=function(e){if(!this._vizCreated){return}try{var t=this._vizModel().type();var i=this._getDefaultProperties(t);var r=_.updateJSON(i,this._properties);r=this._chartView().getValidProperties(r,t);var n={type:t,data:this._data,css:this._css,properties:r};this._updateFeeding(n,t);this._data=n.data;this._type=n.type;if(!d.isGeo(this._type)){this._chartView().hideLoadingIcon()}this._chartView().create(n)}catch(e){if(P.getRuntime()._modelRefs[this._uid]===1){throw e}}};b.prototype._updateFeeding=function(e,t){var i=this.feeds({withMND:true});if(!d.isTable(t)){if(!d.isGeo(t)&&h.isEmptyFeeds(i)){if(v.getDatasetType(e.data)!==n.CrosstableDataset||v.hasFakeData(e.data)){e.data=E.getDataset(t)}}else{e.feeding=this._chartViewInstance.buildFeedings(t,e.data,i)}}else{if(!e.data||v.hasFakeData(e.data)){e.data=E.getDataset(t)}e.feeding=this._chartViewInstance.buildFeedings(t,e.data,i)}};b.prototype.save=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_save");var t={};t["vizInstance"]=this.exportViz(e);var i=this.feeds();var r=this._chartViewInstance.FeedsToJSON(i);t["feedingItems"]=r;t["type"]=this._vizModel().type();t["vizTitleMode"]=this._titleMode;t["vizView"]=this._chartViewInstance.save();t["axis"]=this._saveAxisCache();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_save");return t};b.prototype.load=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_load");e=this._chartPreHandler.preLoadChart(e);this._beginUpdateProperty();var t=e["vizTitleMode"];if(t){this.vizTitleMode(t)}this._loadingModel=true;var i=e["type"];this._updateView(i);var r=null;var n=e["feedingItems"];if(n){r=this._chartViewInstance.FeedsFromJSON(n)}this._vizModel().load({type:i,feedingItems:r});this._loadingModel=false;var s=e["vizInstance"];if(s){this._loadingInstance=true;if(e["vizView"]){this._chartViewInstance.load(e["vizView"],s.properties)}this.loadViz(s);this._loadingInstance=false}var o=e["axis"];if(o){this._loadAxisCache(o)}this._endUpdateProperty();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_load")};b.prototype.feeds=function(e){if(arguments.length>0&&_.isArray(e)){if(e!==null&&e!==undefined&&!v.isArrayOfFeedItem(e)){return}this._beginUpdateProperty();var t=e.slice(0);this._vizModel().feedingItems(t,this._enableTrellis);try{var i=this._vizModel().type();if(this._needCreateViz(i,false)){this._createVizInstance()}else{this._updateVizInstance()}}catch(e){this._endUpdateProperty();throw e}this._endUpdateProperty();return this}else{return this._vizModel().explicitFeedingItems(e)}};b.prototype.enableMorphing=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enableMorphing(!!e)}}else{if(this._chartView()){return this._chartView().enableMorphing()}}return this};b.prototype.enablePropertyZone=function(e){if(arguments.length>0){if(this._chartView()){return this._chartView().enablePropertyZone(!!e)}}else{if(this._chartView()){return this._chartView().enablePropertyZone()}}return this};b.prototype._updateTitle=function(){if(this.isTitleCustomized()){return}var e=this.getTitleTextByFeeding();this._properties.title=this._properties.title||{};e=e.trim();if(this._properties.title.text!=e){this._properties.title.text=e}};b.prototype.feeding=function(){if(this._chartViewInstance){return this._chartViewInstance.feeding()}else{return[]}};b.prototype.showMessage=function(e){if(arguments.length==1){if(this._chartView()){return this._chartView().updateDescription(e)}}};b.prototype.exportToSVGString=function(e){return this._chartView().exportToSVGString(e)};b.prototype.supportExportToSVG=function(){return this._chartView().supportExportToSVG()};b.prototype.getPropertyZones=function(){return this._chartView().getPropertyZones()};b.prototype.setPropertyZones=function(e){this._chartView().setPropertyZones(e)};b.prototype.queryProperties=function(e){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_queryProperties");var t=this._chartView().queryProperties(e);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:chart_control_api_queryProperties");return t};b.prototype.updateProperties=function(e){this._chartView().updateProperties(e)};b.prototype.selectedPropertyZone=function(e){var t=this._chartView();return t.selectedPropertyZone.apply(t,arguments)};b.prototype.getZoneName=function(e){return this._chartView().getZoneName.apply(this._chartView(),arguments)};b.prototype.getDataPointsPosition=function(e){return this._chartView().getDataPointsPosition.apply(this._chartView(),arguments)};b.prototype.setAxisScale=function(e){return this._chartView().setAxisScale.apply(this._chartView(),arguments)};b.prototype.vizCssProperty=function(e,t,i){return this._chartView().cssProperty.apply(this._chartView(),arguments)};b.prototype.getFeeding=function(){return this._chartView().feeding()};b.prototype._getDefaultProperties=function(e){if(!e){return{}}var t;var i=d.getChartId(e);if(this._uiConfig&&this._uiConfig.hasOwnProperty("specificProperties")){t=_.updateJSON(this._uiConfig.defaultProperties,this._uiConfig.specificProperties[i])}else{t=this._uiConfig?this._uiConfig.defaultProperties:null}t=v.convertProperties(t,d.getVizType(e),e);return t};return b});e("sap/viz/controls/plugins/infochart/getPropertiesByCtx",["sap/viz/controls/common/utils/Utils"],function(e){function t(e,t){var i=Object.keys(e),r=Object.keys(t);return i.length>0&&i.every(function(i){return e[i]===t[i]})}function i(e,i){if(!e){return false}if(!Array.isArray(e)){e=[e]}return e.some(function(e){if(!e){return true}return t(e,i)})}function r(e,t){var i;for(var r in e){if(!i){i={}}var n=true;for(var s=0;s<t.length;s++){if(r===t[s]){t.splice(s,1);n=false;break}}if(!n){continue}i[r]=e[r]}return i}return function(e,t){var r=e.ctx;if(!Array.isArray(t)){t=[t]}var n;for(var s=0,o=t.length;s<o;s++){var a=t[s],l=a.ctx,c=a.paras;if(!l){n=c}}var c=this._parameters,p,h=-1,d,u;for(var s=0,o=t.length;s<o;s++){var a=t[s],l=a.ctx,c=a.paras;if(i(l,r)){d=0;for(var _ in l){d++}if(h<d){h=d;u=s}}}if(t[u]){return t[u].paras}return n}});e("sap/viz/controls/plugins/infochart/SVG",[],function(){var e="http://www.w3.org/2000/svg";var t="...";var i;function r(t,i,r){var n=i?i.ownerDocument:window.document;var s=t.toLowerCase()==="svg"?e:i?i.namespaceURI:e;var o=n.createElementNS(s,t);return i?r?i.parentNode.insertBefore(o,i):i.appendChild(o):o}function n(e,t){if(!i){var n=r("svg",document.body);n.style.cssText="position:absolute;left:-1000px;top:-1000px;z-index:-9000;width:1px;height:1px";i=r("text",n)}i.style.cssText=s(t);i.textContent=e;return i}function s(e){var t="";if(Object.prototype.toString.call(e)==="[object String]"){t=e}else{for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r!==null&&r!==undefined&&r!==""){t+=i+":"+r+";"}}}}return t}return{create:r,measureText:function(e,t){if(!e){return{width:0,height:0,x:0,y:0}}return n(e,t).getBBox()},toCSSText:s,createTextNode:function(e,i,o,a,l){i=s(i);var c=a!==undefined,p=l!==undefined;var h;if(o||c||p){var d=n(e,i);var u=false;if(c){var _=d.getComputedTextLength();if(_>a){d.textContent=t;_=d.getComputedTextLength();a-=_;if(a<=0){return}d.textContent=e;var v=e.length-1;while(v>0&&d.getSubStringLength(0,v)>a){v--}if(v>0){h=e;e=e.substr(0,v)+t;u=true}else{return}}}if(o||p){if(u){d.textContent=e}if(o){o=d.getBBox()}if(p&&o.height>l){return}}}var f=r("text");f.setAttribute("style",i);f.textContent=e;if(h){var m=r("title",f);m.textContent=h}return o?{measure:o,node:f}:f}}});e("sap/viz/controls/plugins/infochart/Icon",["./SVG"],function(e){var t={};var i=function(e){var i=document.createElement("div");i.innerHTML=e;var r=this._svgNode=i.firstChild;if(!t[e]){document.body.appendChild(i);t[e]=r.getBBox()}var n=t[e];this._width=n.width;this._height=n.height;this._x=n.x;this._y=n.y};var r=i.prototype;r.render=function(t,i,r){var n=e.create("g",t);var s=this._svgNode;var o=this._svgNode.firstChild;while(o){var a=o.nextSibling;n.appendChild(o);o=a}if(i){if(Array.isArray(i)){i=i.join(" ")}n.setAttribute("transform","scale("+i+")")}if(r){n.setAttribute("fill",r)}return n};r.clipPath=function(e){var t=this._svgNode;var i=this._svgNode.firstChild;while(i){var r=i.nextSibling;e.appendChild(i);i=r}};r.destroy=function(){var e=this._svgNode.parentNode;if(e&&e.parentNode){e.parentNode.removeChild(e)}delete this._svgNode};r.getWidth=function(){return this._width};r.getHeight=function(){return this._height};r.getX=function(){return this._x};r.getY=function(){return this._y};return i});e("sap/viz/controls/plugins/infochart/StackDecoratorGenerator",["./getPropertiesByCtx","./SVG","./Icon"],function(e,t,i){var r=50;var n=0;function s(e,t,i,r){var n;if(r){n=[[e,0]];if(i){n.push([0,t/2],[e,t])}else{n.push([0,0],[e/2,t])}}else{n=[[0,t]];if(i){n.push([0,0],[e,t/2])}else{n.push([e/2,0],[e,t])}}return n}var o={pike:function(e,t,i,n){var o=s(e,t,i,n);if(n){if(i){if(e>r){o.splice(1,0,[r,0]);o.splice(3,0,[r,t])}}else{if(t>r){o.splice(2,0,[0,t-r]);o.splice(4,0,[e,t-r])}}}else{if(i){if(e>r){o.splice(2,0,[e-r,0]);o.splice(4,0,[e-r,t])}}else{if(t>r){o.splice(1,0,[0,r]);o.splice(3,0,[e,r])}}}return o},triangle:s,trapezoid:function(e,t,i,n){var s;if(n){s=[[e,0]];if(i){if(e>r){s.push([r,0])}s.push([0,t])}else{s.push([0,0]);if(t>r){s.push([0,t-r])}}}else{s=[[0,t]];if(i){s.push([0,0]);if(e>r){s.push([e-r,0])}s.push([e,t])}else{if(t>r){s.push([0,r])}s.push([e,0])}}s.push([e,t]);return s}};return{name:"stackDecorator",fn:function(r){return function(s){var a=e(s,r);if(!a){return}var l=s.graphic,c,p=l.width,h=l.height;var d=a.stackShape||{};var u=d.value;var c=s.g;var _=t.create("clipPath",c);var v="clipPath_"+n++;_.setAttribute("id",v);c.setAttribute("clip-path","url(#"+v+")");if(d.type==="svg"){var f=new i(u);var m=f.getWidth();var g=f.getHeight();var E=p/m;var y=h/g;f.clipPath(_);_.setAttribute("transform","translate( "+l.x+","+l.y+") scale("+E+" "+y+")");f.destroy()}else{if(!u||u==="rectangle"){var I=t.create("rect",_);I.setAttribute("width",p);I.setAttribute("height",h)}else{var C=t.create("path",_);var T="";o[u](p,h,s.horizontal,s.negative).forEach(function(e,t){T+=(t===0?"M":"L")+e[0]+" "+e[1]});T+="Z";C.setAttribute("d",T)}_.setAttribute("transform","translate( "+l.x+","+l.y+")")}}}}});e("sap/viz/controls/plugins/infochart/BarShapeRendererGenerator",["./getPropertiesByCtx","./SVG","./Icon"],function(e,t,i){var r=50;function n(e,t,i,r){var n;if(r){n=[[e,0]];if(i){n.push([0,t/2],[e,t])}else{n.push([0,0],[e/2,t])}}else{n=[[0,t]];if(i){n.push([0,0],[e,t/2])}else{n.push([e/2,0],[e,t])}}return n}var s={pike:function(e,t,i,s){var o=n(e,t,i,s);if(s){if(i){if(e>r){o.splice(1,0,[r,0]);o.splice(3,0,[r,t])}}else{if(t>r){o.splice(2,0,[0,t-r]);o.splice(4,0,[e,t-r])}}}else{if(i){if(e>r){o.splice(2,0,[e-r,0]);o.splice(4,0,[e-r,t])}}else{if(t>r){o.splice(1,0,[0,r]);o.splice(3,0,[e,r])}}}return o},triangle:n,trapezoid:function(e,t,i,n){var s;if(n){s=[[e,0]];if(i){if(e>r){s.push([r,0])}s.push([0,t])}else{s.push([0,0]);if(t>r){s.push([0,t-r])}}}else{s=[[0,t]];if(i){s.push([0,0]);if(e>r){s.push([e-r,0])}s.push([e,t])}else{if(t>r){s.push([0,r])}s.push([e,0])}}s.push([e,t]);return s}};return{name:"barShapeRenderer",fn:function(r){return function(n){var o=e(n,r);if(o){var a=n.graphic,l,c=a.width,p=a.height,h=o.dataPointShapeFill,d=h||a.fill,u=o.dataPointShape||{},_=u.type,v=u.value;if(_==="svg"){var f=new i(v);l=t.create("g");var m=f.getWidth();var g=f.getHeight();var E=c/m;var y=p/g;f.render(l,[E,y],d);if(h){n.data.color=h}l.setAttribute("transform","translate("+(c/2-m*E/2-f.getX()*E)+","+(p/2-g*y/2-f.getY()*y)+")");f.destroy()}else{if(!v||v==="rectangle"){l=t.create("rect");l.setAttribute("width",c);l.setAttribute("height",p)}else{l=t.create("path");var I="";s[v](c,p,n.horizontal,n.negative).forEach(function(e,t){I+=(t===0?"M":"L")+e[0]+" "+e[1]});I+="Z";l.setAttribute("d",I)}if(h){n.data.color=h}l.setAttribute("fill",d)}return l}}}}});e("sap/viz/controls/plugins/infochart/CategoryAxisLabelRendererGenerator",["./getPropertiesByCtx","./SVG","./Icon"],function(e,t,i){var r=5;var n=3;var s=.5;return{name:"categoryAxisLabelRenderer",fn:function(o){var a=function(a){var l=e(a,o);if(l){var c=a.position;var p=c==="left";var h=a.size.width;var d=a.size.height;var u=h,_=d;if(p){u-=r}else{_-=r}if(u<=0||_<=0){return null}var v=t.create("g");var f,m;var g=0;if(l.iconVisible===true&&l.iconSVG){var E=l.iconSize;if(E===undefined){E=s}if(E>0){var y=new i(l.iconSVG);var I=y.getWidth();var C=y.getHeight();var T,A;if(p){T=A=Math.min(d*E,u)}else{T=A=Math.min(h*E,_)}var P=Math.min(T/I,A/C);var R=t.create("g",v);y.render(R,P,l.iconColor);y.destroy();var z=y.getX()*P;var O=y.getY()*P;if(p){f=u-T-z;m=_/2-A/2-O;u-=T+n}else{f=u/2-T/2-z;m=r-O;_-=A+n;g=A+n}R.setAttribute("transform","translate("+f+" "+m+")")}}if(u>0&&_>0){if(l.textVisible!==false){var b=!p&&a.rotated===true;var S,x;if(b){S=p?undefined:_;x=u}else{S=u;x=p?undefined:_}var D=a.styles;var L=t.createTextNode(a.text,{"font-family":l.fontFamily||D["font-family"],"font-size":l.fontSize||D["font-size"],"font-weight":l.fontWeight||D["font-weight"],"font-style":l.fontStyle||D["font-style"],fill:l.fontColor||D["fill"]},true,S,x);if(L){var M=L.measure;if(b){var N=l.fontSize||D["font-size"];var w=parseFloat(N)*1.2;var F=3;var V=6;f=u/2+w/2-F;m=V}else{if(p){f=u-M.width-M.x;m=_/2-M.height/2-M.y;if(a.childCells&&a.childCells.length){m-=a.childCells[0].cellHeight/2}}else{f=u/2-M.width/2-M.x;m=d-_-M.y}}var H=L.node;if(b){m+=g;H.setAttribute("x",f);H.setAttribute("y",m);H.setAttribute("text-anchor","end");H.setAttribute("transform","rotate(-90,"+f+","+m+")")}else{H.setAttribute("transform","translate("+f+" "+m+")")}v.appendChild(H)}}}return v}};a.getPreferredSize=function(i){var l=e(i,o);if(!l){return}var c=a._buildCssString(i.styles,l);var p=i.rotated;if(l.iconVisible===true){if(!l.iconSVG){return}}else{if(l.textVisible===false){return{cellWidth:0,cellHeight:0}}else{var h=t.measureText(i.text,c);if(i.position==="left"){return{cellWidth:h.width+r,cellHeight:h.height}}else{if(h.width>i.size){p=true;return{cellWidth:h.height+r,cellHeight:h.width,rotated:true}}else{return{cellWidth:h.width,cellHeight:h.height+r}}}}}var d=r;var u=r;var _=l.iconSize;if(_===undefined){_=s}if(_<=0){return}if(i.position==="top"||i.position==="bottom"){d=i.size;u+=i.size*_;if(l.textVisible!==false){var h=t.measureText(i.text,c);if(h.width>i.size){p=true;u+=n+h.width}else{u+=n+h.height}}}else{u=i.size;d+=i.size*_;if(l.textVisible!==false){var h=t.measureText(i.text,c);d+=n+h.width}}return{cellWidth:d,cellHeight:u,rotated:p}};a._buildCssString=function(e,t){var i="";i+="fill:"+(t.fontColor||e["fill"])+";";i+="font-family:"+(t.fontFamily||e["font-family"])+";";i+="font-size:"+(t.fontSize||e["font-size"])+";";i+="font-style:"+(t.fontStyle||e["font-style"])+";";i+="font-weight:"+(t.fontWeight||e["font-weight"])+";";return i};a.autoHide=function(){return true};return a}}});e("sap/viz/controls/plugins/infochart/PieSliceRendererGenerator",["./getPropertiesByCtx","./SVG"],function(e,t){return{name:"pieSliceRenderer",fn:function(t){return function(i,r){var n=e(i,t);if(n&&n.sliceShapeFill){i.graphic.color=n.sliceShapeFill}return r(i)}}}});e("sap/viz/controls/plugins/infochart/DataLabelRendererGenerator",["./getPropertiesByCtx","./SVG","./Icon"],function(e,t,i){var r=5,n=.8;return{name:"dataLabelRenderer",fn:function(s){return function(o){var a=e(o,s);if(a){var l=t.create("g");var c,p;if(a.textVisible!==false){p=o.text;c=t.create("text",l);c.textContent=p;var h="",d;if(d=a.fontColor){h+="fill:"+d+";"}if(d=a.fontFamily){h+="font-family:"+d+";"}if(d=a.fontSize){h+="font-size:"+d+";"}if(d=a.fontWeight){h+="font-weight:"+d+";"}if(d=a.fontStyle){h+="font-style:"+d+";"}if(h){c.setAttribute("style",h)}}if(a.iconVisible===true&&a.iconSVG){var u=a.iconSize;if(u!==0){u=u||n;var _=new i(a.iconSVG);var v=t.create("g",l);var f=_.getWidth();var m=_.getHeight();var g=o.horizontal;var E=g?m:f;var y=o[g?"dataPointHeight":"dataPointWidth"];if(y===0){_.destroy();return l}var I=y*u/E;_.render(v,I,a.iconColor);_.destroy();if(c){var C=o.styles;var T=t.measureText(p,{"font-family":a.fontFamily||C["font-family"],"font-size":a.fontSize||C["font-size"],"font-weight":a.fontWeight||C["font-weight"],"font-style":a.fontStyle||C["font-style"]});f*=I;m*=I;var A=_.getX()*I;var P=_.getY()*I;var R,z;if(g){R=T.x+T.width+r-A;z=T.y+T.height/2-P-m/2}else{R=T.x+T.width/2-A-f/2;z=T.y-r-P-m}v.setAttribute("transform","translate("+R+","+z+")")}}}return l}}}}});e("sap/viz/controls/plugins/infochart/LineMarkerRendererGenerator",["./getPropertiesByCtx","./SVG","./Icon"],function(e,t,i){return{name:"lineMarkerRenderer",fn:function(r){return function(n){var s=e(n,r);if(s){var o=n.graphic,a=s.iconSVG;if(a){var l=s.iconSize;if(l===0){return null}l=Math.min(s.iconSize,n.bandLength,n.plotSize[n.horizontal?0:1]);a=new i(a);var c=t.create("g");var p=a.getWidth();var h=a.getHeight();var d=l/p;var u=l/h;a.render(c,[d,u],s.iconColor||o.fill);a.destroy();c.setAttribute("transform","translate("+(-a.getX()*d-l/2)+","+(-a.getY()*u-l/2)+")");return c}}}}}});e("sap/viz/controls/plugins/infochart/LineRendererGenerator",["./getPropertiesByCtx"],function(e){return{name:"lineRenderer",fn:function(t){return function(i){var r=e(i,t);if(r){var n=i.graphic;n.color=r.color||n.color;n.width=r.width||n.width;n.dash=r.dash||n.dash}}}}});e("sap/viz/controls/plugins/infochart/setup",["sap/viz/controls/chart/adapters/PropFnGeneratorRegistry","./StackDecoratorGenerator","./BarShapeRendererGenerator","./CategoryAxisLabelRendererGenerator","./PieSliceRendererGenerator","./DataLabelRendererGenerator","./LineMarkerRendererGenerator","./LineRendererGenerator"],function(e,t,i,r,n,s,o,a){function l(t){e.register(t.name,t.fn)}var c=[t,i,r,n,s,o,a];c.forEach(l)});e("sap/viz/controls/common/utils/OSUtil",[],function(){function e(){return undefined!==document.documentElement.style.webkitBoxAlign}function t(){return!!window.XDomainRequest}function i(){return!!window.chrome}function r(){return undefined!==document.documentElement.style.MozBoxAlign&&"Gecko"===navigator.product}function n(){return/javafx\//i.test(window.navigator.userAgent)}function s(){return e()&&!i()}function o(){return undefined!==window.navigator.standalone&&e()&&!i()}return{isIE:t,isChrome:i,isFirefox:r,isJavaFx:n,isSafari:s,isSafariMobile:o,isWebkit:e}});e("sap/viz/controls/contextmenu/constants/MenuItemConst",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/managers/LangManager"],function(e,t){var i={};i.getText=function(e){return t.get(e)};i.DEFAULT={icon:"/contextmenu/uncheck.png"};i.LEGEND={name:"legend",text:"VIZ_CONTEXTMENU_SHOW_LEGEND",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/geomap":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};i.DATALABELS={name:"datalabels",text:"VIZ_CONTEXTMENU_SHOW_DATALABELS",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/heatmap":true,"viz/treemap":true,"viz/radar":true,"viz/waterfall":true}};i.DIRECTION={name:"direction",text:{horizontal:"VIZ_CONTEXTMENU_VERTICAL",vertical:"VIZ_CONTEXTMENU_HORIZONTAL"},supportType:{"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/boxplot":true,"viz/waterfall":true}};i.STACKING={name:"stacking",text:{full:"VIZ_CONTEXTMENU_NORMAL_STACKING",normal:"VIZ_CONTEXTMENU_FULL_STACKING"},supportType:{"viz/stacked_bar":true,"viz/stacked_column":true,"viz/area":true}};i.COMMENT={name:"comment",text:"VIZ_CONTEXTMENU_INSERT_COMMENT",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true}};i.CHARTEDITOR={name:"charteditor",text:"VIZ_CONTEXTMENU_MENU_CHART_EDITOR",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":true,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};i.MBCLEGEND={name:"mbclegend",text:"VIZ_CONTEXTMENU_CHANGE_MBCLEGEND_COLOR",supportType:{"viz/choropleth":true,"viz/treemap":true,"viz/heatmap":true,"viz/tagcloud":true}};i.MND={name:"mnd",text:"VIZ_CONTEXTMENU_SHOW_MND",tooltip:"VIZ_CONTEXTMENU_SHOW_MND_TOOLTIP",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/3d_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/pie":true,"viz/donut":true,"viz/pie_with_depth":true,"viz/geobubble":true,"viz/choropleth":true,"viz/geopie":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/treemap":true,"viz/heatmap":true,"viz/radar":true,"viz/boxplot":true,"viz/tagcloud":false,"viz/tree":true,"viz/network":true,"viz/ext/pa/funnel":true,"viz/ext/pa/pc":true}};i.TITLE={name:"title",text:"VIZ_CONTEXTMENU_SHOW_TITLE",notSupportType:{"viz/geomap":true}};i.SETAXISSCALE={name:"setAxisScale",text:"VIZ_CONTEXTMENU_SET_AXIS_SCALE",supportType:{"viz/bar":true,"viz/column":true,"viz/stacked_bar":true,"viz/stacked_column":true,"viz/dual_bar":true,"viz/dual_column":true,"viz/line":true,"viz/area":true,"viz/combination":true,"viz/dual_line":true,"viz/dual_combination":true,"viz/scatter":true,"viz/bubble":true,"viz/scatter_matrix":true,"viz/boxplot":true,"viz/waterfall":true}};i.NEGATIVE={name:"negative",text:"VIZ_CONTEXTMENU_SHOW_NEGATIVE_VALUES",supportType:{"viz/bubble":true,"viz/geobubble":true}};return i});e("sap/viz/controls/contextmenu/ContextMenuConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{menu:[["direction","stacking"],["title","legend","mbclegend","datalabels","negative","mnd","setAxisScale"],["comment","charteditor"]]}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_CONTEXTMENU,t);return t});e("sap/viz/controls/contextmenu/ContextMenuEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenuEvent"};e.extend(i,t);i.CONTEXT_MENU_CHANGED="contextMenuChanged";i.POPUP_CONTEXT_MENU="popupContextMenu";i.REQUEST_LEGEND_COLOR="chooseLegendColors";i.POPUP_CHART_EDITOR="popupChartEditor";return i});e("sap/viz/controls/contextmenu/models/MenuItem",[],function(){var e=function(e,t,i,r,n,s){this._name=e;this._text=t;this._isVisibleFunc=r;this._iconFunc=i;this._clickHandler=n;this._scope=this;this._isCheckable=false;this._tooltip=s};e.prototype.name=function(e){return this._name};e.prototype.scope=function(e){if(arguments.length>0){this._scope=e;return this}else{return this._scope}};e.prototype.text=function(e){if(this._textFunc){return this._textFunc()}else{return this._text}};e.prototype.textFunc=function(e){this._textFunc=e};e.prototype.clickHandler=function(e){if(arguments.length>0){this._clickHandler=e;return this}else{return this._clickHandler}};e.prototype.icon=function(e){if(!this._iconFunc){return null}return this._iconFunc.apply(this._scope,arguments)};e.prototype.supportPropertyZone=function(e,t){if(t==null){return true}else{return false}};e.prototype.isVisible=function(e){if(!this._isVisibleFunc){return true}return this._isVisibleFunc.apply(this._scope,arguments)};e.prototype.isCheckable=function(e){return this._isCheckable};e.prototype.tooltip=function(e){if(arguments.length>0){this._tooltip=e;return this}else{return this._tooltip}};return e});e("sap/viz/controls/contextmenu/models/DataLabelMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r){var n=function(e,t){n.superclass.constructor.apply(this,[i.DATALABELS.name,i.getText(i.DATALABELS.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DataLabelMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t;this._isCheckable=true};e.extend(n,r);n.prototype.isChecked=function(e){if(i.DATALABELS.supportType[e]){var t=this._chartProxyProvider().getProperties();t=t||{};t.dataLabel=t.dataLabel||{visible:false};var r=t.dataLabel.visible;return r}return null};n.prototype._clickHandler=function(){var e=this._chartProxyProvider().getProperties();var t=!e.dataLabel.visible;var i={};i.dataLabel={};i.dataLabel.visible=t;this._chartProxyProvider().setProperties(i)};return n});e("sap/viz/controls/contextmenu/models/DirectionMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n){var s=function(e){s.superclass.constructor.apply(this,[r.DIRECTION.name,"",this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.DirectionMenuItem";this._chartModelProvider=e};e.extend(s,n);s.prototype._textFunc=function(){var e=i.getDirection(this._getType());return r.getText(r.DIRECTION.text[e])};s.prototype._clickHandler=function(){var e=this.getDirection();if(e==t.DIRECTION_VERTICAL){e=t.DIRECTION_HORIZONTAL}else{e=t.DIRECTION_VERTICAL}var r=this._getType();var n=i.changeDirection(r,e);this._chartModelProvider().type(n)};s.prototype._getType=function(){return this._chartModelProvider().type()};s.prototype.getDirection=function(){return i.getDirection(this._getType())};return s});e("sap/viz/controls/contextmenu/models/LegendMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r){var n=function(e,t){n.superclass.constructor.apply(this,[i.LEGEND.name,i.getText(i.LEGEND.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.LegendMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t;this._isCheckable=true};e.extend(n,r);n.prototype.supportPropertyZone=function(e,t){if(t==="legend"||t==="sizeLegend"){return true}return n.superclass.supportPropertyZone.apply(this,arguments)};n.prototype.isChecked=function(e){if(i.LEGEND.supportType[e]){var t=this._chartProxyProvider().getProperties();t=t||{};t.legend=t.legend||{visible:true};var r=t.legend.visible;if(e.search("geo")>-1){var n=t.sizeLegend;r=r&&(n?n.visible:true)}return r}return null};n.prototype._clickHandler=function(){var e=this._chartProxyProvider().getProperties();var t=false;if(e&&e.legend){t=!e.legend.visible}else if(e&&e.sizeLegend){t=!e.sizeLegend.visible}else if(e&&e.geomap){var i=e.geomap.layers;t=!i[0].options.legendVisible}var r={};r.legend={};r.legend.visible=t;if(this._chartModelProvider().type().search("geo")>-1||this._chartModelProvider().type().search("bubble")>-1){r.sizeLegend={};r.sizeLegend.visible=t}this._chartProxyProvider().setProperties(r)};return n});e("sap/viz/controls/contextmenu/models/StackingMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n){var s=function(e){s.superclass.constructor.apply(this,[r.STACKING.name,"",this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.StackingMenuItem";this._chartModelProvider=e};e.extend(s,n);s.prototype._textFunc=function(){var e=i.getStacking(this._getType());return r.getText(r.STACKING.text[e])};s.prototype._clickHandler=function(){var e=this.getStacking();if(e==t.STACKING_NORMAL){e=t.STACKING_FULL}else{e=t.STACKING_NORMAL}var r=this._getType();var n=i.changeStacking(r,e);this._chartModelProvider().type(n)};s.prototype._getType=function(){return this._chartModelProvider().type()};s.prototype.getStacking=function(){return i.getStacking(this._getType())};return s});e("sap/viz/controls/contextmenu/models/MBCLegendMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r){var n=function(e,t){n.superclass.constructor.apply(this,[i.MBCLEGEND.name,i.getText(i.MBCLEGEND.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.MBCLegendMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t};e.extend(n,r);n.prototype.supportPropertyZone=function(e,t){if(t==="legend"||t==="sizeLegend"){return true}return n.superclass.supportPropertyZone.apply(this,arguments)};n.prototype._isVisibleFunc=function(e){if(this._chartProxyProvider().isFakeChart()){return false}var i=this._chartModelProvider().feedingItems();for(var r=0;r<i.length;r++){var n=i[r];if(e===t.TYPE_TAG_CLOUD&&n.id()==="tagFamily"&&n.values().length===0){return false}if(e===t.TYPE_TREEMAP&&n.id()==="rectangleColor"&&n.values().length===0){return false}}return true};return n});e("sap/viz/controls/contextmenu/models/MNDMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n,s,o){var a=function(e){a.superclass.constructor.apply(this,[s.MND.name,s.getText(s.MND.text),this._iconFunc,this._isVisibleFunc,this._clickHandler,s.getText(s.MND.tooltip)]);this.__className="sap.viz.controls.contextmenu.models.MNDMenuItem";this._chartModelProvider=e;this._isCheckable=true};e.extend(a,o);a.prototype.isChecked=function(){return this._chartModelProvider().isMNDVisible()};a.prototype._isVisibleFunc=function(e){var t=false;var s;var o=-1;var a=sap.viz.api.manifest.Viz.get(e)[0];if(a){s=a.allFeeds();for(o=0;o<s.length;o++){if(n.canAcceptMND(s[o].acceptMND)){t=true;break}}}if(!t&&!i.isMultipleChart(e)&&i.supportMultiChart(e)){var l=i.toMultiChartType(e);a=sap.viz.api.manifest.Viz.get(l)[0];s=a.allFeeds();for(o=0;o<s.length;o++){if(n.canAcceptMND(s[o].acceptMND)){t=true;break}}}if(!t)return false;var c=this._chartModelProvider().feedingItems();for(var p=0;p<c.length;p++){var h=c[p];if(h.type()===r.MEASURE&&h.values().length>0){return true}}return false};a.prototype._clickHandler=function(){var e=this._chartModelProvider().isMNDVisible();this._chartModelProvider().isMNDVisible(!e)};return a});e("sap/viz/controls/contextmenu/models/SetAxisScaleMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,[r.SETAXISSCALE.name,r.getText(r.SETAXISSCALE.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.SetAxisScaleMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t;this._isCheckable=false};e.extend(s,n);s.prototype.isChecked=function(){return false};s.prototype.supportPropertyZone=function(e,i){var r=this._chartModelProvider();if(t.isValueAxis(r.type(),i)){return true}return s.superclass.supportPropertyZone.apply(this,arguments)};s.prototype._isVisibleFunc=function(){var e=this._chartModelProvider();var i=t.getValueAxis(e.type());if(i&&i.length>0){return true}else{return false}};s.prototype._clickHandler=function(e,t){this._chartProxyProvider().setAxisScale(t)};return s});e("sap/viz/controls/contextmenu/models/ChartEditorMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r){var n=function(e){n.superclass.constructor.apply(this,[i.CHARTEDITOR.name,i.getText(i.CHARTEDITOR.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ChartEditorMenuItem";this._chartProxyProvider=e};e.extend(n,r);return n});e("sap/viz/controls/contextmenu/models/ShowHideTitleMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,[r.TITLE.name,r.getText(r.TITLE.text),this._iconFunc,null,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ShowHideTitleMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t;this._isCheckable=true};e.extend(s,n);s.prototype.isChecked=function(e){if(!r.TITLE.notSupportType[e]){var t=this._chartProxyProvider().getProperties();t=t||{};t.title=t.title||{visible:true};var i=t.title.visible;return i}return null};s.prototype._clickHandler=function(){var e=this._chartProxyProvider().getProperties();var t=false;if(e.title){t=!e.title.visible}var i={};i.title={};i.title.visible=t;this._chartProxyProvider().setProperties(i)};return s});e("sap/viz/controls/contextmenu/models/ShowHideNegativeMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/DatasetUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n,s){var o=function(e,t){o.superclass.constructor.apply(this,[n.NEGATIVE.name,n.getText(n.NEGATIVE.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.contextmenu.models.ShowHideNegativeMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t;this._isCheckable=true};e.extend(o,s);o.prototype.isChecked=function(e){if(n.NEGATIVE.supportType[e]){var t=this._chartProxyProvider().getProperties();t=t||{};t.plotArea=t.plotArea||{showNagativeValues:false};var i=t.plotArea.showNegativeValues;return i}return null};o.prototype._isVisibleFunc=function(e){var t=this._chartProxyProvider().getDataset();if(r.hasNegativeMeasureValue(t,this._chartModelProvider().type())){return true}return false};o.prototype._clickHandler=function(){var e=this._chartProxyProvider().getProperties();e=e||{};e.plotArea=e.plotArea||{};var t=!e.plotArea.showNegativeValues;var i={};i.plotArea={};i.plotArea.showNegativeValues=t;this._chartProxyProvider().setProperties(i)};return o});e("sap/viz/controls/contextmenu/views/MenuItem",["jquery","sap/viz/controls/common/constants/CSSConst"],function(e,i){var r=i.CONTEXTMENU_PREFIX;var n=r+"MnuItm";var s=r+"MnuItmIco";var o=r+"MnuItmTxt";var a=r+"MnuItm-Show";var l=r+"MnuItm-Hide";var c=r+"MnuItmIco-Show";var p=r+"MnuItmIco-Hide";var h=r+"MnuItmOpen";var d=i.COMMON_PREFIX+"menu-list-suffix-icon-submenu";var u=i.COMMON_PREFIX+"havanaSharedSprite16";function _(i,r){this.__className="sap.viz.controls.contextmenu.views.MenuItem";i=i||{};var a=this.dom=document.createElement("li");a.className=n;a.innerHTML='<div id="'+i.name+'" class="'+n+'"><div class="'+s+'"></div><div class="'+o+'">'+(i.text===undefined?"":i.text)+'</div><div class="'+d+" "+u+'"></div></div>';this._menuItemNode=a.firstChild;this._iconNode=this._menuItemNode.firstChild;this._textNode=this._iconNode.nextSibling;this._arrowNode=this._menuItemNode.lastChild;this._arrowNode.style.visibility="hidden";this.name=i.name;this.menu=r;if(i.icon){this.setIcon(i.icon)}if(i.tooltip){this.setTooltip(i.tooltip)}if(e.isArray(i.submenu)&&i.submenu.length){var l=t("sap/viz/controls/contextmenu/views/Menu");this.setSubmenu(new l(i.submenu,r))}this.onExecute=i.click;this._setupEvents()}_.prototype._setupEvents=function(){var t=this;var i=e(this.dom);function r(){t.showSubmenu()}function n(){if(!t._submenu){t._onExecute()}}i.on("mouseenter",r).on("click",n);t._cleanupEvents=function(){i.off("mouseenter",r).off("click",n)}};_.prototype.destroy=function(){if(this._submenu){this._submenu.destroy()}this._cleanupEvents();e(this.dom).remove()};_.prototype.text=function(){return this._textNode.innerHTML};_.prototype.setText=function(e){this._textNode.innerHTML=e};_.prototype.setIcon=function(e){this._iconNode.innerHTML='<img src="'+e+'" />'};_.prototype.setTooltip=function(e){m(this.dom,e,this.menu.container())};_.prototype.submenu=function(){return this._submenu};_.prototype.setSubmenu=function(e){this._submenu=e;this._arrowNode.style.visibility=e?"":"hidden"};_.prototype.showSubmenu=function(){this.menu.hideSubmenus();if(this._submenu){e(this.dom).addClass(h);this._submenu.show({dock:this.dom},this.menu._hDir+"-down")}};_.prototype.hideSubmenu=function(){if(this._submenu){e(this.dom).removeClass(h);this._submenu.hideSubmenus();this._submenu.hide()}};_.prototype._onExecute=function(){if(this.onExecute){this.onExecute()}this.menu.hideAll()};var v={top:15,left:20};var f=i.CONTEXTMENU_PREFIX+"MnuItmTooltip";function m(t,i,r){var n;var s=e(t);var o=e(r);s.on("mouseover",function(t){var r=e(document.createElement("div")).addClass(f).appendTo(e("body"));r.text(i);y(o,r,E(o,g(s)),v);n=setTimeout(function(){e("."+f).animate({opacity:1},500)},1e3)});s.on("mouseout mousedown",function(){e("."+f).remove();clearTimeout(n)})}function g(e){var t=e.offset(),i=e.innerWidth(),r=e.innerHeight();return{pageX:t.left+i/2,pageY:t.top+r/2}}function E(e,t){return{pageX:t.pageX-e.offset().left,pageY:t.pageY-e.offset().top}}function y(e,t,i,r){if(!r){r={top:0,left:0}}if(i){var n=e.innerWidth();var s=t.outerWidth();var o=i.pageX+r.left;if(n<s+o){o=i.pageX-s-r.left}var a=i.pageY+r.top;var l=e.innerHeight();var c=t.outerHeight();if(l<c+a){a=i.pageY-c-r.top}t.css({position:"fixed",left:e.offset().left+o+"px",top:e.offset().top+a+"px"})}}return _});e("sap/viz/controls/contextmenu/views/CheckedMenuItem",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/contextmenu/views/MenuItem"],function(e,t,i,r){var n=i.CONTEXTMENU_PREFIX+"MnuItm-Show";var s=i.CONTEXTMENU_PREFIX+"MnuItm-Hide";var o=i.CONTEXTMENU_PREFIX+"MnuItmIco-Show";var a=i.CONTEXTMENU_PREFIX+"MnuItmIco-Hide";function l(e){l.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.CheckedMenuItem";this._iconNode.style.display="none";this.setChecked(e.checked)}t.extend(l,r);l.prototype.setChecked=function(t){e(this.dom).toggleClass(o,!!t).toggleClass(a,!t);e(this._menuItemNode).toggleClass(n,!!t).toggleClass(s,!t)};l.prototype.checked=function(){return e(this.dom).hasClass(o)};l.prototype._onExecute=function(){this.setChecked(!this.checked());l.superclass._onExecute.apply(this,arguments)};return l});e("sap/viz/controls/contextmenu/views/BlankMenuItem",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/contextmenu/views/MenuItem"],function(e,t,i,r,n){var s=i.CONTEXTMENU_PREFIX+"blank-MnuItem";var o=i.CONTEXTMENU_PREFIX+"blank-MnuItmTxt";function a(){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.views.BlankMenuItem";e(this.dom).addClass(s);e(this._textNode).addClass(o).text(r.get("VIZ_CONTEXTMENU_NO_MENU_ITEMS"))}t.extend(a,n);return a});e("sap/viz/controls/contextmenu/views/MenuSeparator",["sap/viz/controls/common/constants/CSSConst"],function(e){function t(){this.__className="sap.viz.controls.contextmenu.views.MenuSeparator";var t=this.dom=document.createElement("div");t.className=e.CONTEXTMENU_PREFIX+"MnuItem-separator"}return t});e("sap/viz/controls/contextmenu/views/Menu",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/contextmenu/views/MenuItem","sap/viz/controls/contextmenu/views/CheckedMenuItem","sap/viz/controls/contextmenu/views/BlankMenuItem","sap/viz/controls/contextmenu/views/MenuSeparator"],function(e,t,i,r,n,s){var o=t.PREFIX+"contextmenu";var a=t.CONTEXTMENU_PREFIX+"list";var l=t.CONTEXTMENU_PREFIX+"list-hovered";var c=document;var p=window;function h(e,t,i){this.__className="sap.viz.controls.contextmenu.views.Menu";var r=this.dom=c.createElement("div");r.className=o;r.innerHTML='<ul class="'+a+'"></ul>';this._listNode=r.firstChild;this._items=[];this._parentMenu=t;this.setContainer(i);this._opennedSubmenuCount=0;this._shown=0;this._setupEvents();this.create(e)}h.prototype.marginOffset=6;h.prototype._setupEvents=function(){var t=this;function i(t,i){var r=false;for(var n=t;n&&!r;n=n._parentMenu){r=e.contains(n.dom,i)}return r}function r(e){if(t._shown&&t._opennedSubmenuCount===0&&!i(t,e.target)){t.hideAll()}}function n(){t.hide()}e(c).on("mousedown",r);e(p).on("blur",n);this._cleanupEvents=function(){e(c).off("mousedown",r);e(p).off("blur",n)}};h.prototype._createMenuItem=function(e){e=e||{};var t={checked:r,blank:n,separator:s}[e.menuItemType]||i;return new t(e,this)};h.prototype.create=function(t){t=e.isArray(t)?t:[];this._destroyChildren();e(this._listNode).toggleClass(l,!!t.length);if(!t.length){t.push({menuItemType:"blank"})}for(var i=0;i<t.length;++i){var r=this._createMenuItem(t[i]);if(r){this.addChild(r)}}};h.prototype._destroyChildren=function(){for(var e=0;e<this._items.length;++e){var t=this._items[e];if(t.destroy){t.destroy()}}this._listNode.innerHTML="";this._items=[]};h.prototype.destroy=function(){this._destroyChildren();this._cleanupEvents();e(this.dom).remove()};h.prototype.setContainer=function(e){this._container=e||this._parentMenu&&this._parentMenu.container()||c.body};h.prototype.container=function(){return this._container};h.prototype.isShown=function(){return!!this._shown};h.prototype._calcPopupPosition=function(t,i){var r=this.dom;var n=this._container;var s=0;var o=0;var a;if(t){s=t.left||0;o=t.top||0;a=t.dock}i=String(i).toLowerCase().split("-");var l=i[0];var p=i[1];this._hDir="right";this._vDir="down";if(n){var h=n.clientHeight;var d=n.clientWidth;var u=r.offsetWidth;var _=r.offsetHeight;var v=e(n).offset();var f=v.left;var m=v.top;if(a){var g=e(a).offset();var E=g.left;var y=g.top;var I=a.offsetWidth;var C=a.offsetHeight;var T=this.marginOffset;if(l==="left"&&f<=E-u||l!=="left"&&f+d<E+I+u){s=E-u;this._hDir="left"}else{s=E+I}if(p==="up"&&m<=y+C-_||p!=="up"&&m+h<y+_){o=y+C-_+T;this._vDir="up"}else{o=y-T}}else{if(l==="left"&&s>=u||l!=="left"&&d<s+u){s-=u;this._hDir="left"}if(p==="up"&&up>=_||p!=="up"&&h<o+_){o-=_;this._vDir="up"}s+=f;o+=m}s-=c.body.scrollLeft;o-=c.body.scrollTop}return{left:s,top:o}};h.prototype.show=function(e,t){if(!this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount++}this._shown=1;c.body.appendChild(this.dom);var i=this.dom.style;i.display="block";var r=this._calcPopupPosition(e,t);i.left=r.left+"px";i.top=r.top+"px"}};h.prototype.hide=function(){if(this._shown){if(this._parentMenu){this._parentMenu._opennedSubmenuCount--}this._shown=0;var e=this.dom;e.style.display="none";if(e.parentNode){e.parentNode.removeChild(this.dom)}}};h.prototype.hideAll=function(){if(this._parentMenu){this._parentMenu.hideAll()}else{this.hideSubmenus();this.hide()}};h.prototype.children=function(){return this._items};h.prototype.addChild=function(e){var t=this._items.indexOf(e);if(t<0){this._items.push(e);this._listNode.appendChild(e.dom)}};h.prototype.removeChild=function(e){var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1);this._listNode.removeChild(e.dom)}};h.prototype.hideSubmenus=function(){this._items.forEach(function(e){if(e.hideSubmenu){e.hideSubmenu()}})};return h});e("sap/viz/controls/contextmenu/ContextMenu",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/OSUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/ContextMenuConfig","sap/viz/controls/contextmenu/ContextMenuEvent","sap/viz/controls/contextmenu/models/MenuItem","sap/viz/controls/contextmenu/models/DataLabelMenuItem","sap/viz/controls/contextmenu/models/DirectionMenuItem","sap/viz/controls/contextmenu/models/LegendMenuItem","sap/viz/controls/contextmenu/models/StackingMenuItem","sap/viz/controls/contextmenu/models/MBCLegendMenuItem","sap/viz/controls/contextmenu/models/MNDMenuItem","sap/viz/controls/contextmenu/models/SetAxisScaleMenuItem","sap/viz/controls/contextmenu/models/ChartEditorMenuItem","sap/viz/controls/contextmenu/models/ShowHideTitleMenuItem","sap/viz/controls/contextmenu/models/ShowHideNegativeMenuItem","sap/viz/controls/contextmenu/views/Menu"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A,P,R){var z=function(t,i){z.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.contextmenu.ContextMenu";this._div$=e(t);this._uiConfig=i?i:u.instance();this._uiConfig.contextMenuAssetFolderPath=o.defaultAssetsRoot()+"/common/assets";this._customizedUiConfig={};this._cusMenuItems=null;this._vizModelProvider=e.proxy(this._vizModel,this);this._vizProxyProvider=e.proxy(this._vizProxy,this);this._menu=new R;this._initMenuItemsModel()};t.extend(z,s);var O={CLICK:"Clicked"};z.prototype._onVizModelChanged=function(e){};z.prototype._initMenuItemsModel=function(){this._cusMenuItems={};var t=new g(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[t.name()]=t;var i=new f(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[i.name()]=i;var r=new m(this._vizModelProvider);this._cusMenuItems[r.name()]=r;var n=new E(this._vizModelProvider);this._cusMenuItems[n.name()]=n;var s=new y(this._vizModelProvider,this._vizProxyProvider);s.clickHandler(e.proxy(function(){this._dispatchEvent(new _(_.REQUEST_LEGEND_COLOR,this))},this));this._cusMenuItems[s.name()]=s;var o=new I(e.proxy(this._vizModelProvider,this));this._cusMenuItems[o.name()]=o;var a=new A(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[a.name()]=a;var l=new C(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[l.name()]=l;var c=new P(this._vizModelProvider,this._vizProxyProvider);this._cusMenuItems[c.name()]=c;this._setCustomizedMenuItems(this._uiConfig.customizedMenu)};z.prototype._redrawMenuItems=function(e){var t=h.getVizType(this._vizModel().type());var i=n.getVizFeeds(t);if(i){var r=this._getMenuConfig(t,e);this._menu.create(r)}return!!i};z.prototype._getMenuConfig=function(e,t){var i=this;var n=this._cusMenuItems;var s=this._uiConfig.contextMenuAssetFolderPath?this._uiConfig.contextMenuAssetFolderPath:"../src/common/assets";function o(a){return a.filter(function(i){if(!r.isString(i)){i=i.name}var s=n[i];return i==="blank"||s&&s.isVisible(e,t)&&s.supportPropertyZone(e,t)}).filter(function(e,t,i){return!(e==="blank"&&(t===0||t===i.length-1||i[t-1]==="blank"))}).map(function(a){if(a==="blank"){return{menuItemType:"separator"}}var l;if(!r.isString(a)){l=a.submenu;a=a.name}var c=n[a];var p=c.icon(e,t);return{menuItemType:c.isCheckable()&&"checked",name:c.name(),text:c.text(),tooltip:c.tooltip(),icon:p&&s+"/"+p,checked:c.isChecked&&c.isChecked(e),click:i._getMenuItemHandler(c,e,t),submenu:l&&o(l)}})}var a=z.typeHelp(e,{menu:this._uiConfig.menu,customizedMenu:this._customizedUiConfig.customizedMenu});return o(a)};z.prototype._getMenuItemHandler=function(e,t,i){var r=this;return function(n){var s=e.clickHandler();if(s){s.apply(e.scope(),[t,i])}var o={};var a=true;switch(e.name()){case d.LEGEND.name:o.legend=e.isChecked(t);break;case d.DATALABELS.name:o.datalabels=e.isChecked(t);break;case d.DIRECTION.name:o.direction=e.getDirection();break;case d.STACKING.name:o.stacking=e.getStacking();break;case d.TITLE.name:o.title=e.isChecked(t);break;case d.NEGATIVE.name:o.negative=e.isChecked(t);break;default:a=false;break}if(a){r._dispatchEvent(new _(_.CONTEXT_MENU_CHANGED,r,o))}}};z.prototype.show=function(e,t){this._menu.setContainer(this._div$.parent().get(0));if(this._redrawMenuItems(t)){this._menu.show(e&&{left:e.pageX,top:e.pageY})}};z.prototype.hide=function(){this._menu.hide()};z.prototype.save=function(){var e={};return e};z.prototype.load=function(e){};z.prototype.addMenuItem=function(e){this._cusMenuItems[e.name()]=e};z.prototype._setCustomizedMenuItems=function(e){var t=this;function i(e,n){e.forEach(function(e){if(e.name==="blank"){n.push("blank")}else{var s=new v(e.name,e.text,null,e.isVisible);s.clickHandler(function(){if(e.click){e.click.apply(s.scope(),arguments)}var i=new _(t._getEventName(e.name,O.CLICK));t._dispatchEvent(i,t)});t.addMenuItem(s);if(r.isArray(e.submenu)){var o=[];i(e.submenu,o);n.push({name:e.name,submenu:o})}else{n.push(e.name)}}})}if(r.isArray(e)){var n=this._customizedUiConfig.customizedMenu=[];i(e,n)}};z.prototype._getEventName=function(e,t){return e+t};z.prototype.getEventNames=function(){var e=[_.CONTEXT_MENU_CHANGED,_.REQUEST_LEGEND_COLOR];if(r.isArray(this._customizedUiConfig.customizedMenu)){var t=this._customizedUiConfig.customizedMenu.slice();while(t.length){var i=t.shift();if(r.isString(i)){e.push(this._getEventName(i,O.CLICK))}else{e.push(this._getEventName(i.name,O.CLICK));t=t.concat(i.submenu)}}}return e};z.typeHelp=function(e,t){var i=[];var r=t.menu||[];for(var n=0;n<r.length;n++){for(var s=0;s<r[n].length;s++){var o=r[n][s].toUpperCase();if(o==="TITLE"){if(!d[o].notSupportType[e]){i.push(r[n][s])}}else if(d[o].supportType[e]){i.push(r[n][s])}}if(n!==r.length-1){i.push("blank")}}return i.concat(t.customizedMenu||[])};return z});e("sap/viz/controls/custombutton/CustomButtonConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{visible:true,title:"Button"}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_CUSTOMBUTTON,t);return t});e("sap/viz/controls/custombutton/CustomButtonEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButtonEvent"};e.extend(i,t);i.CLICK_CUSTOM_BUTTON="clickCustomButton";return i});e("sap/viz/controls/custombutton/CustomButton",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/custombutton/CustomButtonConfig","sap/viz/controls/custombutton/CustomButtonEvent"],function(e,t,i,r,n,s,o){var a=function(e,t){a.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.custombutton.CustomButton";this._div=e;this._uiConfig=t?t:s.instance();this._button$=null;this._icon$=null;this._createChildren()};t.extend(a,r);a.prototype._createChildren=function(){if(!(this._uiConfig.visible===false)){this._button$=e(document.createElement("div")).appendTo(this._div);this._button$.addClass(n.CUSTOMBUTTON_PREFIX+"button");this._icon$=e(document.createElement("div")).appendTo(this._button$);if(this._uiConfig.title){this.setTitle(this._uiConfig.title)}var t=this;this._button$.click(function(e){var i=t._button$.offset();t._dispatchEvent(new o(o.CLICK_CUSTOM_BUTTON,t,i))})}};a.prototype.setIcon=function(e){if(arguments.length>0){this._icon$.removeAttr("class");this._icon$.addClass(e);return this}};a.prototype.setTitle=function(e){if(arguments.length>0){this._icon$.attr("title",e);return this}};return a});e("sap/viz/controls/filterbar0/FilterBarConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{module:{visible:true}}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_FILTERBAR0,t);return t});e("sap/viz/controls/frame/VizFrameConfig",["sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/annotation/AnnotationConfig","sap/viz/controls/annotationcontrol/AnnotationControlConfig","sap/viz/controls/chart/ChartConfig","sap/viz/controls/filterbar0/FilterBarConfig","sap/viz/controls/contextmenu/ContextMenuConfig","sap/viz/controls/custombutton/CustomButtonConfig","sap/viz/controls/common/constants/ChartConst"],function(e,t,i,r,n,s,o,a){var l={};l.instance=function(){var e={enableAnnotation:false,enableAnnotationControl:false,enableContextMenu:true,enableFilterMenu:true,enableFilterBar:true,enableTitleEditor:true,enableSettingButton:true,enableFullScreenButton:true,enablePlayControl:true,useInfoChart:false,controls:{chart:r.instance(),filterBar:n.instance(),contextMenu:s.instance(),annotation:t.instance(),annotationControl:i.instance(),settingButton:o.instance(),fullScreenButton:o.instance()}};return e};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_FRAME,l);return l});e("sap/viz/controls/frame/VizFrameEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrameEvent"};t.extend(r,i);r.FILTERS_CHANGED="filtersChanged";r.CONTEXT_MENU_CHANGED="contextMenuChanged";r.ENTER_FULL_SCREEN="enterFullScreen";r.EXIT_FULL_SCREEN="exitFullScreen";r.ADD_COMMENT="addComment";r.ADD_FILTER="addFilter";r.REQUEST_LEGEND_COLOR="chooseLegendColors";r.POPUP_CHART_EDITOR="popupChartEditor";r.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";return r});e("sap/viz/controls/frame/chartEditor/ChartEditorEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments)};t.extend(r,i);r.FILTER_CLICKED="filterClicked";r.EXCLUDE_CLICKED="excludeClicked";return r});e("sap/viz/controls/frame/chartEditor/ChartEditor",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/frame/chartEditor/ChartEditorEvent"],function(e,t,i,r,n,s){var o=function(t,i){o.superclass.constructor.apply(this,arguments);this._dom$=e(t);this._createChildren(i)};r.extend(o,n);o.prototype._createChildren=function(r){var n=this;this._dom$.addClass(t.FRAME_PREFIX+"editor");var o=e("<div/>").appendTo(this._dom$);o.addClass(t.FRAME_PREFIX+"editor-main");o.addClass(t.COMMON_PREFIX+"popUp");var a=e("<div/>").appendTo(o).addClass(t.FRAME_PREFIX+"editor-header");var l=e("<h3/>").appendTo(a).text(i.get("VIZ_FRAME_CHART_EDITOR"));var c=e("<div/>").appendTo(o).addClass(t.FRAME_PREFIX+"editor-content");var p=e("<img/>").appendTo(c).addClass(t.FRAME_PREFIX+"editor-content-img");p.attr("src",r+"/chartEditorPH.png");var h=e("<div/>").appendTo(o).addClass(t.FRAME_PREFIX+"editor-footer");var d=e("<button/>").appendTo(h).text(i.get("VIZ_COMMON_OK"));d.addClass(t.FRAME_PREFIX+"editor-footer-button");d.addClass(t.COMMON_PREFIX+"button");var u=e("<button/>").appendTo(h).text(i.get("VIZ_COMMON_CANCEL"));u.addClass(t.FRAME_PREFIX+"editor-footer-button");u.addClass(t.COMMON_PREFIX+"button");var _=e("<div/>").appendTo(o);_.addClass(t.COMMON_PREFIX+"havanaSharedSprite16");_.addClass(t.FRAME_PREFIX+"editor-close");var v=function(){n._dispatchEvent(new s(s.EDIT_CANCELED,this));n._dispatchEvent(new s(s.EDITOR_CLOSED,this));n._dom$.detach()};var f=function(){n._dispatchEvent(new s(s.EDIT_CONFIRMED,this,{}));n._dispatchEvent(new s(s.EDITOR_CLOSED,this));n._dom$.detach()};d.click(f);u.click(v);_.click(v)};return o});e("sap/viz/controls/frame/chartEditor/ChartEditorPlugin",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/frame/chartEditor/ChartEditor","sap/viz/controls/frame/chartEditor/ChartEditorEvent"],function(e,t,i,r){var n=function(e,t,i){this.__className="sap.viz.controls.frame.chartEditor.ChartEditorPlugin";this._vizFrame=t;this._uiConfig=i;this._div=e;this._chartEditor=null};n.prototype.validateSize=function(e,t){this._locateChartEditor()};n.prototype.destroy=function(){if(this._chartEditor){this._chartEditor.removeAllEventListeners();this._chartEditor.destroy();this._chartEditor=null}e(this._div).remove()};n.prototype._popUpEditor=function(){var n=e(this._div);var s=this._uiConfig.chartEditorAssetFolderPath?this._uiConfig.chartEditorAssetFolderPath:"../src/controls/frame/assets";n.children().addClass(t.COMMON_PREFIX+"blur");var o=e(document.createElement("div")).appendTo(n);this._chartEditor=new i(o[0],s);this._locateChartEditor();this._chartEditor.addEventListener(r.EDITOR_CLOSED,function(e){n.children().removeClass(t.COMMON_PREFIX+"blur")})};n.prototype._locateChartEditor=function(){if(this._chartEditor){var t=e(this._div);var i=e(this._chartEditor._dom);i.css({left:(t.width()-i.width())/2,top:Math.min(120,(t.height()-i.height())/2)})}};return n});e("sap/viz/controls/frame/menu/CommentMenuItem",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/contextmenu/constants/MenuItemConst","sap/viz/controls/contextmenu/models/MenuItem"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,[r.COMMENT.name,r.getText(r.COMMENT.text),this._iconFunc,this._isVisibleFunc,this._clickHandler]);this.__className="sap.viz.controls.frame.menu.CommentMenuItem";this._chartModelProvider=e;this._chartProxyProvider=t};e.extend(s,n);s.prototype._isVisibleFunc=function(){var e=i.getVizType(this._getType());var t=this._chartProxyProvider.getSelection();var n=t&&t.length>0;return n&&r.COMMENT.supportType[e]};s.prototype._getType=function(){return this._chartModelProvider().type()};s.prototype.getDirection=function(){return i.getDirection(this._getType())};return s});e("sap/viz/controls/filterbar0/Tooltip",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/managers/LangManager"],function(e,t,i,r){var n=1e3;var s={x:8,y:16};var o=function(e){this._div=e;this._showing=false;this._tooltip$=null};o.prototype._getTitle=function(e){if(e.getType()!==i.VALUE_TYPE){return e.filterTitle()}var t=e.values().length;var n=e.filterName()+" ("+t+" ";if(e.isExcluded()){n+=r.get("VIZ_FILTERBAR_ITEMS_EXCLUDED")}else{n+=r.get("VIZ_FILTERBAR_ITEMS_INCLUDED")}n+=")";return n};o.prototype._showTooltip=function(i){if(!this._showing){return}if(!this._tooltip$){this._tooltip$=e(document.createElement("div")).appendTo(this._div)}else{this._tooltip$.empty()}var n=this._tooltip$;n.addClass(t.FILTERBAR0_PREFIX+"filter-item-tooltip");if(i.isGlobalFilter()){var o=r.get("VIZ_FILTERBAR_GLOBAL_FILTER");var a=e(document.createElement("span")).appendTo(n).text(o);a.addClass(t.FILTERBAR0_PREFIX+"filter-item-tooltip-globalfilter")}var l=e(document.createElement("span")).appendTo(n).text(this._getTitle(i));l.addClass(t.FILTERBAR0_PREFIX+"filter-item-tooltip-title");var c=e(document.createElement("span")).appendTo(n);c.addClass(t.FILTERBAR0_PREFIX+"filter-item-tooltip-value");if(i.isExcluded()){c.addClass(t.FILTERBAR0_PREFIX+"filter-exclude")}c.text(i.filterContent());var p=15*15;while(c.height()>p){c.text(c.text().replace(/(\s)*([a-zA-Z0-9]+|\W)(\.\.\.)?$/,"..."))}var h=this._position.left+s.x;var d=this._div.offset().left+this._div.outerWidth();h=Math.min(h,d-n.outerWidth());n.offset({left:h,top:this._position.top+s.y})};o.prototype.show=function(e,t){this._position=t;if(this._showing){return}this._showing=true;var i=this;setTimeout(function(){i._showTooltip(e)},n)};o.prototype.position=function(e){this._position=e};o.prototype.hide=function(){this._showing=false;if(this._tooltip$){this._tooltip$.remove();this._tooltip$=null}};return o});e("sap/viz/controls/filterbar0/FilterBarEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBarEvent"};e.extend(i,t);i.DELETE_FILTER="deleteFilter";i.HEIGHT_CHANGED="heightExtend";return i});e("sap/viz/controls/filterbar0/FilterBar",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/views/feed/FeedList","sap/viz/controls/common/views/feed/FeedListEvent","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/helpers/Rectangle","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/filter/DateRangeFilter","sap/viz/controls/common/filter/NumericRangeFilter","sap/viz/controls/common/filter/ValueFilter","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/filterbar0/Tooltip","sap/viz/controls/filterbar0/FilterBarConfig","sap/viz/controls/filterbar0/FilterBarEvent"],function(e,t,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T){var A=function(e,t){A.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar0.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_filterbar_control");this._div=e;this._uiConfig=t?t:C.instance();this._containerCurrentPosition=0;this._allAnalyses=null;this._settings=null;this._visualLines=2;this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._tooltip=new I(this._div);this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_filterbar_control")};var P=.8;var R=40;var z=190;l.extend(A,t);A.TYPE_STRING="string";A.TYPE_INTEGER="integer";A.TYPE_NUMBER="number";A.TYPE_DATE="date";var O=16;A.prototype.filterItems=function(e){if(arguments.length>0){this._vizModel().filterItems(e);return this}else{return this._vizModel().filterItems()}};A.prototype.save=function(){var e={};e["filterItems"]=y.toJSON(this._vizModel().filterItems());return e};A.prototype.load=function(e){var t=null;if(e&&e.filterItems){t=y.fromJSON(e.filterItems)}t=t||[];this._vizModel().filterItems(t)};A.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){this._filtersChanged()}};A.prototype._createChildren=function(){var t=this;var i=this._uiConfig.module;if(i&&!(i.visible===false)){this._headerVisible=true;this._plus$=e(document.createElement("div")).appendTo(this._div);this._plus$.addClass(r.COMMON_PREFIX+"havanaVXTabSprite16");this._plus$.addClass(r.FILTERBAR0_PREFIX+"header-plus");this._plus$.click(function(e){t._plusClickHandler(e)});var n=i.label?i.label:a.get("VIZ_FILTERBAR_DESCRIPTION");this._description$=e(document.createElement("span")).text(n).appendTo(this._div);this._description$.addClass(r.FILTERBAR0_PREFIX+"description")}this._layout$=e(document.createElement("div")).appendTo(this._div);this._layout$.addClass(r.FILTERBAR0_PREFIX+"layout");this._layout$.addClass(r.COMMON_PREFIX+"scrollable");this._layout$.addClass(r.COMMON_PREFIX+"scrollable-y");this._layout$.css({"max-height":this._visualLines*R});this._filterItemsContainer$=e(document.createElement("div")).appendTo(this._layout$);this._filterItemsContainer$.addClass(r.FILTERBAR0_PREFIX+"filterItems-container");if(this._headerVisible===true){this._layout$.hide()}else{this._layout$.css({left:"0px"})}e(this._div).droppable({tolerance:"pointer",accept:"."+o.DRAGGABLE_CLASS_ANALYSIS,over:e.proxy(this._dragOver,this),out:e.proxy(this._dragOut,this),drop:e.proxy(this._drop,this)})};A.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){this._allAnalyses=e}else{return this._allAnalyses}};A.prototype._plusClickHandler=function(e){var t=document.createElement("div");var i=this._getExcludeGlobalFilter(this._vizModel().filterItems());var r=new h(t,this._allAnalyses,_.DIMENSION,i);r.addEventListener(d.ITEM_SELECTED,function(e){var t=e.data.selectedItem;if(t){this._addFilterItem(t)}},this);var n=this._plus$.offset();r.open({x:n.left,y:n.top,shelfWidth:this._plus$.width()})};A.prototype._getExcludeGlobalFilter=function(e){var t=[];if(e){for(i=0;i<e.length;i++){if(e[i].isGlobalFilter()==false){t.push(e[i])}}}return t};A.prototype._getDroppableAnalysisObject=function(e){if(!e||!e.analysisObject){return null}var t=e.analysisObject;var i=t.type();var r=y.getFilterInfo(t);if(u.compatible(u.DIMENSION,i)&&!y.isFilterItemExisted(this._vizModel(),r.id,r.hierarchyLevelId)&&i!==u.MND){return t}else{return null}};A.prototype._dragOver=function(e,t){var i=o.instance().getAnalysisToken(t.helper);if(!i){return}var r=this._getDroppableAnalysisObject(i);if(r){i.currentAction(p.ACCEPT_AS_COPY)}else{i.currentAction(p.DENY)}};A.prototype._dragOut=function(e,t){var i=o.instance().getAnalysisToken(t.helper);if(i){i.currentAction(p.DENY)}};A.prototype._drop=function(e,t){var i=o.instance().getAnalysisToken(t.helper);if(!i){return}var r=this._getDroppableAnalysisObject(i);if(r){i.currentAction(p.ACCEPT_AS_COPY);this._addFilterItem(r)}else{i.currentAction(p.DENY)}i.dropTarget(this._dom)};A.prototype._addFilterItem=function(e){var t=y.getFilterInfo(e);var i=t.name;var r=t.id;var n=e.dataType();var s;switch(n){case A.TYPE_INTEGER:case A.TYPE_NUMBER:s=new g(r,i);break;case A.TYPE_DATE:s=new m(r,i);break;case A.TYPE_STRING:default:s=new E(r,i);if(t.hierarchyLevelId){s.hierarchyLevelId=t.hierarchyLevelId}break}var o=this._vizModel().filterItems();o.push(s);this._vizModel().filterItems(o);this._dispatchRequestFilterEvent(s)};A.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty()}var e=this._vizModel().filterItems();if(!e||e.length==0){this._updateDescription();return this}if(this._headerVisible===true){this._description$.hide();this._layout$.show()}this._updateFilterItemContainer()};A.prototype._dispatchRequestFilterEvent=function(t){var i=this;var r=function(e){var r=i._vizModel().filterItems();if(t.isEmpty()){var n=r.indexOf(t);if(n>=0){r.splice(n,1);i._vizModel().filterItems(r);i._tooltip.hide()}return}if(e){i._vizModel().filterItems(r)}};var o=e("#"+t.id(),this._filterItemsContainer$);var a={bounds:v.toJSON(v.parseDOM(o)),filterName:t.filterName(),analysisObjectId:t.analysisObjectId(),filterItem:t,validate:r};this._dispatchEvent(new s(n.REQUEST_FILTER_VALUES,this,a))};A.prototype._createFilterTitle=function(t,i){if(t.getType()!==f.VALUE_TYPE){var n=e(document.createElement("span")).appendTo(i).text(t.filterTitle());n.addClass(r.FILTERBAR0_PREFIX+"filter-item-text");n.addClass(r.FILTERBAR0_PREFIX+"range-filter-item-text");return}var s=e(document.createElement("div")).appendTo(i);var o=e(document.createElement("div")).appendTo(s).text(t.filterName()).css("display","inline");o.addClass(r.FILTERBAR0_PREFIX+"filter-item-text").attr("id","filterName");var a=e(document.createElement("div")).appendTo(s).css("display","inline").attr("id","countInfo");a.addClass(r.FILTERBAR0_PREFIX+"filter-item-info");e(document.createElement("span")).appendTo(a).text("(");var l=e(document.createElement("span")).appendTo(a).text(t.values().length);if(t.isExcluded()){l.addClass(r.FILTERBAR0_PREFIX+"filter-exclude")}e(document.createElement("span")).appendTo(a).text(")")};A.prototype._createFilterItem=function(t){var i=t.filterName();var n=this;var s=document.createElement("div");var o=e(s).appendTo(this._filterItemsContainer$);this._createFilterTitle(t,o);if(t.isGlobalFilter()){o.attr({id:"GLOBAL-"+t.id()});o.addClass(r.FILTERBAR0_PREFIX+"global-filter-item")}else{o.attr({id:t.id()});o.addClass(r.FILTERBAR0_PREFIX+"filter-item");o.click(function(){n._dispatchRequestFilterEvent(t)});var a=e(document.createElement("div")).appendTo(o);a.addClass(r.FILTERBAR0_PREFIX+"delete-icon");a.addClass(r.COMMON_PREFIX+"UVBSharedSprite");a.click(function(e){n._removeFilterItem(t);n._dispatchEvent(new T(T.DELETE_FILTER,n));n._tooltip.hide();e.stopPropagation()})}return o};A.prototype._stringToNumber=function(e){if(!e){return 0}return parseInt(e.replace("px",""))};A.prototype.validateSize=function(){var e=this._filterItemsContainer$.children();if(e.length==0){return this}e.css({width:z});this._updateFilterItemsWidth()};A.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var t=e>R;if(t){return true}else{return false}};A.prototype._updateFilterItemContainer=function(){var e=this._vizModel().filterItems();var t;for(t=0;t<e.length;t++){this._createFilterUI(e[t])}this._updateFilterItemsWidth();return this};A.prototype._createFilterUI=function(t){var i=t.filterName();var n;var s=this;n=this._createFilterItem(t);n.mouseover(function(i){s._tooltip.show(t,{left:i.clientX,top:i.clientY});e("."+r.FILTERBAR0_PREFIX+"filter-values",i.currentTarget).addClass(r.FILTERBAR0_PREFIX+"filter-values-active")});n.mousemove(function(e){s._tooltip.position({left:e.clientX,top:e.clientY})});n.mouseout(function(t){s._tooltip.hide();e("."+r.FILTERBAR0_PREFIX+"filter-values",t.currentTarget).removeClass(r.FILTERBAR0_PREFIX+"filter-values-active")});this._addFilterValues(t,n)};A.prototype._updateFiltersTitle=function(){var t=function(t,i){var r=e("#filterName",i);if(r.length===0){return}r.css({width:"auto"});var n=r.parent();var s=e("#countInfo",i);var o=r.position();var a=r.width()+o.left+2;var l=n.width()-O;var c=s.width();var p=Math.min(a,l-c);r.css({width:p-o.left});s.css({left:p})};e("."+r.FILTERBAR0_PREFIX+"filter-item",this._div).each(t);e("."+r.FILTERBAR0_PREFIX+"global-filter-item",this._div).each(t)};A.prototype._updateFilterItemsWidth=function(){var t;if(this._filterItemsContainer$.children().length===0){this._updateDescription();return this}if(!this._needAdjust()){t={height:R};this._dispatchEvent(new T(T.HEIGHT_CHANGED,this,t));this._updateFiltersTitle();return this}var i=0;while(this._needAdjust()&&i<2){i++;var n=e("."+r.FILTERBAR0_PREFIX+"filter-item");var s=e(e("."+r.FILTERBAR0_PREFIX+"filter-item")[0]).outerWidth()*P;n.css({width:s})}if(this._needAdjust()){t={height:this._avaliableHeightForHeader()};this._dispatchEvent(new T(T.HEIGHT_CHANGED,this,t));if(t.height<this._filterItemsContainer$.outerHeight()){e(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight())}}if(!this._needAdjust()){t={height:R};this._dispatchEvent(new T(T.HEIGHT_CHANGED,this,t))}this._updateFiltersTitle();return this};A.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var t=R-2;var i=R;var r=this._visualLines-1;for(var n=2;n<=this._visualLines;n++){if(t*n<=e&&e<=i*n){r=n-1;break}}var s=2;return r*t+i+s};A.prototype._addFilterValues=function(t,i){var n=t.filterContent();var s=i.find("span[id='values']");if(s.length===0){s=e(document.createElement("span")).appendTo(i);s.addClass(r.FILTERBAR0_PREFIX+"filter-values");s.attr({id:"values"})}s.text(n);var o=r.FILTERBAR0_PREFIX+"filter-exclude";if(t.isExcluded()){s.addClass(o)}else{s.removeClass(o)}};A.prototype._removeFilterItem=function(e){var t=this._vizModel().filterItems().slice(0);var i=t.indexOf(e);t.splice(i,1);this._vizModel().filterItems(t);return t};A.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide()}};return A});e("sap/viz/controls/frame/views/FilterMenuEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenuEvent"};t.extend(r,i);r.FILTER_CLICKED="filterClicked";r.EXCLUDE_CLICKED="excludeClicked";return r});e("sap/viz/controls/frame/views/FilterMenu",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/frame/views/FilterMenuEvent"],function(e,t,i,r,n,s){var o=function(e,t){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.views.FilterMenu";this._div=e;this._uiConfig=t;this._container=null;this._createChildren()};t.extend(o,i);o.prototype._createChildren=function(){this._container=e(document.createElement("div")).appendTo(this._div);e(this._container).addClass(r.FRAME_PREFIX+"filtermenu");var t=e(document.createElement("div")).appendTo(this._container);var i=e(document.createElement("div")).appendTo(t);i.addClass(r.COMMON_PREFIX+"havanaSharedSprite16");i.addClass(r.FRAME_PREFIX+"filtermenu-filter-icon");var o=e(document.createElement("div")).appendTo(t);o.text(n.get("VIZ_FRAME_FILTERMENU_FILTER"));t.click(e.proxy(function(){this._dispatchEvent(new s(s.FILTER_CLICKED),this)},this));var a=e(document.createElement("div")).appendTo(this._container);var l=e(document.createElement("div")).appendTo(a);l.addClass(r.COMMON_PREFIX+"havanaSharedSprite16");l.addClass(r.FRAME_PREFIX+"filtermenu-exclude-icon");var c=e(document.createElement("div")).appendTo(a);c.text(n.get("VIZ_FRAME_FILTERMENU_EXCLUDE"));e(a).click(e.proxy(function(){this._dispatchEvent(new s(s.EXCLUDE_CLICKED),this)},this))};o.prototype.show=function(t,i){if(t||i){e(this._container).css({bottom:2+"px",visibility:"visible",display:"block"});e(this._container).show()}else{e(this._container).hide()}};o.prototype.hide=function(){e(this._container).hide()};o.prototype.size=function(t){e(this._container).css({left:(t.width-e(this._container).outerWidth())/2+"px"})};return o});e("sap/viz/controls/chart/views/TitleContextMenu",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/OSUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/constants/CSSConst","jquery"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleContextMenu";this._div=e;this._menu=null;this._visible=true;this._shown=false;this._cusMenuItems=t;this._createContextMenu();this._mousedownHandler=n.proxy(this._handleMousedownEvent,this)};e.extend(s,i);s.prototype._createContextMenu=function(){var e=this;this._menu=document.createElement("div");n(this._menu).addClass(r.PREFIX+"contextmenu");n(this._div).append(this._menu);this.hide();this._ul=document.createElement("ul");n(this._ul).addClass([r.CONTEXTMENU_PREFIX+"list",r.CONTEXTMENU_PREFIX+"list-hovered"].join(" "));n(this._ul).appendTo(this._menu)};var o=[];s.prototype._getCusMenuItem=function(e){if(this._cusMenuItems&&this._cusMenuItems.length>0){for(var t=0;t<this._cusMenuItems.length;t++){var i=this._cusMenuItems[t];if(i.name===e){return i}}}return null};s.prototype.updateMenu=function(){var e=[];n(this._ul).empty();for(var t=0;t<this._cusMenuItems.length;t++){var i=this._cusMenuItems[t];this._createMenuItemUI(i)}};s.prototype._createMenuItemUI=function(e){var t=e.text;var i={};i.clickHandler=e.clickHandler;i.scope=e.scope;var s=e.enableValidator.apply(e.scope);var o=e.name;var a=document.createElement("li");var l=document.createElement("div");n(a).addClass(r.CONTEXTMENU_PREFIX+"MnuItm");n(l).addClass(r.CONTEXTMENU_PREFIX+"MnuItm");n(a).appendTo(this._ul);n(l).appendTo(a);var c=n("<div>",{class:r.CONTEXTMENU_PREFIX+"MnuItmTxt"});n(c).appendTo(l);n(c).text(t);if(s){n(c).css("color","black")}else{n(c).css("color","grey")}l.id=o;var p=this;if(s){n(l).click(function(e){if(i.clickHandler){i.clickHandler.apply(i.scope)}p.hide()})}else{n(l).click(function(e){p.hide()})}};s.prototype.isShown=function(){return this._shown};s.prototype.show=function(e){this.updateMenu();if(e&&e.position){var t=n(this._div).innerWidth();var i=n(this._menu).outerWidth();var r=e.position.pageX;if(t<i+r){r=t-i}var s=e.position.pageY;var o=n(this._div).parent().innerHeight();var a=n(this._menu).outerHeight();if(o<a+s){s=o-a}s+=n(this._div).parent().offset().top;if(r<0){r=n(this._div).parent().offset().left}else{r+=n(this._div).parent().offset().left}n(this._menu).css({position:"fixed",left:r+"px",top:s+"px"})}n(this._menu).css("visibility","visible");this._shown=true;document.removeEventListener("mousedown",this._mousedownHandler,true);n(window).off("blur",this._mousedownHandler);document.addEventListener("mousedown",this._mousedownHandler,true);n(window).on("blur",this._mousedownHandler)};s.prototype._handleMousedownEvent=function(e){var i=e.target.id;if(t.isIE()&&i==""){i=e.target.parentNode.id}var r=this._getCusMenuItem(i);if(r){return}this.hide()};s.prototype.hide=function(){n(this._menu).find("*").removeData().off();n(this._menu).css("visibility","hidden");this._shown=false};return s});e("sap/viz/controls/chart/views/TitleEditor",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/OSUtil","sap/viz/controls/common/events/Event","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/helpers/Rectangle","sap/viz/controls/chart/views/TitleContextMenu","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/chart/Chart"],function(e,t,i,r,n,s,o,a,l,c,p){var h=function(e,t){h.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.TitleEditor";this._targetDiv=e;this._uiconfig=t;this._editing=false;this.createChildren()};i.extend(h,s);h.prototype.createChildren=function(){var i=this._targetDiv;this._div=e(document.createElement("DIV"));this._textInput=e('<input type="text" spellcheck="false"/>');this._textInput.addClass(t.CHART_PREFIX+"title-text");this._textInput.attr("value",this._vizProxy().getTitleText());this._settingBtn=e(document.createElement("div"));this._settingBtn.addClass(t.CHART_PREFIX+"title-button");var r=e(document.createElement("div")).appendTo(this._settingBtn);r.addClass(t.COMMON_PREFIX+"UVBSharedSprite");r.addClass(t.CHART_PREFIX+"setting-icon");this._settingBtn.hide();var n=[{text:l.get("VIZ_CHART_TITLE_CONTEXT_MENU_EDIT"),name:"edit",clickHandler:this.enterEditMode,enableValidator:function(){return true},scope:this},{text:l.get("VIZ_CHART_TITLE_CONTEXT_MENU_RESTORE"),name:"restore",clickHandler:this.restore,enableValidator:function(){return this.edited()},scope:this}];this._contextMenu=new a(i,n);this._div.append(this._textInput).append(this._settingBtn).appendTo(i);var s=this;document.addEventListener("mousedown",function(e){s._documentMouseDownHandler(e)},true);this._settingBtn.click(function(e){s._popupContextMenu()});this._div.bind("mouseover",function(){s.mouseOver()}).bind("mouseout",function(){s.mouseOut()}).bind("dblclick",function(){s.dblClick()}).bind("keypress",function(e){if(e.keyCode==13){s._documentKeyPressHandler(e);e.preventDefault()}})};h.prototype.editable=function(){return!this._vizProxy().isFakeChart()};h.prototype.edited=function(){return this._vizProxy().isTitleCustomized()};h.prototype.restore=function(){this._editing=false;this._vizProxy().setTitleMode(p.VIZ_TITLE_MODE.auto);this._vizProxy().restoreTitleText()};h.prototype.enterEditMode=function(){if(this.editable()){this._settingBtn.hide();this._editing=true;this._layoutTitleDiv();this._textInput.css({display:"block"});this._textInput.val(this._vizProxy().getTitleText());this._textInput.focus().select()}};h.prototype._layoutTitleDiv=function(){var e=this._vizProxy().getTitleZone();if(e&&e.length>0){var i=this._targetDiv.scrollLeft();var n=e[0][0],s=e[0][1],o=e[2][0]-e[0][0],a=e[2][1]-e[0][1];var l="position:absolute;box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;";if(this._editing){var c=8;l+="left:"+i+"px;top:"+(s-c)+"px;width:100%;"+"height:"+(a+c*2)+"px;";this._div.addClass(t.CHART_PREFIX+"title-edit")}else{l+="left:"+n+"px;top:"+s+"px;width:"+(o+16)+"px;height:"+a+"px;";if(r.isIE()){l+="background-color:rgba(0,0,0,0)"}this._div.removeClass(t.CHART_PREFIX+"title-edit")}this._div.attr("style",l)}};h.prototype.init=function(){if(c.supportTitle(this._vizModel().type())){this.size();this._show()}else{this._hide()}};h.prototype._show=function(){this.show()};h.prototype._hide=function(){this.hide()};h.prototype.dblClick=function(){if(this.editable()&&!this._editing){this.enterEditMode()}};h.prototype._popupContextMenu=function(){var e=this._vizProxy().getTitleZone();var t=e[0][0],i=e[0][1],r=e[2][0]-e[0][0],n=e[2][1]-e[0][1];var s=95;var o={pageX:t+r-s-this._targetDiv.scrollLeft(),pageY:i+n-this._targetDiv.scrollTop()};this._contextMenu.show({position:o})};h.prototype.mouseOver=function(){var e=this._vizProxy().getProperties().title||{visible:true};if(this.editable()&&!this._editing&&e.visible){this._layoutTitleDiv();this._settingBtn.show()}};h.prototype.mouseOut=function(){if(this.editable()&&!this._editing){this._layoutTitleDiv();if(r.isIE()){this._div.css({"border-width":"0px","background-color":"rgba(0,0,0,0)"})}else{this._div.css({"border-width":"0px","background-color":"transparent"})}this._textInput.css({display:"none"});this._textInput.blur();if(!this._contextMenu.isShown()){this._settingBtn.hide()}}};h.prototype._documentMouseDownHandler=function(e){if(this._editing&&e.target!==this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}if(this._contextMenu.isShown()&&e.target!=this._settingBtn[0]&&e.target.parentElement!=this._settingBtn[0]){this._settingBtn.hide()}};h.prototype._documentKeyPressHandler=function(e){if(this._editing&&e.target===this._textInput[0]){this._commitTitleEdit();e.stopPropagation()}};h.prototype._onVizModelChanged=function(){this.init()};h.prototype._commitTitleEdit=function(){this._editing=false;var e=this._textInput[0].value;if(e!=this._vizProxy().getTitleText()){this._vizProxy().setTitleMode(p.VIZ_TITLE_MODE.manual);this._vizProxy().setTitleText(e)}this.mouseOut()};h.prototype.size=function(){this._layoutTitleDiv();if(this._contextMenu.isShown()){this._popupContextMenu()}};h.prototype.load=function(){this.init()};return h});e("sap/viz/controls/playcontrol/PlayControlEvent",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControlEvent"};t.extend(r,i);r.SLICE_DIMENSION_CHANGED="sliceDimensionChanged";r.UPDATE_CHART_COMPLETE="updateChartComplete";return r});e("sap/viz/controls/playcontrol/PlayControl",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/playcontrol/PlayControlEvent","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/constants/ChartConst"],function(e,t,i,r,n,s,o,a,l,c){var p=0,h=1,d=2,u=1,_=1e3,v="/controls/playcontrol/assets/paused.svg",f="/controls/playcontrol/assets/inprogress.svg",m=48;var g=function(e){this._player=e;this._t=null;this._lastUpdateTstmp=0};g.prototype._playerUpdateHandler=function(){if(this._player){var t=(new Date).getTime();if(t-this._lastUpdateTstmp>=_){this._player._progressing();this._lastUpdateTstmp=t}else{if(!this._t){this._t=setTimeout(e.proxy(function(){clearTimeout(this._t);this._t=null;this._playerUpdateHandler()},this),t-this._lastUpdateTstmp)}}}};g.prototype.start=function(){this._player._start();if(!this._player.hasEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.addEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._playerUpdateHandler()};g.prototype.pause=function(){if(this._t){clearTimeout(this._t);this._t=null}if(this._player.hasEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._player._pause()};g.prototype.stop=function(){if(this._t){clearTimeout(this._t);this._t=null}if(this._player.hasEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)){this._player.removeEventListener(s.UPDATE_CHART_COMPLETE,this._playerUpdateHandler,this)}this._player._stop()};var E=function(t,i){E.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.playcontrol.PlayControl";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol");this._div=t;this._body=null;this._slider=null;this._playBtn=null;this._slicedData=[];this._labelDiv=null;this._timer=new g(this);this._state=p;this._currentVal=0;this._step=u;this._visible=false;this._chartFeedings=[];this._createChildren();this._chartUpdateCompleteHandler=e.proxy(function(){this._dispatchEvent(new s(s.UPDATE_CHART_COMPLETE,this))},this);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_playcontrol")};n.extend(E,t);E.prototype.sliceDimension=function(e){if(arguments.length>0){this._vizModel().playerField(e);return this}else{return this._vizModel().playerField()}};E.prototype.slicedData=function(e){if(arguments.length>0){this._slicedData=e;this._resetControls();this._resetChartFrameDataScale();this._timer.stop()}else{return this._slicedData}};E.prototype._createChildren=function(){var t=this;var n=this._uiConfig;if(!this._body){this._body=e(document.createElement("div")).appendTo(this._div);this._body.addClass(r.PLAYCTRL_PREFIX+"body")}if(!this._playBtnDiv){this._playBtnDiv=e(document.createElement("div")).appendTo(this._body);this._playBtnDiv.addClass(r.PLAYCTRL_PREFIX+"playbtn");this._playBtn=new sap.ui.commons.Button({icon:i.defaultAssetsRoot()+v,iconDesityAware:true,press:e.proxy(t._btnPress,this)});this._playBtn.addStyleClass(r.PLAYCTRL_PREFIX+"playbtn");this._playBtn.placeAt(this._playBtnDiv)}if(!this._sliderDiv){this._sliderDiv=e(document.createElement("div")).appendTo(this._body);this._sliderDiv.addClass(r.PLAYCTRL_PREFIX+"slider");this._slider=new sap.ui.commons.Slider({editable:false,min:0,max:1,smallStepWidth:1,liveChange:e.proxy(this._sliderValueChange,this)});this._slider.placeAt(this._sliderDiv)}if(!this._labelDiv){this._labelDiv=e(document.createElement("div")).appendTo(this._body);this._labelDiv.addClass(r.PLAYCTRL_PREFIX+"label").text("text")}this._resetControls()};E.prototype._progressing=function(){this._currentVal+=this._step;if(this._currentVal>this._slider.getMax()){this._timer.stop();return}this._updateControls();this._updateChartData()};E.prototype._start=function(){this._state=h;this._updateControls();this._updateChartScale();this._enableChartInteraction(false)};E.prototype._stop=function(){this._state=p;this._currentVal=0;this._updateControls();this._updateChartData();this._enableChartInteraction(true)};E.prototype._pause=function(){this._state=d;this._updateControls();this._enableChartInteraction(true)};E.prototype._updateChartData=function(){if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._vizProxy().SetDataset(this._slicedData.slices[this._currentVal].data)}};E.prototype._updateChartScale=function(){if(this._vizModel().type()===c.TYPE_GEO_BUBBLE){var e=this._vizProxy().getProperties();if(e&&e.geoContainer){this._vizProxy().updateProperties({properties:{geoContainer:{scale:e.geoContainer.scale,center:e.geoContainer.center}}})}}};E.prototype._resetChartFixScale=function(){if(this._vizModel().type()===c.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoContainer:{isFixedScale:this.sliceDimension()!=null,scale:null,center:[]}}})}};E.prototype._resetChartFrameDataScale=function(){function e(e,t){var i,r,n=Number.MAX_VALUE,s=Number.MIN_VALUE,o=false;if(e&&t){for(i=0;i<e.length;i++){r=e[i].name();if(t[r]){n=Math.min(t[r][0],n);s=Math.max(t[r][1],s);o=true}}}return o?[n,s]:[0,0]}function t(e,t,i){var r=t.split("."),n,s;for(n=0,s=e;n<r.length;n++){if(n==r.length-1){s[r[n]]=i}else{s[r[n]]=s[r[n]]||{};s=s[r[n]]}}}var i={},r=[],n=this._vizModel().type(),s=sap.viz.api.manifest.Viz.get(n),o={},c,p,h,d={},u=s&&s[0]?s[0].dataScale:null;if(!u){return}if(this._slicedData&&a.isArray(this._slicedData.measuresInfo)){this._slicedData.measuresInfo.forEach(function(e){o[e.name]=e.range})}if(this._chartFeedings){r=this._chartFeedings.filter(function(e){return e&&e.type()===l.MEASURE});if(r.length>0){r.forEach(function(t){d[t.id()]=e(t.values(),o)})}}for(c in d){if(d.hasOwnProperty(c)){h=d[c]}if(u[c]&&a.isArray(u[c].minValue)){u[c].minValue.forEach(function(e){t(i,e,h[0])})}if(u[c]&&a.isArray(u[c].maxValue)){u[c].maxValue.forEach(function(e){t(i,e,h[1])})}}this._vizProxy().updateProperties({properties:i})};E.prototype._enableChartInteraction=function(e){if(this._vizModel().type()===c.TYPE_GEO_BUBBLE){this._vizProxy().updateProperties({properties:{geoController:{disableInteraction:!e}}})}};E.prototype._updateControls=function(){switch(this._state){case p:this._playBtn.setIcon(i.defaultAssetsRoot()+v);break;case h:this._playBtn.setIcon(i.defaultAssetsRoot()+f);break;case d:this._playBtn.setIcon(i.defaultAssetsRoot()+v);break}this._slider.setValue(this._currentVal);if(this._slicedData&&this._slicedData.slices&&this._slicedData.slices[this._currentVal]!==undefined){this._labelDiv.text(this._slicedData.slices[this._currentVal].dimensionMember);this._alignLabelWithSliderThumb()}};E.prototype._alignLabelWithSliderThumb=function(){this._labelDiv.width("auto");var t=this._sliderDiv.offset().left,i=this._sliderDiv.width(),r=Math.min(i,this._labelDiv.width()),n=e(".sapUiSliGrip",this._sliderDiv).offset()?e(".sapUiSliGrip",this._sliderDiv).offset().left:0;this._labelDiv.width(r+1);this._labelDiv.offset({left:r+n<t+i?n:t+i-r})};E.prototype._resetControls=function(){var e=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._playBtn.setEnabled(e);this._slider.setEditable(e);this._slider.setEnabled(e);this._slider.setMin(0);this._slider.setMax(e?this._slicedData.slices.length-1:1);this._updateControls();this._updateLabelVisiblity()};E.prototype._btnPress=function(){switch(this._state){case p:case d:this._timer.start();break;case h:this._timer.pause();break}};E.prototype._onConnect=function(e){E.superclass._onConnect.apply(this,arguments);this._chartFeedings=this._vizModel().feedingItems();this._sliceDimensionChanged();this._vizProxy().on("initialized.playcontrol",this._chartUpdateCompleteHandler)};E.prototype._onVizModelChanged=function(e){if(e.data.feedingItemsChanged){this._chartFeedings=this._vizModel().feedingItems();this.slicedData([])}if(e.data.sliceDimensionChanged){this._sliceDimensionChanged()}};E.prototype._sliderValueChange=function(){this._currentVal=this._slider.getValue();this._updateControls();this._updateChartScale();this._updateChartData()};E.prototype._sliceDimensionChanged=function(){this.slicedData([]);this._resetChartFixScale();var e={sliceDimension:this.sliceDimension()};this._dispatchEvent(new s(s.SLICE_DIMENSION_CHANGED,this,e))};E.prototype.validateSize=function(t,i){var r=0,n=0,s,o=e(this._body).height();e(this._body).css({width:t});if(this._playBtnDiv){r=this._playBtnDiv.outerWidth();n=this._playBtnDiv.outerHeight();this._playBtnDiv.css({top:o/2-n/2+"px",left:0+"px",position:"absolute"})}if(this._sliderDiv){s=t-r;this._slider.setWidth(s+"px");sliderHeight=this._slider.getHeight();this._sliderDiv.css({top:o/2+"px",left:r+"px",position:"absolute"})}if(this._labelDiv){setTimeout(e.proxy(function(){this._alignLabelWithSliderThumb()},this),0)}if(this._slider.oGrip&&this._slider.oGrip.title){e(".viz-controls-playcontrol-slider #__slider0-grip").mouseover(function(t){e("#__slider0-grip").attr("title"," ")})}};E.prototype.visible=function(e){E.superclass.visible.apply(this,arguments);this._visible=e;this._updateLabelVisiblity()};E.prototype._updateLabelVisiblity=function(){var e=!!(this._slicedData&&this._slicedData.slices&&this._slicedData.slices.length>0);this._labelDiv.css("visibility",e&&this._visible?"visible":"hidden")};E.prototype.save=function(e){var t={},i=0;if(e&&e.emptyDataset===true){t.measuresInfo=[];t.slices=[]}else if(this._slicedData){t.measuresInfo=this._slicedData.measuresInfo;if(a.isArray(this._slicedData.slices)){t.slices=[];for(;i<this._slicedData.slices.length;i++){t.slices.push({data:this._slicedData.slices[i].data.toJSON(),dimensionMember:this._slicedData.slices[i].dimensionMember})}}}return{sliceDimension:o.toJSON(this.sliceDimension()),slicedData:t,value:this._currentVal}};E.prototype.load=function(e){var t=e.slicedData,i=t&&a.isArray(t.slices)&&t.slices.length>0;this.sliceDimension(o.fromJSON(e.sliceDimension));if(i){t.slices=t.slices.map(function(e){return{dimensionMember:e.dimensionMember,data:sap.viz.api.data.CrosstableDataset.fromJSON(e.data)}})}this._slicedData=t;this._currentVal=i?Math.min(e.value,t.slices.length):0;this._resetControls();this._resetChartFrameDataScale();this._resetChartFixScale()};E.prototype.destroy=function(){this._vizProxy().off("initialized.playcontrol",this._chartUpdateCompleteHandler);E.superclass.destroy.apply(this,arguments);if(this._playBtn){this._playBtn.destroy(true)}if(this._slider){this._slider.destroy(true)}e(".viz-controls-playcontrol-slider #__slider0-grip").unbind("mouseover")};return E});e("sap/viz/controls/frame/VizFrame",["jquery","sap/viz/controls/common/VizControlHost","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/events/FeedEvent","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/FeedUtils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/filter/FilterHelper","sap/viz/controls/common/managers/LangManager","sap/viz/controls/frame/VizFrameConfig","sap/viz/controls/frame/VizFrameEvent","sap/viz/controls/annotation/Annotation","sap/viz/controls/annotation/AnnotationEvent","sap/viz/controls/annotationcontrol/AnnotationControl","sap/viz/controls/annotationcontrol/AnnotationControlConfig","sap/viz/controls/annotationcontrol/AnnotationControlEvent","sap/viz/controls/frame/chartEditor/ChartEditorPlugin","sap/viz/controls/chart/Chart","sap/viz/controls/contextmenu/ContextMenu","sap/viz/controls/contextmenu/ContextMenuEvent","sap/viz/controls/frame/menu/CommentMenuItem","sap/viz/controls/custombutton/CustomButton","sap/viz/controls/custombutton/CustomButtonEvent","sap/viz/controls/filterbar0/FilterBar","sap/viz/controls/filterbar0/FilterBarEvent","sap/viz/controls/frame/views/FilterMenu","sap/viz/controls/frame/views/FilterMenuEvent","sap/viz/controls/chart/views/ChartEvent","sap/viz/controls/chart/views/TitleEditor","sap/viz/controls/playcontrol/PlayControl","sap/viz/controls/playcontrol/PlayControlEvent","sap/viz/controls/runtime/RuntimeManager","sap/viz/controls/runtime/VizModel","sap/viz/controls/Version","sap/viz/controls/annotation/AnnotationConfig","sap/viz/controls/chart/ChartConfig","sap/viz/controls/filterbar0/FilterBarConfig","sap/viz/controls/contextmenu/ContextMenuConfig","sap/viz/controls/custombutton/CustomButtonConfig","sap/viz/controls/common/utils/Serialization"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T,A,P,R,z,O,b,S,x,D,L,M,N,w,F,V,H,k,U,B,$,Y,X){var G=function e(t,i){e.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.frame.VizFrame";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizframe_control");this._div=t;this._uiConfig=i?i:v.instance();if(this._uiConfig.enablePlayControl){try{jQuery.sap.require("sap.ui.commons.Button");jQuery.sap.require("sap.ui.commons.Slider")}catch(e){throw h.substitute(_.get("VIZ_COMMON_DEPENDENCY_ERROR_WITH_UI_CONFIG"),"sap.ui.commons","VizFrame","{enablePlayControl: true}")}}this._layout=null;this._filterBar=null;this._chart=null;this._chartEditorPlugin=new C(this._div,this,this._uiConfig);this._contextMenu=null;this._popupLayout=null;this._annotation=null;this._settingBtn=null;this._fullScreenBtn=null;this._titleEditor=null;this._playControl=null;this._createChildren();this._addChild(this._chart,["enableMorphing","feedAnalysisObjects"],[L.CHART_CHANGED,L.CHART_CHANGING,L.VIZTYPE_CHANGED,o.FEEDS_CHANGED]);if(this._filterBar){this._addChild(this._filterBar,["analysisObjectsForPicker"],[n.REQUEST_FILTER_VALUES])}if(this._annotationControl){this._addChild(this._annotationControl,[I.ANNOTATION_SELECTED_EVENT,I.ANNOTATION_LAYOUTED_EVENT])}this._addChild(this._annotation,[],[]);if(this._contextMenu&&h.isFunction(this._contextMenu.getEventNames)){this._addChild(this._contextMenu,[],this._contextMenu.getEventNames())}this._addChild(this._fullScreenBtn,[],[f.ENTER_FULL_SCREEN,f.EXIT_FULL_SCREEN]);sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizframe_control")};p.extend(G,t);G.HEADER_HEIGHT=40;G.prototype.vizType=function(e){return this._chart.vizType.apply(this._chart,arguments)};G.prototype.filterItems=function(e){if(arguments.length>0){this._beginUpdateProperty();if(this._filterBar){this._filterBar.filterItems(e)}this._endUpdateProperty();return this}else{if(this._filterBar){return this._filterBar.filterItems()}return[]}};G.prototype.clearSelectedPropertyZone=function(){this._chart.clearSelectedPropertyZone()};G.prototype._onVizModelChanged=function(e){if(e.data.filterChanged){var t=this._vizModel().filterItems();if(!this._inUpdatingProperty()){this._chart.showLoadingIcon()}this._dispatchPropertyEvent(new f(f.FILTERS_CHANGED,this,t))}if(e.data.sliceDimensionChanged){if(!this._playControl){var i=this._uiConfig.enablePlayControl===false?false:true;if(i){this._createPlayControl()}}}};G.prototype._commentChangedHandler=function(e){var t={commentChanged:true};this._dispatchEvent(new s(n.VIZ_DEFINITION_CHANGED,this,t))};G.prototype._vizDefinitionChanged=function(e){this._dispatchEvent(new s(n.VIZ_DEFINITION_CHANGED,this,e.data))};G.prototype._vizViewChanged=function(e){var t=this._uiConfig.enableTitleEditor===false?false:true;if(t){if(this._titleEditor){this._titleEditor.destroy();this._titleEditor=null}var i=e.data.type;if(c.supportTitle(i)){this._createTitleEditor();this._titleEditor.connect(this.vizUid())}}};G.prototype._createChart=function(){this._layout=document.createElement("div");e(this._div).append(this._layout);var t=U.instance();if(this._uiConfig.controls&&this._uiConfig.controls.chart){t=this._uiConfig.controls.chart}t=e.extend({},t);t.useInfoChart=this._uiConfig.useInfoChart===true;this._chart=new T(this._layout,t);this._chart.addEventListener(n.VIZ_DEFINITION_CHANGED,this._vizDefinitionChanged,this);this._chart.addEventListener(L.SELECT_PROPERTY_ZONE,e.proxy(function(e){this._dispatchEvent(new L(L.SELECT_PROPERTY_ZONE,this,e.data))},this));this._chart.addEventListener(L.VIZ_VIEW_CHANGED,this._vizViewChanged,this);this._chart.addEventListener(L.CHART_CHANGED,this._chartChangedHandler,this);this._validateSize();this.__vizModel=this._chart.chartModel();this.__vizModel.addEventListener(V.PropertiesChangedEvent,this._onVizModelChanged,this)};G.prototype._chartChangedHandler=function(){if(this._titleEditor){this._titleEditor.init()}};G.prototype.popupLayer=function(){return this._popupLayout};G.prototype._createPopupLayer=function(){this._popupLayout=document.createElement("div");this._popupLayout.id="popupLayout";e(this._div).append(this._popupLayout)};G.prototype._createHeader=function(){if(!this._header$){this._header$=e(document.createElement("div")).appendTo(this._div);this._header$.addClass(i.FRAME_PREFIX+"header")}};G.prototype._createFullScreenButton=function(){var t=Y.instance();if(this._uiConfig.controls&&this._uiConfig.controls.fullScreenButton){t=this._uiConfig.controls.fullScreenButton}this._fullScreenBtn=new z(this._header$,t);this._fullScreenBtn.setIcon([i.COMMON_PREFIX+"UVBSharedSprite",i.FRAME_PREFIX+"header-fullscreen-enter-icon"].join(" "));this._fullScreenBtn.setTitle(_.get("VIZ_CUSTOMBUTTON_MAXIMIZE"));this._fullScreenBtn.addEventListener(O.CLICK_CUSTOM_BUTTON,e.proxy(function(e){this._isFullScreen=!this._isFullScreen;if(this._isFullScreen){this._fullScreenBtn.setIcon([i.COMMON_PREFIX+"UVBSharedSprite",i.FRAME_PREFIX+"header-fullscreen-exit-icon"].join(" "));this._fullScreenBtn.setTitle(_.get("VIZ_CUSTOMBUTTON_RESTORE_DOWN"));this._dispatchEvent(new f(f.ENTER_FULL_SCREEN,this,this._isFullScreen))}else{this._fullScreenBtn.setIcon([i.COMMON_PREFIX+"UVBSharedSprite",i.FRAME_PREFIX+"header-fullscreen-enter-icon"].join(" "));this._fullScreenBtn.setTitle(_.get("VIZ_CUSTOMBUTTON_MAXIMIZE"));this._dispatchEvent(new f(f.EXIT_FULL_SCREEN,this,this._isFullScreen))}},this),this)};G.prototype._createSettingButton=function(){var t=Y.instance();if(this._uiConfig.controls&&this._uiConfig.controls.settingButton){t=this._uiConfig.controls.settingButton}this._settingBtn=new z(this._header$,t);this._settingBtn.setIcon([i.COMMON_PREFIX+"UVBSharedSprite",i.FRAME_PREFIX+"header-setting-icon"].join(" "));this._settingBtn.setTitle(_.get("VIZ_CUSTOMBUTTON_SETTINGS"));this._settingBtn.addEventListener(O.CLICK_CUSTOM_BUTTON,e.proxy(function(t){var i=34;var r={pageX:e(this._div).width(),pageY:i};this._contextMenu.show(r,null)},this),this)};G.prototype._createFilterBar=function(){this._filterBarContainer$=e(document.createElement("div")).appendTo(this._header$);this._filterBarContainer$.addClass(i.FRAME_PREFIX+"header-filterbar-container");var t=B.instance();if(this._uiConfig.controls&&this._uiConfig.controls.filterBar){t=this._uiConfig.controls.filterBar}this._filterBar=new b(this._filterBarContainer$,t);this._filterBar.addEventListener(S.HEIGHT_CHANGED,function(e){if(!this._header$){return this}this._header$.css({height:e.data.height});this._validateSize(true)},this)};G.prototype._createContextMenu=function(){var t=$.instance();if(this._uiConfig.controls&&this._uiConfig.controls.contextMenu){t=this._uiConfig.controls.contextMenu}this._contextMenu=new A(e(this._popupLayout),t);e(this._layout).bind("contextmenu",e.proxy(function(t){var i=h.getEventPosition(t);var r={pageX:i.pageX-e(this._div).offset().left,pageY:i.pageY-e(this._div).offset().top};var n=e(this._layout).offset();var s=this._chart.getZoneName({x:i.pageX-n.left,y:i.pageY-n.top});this._contextMenu.show(r,s);return false},this))};G.prototype._createFilterMenu=function(){this._filterMenu=new x(e(this._popupLayout),this._uiConfig);this._filterMenu.addEventListener(D.FILTER_CLICKED,function(e){this._filterMenu.hide();this._addFilter(false)},this);this._filterMenu.addEventListener(D.EXCLUDE_CLICKED,function(e){this._filterMenu.hide();this._addFilter(true)},this);this._chart.addEventListener(L.CHANGED_SELECTED_DATA,function(e){var t=this.vizSelection();var i=t?t.length:0;var r=i>0;var n=i>0;this._filterMenu.show(r,n)},this);this.vizOn("initialized.filterMenu",e.proxy(function(e){if(this._filterMenu){var t=this.vizSelection();var i=t?t.length:0;if(i>0){this._filterMenu.show(true,true)}else{this._filterMenu.hide()}}},this))};G.prototype._createPlayControl=function(){var t=document.createElement("div");this._playControlContainer$=e(t);e(t).css({position:"relative"});e(this._div).append(t);this._playControl=new N(e(t));this._validateSize();this._playControl.addEventListener(w.SLICE_DIMENSION_CHANGED,e.proxy(function(e){var t=this._playControl.sliceDimension();this._playControl.visible(!!t);this._validateSize();this._dispatchPropertyEvent(new f(f.SLICE_DIMENSION_CHANGED,this,t))},this));this.vizOn("initialized.playControl",e.proxy(function(e){this._validatePlayControlSize()},this));this._playControl.connect(this.vizUid())};G.prototype._validatePlayControlSize=function(){var t=this.vizFeedingZone();var i;for(var r=0;r<t.length;r++){var n=t[r];if(n.name==="plot"){i=n.bound[0];break}}if(i&&i.length>0){var s=i[1][0]-i[0][0];var o=i[0][0];e(this._playControlContainer$).css({width:s,left:o});this._playControl.validateSize(s)}};G.prototype._addFilter=function(e){if(this._filterBar){var t=this.vizSelection({withDataCtx:true});this._vizModel().updateFilterItems(t,e,this.vizData(),this._chart.feeding())}else{var i={isExclude:e,feeding:this._chart.feeding()};this._dispatchEvent(new f(f.ADD_FILTER,this,i))}};G.prototype._createTitleEditor=function(){this._titleEditorContainer$=e(this._layout).find("."+i.CHART_PREFIX+"holder");e(this._titleEditorContainer$).css({position:"absolute",width:"100%"});this._titleEditor=new M(this._titleEditorContainer$);this.vizOn("initialized.titleEditor",e.proxy(function(e){if(this._titleEditor){this._titleEditor.init()}},this))};G.prototype._createAnnotation=function(){var t=k.instance();if(this._uiConfig.controls&&this._uiConfig.controls.annotation){t=this._uiConfig.controls.annotation}this._annotation=new m(this._div,t);this._annotation.popupLayer(this._popupLayout);if(this._contextMenu){var i=new R(e.proxy(this._vizModel,this),this._chart.__vizProxy);i.clickHandler(e.proxy(function(){this._dispatchEvent(new f(f.ADD_COMMENT,this))},this));this._contextMenu.addMenuItem(i)}this.addEventListener(L.CHART_CHANGED,e.proxy(function(e){if(this._annotation){this._annotation.setChartInfo({vizType:this._chart.vizType(),vizData:this._chart.vizData()});var t=this._chart.size();this._annotation.validateSize(t.width,t.height)}},this));this.addEventListener(L.CHART_CHANGING,e.proxy(function(e){if(this._annotation){this._annotation.clean()}},this));this.addEventListener(o.FEEDS_CHANGED,e.proxy(function(e){if(this._annotation){this._annotation.feedsChanged()}},this));this.addEventListener(f.ADD_COMMENT,e.proxy(function(e){if(this._annotation){this._annotation.addComment(this.vizSelection({withDataCtx:true}))}},this));this.vizOn("initialized.annotation",e.proxy(function(e){if(this._annotation){this._annotation.redraw()}},this))};G.prototype._createAnnotationControl=function(){var t=null;if(this._uiConfig.controls&&this._uiConfig.controls.annotationControl){t=this._uiConfig.controls.annotationControl}else{t=y.instance()}var i=e(document.createElement("div")).insertBefore(this._popupLayout);this._annotationControl=new E(i[0],t);if(this._contextMenu){var r=new R(e.proxy(this._vizModel,this),this._chart.__vizProxy);r.clickHandler(e.proxy(function(){var e=this.vizSelection({withDataCtx:true});this._dispatchEvent(new f(f.ADD_COMMENT,this,{context:e[0]}))},this));this._contextMenu.addMenuItem(r)}};G.prototype._createChildren=function(){var e=this._uiConfig.enableFilterBar===false?false:true;var t=this._uiConfig.enableFullScreenButton===false?false:true;var i=this._uiConfig.enableSettingButton===false?false:true;if(e||t||i){this._createHeader()}if(e){this._createFilterBar()}if(t){this._createFullScreenButton()}if(i){this._createSettingButton()}this._createChart();this._createPopupLayer();var r=this._uiConfig.enableContextMenu===false?false:true;if(r){this._createContextMenu()}var n=this._uiConfig.enableAnnotation===false?false:true;if(n){this._createAnnotation()}if(this._uiConfig.enableAnnotationControl===true){this._createAnnotationControl()}var s=this._uiConfig.enableFilterMenu===false?false:true;if(s){this._createFilterMenu()}var o=this._uiConfig.enableTitleEditor===false?false:true;if(o){this._createTitleEditor()}if(this._filterBar){this._filterBar.connect(this.vizUid())}if(this._contextMenu){this._contextMenu.connect(this.vizUid())}if(this._titleEditor){this._titleEditor.connect(this.vizUid())}if(this._annotation){this._annotation.connect(this.vizUid())}if(this._annotationControl){this._annotationControl.connect(this.vizUid())}};G.prototype._validateSize=function(t){var i=e(this._div).width();var r=e(this._div).height();if(this._header$&&this._header$.css("display")!="none"&&!isNaN(this._header$.outerHeight())){if(this._filterBar&&!(t===true)){this._filterBar.validateSize()}r-=this._header$.outerHeight()}if(this._playControl&&this._playControlContainer$.css("visibility")==="visible"&&!isNaN(this._playControlContainer$.outerHeight())){r-=this._playControlContainer$.outerHeight()}e(this._layout).css({width:i+"px",height:r+"px",visibility:"visible",display:""});if(this._chart){this._chart.size({width:i,height:r})}if(this._annotation){this._annotation.validateSize(i,r)}if(this._chartEditorPlugin){this._chartEditorPlugin.validateSize(i,r)}if(this._filterMenu){this._filterMenu.size({width:i})}if(this._playControl){this._validatePlayControlSize()}if(this._titleEditor){this._titleEditor.size()}};G.prototype._chartControl=function(){return this._chart};G.prototype.connect=function(e){};G.prototype.disconnect=function(){};G.prototype.destroy=function(){if(this._contextMenu){this._contextMenu.removeAllEventListeners();this._contextMenu.destroy();this._contextMenu=null}if(this._filterMenu){this._filterMenu.removeAllEventListeners();this._filterMenu.destroy();this._filterMenu=null}if(this._chartEditorPlugin){this._chartEditorPlugin.destroy();this._chartEditorPlugin=null}if(this._annotation){this._annotation.destroy();this._annotation=null}if(this._playControl){this._playControl.destroy();this._playControl=null}G.superclass.destroy.apply(this,arguments);this._chart=null;this._filterBar=null};G.prototype.vizUid=function(){return this._chart.vizUid()};G.prototype.vizData=function(e){return this._chart.vizData.apply(this._chart,arguments)};G.prototype.vizCss=function(e){return this._chart.vizCss.apply(this._chart,arguments)};G.prototype.vizProperties=function(e){return this._chart.vizProperties.apply(this._chart,arguments)};G.prototype.vizDescription=function(){return this._chart.vizDescription.apply(this._chart,arguments)};G.prototype.vizUpdate=function(e){if(!e){return}this._beginUpdateProperty();try{if(e.filters&&this._filterBar){var t=e.filters.value?e.filters.value:e.filters;this._filterBar.filterItems(t)}var i=this._chart.vizUpdate.apply(this._chart,arguments)}catch(e){this._endUpdateProperty();throw e}this._endUpdateProperty();return i};G.prototype.vizOn=function(e,t){this._chart.vizOn.apply(this._chart,arguments);return this};G.prototype.vizOff=function(e){this._chart.vizOff.apply(this._chart,arguments);return this};G.prototype.vizAction=function(e,t){this._chart.vizAction.apply(this._chart,arguments);return this};G.prototype.vizSelection=function(e,t){return this._chart.vizSelection.apply(this._chart,arguments)};G.prototype.vizFeedingZone=function(){return this._chart.vizFeedingZone.apply(this._chart,arguments)};G.prototype.vizTitle=function(e){return this._chart.vizTitle.apply(this._chart,arguments)};G.prototype.createViz=function(e){if(arguments.length>0){this._chart.createViz(e);return this}};G.prototype.changeTemplate=function(){return this._chart.changeTemplate.apply(this._chart)};G.prototype.exportViz=function(e){return this._chart.exportViz(e)};G.prototype.loadViz=function(e){this._chart.loadViz(e)};G.prototype.save=function(e){var t={};t["version"]=H.VERSION;t["chart"]=this._chart.save(e);if(this._filterBar){t["filterBar"]=this._filterBar.save()}if(this._contextMenu){t["contextMenu"]=this._contextMenu.save()}if(this._annotation){t["annotation"]=this._annotation.save()}if(this._titleEditor){t["titleEditor"]=this._titleEditor.save()}if(this._playControl){t["playControl"]=this._playControl.save(e)}return t};G.prototype.load=function(e){this._beginUpdateProperty();var t=X.migrateVizFrame(e);this._vizModel().playerField(null);var i=t["version"];i=t["filterBar"];if(i&&this._filterBar){this._filterBar.load(i)}i=t["contextMenu"];if(i&&this._contextMenu){this._contextMenu.load(i)}i=t["chart"];if(i){this._chart.load(i)}i=t["annotation"];if(i&&this._annotation){this._annotation.load(i)}i=t["titleEditor"];if(i&&this._titleEditor){this._titleEditor.load(i)}i=t["playControl"];if(i){if(!this._playControl){var r=this._uiConfig.enablePlayControl===false?false:true;if(r){this._createPlayControl()}}if(this._playControl){this._playControl.load(i)}}this._endUpdateProperty()};G.prototype.feeds=function(e){return this._chart.feeds.apply(this._chart,arguments)};G.prototype.getDefaultIncompleteOptions=function(e){return this._chart.getDefaultIncompleteOptions.apply(this._chart,arguments)};G.prototype.showMessage=function(e){if(arguments.length==1){this._chart.showMessage(e)}};G.prototype.setTitleGeneratorFunc=function(e){this._chart.setTitleGeneratorFunc(e)};G.prototype.vizTitleMode=function(e){if(arguments.length>0){this._chart.vizTitleMode(e)}else{return this._chart.vizTitleMode()}};G.prototype.annotationControl=function(){return this._annotationControl};G.prototype.chart=function(){return this._chart};G.prototype.filterBar=function(){return this._filterBar};G.prototype.contextMenu=function(){return this._contextMenu};G.prototype.titleEditor=function(){return this._titleEditor};G.prototype.playControl=function(){return this._playControl};G.prototype.exportToSVGString=function(e){return this._chart.exportToSVGString(e)};G.prototype.supportExportToSVG=function(){var e=false;if(this.vizType()){e=c.isBuildInType(this.vizType())||e}return e};G.prototype.selectedPropertyZone=function(e){return this._chart.selectedPropertyZone.apply(this._chart,arguments)};return G});e("sap/viz/controls/filterbar/FilterBarConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(){return{maxLines:2,enableDrop:true,showInformationIcon:false,showClearIcon:false,addButtonVisible:true,informationIconTooltip:""}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_FILTERBAR,t);return t});e("sap/viz/controls/filterbar/FilterBarEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBarEvent"};e.extend(i,t);i.REQUEST_ADD_FILTER="requestAddFilter";i.REQUEST_REMOVE_FILTER="requestRemoveFilter";i.REQUEST_EDIT_FILTER="requestEditFilter";i.SIZE_CHANGED="sizeChanged";i.CLEAR_FILTERS="clearFilters";return i});e("sap/viz/controls/filterbar/FilterItem",["sap/viz/controls/common/utils/Utils"],function(e){var t=function(t,i,r,n,s,o,a,l){this.__className="sap.viz.controls.filterbar.FilterItem";this._id=t;this._displayName=i;this._displayValue=r;this._customData=n;this._cssClass=s;this._valueCssClass=o;this._disableRemoval=e.isBoolean(a)?a:false;this._valueCount=e.isNumber(l)?l:0};e.genGetterSetters(t.prototype,["_id","_displayName","_valueCount","_disableRemoval","_cssClass","_customData","_valueCssClass","_displayValue"]);return t});e("sap/viz/controls/filterbar/FilterRenderer",["jquery","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/filterbar/FilterBarEvent"],function(e,t,i,r,n,s){var o=function(t,i,r,n){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterRenderer";this._filterItem=t;this._showInformationIcon=r;this._informationIconTooltip=n;this._div$=e(i);this._draw()};t.extend(o,i);o.prototype.filterItem=function(e){if(arguments.length>0){this._filterItem=e;this._reset();this._draw()}else{return this._filterItem}};o.prototype.destroy=function(){this._div$.empty()};o.prototype._draw=function(){var t=this._filterItem;var i=this;this._createFilterTitle(t,this._div$);this._addFilterValues(t,this._div$);this._div$.attr({id:t.id()});this._div$.mouseover(function(t){e("."+r.FILTERBAR_PREFIX+"filter-values",t.currentTarget).addClass(r.FILTERBAR_PREFIX+"filter-values-active")});this._div$.mouseout(function(t){e("."+r.FILTERBAR_PREFIX+"filter-values",t.currentTarget).removeClass(r.FILTERBAR_PREFIX+"filter-values-active")});if(t.cssClass()){this._div$.addClass(t.cssClass())}this._div$.addClass(r.FILTERBAR_PREFIX+"filter-item");if(t.disableRemoval()){this._div$.addClass(r.FILTERBAR_PREFIX+"filter-item-readonly");if(this._showInformationIcon){var o=e(document.createElement("div")).appendTo(this._div$);o.attr("title",this._informationIconTooltip||n.get("VIZ_FILTERBAR_READONLY_FILTER"));o.addClass(r.COMMON_PREFIX+"havanaVXTabSprite16");o.addClass(r.FILTERBAR_PREFIX+"info-icon")}}else{this._div$.click(function(){i._dispatchEvent(new s(s.REQUEST_EDIT_FILTER,i,{filterItem:i._filterItem}))});var a=e(document.createElement("div")).appendTo(this._div$);a.addClass(r.FILTERBAR_PREFIX+"delete-icon");a.addClass(r.COMMON_PREFIX+"UVBSharedSprite");a.click(function(e){i._dispatchEvent(new s(s.REQUEST_REMOVE_FILTER,i,{filterItem:i._filterItem}));e.stopPropagation()})}};o.prototype._createFilterTitle=function(t,i){if(t.valueCount()<=0){var n=e(document.createElement("span")).appendTo(i).text(t.displayName()).attr("title",t.displayName());n.addClass(r.FILTERBAR_PREFIX+"filter-item-text");n.addClass(r.FILTERBAR_PREFIX+"range-filter-item-text");return}var s=e(document.createElement("div")).appendTo(i);var o=e(document.createElement("div")).appendTo(s).text(t.displayName()).attr("title",t.displayName()).css("display","inline");o.addClass(r.FILTERBAR_PREFIX+"filter-item-text").attr("id","filterName");var a=e(document.createElement("div")).appendTo(s).css("display","inline").attr("id","countInfo");a.addClass(r.FILTERBAR_PREFIX+"filter-item-info");e(document.createElement("span")).appendTo(a).text("(");var l=e(document.createElement("span")).appendTo(a).text(t.valueCount());if(t.valueCssClass()){l.addClass(t.valueCssClass())}e(document.createElement("span")).appendTo(a).text(")")};o.prototype._addFilterValues=function(t,i){var n=i.find("span[id='values']");if(n.length===0){n=e(document.createElement("span")).appendTo(i);n.addClass(r.FILTERBAR_PREFIX+"filter-values");n.attr({id:"values"})}var s=t.displayValue();n.text(s).attr("title",s);if(t.valueCssClass()){n.addClass(t.valueCssClass())}};return o});e("sap/viz/controls/filterbar/FilterBar",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/EventTypeConst","sap/viz/controls/common/events/Event","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/UIControl","sap/viz/controls/common/views/drag/DropAction","sap/viz/controls/common/views/feed/FeedList","sap/viz/controls/common/views/feed/FeedListEvent","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/FeedItemType","sap/viz/controls/common/helpers/Rectangle","sap/viz/controls/filterbar/FilterBarConfig","sap/viz/controls/filterbar/FilterBarEvent","sap/viz/controls/filterbar/FilterItem","sap/viz/controls/filterbar/FilterRenderer"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y){var I=function(e,t){I.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.filterbar.FilterBar";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_filterbar_control");this._div=e;this._uiConfig=t?t:m.instance();this._filterItems=[];this._renderers=[];this._allAnalyses=null;this._settings=null;this._visualLines=1;if(l.isNumber(this._uiConfig.maxLines)&&this._uiConfig.maxLines>1){this._visualLines=this._uiConfig.maxLines}this._description$=null;this._layout$=null;this._headerVisible=false;this._isFullScreen=false;this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_filterbar_control")};var C=.8;var T=40;var A=180;a.extend(I,t);I.TYPE_STRING="string";I.TYPE_INTEGER="integer";I.TYPE_NUMBER="number";I.TYPE_DATE="date";var P=16;I.prototype.filterItems=function(e){if(arguments.length>0){this._filterItems=e;this._filtersChanged();return this}else{return this._filterItems}};I.prototype._createChildren=function(){var t=this;var r=this._uiConfig;if(!r||r.addButtonVisible!==false){this._headerVisible=true;this._plus$=e(document.createElement("div")).appendTo(this._div);this._plus$.addClass(i.COMMON_PREFIX+"havanaVXTabSprite16");this._plus$.addClass(i.FILTERBAR_PREFIX+"header-plus");this._plus$.click(function(e){t._plusClickHandler(e)});var n=r.label?r.label:o.get("VIZ_FILTERBAR_ADD_FILTERS");this._description$=e(document.createElement("span")).text(n).appendTo(this._div);this._description$.addClass(i.FILTERBAR_PREFIX+"description")}var a=0;if(r&&r.showClearIcon){this._clearIcon$=e(document.createElement("div"));this._clearIcon$.addClass(i.COMMON_PREFIX+"havanaVXTabSprite16");this._clearIcon$.addClass(i.FILTERBAR_PREFIX+"clear-disabled");this._clearIcon$.attr({title:o.get("VIZ_FILTERBAR_CLEAR_FILTERS")});this._clearIcon$.appendTo(this._div);a=24}this._layout$=e(document.createElement("div")).appendTo(this._div);this._layout$.addClass(i.FILTERBAR_PREFIX+"layout");this._layout$.addClass(i.COMMON_PREFIX+"scrollable");this._layout$.addClass(i.COMMON_PREFIX+"scrollable-y");this._layout$.css({"max-height":this._visualLines*T,right:a});this._filterItemsContainer$=e(document.createElement("div")).appendTo(this._layout$);this._filterItemsContainer$.addClass(i.FILTERBAR_PREFIX+"filterItems-container");if(this._headerVisible===true){this._layout$.hide()}else{this._layout$.css({left:"0px"})}if(!r||r.enableDrop!==false){e(this._div).droppable({tolerance:"pointer",accept:"."+s.DRAGGABLE_CLASS_ANALYSIS,over:e.proxy(this._dragOver,this),out:e.proxy(this._dragOut,this),drop:e.proxy(this._drop,this)})}};I.prototype.analysisObjectsForPicker=function(e){if(arguments.length>0){if(e!=null&&!c.isArrayOfAnalysisObject(e)){return}this._allAnalyses=e}else{return this._allAnalyses}};I.prototype._plusClickHandler=function(e){var t=document.createElement("div");var i=this._filterItems;if(this._filterItemsFilter){i=this._filterItemsFilter(this._filterItems)}var r=new d(t,this._allAnalyses,v.DIMENSION,i);r.addEventListener(u.ITEM_SELECTED,function(e){var t=e.data.selectedItem;if(t){this._addFilterItem(t)}},this);var n=this._plus$.offset();r.open({x:n.left,y:n.top,shelfWidth:this._plus$.width()})};I.prototype.setfilterItemsFilter=function(e){this._filterItemsFilter=e};I.prototype._isExist=function(e){var t=e.id();if(e.type()===_.HIERARCHY){t=e.selectedHierarchyLevel().analysis().id()}for(var i=0;i<this._filterItems.length;++i){if(this._filterItems[i].id()===t){return true}}return false};I.prototype._getDroppableAnalysisObject=function(e){if(!e||!e.analysisObject){return null}var t=e.analysisObject;var i=t.type();if(_.compatible(_.DIMENSION,i)&&i!==_.MND&&!this._isExist(t)&&!t.aggregationType()){return t}else{return null}};I.prototype._dragOver=function(e,t){var i=s.instance().getAnalysisToken(t.helper);if(!i){return}var r=this._getDroppableAnalysisObject(i);if(r){i.currentAction(h.ACCEPT_AS_COPY)}else{i.currentAction(h.DENY)}};I.prototype._dragOut=function(e,t){var i=s.instance().getAnalysisToken(t.helper);if(i){i.currentAction(h.DENY)}};I.prototype._drop=function(e,t){var i=s.instance().getAnalysisToken(t.helper);if(!i){return}var r=this._getDroppableAnalysisObject(i);if(r){i.currentAction(h.ACCEPT_AS_COPY);this._addFilterItem(r)}else{i.currentAction(h.DENY)}i.dropTarget(this._dom)};I.prototype._addFilterItem=function(e){this._dispatchEvent(new g(g.REQUEST_ADD_FILTER,this,{analysisObject:e}))};I.prototype._updateClearIcon=function(){if(!this._clearIcon$){return}var e=this._filterItems;var t=false;if(e){for(var r=0;r<e.length;r++){if(!e[r].disableRemoval()){t=true;break}}}var n=this;this._clearIcon$.unbind("click");if(t){this._clearIcon$.addClass(i.FILTERBAR_PREFIX+"clear");this._clearIcon$.removeClass(i.FILTERBAR_PREFIX+"clear-disabled");this._clearIcon$.click(function(e){n._dispatchEvent(new g(g.CLEAR_FILTERS,n,null))})}else{this._clearIcon$.addClass(i.FILTERBAR_PREFIX+"clear-disabled");this._clearIcon$.removeClass(i.FILTERBAR_PREFIX+"clear")}};I.prototype._filtersChanged=function(){if(this._filterItemsContainer$){this._filterItemsContainer$.empty()}this._updateClearIcon();var e=this._filterItems;if(!e||e.length==0){this._updateDescription();this._updateFilterItemContainer();return this}if(this._headerVisible===true){this._description$.hide();this._layout$.show()}this._updateFilterItemContainer()};I.prototype._stringToNumber=function(e){if(!e){return 0}return parseInt(e.replace("px",""))};I.prototype._validateSize=function(){var t=e("."+i.FILTERBAR_PREFIX+"filter-item");if(t.length==0){return this}t.css({width:A});this._updateFilterItemsWidth()};I.prototype._needAdjust=function(){var e=this._filterItemsContainer$.innerHeight();var t=e>T;if(t){return true}else{return false}};I.prototype._updateFilterItemContainer=function(){var t=this._filterItems;var i;for(i=0;i<this._renderers.length;i++){this._renderers[i].destroy()}for(i=0;i<t.length;i++){var r=e(document.createElement("div")).appendTo(this._filterItemsContainer$);this._renderers[i]=new y(t[i],r,this._uiConfig.showInformationIcon,this._uiConfig.informationIconTooltip);this._renderers[i].addEventListener(g.REQUEST_REMOVE_FILTER,this._dispatchFilterEvent,this);this._renderers[i].addEventListener(g.REQUEST_EDIT_FILTER,this._dispatchFilterEvent,this)}this._updateFilterItemsWidth();return this};I.prototype._dispatchFilterEvent=function(e){this._dispatchEvent(e)};I.prototype._updateFiltersTitle=function(){var t=function(t,i){var r=e("#filterName",i);if(r.length===0){return}r.css({width:"auto"});var n=r.parent();var s=e("#countInfo",i);var o=r.position();var a=r.width()+o.left+2;var l=n.width()-P;var c=s.width();var p=Math.min(a,l-c);r.css({width:p-o.left});s.css({left:p})};e("."+i.FILTERBAR_PREFIX+"filter-item",this._div).each(t);e("."+i.FILTERBAR_PREFIX+"global-filter-item",this._div).each(t)};I.prototype._updateFilterItemsWidth=function(){var t;if(this._filterItemsContainer$.children().length===0){this._updateDescription();var i=this._filterItemsContainer$.innerHeight();if(i!==T){t={height:T};this._dispatchEvent(new g(g.SIZE_CHANGED,this,t))}return this}if(!this._needAdjust()){t={height:T};this._dispatchEvent(new g(g.SIZE_CHANGED,this,t));this._updateFiltersTitle();return this}var r=0;var n=A;var s=this._filterItemsContainer$.children();while(this._needAdjust()&&r<2){r++;n=n*C;s.css({width:n})}if(this._needAdjust()){t={height:this._avaliableHeightForHeader()};this._dispatchEvent(new g(g.SIZE_CHANGED,this,t));if(t.height<this._filterItemsContainer$.outerHeight()){e(this._layout$).scrollTop(this._filterItemsContainer$.outerHeight())}}if(!this._needAdjust()){t={height:T};this._dispatchEvent(new g(g.SIZE_CHANGED,this,t))}this._updateFiltersTitle();return this};I.prototype._avaliableHeightForHeader=function(){var e=this._filterItemsContainer$.outerHeight();var t=T-2;var i=T;var r=this._visualLines-1;for(var n=2;n<=this._visualLines;n++){if(t*n<=e&&e<=i*n){r=n-1;break}}var s=2;return r*t+i+s};I.prototype._updateDescription=function(){var e=this._vizModel().filterItems();if(e.length===0&&this._headerVisible===true){this._description$.show();this._layout$.hide()}};return I});e("sap/viz/controls/propertyeditor/PropertyEditorConfig",["sap/viz/controls/common/config/GlobalConfig"],function(e){var t={};t.instance=function(e){return{icons:[{id:"bus",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 309 293" enable-background="new 0 0 309 293" xml:space="preserve">'+'<path d="M195.781,200.678v5.801h72.909V5.316H42.312v201.163h72.899v-5.801H195.781z M221.002,176.428'+"c-11.501,0-20.826-9.325-20.826-20.809c0-11.518,9.325-20.826,20.826-20.826s20.834,9.309,20.834,20.826"+"C241.836,167.103,232.503,176.428,221.002,176.428z M159.738,27.415h95.483v57.129h-95.483V27.415z M55.785,27.415h95.475"+"v57.129H55.785V27.415z M92.741,174.805c-11.518,0-20.83-9.326-20.83-20.827s9.312-20.817,20.83-20.817"+'c11.476,0,20.81,9.316,20.81,20.817S104.217,174.805,92.741,174.805z"/>'+'<polygon points="195.781,218.038 195.781,225.137 115.212,225.137 115.212,218.038 29.091,218.038'+'29.091,243.811 281.89,243.811 281.89,218.038"/>'+'<rect x="115.212" y="206.479" width="80.569" height="11.56"/>'+'<rect x="42.312" y="243.811" width="36.434" height="33.843"/>'+'<rect x="232.244" y="243.811" width="36.446" height="33.843"/>'+'<rect x="274.7" y="55.975" width="30.301" height="56.292"/>'+'<rect x="5.001" y="55.975" width="30.297" height="56.292"/></svg>'},{id:"plane",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 424.876 469.719" enable-background="new 0 0 424.876 469.719" xml:space="preserve">'+'<path d="M211.131,4.251c6.051-0.543,12.363,5.176,19.721,25.602c7.393,20.47,7.188,41.583,7.193,42.477v70.454'+"l36.368,33.614l0.03-5.229c0.03-3.354,1.335-7.684,3.661-10.167c0.616-0.656,1.469-0.897,2.385-0.9h14.942"+"c0.9,0.001,1.771,0.234,2.376,0.9c2.287,2.519,3.55,6.806,3.512,10.167v28.655l30.799,27.212l0.027-2.894"+"c0.012-3.364,1.316-6.443,3.651-8.926c0.622-0.658,1.479-1.065,2.376-1.06h14.954c0.886,0.006,1.763,0.398,2.358,1.06"+"c2.305,2.513,3.367,5.757,3.347,9.113v26.129l61.135,51.113c0.694,0.614,0.915,1.506,0.909,2.445v25.433"+"c-0.012,1.152-0.625,2.225-1.64,2.775c-1.009,0.568-2.245,0.568-3.245-0.024l-122.26-70.578l-55.687-17.585v104.766"+"c-0.117,15.592-2.816,25.786-2.931,26.218l-4.263,15.474l58.095,53.767c0.635,0.613,1.291,1.454,1.281,2.355v15.894"+"c-0.009,0.993-0.47,1.939-1.281,2.544c-0.793,0.61-1.816,0.805-2.783,0.557l-67.872-17.462l-0.876,4.971"+"c-0.165,0.844-0.656,1.672-1.275,1.994c-0.773,0.402-1.4,0.635-2.25,0.432l-2.759-0.504l-2.81,0.504"+"c-0.86,0.194-1.442,0.059-2.163-0.432c-0.721-0.482-1.233-1.147-1.401-1.994l-0.801-4.971l-67.659,17.462"+"c-0.979,0.258-1.997,0.051-2.805-0.557c-0.775-0.626-1.22-1.541-1.218-2.544v-15.894c0.003-0.91,0.564-1.739,1.218-2.355"+"l58.184-53.767l-4.077-15.474c-0.064-0.258-2.64-10.63-2.516-26.218V244.037l-57.453,17.585L7.249,332.2"+"c-1.01,0.587-2.236,0.614-3.245,0.024c-0.994-0.565-1.607-1.614-1.595-2.775v-25.433c0.014-0.949,0.607-1.828,1.307-2.445"+"l58.987-51.113v-28.236c0.024-3.369,1.505-4.519,3.834-7.005c0.618-0.654,1.476-1.068,2.384-1.06H83.87"+"c0.915,0.008,1.76,0.382,2.374,1.06c2.279,2.505,3.527,3.822,3.499,7.206l-0.015,4.614l31.402-27.212l0.207-28.655"+"c0.014-3.354,1.308-7.661,3.64-10.167c0.618-0.643,1.489-0.911,2.376-0.9h14.958c0.901,0.009,1.76,0.237,2.363,0.9"+"c2.302,2.516,3.544,6.808,3.513,10.167l-0.033,5.229l36.929-33.614V71.981c0,0-1.081-22.023,6.593-42.388"+'C199.329,9.287,205.091,3.617,211.131,4.251z"/></svg>'}],enableTitle:false}};e.registerUIConfig(e.DEFAULT_UICONFIG_TYPE_PROPERTYEDITOR,t);return t});e("sap/viz/controls/propertyeditor/helpers/CSSHelper",["jquery"],function(e){var t={};t.FontCSSProperties=["font-family","font-size","font-weight","fill","font-style"];t.FontProperties=["fontFamily","fontSize","fontWeight","fontColor","fontStyle"];t.cssTofont=function(e){var i={};for(var r=0;r<t.FontCSSProperties.length;++r){i[t.FontProperties[r]]=e[t.FontCSSProperties[r]]}return i};t.fontToCss=function(e){var i="{";for(var r=0;r<t.FontCSSProperties.length;++r){if(e.hasOwnProperty(t.FontProperties[r])){i+=t.FontCSSProperties[r]+":"+e[t.FontProperties[r]]+";"}}i+="}";return i};return t});e("sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper",["sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/propertyeditor/helpers/CSSHelper"],function(e,t,i){var r={};r.Type_Boolean="boolean";r.Type_Font="font";r.Type_Separator="separator";r.Text_Alignment="alignment";r.Text_Format="format";function n(e,t,n,s){var o={path:t,type:r.Type_Boolean,text:e,children:[{path:t,cssClass:n,cssProperties:i.FontCSSProperties,type:r.Type_Font}]};if(s){o.children.push({path:s,type:r.Text_Alignment})}return o}function s(e,t){return{path:t,text:e,type:r.Type_Separator}}function o(e,t,i,o){var a=e.toUpperCase();i=i||"PROPERTY_EDITOR_"+a;o=o||".v-m-root .v-m-main .v-m-"+e;t.push(s(i,e+".visible"));t.push({path:e+".visible",type:r.Type_Boolean,text:"PROPERTY_EDITOR_SHOW_AXIS",children:[n("PROPERTY_EDITOR_SHOW_AXIS_TITLE",e+".title.visible",o+" .v-title"),n("PROPERTY_EDITOR_SHOW_AXIS_LABEL",e+".label.visible",o+" .v-label")]})}function a(e,t){e.push(s("PROPERTY_EDITOR_GENERAL","title.visible"));e.push(n("PROPERTY_EDITOR_SHOW_CHART_TITLE","title.visible",[".v-m-root .v-m-title .v-title",".v-m-root .v-m-Title .v-title"]));e.push(n("PROPERTY_EDITOR_SHOW_LEGEND",["legend.visible","sizeLegend.visible"],[".v-m-root .v-m-legends .v-m-legend .v-label",".v-m-root .v-m-legends .v-m-sizeLegend .v-label",".v-m-root .v-m-ColorLegend .v-label"]));e.push(n("PROPERTY_EDITOR_SHOW_DATA_LABEL","dataLabel.visible",t))}var l=null;function c(){if(!l){l=[];a(l,".v-m-root .v-m-main .v-m-datalabel .v-datalabel");o("xAxis",l);o("xAxis2",l);o("yAxis",l);o("yAxis2",l);o("zAxis",l);o("plotArea.valueAxis",l,"PROPERTY_EDITOR_VALUE_AXIS",".v-m-root .v-m-main .v-m-plot");l.push(s("PROPERTY_EDITOR_POLAR_AXIS","plotArea.polarAxis.title.visible"));l.push(n("PROPERTY_EDITOR_SHOW_AXIS_TITLE","plotArea.polarAxis.title.visible",".v-m-root .v-m-main .v-m-plot .v-polar-axis-title"))}return l}var p=null;function h(){if(!p){p=[];a(p,".v-m-root .v-m-main .v-m-plot .v-m-datalabel .v-datalabel");o("rowAxis",p,"PROPERTY_EDITOR_ROW_AXIS",".v-m-root>.v-m-main>.v-m-yAxis");o("columnAxis",p,"PROPERTY_EDITOR_COLUMN_AXIS",".v-m-root>.v-m-main>.v-m-xAxis2");o("xAxis",p,null,".v-m-root .v-m-main .v-m-plot .v-m-xAxis");o("xAxis2",p,null,".v-m-root .v-m-main .v-m-plot .v-m-xAxis2");o("yAxis",p,null,".v-m-root .v-m-main .v-m-plot .v-m-yAxis");o("yAxis2",p,null,".v-m-root .v-m-main .v-m-plot .v-m-yAxis2");o("plotArea.valueAxis",p,"PROPERTY_EDITOR_VALUE_AXIS",".v-m-root .v-m-main .v-m-plot .v-m-plot");p.push(s("PROPERTY_EDITOR_POLAR_AXIS","plotArea.polarAxis.title.visible"));p.push(n("PROPERTY_EDITOR_SHOW_AXIS_TITLE","plotArea.polarAxis.title.visible",".v-m-root .v-m-main .v-m-plot .v-m-plot .v-polar-axis-title"))}return p}var d={};r.register=function(e,t){if(e&&t){d[e]=t}};r.getProperties=function(e){if(d.hasOwnProperty(e)){return d[e]()}else if(t.isMultipleChart(e)){return h()}else{return c()}};var u={};u[r.Type_Font]=i.fontToCss;r.toCSSValue=function(e,t){if(t==null){return t}if(u.hasOwnProperty(e)){return u[e](t)}else{return t}};var _={};_[r.Type_Font]=i.cssTofont;r.fromCSSValue=function(e,t){if(t==null){return t}if(_.hasOwnProperty(e)){return _[e](t)}else{return t}};var v=null;function f(){if(!v){v=[];v.push({path:"plotArea.valuePoint.label",text:"NUMBERCHART_VALUE_NAME",type:r.Type_Separator});v.push({path:"plotArea.valuePoint.label",type:r.Type_Font});v.push({path:"plotArea.valuePoint.label.formatString",type:r.Text_Format});v.push(s("NUMBERCHART_TITLE_NAME","title.visible"));var t=n("NUMBERCHART_SHOW_TITLE","title.visible",".v-m-root .v-m-title .v-title","title.alignment");t.children.push({path:"title.layout.position",text:"PROPERTY_EDITOR_TITLE_POSITION",type:"list",items:[{key:"top",value:e.get("PROPERTY_EDITOR_TITLE_POSITION_TOP")},{key:"bottom",value:e.get("PROPERTY_EDITOR_TITLE_POSITION_BOTTOM")}]});v.push(t)}return v}r.register("viz/number",f);return r});e("sap/viz/controls/propertyeditor/sections/PropertyViewFactory",[],function(){var e={};e.produce=function(e,t,i,r,n){return new e.viewClass(t,i,r,n)};return e});e("sap/viz/controls/propertyeditor/pickers/PickerEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.PickerEvent"};e.extend(i,t);i.PICKED_ITEM_CHANGED="pickedItemChanged";i.STATUS_CHANGED="statusChanged";return i});e("sap/viz/controls/propertyeditor/pickers/PickerBase",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this._pickedItem=t;this._config=i};e.extend(r,t);r.prototype.pickedItem=function(e){if(arguments.length>0){this._pickedItem=e;return this}else{return this._pickedItem}};r.prototype.visible=function(e){if(arguments.length>0){this._dom$.css("display",e?"":"none");this._onStatusChanged();return this}else{return this._dom$.css("display")!=="none"}};r.prototype._onStatusChanged=function(){this._dispatchEvent(new i(i.STATUS_CHANGED,this,{}))};r.prototype._changePickedItem=function(e,t){if(e!==undefined){this._pickedItem=e}this._dispatchEvent(new i(i.PICKED_ITEM_CHANGED,this,{pickedItem:this._pickedItem,changedItem:t}))};return r});e("sap/viz/controls/propertyeditor/pickers/SectionPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);r=this._config||{};this._sectionMap=null;this._combobox=new sap.ui.commons.DropdownBox({maxPopupItems:-1,change:$.proxy(function(e){this._changePickedItem(this._sectionMap[e.oSource.getSelectedKey()])},this)});this._combobox.placeAt(e);this.sections(r.sections)};e.extend(i,t);i.prototype.sections=function(e){this._sections=e||[];this._commitSections();return this};i.prototype._commitSections=function(){this._combobox.removeAllItems();this._sectionMap={};var e=0;this._sections.forEach($.proxy(function(t){if(e!==t.groupIndex){e=t.groupIndex;var i=new sap.ui.core.ListItem({enabled:false,text:"------"});i.setTooltip(new sap.ui.core.TooltipBase({text:""}));this._combobox.addItem(i)}this._sectionMap[t.id]=t;this._combobox.addItem(new sap.ui.core.ListItem({key:t.id,text:t.caption}))},this))};i.prototype.pickedItem=function(e){i.superclass.pickedItem.apply(this,arguments);this._combobox.setSelectedKey(this._pickedItem.id)};return i});e("sap/viz/controls/propertyeditor/events/PropertyEditorEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyEditor.PropertyEditorEvent"};e.extend(i,t);i.RECENTCOLORS_CHANGED="recentColorsChanged";return i});e("sap/viz/controls/propertyeditor/pickers/ColorButton",[],function(){var e=function(){jQuery.sap.declare("sap.viz.controls.propertyeditor.pickers.ColorButton");sap.ui.commons.Button.extend("sap.viz.controls.propertyeditor.pickers.ColorButton",{metadata:{properties:{color:{type:"any",defaultValue:"#FFFFFF"}}},setColor:function(e){this.setProperty("color",e,true);this.$().css("background-color",e)},renderer:function(e,t){e.addStyle("background-color",t.getColor());e.addClass("colorButton");sap.ui.commons.ButtonRenderer.render(e,t)}})};return{create:function(t,i){try{return new sap.viz.controls.propertyeditor.pickers.ColorButton(t,i)}catch(t){e();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/propertyeditor/pickers/ColorPicker",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/PickerBase","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/events/EventDispatcher","sap/viz/controls/propertyeditor/events/PropertyEditorEvent","sap/viz/controls/propertyeditor/pickers/ColorButton"],function(e,t,i,r,n,s,o){var a=function(t,i,r){a.superclass.constructor.apply(this,arguments);r=this._config||{};var n;if(this._pickedItem===null){n=true}else{n=false}if(this._pickedItem===undefined){this._pickedItem="rgba(0,0,0,1)"}this._pickedItemChanged=false;this._mode=r.mode||"fill";this._needUpdate=true;this._viewsContainer$=null;this._views=[];this._mdHandler=null;this._noColorText=null;this._resizeHandler=null;this._oRecentColorsPalette=null;this._pickContainer$=$(document.createElement("div")).appendTo(t).on("click",$.proxy(this._pickerBtnClickHandler,this));this._pickContainer$.addClass("sapUiTfBrd sapUiTfStd  sapUiTfCombo "+e.PROPERTYEDITOR_PREFIX+"colorpicker-pickercontainer");this._colorDiv$=$(document.createElement("div")).appendTo(this._pickContainer$);this._imgDiv$=$(document.createElement("div")).appendTo(this._pickContainer$);if(!n){this._colorDiv$.css({"background-color":this._pickedItem})}this._imgDiv$.addClass("sapUiTfComboIcon");this._colorDiv$.addClass(e.PROPERTYEDITOR_PREFIX+"colorpicker-background-color")};a._recentColors=[];a._shouldExcludeRecentColors={"rgba(0,0,0,0)":true};a._eventDispatch=new n;var l=["#000000","#7F7F7F","#ED1C24","#FF7F27","#FFF200","#22B14C","#00A2E8","#3F48CC","#A349A4","#FFFFFF","#C3C3C3","#FFAEC9","#FFC90E","#EFE4B0","#B5E61D","#99D9EA","#7092BE","#C8BFE7"];var c=["rgba(0,0,0,1)","rgba(127,127,127,1)","rgba(237,28,36,1)","rgba(255,127,39,1)","rgba(255,242,0,1)","rgba(34,177,76,1)","rgba(0,162,232,1)","rgba(63,72,204,1)","rgba(163,73,164,1)","rgba(255,255,255,1)","rgba(195,195,195,1)","rgba(255,174,201,1)","rgba(255,201,14,1)","rgba(239,228,176,1)","rgba(181,230,29,1)","rgba(153,217,234,1)","rgba(112,146,190,1)","rgba(200,191,231,1)"];var p=9;t.extend(a,i);a.prototype._pickerBtnClickHandler=function(){if(this._viewsContainer$!==null){this._destroyControls();return}var t=this._viewsContainer$=$(document.createElement("div"));t.addClass(e.PROPERTYEDITOR_PREFIX+"colorpicker-views-container");this._locate();t.appendTo(document.body);var i=$(document.createElement("div"));var n=$(document.createElement("div"));n.css({width:"100%"}).appendTo(t);this._oTogglePickerBtn=new sap.ui.commons.ToggleButton({text:r.get("PROPERTY_EDITOR_COLORPICKER_MORE"),press:function(e){var t=e.getSource();if(t.getPressed()){this._oPicker.$().addClass("visible");this._locate()}else{this._oPicker.$().removeClass("visible");this._locate()}}.bind(this)});this._oPicker=new sap.ui.commons.ColorPicker({colorString:u(this._pickedItem?this._pickedItem:"rgba(0,0,0,1)")});this._oPicker.attachLiveChange($.proxy(this._handlerColorPickerChange,this));this._oPalette=this._createColorPalette(l);this._oPalette.placeAt(t);var s=$(document.createElement("div"));var o=new sap.ui.commons.Label;o.setText(r.get("PROPERTY_EDITOR_COLORPICKER_RECENTCOLORS"));o.addStyleClass("recentColorLabel");o.placeAt(s);s.appendTo(t);this._oRecentColorsPalette=this._createRecentColorsPalette();this._oRecentColorsPalette.placeAt(t);this._oTogglePickerBtn.placeAt(i);this._oPicker.placeAt(i);this._needUpdate=true;i.appendTo(t);t.fadeIn();this._addEventListeners();this._mdHandler=$.proxy(this._mousedownHandler,this);$(document).on("mousedown",this._mdHandler);$(window).on("blur",this._mdHandler)};a.prototype._handleColorPalettePickerChange=function(e){var t=e.getParameters().id;this._pickedItem=$("#"+t)[0].title;this._needUpdate=false;this._oPicker.setColorString(this._pickedItem);if(this._oPicker._processRGBchanges){this._oPicker._processRGBchanges()}this._updateColor();this._needUpdate=true};a.prototype._handleNoColorClicked=function(){this._pickedItem="rgba(0,0,0,0)";this._updateColor()};var h=function(e){var t=e.getParameters();if(t.h===360){this._oPicker.oHueField.setValue(359.9);if(this._oPicker._handleHueValueChange){this._oPicker._handleHueValueChange()}return}return"rgba("+t.r+","+t.g+","+t.b+","+(!!t.alpha||t.alpha===0?t.alpha:1)+")"};a.prototype._handlerColorPickerChange=function(e){if(!this._needUpdate){return}this._pickedItem=h(e);this._pickedItemChanged=true;this._updateColor()};a.prototype._updateRecentColor=function(e){this._updateRecentColorPalette()};a.prototype._updateColor=function(){this._changePickedItem(this._pickedItem);this._colorDiv$.css({"background-color":this._pickedItem})};a.prototype._locate=function(){if(this._viewsContainer$!==null&&this._pickContainer$!==null){var e=$(".viz-controls-propertyeditor-main").offset();var t=this._pickContainer$.offset();var i=$("body").height();var r=this._viewsContainer$.height();r=r>100?r:100;var n=t.top+32+r<i-20?t.top+26:t.top-r-12;this._viewsContainer$.css({left:e.left-10,top:n<0?0:n})}};a.prototype._resizer=function(e){if(!e.data.invalidateSize){setTimeout($.proxy(function(){e.data.invalidateSize=false;this._locate()},this),1e3/24)}e.data.invalidateSize=true};a.prototype._addEventListeners=function(){this._resizeHandler=$.proxy(this._resizer,this);$(window).resize({invalidateSize:false},this._resizeHandler)};a.prototype._mousedownHandler=function(e){if(this._viewsContainer$!==null&&$(e.target).closest(this._viewsContainer$).length<=0&&$(e.target).closest(this._pickContainer$).length<=0){this._destroyControls();this._updateRecentColor()}};a.prototype._destroyControls=function(){$(document).off("mousedown",this._mdHandler);$(window).off("blur",this._mdHandler);$(window).off("resize",this._resizeHandler);this._views.forEach(function(e){e.destroy()});if(!!this._noColorText){this._noColorText.destroy()}this._viewsContainer$.empty().detach();this._views=[];this._viewsContainer$=null;this._mdHandler=null;this._resizeHandler=null};var d=function(e,t,i){var e=e===undefined?"transparent":e;var r=o.create({color:e,tooltip:e});r.attachPress(function(e){t.call(i,e)});r.addStyleClass("colorButton");return r};a.prototype._createColorPalette=function(e){var t=e.length;var i=$(document.createElement("div"));for(var n=0;n<t;n++){var s=d(e[n],this._handleColorPalettePickerChange,this);s.placeAt(i)}var a=o.create({color:"transparent",tooltip:r.get("PROPERTY_EDITOR_COLORPICKER_NOCOLOR")});a.attachPress(function(e){this._handleNoColorClicked()}.bind(this));a.addStyleClass("colorButton");a.placeAt(i);this._noColorText=new sap.ui.core.HTML("noColorText",{content:"<span class='sapUiBtnS noColorText'>"+r.get("PROPERTY_EDITOR_COLORPICKER_NOCOLOR")+"</span>"});this._noColorText.attachBrowserEvent("click",function(){this._handleNoColorClicked()}.bind(this));this._noColorText.placeAt(i);return{placeAt:function(e){i.appendTo(e)}}};a.prototype._createRecentColorsPalette=function(){var e=$(document.createElement("div"));e.addClass("recentColorsContainer");var t=a._recentColors.length>p?p:a._recentColors.length;var i=[];for(var r=0;r<t;r++){var n=d(a._recentColors[r],this._handleRecentColorChange,this);n.placeAt(e);i.push(n)}return{placeAt:function(t){e.appendTo(t)},update:function(){var r;for(r=0;r<t;r++){if(r===0){i[r].addStyleClass("colorButtonSelected")}else{i[r].removeStyleClass("colorButtonSelected")}i[r].setColor(a._recentColors[r]);i[r].setTooltip(a._recentColors[r])}for(r=t;r<p;r++){if(!!a._recentColors[r]){var n=d(a._recentColors[r],this._handleRecentColorChange,this);n.placeAt(e);i.push(n)}}}}};a.prototype._checkExcludedRecentColor=function(){var e=false;if(this._pickedItem){if(a._shouldExcludeRecentColors.hasOwnProperty(this._pickedItem)&&a._shouldExcludeRecentColors[this._pickedItem]){e=true}}return e};a.prototype._handleRecentColorChange=function(e){var t=e.getParameters().id;this._pickedItem=$("#"+t)[0].title;this._pickedItemChanged=true;this._needUpdate=false;this._oPicker.setColorString(this._pickedItem);this._updateRecentColorPalette();if(this._oPicker._processRGBchanges){this._oPicker._processRGBchanges()}this._updateColor();this._needUpdate=true};a.prototype._updateRecentColorPalette=function(){if(this._pickedItemChanged===false){return}this._pickedItemChanged=false;if(l.indexOf(this._pickedItem)>=0||c.indexOf(this._pickedItem)>=0||this._checkExcludedRecentColor()){return}var e=a._recentColors.indexOf(this._pickedItem);if(e>=0){a._recentColors.splice(e,1)}a._recentColors.splice(0,0,this._pickedItem);this._oRecentColorsPalette.update.call(this);a._recentColors.length=a._recentColors.length>p?p:a._recentColors.length;var t=new s(s.RECENTCOLORS_CHANGED,this,a._recentColors);a._eventDispatch._dispatchEvent(t)};var u=function(e){var t=e;if(t.substr(0,4)==="rgba"){t=t.substr(4);t=t.replace("(","");t=t.replace(")","");t=t.split(",");if(Number(t[3])===0){t[3]="0.0";t=t.join(",");t="rgba("+t+")";return t}}return e};return a});e("sap/viz/controls/propertyeditor/pickers/AlignmentPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/propertyeditor/pickers/PickerBase","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r){var n=function(e,t,i){n.superclass.constructor.apply(this,arguments);this._dom$;this._buttons={};this._createChildren();t=t?t:o;this._switchUIHandler(t)};var s="left";var o="center";var a="right";e.extend(n,i);n.prototype._createChildren=function(){this._pickerContainer$=$(document.createElement("div")).appendTo(this._dom$);this._pickerContainer$.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row "+t.PROPERTYEDITOR_PREFIX+"view-item-padding-bottom");this._buttons={left:this._addButton(s),center:this._addButton(o),right:this._addButton(a)}};n.prototype._switchUIHandler=function(e){for(var i in this._buttons){var r=this._buttons[i];r.removeClass(t.PROPERTYEDITOR_PREFIX+"alignmentpicker-selected-"+i);if(i===e){r.removeClass(t.PROPERTYEDITOR_PREFIX+"alignmentpicker-unselected-"+i);r.addClass(t.PROPERTYEDITOR_PREFIX+"alignmentpicker-selected-"+i)}else{r.addClass(t.PROPERTYEDITOR_PREFIX+"alignmentpicker-unselected-"+i)}}};n.prototype._addButton=function(e){var i=$(document.createElement("div"));i.addClass(t.PROPERTYEDITOR_PREFIX+"alignmentpicker-button");i.addClass(t.PROPERTYEDITOR_PREFIX+"icon");i.appendTo(this._pickerContainer$);i.on("click",$.proxy(function(t){this._switchUIHandler(e);this.pickedItem(e);this._changePickedItem()},this));return i};return n});e("sap/viz/controls/propertyeditor/pickers/FontPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/Utils","sap/viz/controls/propertyeditor/pickers/PickerBase","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/AlignmentPicker"],function(e,t,i,r,n,s,o){var a=function(e,r,o,l){a.superclass.constructor.apply(this,arguments);o=this._config||{};this._sizes=[8,9,10,11,12,14,16,18,20,22,24,26,28];this._pickedItem={fontFamily:r?c(r.fontFamily):undefined,fontSize:r?r.fontSize:undefined,fontWeight:r?r.fontWeight:undefined,fontColor:r?r.fontColor:undefined,fontStyle:r?r.fontStyle:undefined};this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"fontpicker");var p=this._createItemRow(2,t.PROPERTYEDITOR_PREFIX+"view-item-row");var h=$(p.children()[0]).addClass(t.PROPERTYEDITOR_PREFIX+"fontpicker-family");var d=new sap.ui.commons.DropdownBox({width:h.width()+"px",selectedKey:this._pickedItem.fontFamily,items:this._genFamilyItems(),change:$.proxy(function(e){this._pickedItem.fontFamily=e.oSource.getSelectedKey();this._changePickedItem(this._pickedItem,{fontFamily:this._pickedItem.fontFamily})},this)}).placeAt(h);if(this._pickedItem.fontFamily===null){i.defer(function(){sap.ui.commons.TextField.prototype.setValue.apply(d,[" "])})}else{this._pickedItem.fontFamily=d.getSelectedKey()}var u=$(p.children()[1]).addClass(t.PROPERTYEDITOR_PREFIX+"fontpicker-size");if(i.isArray(l)){this._sizes=l}var _=this._size=new sap.ui.commons.ComboBox({width:u.width()+"px",selectedKey:this._pickedItem.fontSize?parseInt(this._pickedItem.fontSize):null,items:this._genSizeItems(),change:$.proxy(function(e){var t=e.oSource.getValue();if(isNaN(t)){this._updateSize(this._sizes[0])}else{this._updateSize(e.oSource.getSelectedKey()||parseInt(t))}this._changePickedItem(this._pickedItem,{fontSize:this._pickedItem.fontSize})},this)}).placeAt(u);this._updateSize(this._pickedItem.fontSize!==null?parseInt(this._pickedItem.fontSize):null);i.defer(function(){var e=$("input",_.$());e.on("click",function(){e.get(0).select()})});p=this._createItemRow(3,t.PROPERTYEDITOR_PREFIX+"view-item");var v=new sap.ui.commons.ToggleButton({text:"B",pressed:this._pickedItem.fontWeight==="bold"?true:false,press:$.proxy(function(e){this._pickedItem.fontWeight=e.oSource.getPressed()?"bold":"normal";this._changePickedItem(this._pickedItem,{fontWeight:this._pickedItem.fontWeight})},this)}).placeAt($(p.children()[0]));v.addStyleClass(t.PROPERTYEDITOR_PREFIX+"fontpicker-button");if(this._pickedItem.fontWeight!==null){this._pickedItem.fontWeight=v.getPressed()?"bold":"normal"}var f=new sap.ui.commons.ToggleButton({text:"/",pressed:this._pickedItem.fontStyle==="oblique"?true:false,press:$.proxy(function(e){this._pickedItem.fontStyle=e.oSource.getPressed()?"oblique":"normal";this._changePickedItem(this._pickedItem,{fontStyle:this._pickedItem.fontStyle})},this)}).placeAt($(p.children()[1]));f.addStyleClass(t.PROPERTYEDITOR_PREFIX+"fontpicker-button");if(this._pickedItem.fontStyle!==null){this._pickedItem.fontStyle=f.getPressed()?"oblique":"normal"}if(o.showColorPicker===false){p.children().eq(2).hide()}var m=new s($(p.children()[2]),this._pickedItem.fontColor,{mode:"text"});m.addEventListener(n.PICKED_ITEM_CHANGED,function(e){this._pickedItem.fontColor=e.data.pickedItem;this._changePickedItem(this._pickedItem,{fontColor:this._pickedItem.fontColor})},this);if(this._pickedItem.fontColor!==null){this._pickedItem.fontColor=m.pickedItem()}};e.extend(a,r);a.prototype._updateSize=function(e){if(e){this._pickedItem.fontSize=e+"px";this._size.setValue(e)}else{this._size.setValue(" ")}};a.prototype._createItemRow=function(e,i){var r,n,s;n=$(document.createElement("div"));if(i){n.addClass(i)}for(r=0;r<e;r++){s=$(document.createElement("div"));if(r===0){s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(n)}n.appendTo(this._dom$);return n};var l=["Arial","Courier","Georgia","Times New Roman","Trebuchet MS","Verdana"];a.prototype._genFamilyItems=function(){var e=[];l.forEach(function(t){e.push(new sap.ui.core.ListItem({key:t,text:t}))});return e};a.prototype._genSizeItems=function(){var e=[];this._sizes.sort(function(e,t){return e-t});this._sizes.forEach(function(t){e.push(new sap.ui.core.ListItem({key:t,text:t}))});return e};var c=function(e){if(!e){return null}var t;for(var i in l){t=l[i];if(e.indexOf(t)>=0){return t}}return e};return a});e("sap/viz/controls/propertyeditor/pickers/SwitchPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);r=this._config||{};this._checkBox=new sap.ui.commons.CheckBox({text:r.text,checked:this._pickedItem,change:$.proxy(function(e){this._changePickedItem(this._checkBox.getChecked());this._onStatusChanged()},this)});this._checkBox.placeAt(e)};e.extend(i,t);i.prototype.checked=function(e){if(arguments.length>0){if(this._checkBox.getChecked()!==e){this._checkBox.setChecked(e)}return this}else{return this._checkBox.getChecked()}};i.prototype.enabled=function(e){if(arguments.length>0){if(this._checkBox.getEnabled()!==e){this._checkBox.setEnabled(e)}return this}else{return this._checkBox.getEnabled()}};return i});e("sap/viz/controls/propertyeditor/sections/PropertyViewBase",["sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/UIControl","sap/viz/controls/common/utils/Utils"],function(e,t,i,r){var n=function(e,t,i,r){n.superclass.constructor.apply(this,arguments);this._vizProxy=i;this._propertyZones=r;this._vizProxy.on("initialized.PropertyViewBase",$.proxy(function(e){this._propertyChangedHandler(e)},this))};t.extend(n,i);n.prototype._createHelper=function(e,t){return new e(t,{view:this,dom$:this._dom$,proxy:this._vizProxy,queryProperty:$.proxy(this._queryProperty,this),queryProperties:$.proxy(this._queryProperties,this),updateProperty:$.proxy(this._updateProperty,this),updateProperties:$.proxy(this._updateProperties,this)})};n.prototype._queryProperty=function(e){var t={};t[e]=true;var i=this._queryProperties(t);return i?i[e]:undefined};n.prototype._queryProperties=function(e){if(this._propertyZones){return this._vizProxy.queryProperties({propertyZones:this._propertyZones,propertyFields:e,chartType:this._vizProxy._client().type()})}else{return this._vizProxy.queryProperties({propertyFields:e})}};n.prototype._updateProperty=function(e,t){var i={};i[e]=t;this._updateProperties(i)};n.prototype._updateProperties=function(t,i,r){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_properties_on_propertyviewbase");if(!i){this._filterNullValue(t)}if(this._propertyZones){if(r===true){this._vizProxy.updateProperties({propertyZones:[new e(this._propertyZones[0].type())],properties:t,chartType:this._vizProxy._client().type()})}else{var n=[];this._propertyZones.forEach($.proxy(function(e){n.push(e)},this));this._vizProxy.updateProperties({propertyZones:n,properties:t,chartType:this._vizProxy._client().type()})}}else{this._vizProxy.updateProperties(t)}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_properties_on_propertyviewbase")};n.prototype._isAllSelected=function(){if(this._propertyZones){return this._propertyZones[0].context()===undefined}return false};n.prototype._filterNullValue=function(e){for(var t in e){if(e[t]===null){delete e[t]}}};n.prototype._getExtraContext=function(e){var t,i,r,n;if(this._propertyZones&&this._propertyZones.length&&this._propertyZones[0].extraContext()){r=this._propertyZones[0].extraContext()[e];for(t=0;t<this._propertyZones.length;t++){i=this._propertyZones[t].extraContext();if(i[e]!==r){n=true;break}}}if(!n){return r}return null};n.prototype.destroy=function(){this._vizProxy.off("initialized.PropertyViewBase");n.superclass.destroy.apply(this,arguments)};n.prototype._propertyChangedHandler=function(e){};return n});e("sap/viz/controls/propertyeditor/spin/SpinEvent",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/events/Event"],function(e,t){var i=function(e,t,r){i.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.chart.views.SpinEvent"};e.extend(i,t);i.CHANGED="changed";return i});e("sap/viz/controls/propertyeditor/spin/Spin",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/constants/KeyboardEventConst","sap/viz/controls/common/UIControl","sap/viz/controls/propertyeditor/spin/SpinEvent"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyeditor.spin.Spin";this._options=t!=null?t:{};if(!this._options.hasOwnProperty("step")){this._options.step=1}if(!this._options.hasOwnProperty("decimals")){this._options.decimals=0}if(!this._options.hasOwnProperty("value")){this._options.value=0}this._createChildren()};e.extend(s,r);s.prototype._createChildren=function(){var e=$(document.createElement("div"));this._dom.append(e);var i=document.createElement("div");this._input=new sap.ui.commons.TextField({width:"100%"});this._input.setValue(this._options.value);this._input.placeAt($(i));e.append(i);var r=document.createElement("span");var n=document.createElement("span");r.appendChild(n);e.append(r);var s=document.createElement("span");var o=document.createElement("span");s.appendChild(o);e.append(s);e.addClass(t.PROPERTYEDITOR_PREFIX+"spin");$(i).addClass(t.PROPERTYEDITOR_PREFIX+"spin-input");$(n).addClass(t.PROPERTYEDITOR_PREFIX+"icon");$(n).addClass(t.PROPERTYEDITOR_PREFIX+"spin-upButton-content");$(r).addClass(t.PROPERTYEDITOR_PREFIX+"spin-upButton");$(o).addClass(t.PROPERTYEDITOR_PREFIX+"icon");$(o).addClass(t.PROPERTYEDITOR_PREFIX+"spin-downButton-content");$(s).addClass(t.PROPERTYEDITOR_PREFIX+"spin-downButton");var a=this;this._input.attachChange(function(e){a.setValue(a._input.getValue())});i.addEventListener("mousewheel",$.proxy(this._handleMouseWheel,this),this);i.addEventListener("DOMMouseScroll",$.proxy(this._handleMouseWheel,this),false);i.addEventListener("keydown",$.proxy(this._handleKeyDown,this),false);i.addEventListener("keypress",$.proxy(this._handleKeyPress,this),false);i.addEventListener("keyup",$.proxy(this._stop,this),false);r.addEventListener("mousedown",$.proxy(this._upButtonStart,this),false);r.addEventListener("mouseup",$.proxy(this._stop,this),false);r.addEventListener("mouseout",$.proxy(this._stop,this),false);s.addEventListener("mousedown",$.proxy(this._downButtonStart,this),false);s.addEventListener("mouseup",$.proxy(this._stop,this),false);s.addEventListener("mouseout",$.proxy(this._stop,this),false)};s.prototype.getValue=function(){return this._input.getValue()};s.prototype.setValue=function(e){this._setValue(e,false)};s.prototype._setValue=function(e,t){var i;if(e===null||e===""){i=true}var e=parseFloat(e);if(isNaN(e)){e=0}if(this._options.hasOwnProperty("min")){e=Math.max(this._options.min,e)}if(this._options.hasOwnProperty("max")){e=Math.min(this._options.max,e)}var r=e<0?"-":"";e=Math.abs(e);var s=Math.pow(10,this._options.decimals);e=Math.round(e*s);var o=(e-e%s)/s;var a=""+e%s;var l=this._options.decimals-a.length;if(l>0){for(var c=0;c<l;c++){a="0"+a}}if(i){this._input.setValue("")}else{this._input.setValue(r+o+(this._options.decimals>0?"."+a:""));if(!t){this._dispatchEvent(new n(n.CHANGED,this,{value:this._input.getValue()}))}}};s.prototype.updateUI=function(e){this._setValue(e,true)};s.prototype._handleMouseWheel=function(e){if(e.target.id===this._input.sId){if(e.wheelDelta){this._start(e,e.wheelDelta>1)}else if(e.detail){this._start(e,e.detail<1)}this._stop()}};s.prototype._handleKeyDown=function(e){if(e.keyCode==i.UP)this._start(e,true);if(e.keyCode==i.DOWN)this._start(e,false)};s.prototype._handleKeyPress=function(e){var t=e.keyCode;if(t==0||e.altKey||e.ctrlKey||e.metaKey){return}if(t==i.SUBTRACT&&(!this._options.hasOwnProperty("min")||this._options.min<0)){return}if(t==i.DECIMAL&&this._options.decimals>0){return}if(t>=i.NUM_0&&t<=i.NUM_9){return}if(t==i.ENTER){this.setValue(this._input.getValue());return}e.preventDefault()};s.prototype._upButtonStart=function(e){e.preventDefault();this._start(e,true)};s.prototype._downButtonStart=function(e,t){e.preventDefault();this._start(e,false)};s.prototype._start=function(e,t){if(this._timeout)return;this._curStep=t?this._options.step:-this._options.step;this._delay=500;this._update()};s.prototype._stop=function(e){if(this._timeout){clearTimeout(this._timeout);delete this._timeout}};s.prototype._update=function(){var e=parseFloat(this._input.getValue());if(isNaN(e))e=0;this.setValue(e+this._curStep);this._delay=Math.max(20,Math.floor(this._delay*.8));this._timeout=setTimeout($.proxy(function(){this._update()},this),this._delay)};return s});e("sap/viz/controls/propertyeditor/pickers/PSfixPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t,i,r){var n=function(e,i){n.superclass.constructor.apply(this,arguments);this._pickedItem={fix:i?i.fix:undefined,value:i?i.value:""};this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"fixpicker-container");this._createChildren()};e.extend(n,r);n.LABEL_PREFIX="Prefix";n.LABEL_SUFFIX="Suffix";n.prototype._createChildren=function(){var e=this._createItemRow(2,t.PROPERTYEDITOR_PREFIX+"view-item");var i=$(e.children()[0]).addClass(t.PROPERTYEDITOR_PREFIX+"fixpicker-fix");var r=new sap.ui.commons.DropdownBox({width:i.width()+"px",selectedKey:this._pickedItem.fix,items:o(),change:$.proxy(function(e){this._pickedItem.fix=e.oSource.getSelectedKey();this._pickedItem.value=this._input.getValue();this._changePickedItem(this._pickedItem,{fix:this._pickedItem.fix,value:this._pickedItem.value?this._pickedItem.value:""})},this)}).placeAt(i);var s=$(e.children()[1]).addClass(t.PROPERTYEDITOR_PREFIX+"fixpicker-input");this._input=new sap.ui.commons.TextField({width:"60px"}).placeAt(e.children()[1]);this._input.setMaxLength(3);this._input.setValue(this._pickedItem.value);var a=this;this._input.attachChange(function(e){var t=a._pickedItem.fix?a._pickedItem.fix:n.LABEL_PREFIX;a._pickedItem.value=a._input.getValue();a._changePickedItem(a._pickedItem,{fix:t,value:a._pickedItem.value})})};var s=[{key:n.LABEL_PREFIX,text:i.get("PROPERTY_EDITOR_PSPICKER_PREFIX")},{key:n.LABEL_SUFFIX,text:i.get("PROPERTY_EDITOR_PSPICKER_SUFFIX")}];function o(){var e=[];s.forEach(function(t){e.push(new sap.ui.core.ListItem({key:t["key"],text:t["text"]}))});return e}n.prototype._createItemRow=function(e,i){var r,n,s;n=$(document.createElement("div"));if(i){n.addClass(i)}for(r=0;r<e;r++){s=$(document.createElement("div"));s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell");s.appendTo(n)}n.appendTo(this._dom$);return n};return n});e("sap/viz/controls/propertyeditor/pickers/FormatPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/propertyeditor/pickers/PickerBase","sap/viz/controls/propertyeditor/spin/Spin","sap/viz/controls/propertyeditor/pickers/PSfixPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s,o){var a="u";var l="[CVOM#UNIT]k";var c="[CVOM#UNIT]m";var p="[CVOM#UNIT]b";var h="[CVOM#UNIT]t";var d=[a,l,c,p,h];var u="[CVOM#PFIX]";var _="[CVOM#SFIX]";var v="#minus#";function f(e){var t=0,i=true,r=false,n=false;var s=false,o=undefined,a,l,c,p,h=0,v;var f=null,m=null,g;if(e){e=e.replace(/#minus#/g,"-");var E=11;var y=e.indexOf(u);var I=e.lastIndexOf(u);if(y>=0&&I>=0&&y!==I){f=e.substring(y+E,I);e=e.substring(I+E)}y=e.indexOf(_);I=e.lastIndexOf(_);if(y>=0&&I>=0&&y!==I){m=e.substring(y+E,I);e=e.substring(0,y)}var C=e.length;if(e.substring(C-1)==="%"){r=true;i=false;c=e.substring(0,C-1)}else{r=false;i=true;c=e;for(v=0;v<d.length;v++){g=d[v];unitFormtSuffixLen=g.length;a=e.substring(C-unitFormtSuffixLen);if(g===a){s=true;o=g;c=e.substring(0,C-unitFormtSuffixLen);break}}if(c.indexOf(",")>-1){n=true}}p=c.indexOf(".");if(p>-1){fraction=c.substring(p);for(v=1,h=0;v<fraction.length;v++){if(fraction.charAt(v)==="0"){h++}else{break}}}t=h}return{decimal:t,displayAsNumber:i,displayAsPercent:r,showSep:n,useAbbr:s,abbrOption:o,prefix:f,suffix:m}}function m(e,t){if(e){e=e.replace(/-/g,v);if(t===s.LABEL_PREFIX){return u+e+u}else if(t===s.LABEL_SUFFIX){return _+e+_}}return null}function g(e){var t=e["decimal"],i=e["displayAsNumber"];var r=e["displayAsPercent"],n=e["showSep"];var o=e["useAbbr"],d=e["abbrOption"],u="",_;var v=m(e["prefix"],s.LABEL_PREFIX);var f=m(e["suffix"],s.LABEL_SUFFIX);if(t&&!isNaN(Number(t))){t=Number(t);if(t>0){u+=".";while(t--){u+="0"}}}if(i){u=(n?"#,##0":"###0")+u;if(o){switch(d){case a:u+=a;break;case l:case c:case p:case h:u+=d;default:}}}else if(r){u="0"+u+"%"}if(v){u=v+u}if(f){u=u+f}return u}var E=function(e,t){E.superclass.constructor.apply(this,arguments);try{this._formatItem=f(t)}catch(e){this._formatItem={}}this._createChildren()};e.extend(E,r);E.prototype._createChildren=function(){var e,r;e=$(document.createElement("div"));e.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");e.appendTo(this._dom$);var l=new sap.ui.commons.Label({text:t.get("FORMAT_PICKER_DECIMAL")});l.placeAt(e);e=$(document.createElement("div"));e.appendTo(this._dom$).addClass(i.PROPERTYEDITOR_PREFIX+"view-item-padding-bottom");e.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var c=new n(e,{min:0,max:10,value:this._formatItem.decimal});c.addEventListener("changed",$.proxy(function(e){this._formatItem["decimal"]=e.data.value;this._pickedItem=g(this._formatItem);this._changePickedItem()},this));e=$(document.createElement("div")).addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");e.appendTo(this._dom$);var p=new sap.ui.commons.RadioButton({text:t.get("FORMAT_PICKER_DISPLAY_NUMBER"),groupName:"formatradio",selected:this._formatItem.displayAsNumber,select:$.proxy(function(e){this._formatItem["displayAsNumber"]=true;this._formatItem["displayAsPercent"]=false;E.apply(this);this._pickedItem=g(this._formatItem);this._changePickedItem()},this)}).placeAt(e);e=$(document.createElement("div"));e.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-indent1 "+i.PROPERTYEDITOR_PREFIX+"formatpicker-number");e.appendTo(this._dom$);r=$(document.createElement("div"));r.appendTo(e);var h=new sap.ui.commons.CheckBox({text:t.get("FORMAT_PICKER_SHOW_SEP"),checked:this._formatItem.showSep,change:$.proxy(function(e){this._formatItem["showSep"]=e.oSource.getChecked();this._pickedItem=g(this._formatItem);this._changePickedItem()},this)}).placeAt(r);r=$(document.createElement("div"));r.appendTo(e).addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var d=new sap.ui.commons.CheckBox({text:t.get("FORMAT_PICKER_SHOW_BY_UNIT"),width:r.width()+"px",checked:this._formatItem.useAbbr,change:$.proxy(function(e){this._formatItem["useAbbr"]=e.oSource.getChecked();this._formatItem["abbrOption"]=u.getSelectedKey();E.apply(this);this._pickedItem=g(this._formatItem);this._changePickedItem()},this)}).placeAt(r);r=$(document.createElement("div"));r.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row "+i.PROPERTYEDITOR_PREFIX+"formatpicker-dropdown");r.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-indent1");r.appendTo(e);var u=new sap.ui.commons.DropdownBox({width:r.width()+"px",items:this._createAbbrOptions(),selectedKey:this._formatItem.abbrOption||a,change:$.proxy(function(e){this._formatItem["abbrOption"]=e.oSource.getSelectedKey();this._pickedItem=g(this._formatItem);this._changePickedItem()},this)}).placeAt(r);e=$(document.createElement("div"));e.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");e.appendTo(this._dom$);var _=new sap.ui.commons.RadioButton({text:t.get("FORMAT_PICKER_DISPLAY_PERCENT"),groupName:"formatradio",selected:this._formatItem.displayAsPercent,select:$.proxy(function(e){this._formatItem["displayAsNumber"]=false;this._formatItem["displayAsPercent"]=true;E.apply(this);this._pickedItem=g(this._formatItem);this._changePickedItem()},this)}).placeAt(e);e=$(document.createElement("div"));e.appendTo(this._dom$);var v,f;if(this._formatItem.prefix&&this._formatItem.prefix!==""){v="Prefix";f=this._formatItem.prefix}else if(this._formatItem.suffix&&this._formatItem.suffix!==""){v="Suffix";f=this._formatItem.suffix}var m=new s(e,{fix:v,value:f});m.addEventListener(o.PICKED_ITEM_CHANGED,$.proxy(function(e){var t=e.data.changedItem;this._formatItem["prefix"]=t.fix===s.LABEL_PREFIX?t.value:null;this._formatItem["suffix"]=t.fix===s.LABEL_SUFFIX?t.value:null;this._pickedItem=g(this._formatItem);this._changePickedItem()},this));function E(){d.setEnabled(this._formatItem["displayAsNumber"]);u.setEnabled(this._formatItem["displayAsNumber"]&&this._formatItem["useAbbr"]);h.setEnabled(this._formatItem["displayAsNumber"])}E.apply(this)};E.prototype._createAbbrOptions=function(){var e=[];var i=[{key:a,value:t.get("FORMAT_PICKER_UNIT_AUTO")},{key:l,value:t.get("FORMAT_PICKER_UNIT_K")},{key:c,value:t.get("FORMAT_PICKER_UNIT_M")},{key:p,value:t.get("FORMAT_PICKER_UNIT_B")},{key:h,value:t.get("FORMAT_PICKER_UNIT_T")}];i.forEach(function(t){e.push(new sap.ui.core.ListItem({key:t.key,text:t.value}))});return e};E.analysisFormatString=function(e){if(e===undefined||e===null){return}var t=e.toString();var i=0;if(t.indexOf(".")>=0){i=t.length-1-t.indexOf(".")}var r="0";for(var n=0;n<i;n++){if(n===0){r="0."}r=r.concat("0")}return r};return E});e("sap/viz/controls/propertyeditor/pickers/ListPicker",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/propertyeditor/pickers/PickerBase","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r){var n=function(e,t,i){n.superclass.constructor.apply(this,arguments);this._pickedItem=t;this._createChildren(i)};e.extend(n,i);n.prototype._createChildren=function(e){this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"listpicker");var i=$(document.createElement("div"));i.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");i.appendTo(this._dom$);var r=new sap.ui.commons.Label({text:e.text}).placeAt(i);i=$(document.createElement("div"));i.addClass(t.PROPERTYEDITOR_PREFIX+"listpicker-dropdown");i.appendTo(this._dom$);var n=new sap.ui.commons.DropdownBox({width:i.width()+"px",items:this._createOptions(e.items),selectedKey:this._pickedItem,change:$.proxy(function(e){this._pickedItem=e.oSource.getSelectedKey();this._changePickedItem()},this)}).placeAt(i)};n.prototype._createOptions=function(e){var t=[];if(e){e.forEach(function(e){t.push(new sap.ui.core.ListItem({key:e.key,text:e.value}))})}return t};return n});e("sap/viz/controls/propertyeditor/sections/views/VizChartView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/SwitchPicker","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/common/events/Event","sap/viz/controls/propertyeditor/pickers/FormatPicker","sap/viz/controls/propertyeditor/pickers/ListPicker","sap/viz/controls/propertyeditor/pickers/AlignmentPicker"],function(e,t,i,r,n,s,o,a,l,c,p,h){var d=function(e,t,i,r){d.superclass.constructor.apply(this,arguments);this._createChildren()};t.extend(d,a);var u={boolean:o,font:n,alignment:h,format:c,list:p};d.prototype._createChildren=function(){this._area$=$(document.createElement("div")).appendTo(this._dom$);this._area$.addClass(e.PROPERTYEDITOR_PREFIX+"views-container")};d.prototype.update=function(e,t){this._vizProxy=t;this._updateChildren(e)};d.prototype._updateChildren=function(e){this.destroy();var t=this._area$=$(document.createElement("div")).appendTo(this._dom$);this._createUIChildren(t,e,null)};d.prototype._createUIChildren=function(t,i,r,n){for(var s=0;s<i.length;s++){var o=i[s];var a=$(document.createElement("div")).appendTo(t);var l=this._createUIControl(o,a,r);if(!l){continue}if(o.hasOwnProperty("children")){var c=$(document.createElement("div")).appendTo(t).addClass(e.PROPERTYEDITOR_PREFIX+"vizchartview-childcontainer");this._createUIChildren(c,o.children,l,true);if(!n){c.hide()}}if(!a.hasClass(e.PROPERTYEDITOR_PREFIX+"collapse")&&!n){a.hide()}}if(!n){var p=new Object;p.currentTarget=$(t.get(0).children[0]);if(p.currentTarget.length<=0){return}this._collapseControlClickHandler(p)}};d.prototype._createCollapseControl=function(t,i,r){var n=t.text||"";var s=i.addClass(e.PROPERTYEDITOR_PREFIX+"collapse");s.data("isCollapsed",true);var o=$(document.createElement("div")).addClass(e.COMMON_PREFIX+"UVBSharedSprite");o.addClass(e.PROPERTYEDITOR_PREFIX+"collapse-icon");o.appendTo(s);var a=$(document.createElement("div")).appendTo(s);a.addClass(e.PROPERTYEDITOR_PREFIX+"title-text");var l=new sap.ui.commons.Label({text:n});l.placeAt(a);s.click(this._collapseControlClickHandler)};d.prototype._collapseControlClickHandler=function(t){var i=$(t.currentTarget);var r=!i.data("isCollapsed");i.data("isCollapsed",r);var n=$(i.get(0).children[0]);if(r){n.removeClass(e.PROPERTYEDITOR_PREFIX+"expand-icon");n.addClass(e.PROPERTYEDITOR_PREFIX+"collapse-icon")}else{n.removeClass(e.PROPERTYEDITOR_PREFIX+"collapse-icon");n.addClass(e.PROPERTYEDITOR_PREFIX+"expand-icon")}_(i,r)};var _=function(t,i){var r=t.next();if(i){while(!r.hasClass(e.PROPERTYEDITOR_PREFIX+"collapse")&&r.length>0){r.hide();r=r.next()}}else{while(!r.hasClass(e.PROPERTYEDITOR_PREFIX+"collapse")&&r.length>0){r.show();r=r.next()}}};d.prototype._createUIControl=function(e,t,i){var n=e.type;var o=null;if(u.hasOwnProperty(n)){if(n==="font"&&this._vizProxy.getType()==="viz/number"){var a=[8,9,10,11,12,14,16,18,20,22,24,26,28,36,48,72];o=new u[n](t[0],e.value,e,a)}else if(n==="format"&&this._vizProxy.getType()==="viz/number"){var l=this._vizProxy.getDataset().data().measureValuesGroup;if(l&&l[0]&&l[0].data&&l[0].data[0]&&l[0].data[0].values&&l[0].data[0].values[0]&&l[0].data[0].values[0][0]){e.value=e.value||u[n].analysisFormatString(l[0].data[0].values[0][0])}o=new u[n](t[0],e.value,e);this._updateProperty(e.path,e.value)}else{o=new u[n](t[0],e.value,e)}o.addEventListener(s.PICKED_ITEM_CHANGED,function(t){this._pickedItemChangedHandler(t.data.pickedItem,e)},this);if(i&&i.pickedItem){o.visible(i.pickedItem()&&i.visible());i.addEventListener(s.STATUS_CHANGED,function(){o.visible(i.pickedItem()&&i.visible())})}}else if(n===r.Type_Separator){o=this._createCollapseControl(e,t,i)}return o};d.prototype._pickedItemChangedHandler=function(e,t){if(t.cssClass){var i=r.toCSSValue(t.type,e);this._updateProperties({css:{selector:t["cssClass"],value:i}})}else{this._updateProperty(t.path,e)}};d.prototype._updateProperty=function(e,t){var r=this._queryProperties();if(!i.isArray(e)){e=[e]}for(var n=0;n<e.length;++n){var s=e[n].split(".");var o=r;var a=true;for(var l=0;l<s.length-1;l++){if(!o[s[l]]){a=false;break}o=o[s[l]]}if(a){var c=s[s.length-1];o[c]=t}}this._updateProperties({properties:r})};d.prototype.destroy=function(){d.superclass.destroy.apply(this,arguments);this._area$.empty()};return d});e("sap/viz/controls/propertyeditor/VizPropertyEditor",["sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/VizUtils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/helpers/VizPropertiesHelper","sap/viz/controls/propertyeditor/sections/PropertyViewFactory","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/SectionPicker","sap/viz/controls/propertyeditor/sections/views/VizChartView"],function(e,t,i,r,n,s,o,a,l,c,p,h){var d=function(e,t){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyeditor.VizPropertyEditor";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizpropertyeditor_control");this._title$=null;this._sectionPicker=null;this._viewsContainer$=null;this._views=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_vizpropertyeditor_control")};i.extend(d,e);d.prototype._onConnect=function(e,t){d.superclass._onConnect.apply(this,arguments);this._updateChildren();this._vizProxy().addEventListener("ChartChanged",this._chartChangedHandler,this)};d.prototype._onDisconnect=function(){d.superclass._onDisconnect.apply(this,arguments);this._vizProxy().removeEventListener("ChartChanged",this._chartChangedHandler,this)};d.prototype._chartChangedHandler=function(){var e=this._vizModel().type();if(e){this._updateVizChartView(e)}};d.prototype._createChildren=function(){var e;this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"main");this._dom$.css("overflow","auto");if(this._uiConfig.enableTitle===true){this._title$=$(document.createElement("div"));this._title$.addClass(t.PROPERTYEDITOR_PREFIX+"title");this._title$.appendTo(this._dom$)}this._viewsContainer$=$(document.createElement("div"));this._viewsContainer$.addClass(t.PROPERTYEDITOR_PREFIX+"views-container");this._viewsContainer$.appendTo(this._dom$);this._vizChartView=new h(this._viewsContainer$,{},this._vizProxy());this._updateChildren()};d.prototype._updateChildren=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_vizpropertyeditor");var e=this._vizModel().type();if(n.isInfoChart(e)){return}if(e){var t=n.getVizType(e);if(this._title$){this._title$.text(r.substitute(o.get("PROPERTY_EDITOR_TITLE_PREFIX"),n.getVizTypeObject(t).caption))}this._updateVizChartView(e)}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_vizpropertyeditor")};d._getPropertyValue=function(e,t){var i=t.split(".");var r=e;for(var n=0;n<i.length;n++){r=r[i[n]];if(r==null){break}}return r};d.prototype._getCssValue=function(e,t,i){var r=this._vizProxy().queryProperties({css:{selector:e,properties:t}});if(r){r=a.fromCSSValue(i,r)}return r};d.prototype._createPropertiesData=function(e,t){var i=[];for(var n=0;n<t.length;++n){i.push(t[n].path)}var a=s.hasProperties(e,i);var l=[];var c=this._vizProxy().getProperties();if(!c){return l}for(var n=0;n<t.length;n++){if(!a[n]){continue}var p=r.clone(t[n]);p.text=o.get(p.text);var h=p.path;var u=null;if(p.cssClass){u=this._getCssValue(p.cssClass,p.cssProperties,p.type)}else{if(r.isArray(h)){for(var _=0;_<h.length;++_){u=u||d._getPropertyValue(c,h[_])}}else{u=d._getPropertyValue(c,h)}}p.value=u;if(p.hasOwnProperty("children")){p.children=this._createPropertiesData(e,p.children)}l.push(p)}return l};d.prototype._updateVizChartView=function(e){var t=this._createPropertiesData(e,a.getProperties(e));this._vizChartView.update(t,this._vizProxy())};d.prototype.destroy=function(){this._dom$.css("overflow","visible");d.superclass.destroy.apply(this,arguments);this._vizChartView.destroy();this._viewsContainer$.empty()};return d});e("sap/viz/controls/propertyeditor/sections/Section",[],function(){var e=function(e,t,i,r,n){this.id=e;this.viewClass=t;this.caption=i;this.groupIndex=r;this.itemIndex=n};e.CHART_AREA="sectionChartArea";e.CHART_TITLE="sectionChartTitle";e.PLOT_AREA="sectionPlotArea";e.LEGEND="sectionLegend";e.CATEGORY_AXIS="sectionCategoryAxis";e.VALUE_AXIS="sectionValueAxis";e.VALUE_AXIS_TITLE="sectionValueAxisTitle";e.CATEGORY_AXIS_TITLE="sectionCategoryAxisTitle";e.COLUMN_DATA_POINT="sectionColumnDataPoint";e.COLUMN_DATA_LABEL="sectionColumnDataLabel";e.DONUT_DATA_POINT="sectionDonutDataPoint";e.DONUT_DATA_LABEL="sectionDonutDataLabel";e.DONUT_PLOT_AREA="sectionDonutPlotArea";e.LINE_DATA_POINT="sectionLineDataPoint";e.LINE_DATA_LABEL="sectionLineDataLabel";e.LINE="sectionLine";return e});e("sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase",[],function(){var e=function(e,t){this._config=e;this._target=t};return e});e("sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/FontPicker"],function(e,t,i,r,n){var s=function(e,t){s.superclass.constructor.apply(this,arguments);this._checkbox=null;this._fontPicker=null;this._createChildren()};e.extend(s,i);s.prototype._createChildren=function(){var e=$(document.createElement("div")).appendTo(this._target.dom$).addClass(t.PROPERTYEDITOR_PREFIX+"view-item");var i=this._checkbox=new sap.ui.commons.CheckBox({text:this._config.visible.text,change:$.proxy(this._checkboxChangedHandler,this)});i.placeAt(e);var s=$(document.createElement("div")).appendTo(this._target.dom$).addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._fontPicker=new n(s.get(0),this._target.queryProperties({fontFamily:true,fontSize:true,fontWeight:true,fontColor:true,fontStyle:true}));this._fontPicker.addEventListener(r.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);i.setChecked(this._target.queryProperty(this._config.visible.propertyField));this._commitChecked()};s.prototype._checkboxChangedHandler=function(){var e=this._checkbox.getChecked();this._target.updateProperty(this._config.visible.propertyField,e);if(this._config.visible.updateLayout){this._config.visible.updateLayout(e)}this._commitChecked()};s.prototype._commitChecked=function(){var e=this._checkbox.getChecked();this._fontPicker.visible(e)};s.prototype._fontPickerChangedHandler=function(e){this._target.updateProperties(e.data.pickedItem)};return s});e("sap/viz/controls/propertyeditor/sections/views/CategoryAxisTitleView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper"],function(e,t,i,r){var n=function(e,t,i){n.superclass.constructor.apply(this,arguments);this._createChildren()};e.extend(n,i);n.prototype._createChildren=function(){var e=this._createHelper(r,{visible:{text:t.get("PROPERTY_EDITOR_SHOW_AXIS_TITLE"),propertyField:"categoryAxis.title.visible"}})};return n});e("sap/viz/controls/propertyeditor/sections/views/ValueAxisTitleView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper"],function(e,t,i,r){var n=function(e,t,i,r){n.superclass.constructor.apply(this,arguments);this._createChildren()};e.extend(n,i);n.prototype._createChildren=function(){var e=this._createHelper(r,{visible:{text:t.get("PROPERTY_EDITOR_SHOW_AXIS_TITLE"),propertyField:"valueAxis.title.visible"}})};return n});e("sap/viz/controls/propertyeditor/utils/PropertyUtil",[],function(){var e={};e.propertyToToggle=function(e){if(e===null){return"Mixed"}else if(e!==true){return"Unchecked"}else{return"Checked"}};return e});e("sap/viz/controls/propertyeditor/helpers/SVGHelper",["jquery"],function(e){var t={};t.setColor=function(t,i){e(t).find("*").each(function(){var t=e(this);if(t.css("stroke")&&t.css("stroke")!=="none"){t.css("stroke",i)}if(t.css("fill")&&t.css("fill")!=="none"){t.css("fill",i)}})};return t});e("sap/viz/controls/propertyeditor/helpers/ObjectHelper",["jquery","sap/viz/controls/propertyeditor/helpers/SVGHelper"],function(e,t){var i={};i.setSVGColor=function(i,r,n){if(e("svg",i).length>0){t.setColor(i,r);if(n){n()}}};return i});e("sap/viz/controls/propertyeditor/pickers/IconPicker",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/helpers/ObjectHelper","sap/viz/controls/propertyeditor/helpers/SVGHelper","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t,i,r,n,s){var o=function(t,i,r){o.superclass.constructor.apply(this,arguments);r=this._config||{};this._icons=r.icons;this._iconMap={};this._parseIconMap();if(this._pickedItem===null){this._icon=null}else{this._icon=i?i:this._icons[0].svg}this._color=r.color?r.color:"rgb(0,0,0)";this._createChildren();this._list$=null;this._container$=null;this._resizeHandler=null;this._mdHandler=e.proxy(this._mousedownHandler,this)};i.extend(o,s);var a=t.PROPERTYEDITOR_PREFIX+"iconpicker-";var l=t.COMMON_PREFIX;o.prototype._createChildren=function(){this._container$=e(document.createElement("div")).appendTo(this._dom$);this._container$.addClass("sapUiTfBrd sapUiTfStd  sapUiTfCombo "+a+"container");this._icon$=e(document.createElement("div")).appendTo(this._container$);this._icon$.addClass(a+"icon");this._arrow$=e(document.createElement("div")).appendTo(this._container$);this._arrow$.addClass("sapUiTfComboIcon");this._arrow$.click(e.proxy(this._arrowClickHandler,this));this._applyDefaultIcon()};o.prototype._parseIconMap=function(){var e,t;for(e=0;e<this._icons.length;e++){t=this._icons[e];this._iconMap[t.id]=t.svg}};o.prototype.icon=function(e){if(arguments.length>0){if(this._icon!==e){this._icon=e;this._applyIcon();this._changePickedItem(this._icon)}return this}else{return this._icon}};o.prototype._applyIcon=function(){if(this.icon()){this._icon$[0].innerHTML=this.icon();var e=this._icon$.children().get(0);if(!e.getAttribute("viewBox")){var t=e.getBBox();e.setAttribute("viewBox",[t.x,t.y,t.width,t.height].join(" "))}e.setAttribute("fill",this.color())}};o.prototype.color=function(e){if(arguments.length>0){this._color=e;this._applyColor();return this}else{return this._color}};o.prototype._applyColor=function(){e("svg",this._dom$).each(e.proxy(function(e,t){n.setColor(t,this.color())},this))};o.prototype._createIconList=function(){this._list$=e(document.createElement("div")).appendTo(e("body"));this._locate();this._list$.addClass(a+"list");var t=e(document.createElement("div")).appendTo(this._list$);var i,r,n,s,o,l,c;for(i=0;i<this._icons.length;i++){n=this._icons[i];r=n.id;s=n.svg;this._iconMap[r]=s;c=e(document.createElement("div")).appendTo(t);c.addClass(a+"list-cell");c.data("icon",s);l=e(document.createElement("div")).appendTo(c);l[0].innerHTML=s;var s=l.children().get(0);if(!s.getAttribute("viewBox")){var p=s.getBBox();s.setAttribute("viewBox",[p.x,p.y,p.width,p.height].join(" "))}l.addClass(a+"list-icon");s.setAttribute("fill",this.color());c.click(e.proxy(this._iconListClickHandler,this))}this._addEventListeners();e(document).on("mousedown",this._mdHandler);e(window).on("blur",this._mdHandler)};o.prototype._iconListClickHandler=function(t){var i=e(t.currentTarget);var r=i.data("icon");this.icon(r);this._destroyList()};o.prototype._arrowClickHandler=function(e){if(this._list$!==null){this._destroyList();return}this._createIconList()};o.prototype._destroyList=function(){e(document).off("mousedown",this._mdHandler);e(window).off("blur",this._mdHandler);e(window).off("resize",this._resizeHandler);this._list$.empty().detach();this._list$=null};o.prototype._locate=function(){if(!!this._list$){var e;if(!!this._container$){e=this._container$.offset()}else{e=this._dom$.children().offset()}this._list$.css({position:"absolute",top:e.top+2,left:e.left})}};o.prototype._resizer=function(t){if(!t.data.invalidateSize){setTimeout(e.proxy(function(){t.data.invalidateSize=false;this._locate()},this),1e3/24)}t.data.invalidateSize=true};o.prototype._addEventListeners=function(){this._resizeHandler=e.proxy(this._resizer,this);e(window).resize({invalidateSize:false},this._resizeHandler)};o.prototype._mousedownHandler=function(t){if(this._list$!==null&&this._list$.css("visibility")=="visible"&&e(t.target).closest(this._list$).length<=0&&t.target!==this._arrow$[0]){this._destroyList()}};o.prototype._applyDefaultIcon=function(){var e,t;for(e=0;e<this._icons.length;e++){t=this._icons[e];if(this._icon===t.svg){this._applyIcon();break}}};return o});e("sap/viz/controls/propertyeditor/sections/views/CategoryAxisView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/SwitchPicker","sap/viz/controls/propertyeditor/utils/PropertyUtil","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/propertyeditor/pickers/IconPicker","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s,o,a,l,c,p,h,d){var u=function(){u.superclass.constructor.apply(this,arguments);this._axisSize=0;this._defaultIcon=this._uiConfig.icons[0].svg;this._axisName=r.getCategoryAxis(this._vizProxy.getType())[0];this._axisVisibleProperty="categoryAxis.visible";this._axisLineVisibleProperty="categoryAxis.axisLine.visible";this._axisTickVisibleProperty="categoryAxis.axisTick.visible";this._axisLabelVisibleProperty="textVisible";var e=r.getDirection(n.getVizType(this._vizProxy.getType()));if(e===s.DIRECTION_HORIZONTAL){this._axisSizeProperty="categoryAxis.layout.maxWidth"}else{this._axisSizeProperty="categoryAxis.layout.maxHeight"}this._axisImageProperty="iconSVG";this._axisImageColorProperty="iconColor";this._axisImageSizeProperty="iconSize";this._axisImageVisibleProperty="iconVisible";this._axisDefaultSize=.25;this._axisDefaultImageSize=.5;this._createChildren()};i.extend(u,o);u.prototype.destroy=function(){u.superclass.destroy.apply(this,arguments);if(this._axisImageSize){this._axisImageSize.destroy()}this._axisImageSize=null};u.prototype._createChildren=function(){var i=this._initialProperties();if(i){var r=this._createItemRow(1,e.PROPERTYEDITOR_PREFIX+"view-item-row");var n=i[this._axisLineVisibleProperty]!==false;this._axisLineVisible=new a($(r.children()[0]),n,{text:t.get("PROPERTY_EDITOR_SHOW_AXIS_LINE")});var s=true;this._axisLineVisible.enabled(s);var o=this._createItemRow(1,e.PROPERTYEDITOR_PREFIX+"view-item-row");if(i[this._axisLabelVisibleProperty]===null){n=null}else{n=i[this._axisLabelVisibleProperty]!==false}n=l.propertyToToggle(n);this._axisLabelVisible=new sap.ui.commons.TriStateCheckBox({text:t.get("PROPERTY_EDITOR_SHOW_AXIS_LABEL")});this._axisLabelVisible.toggle(n);this._axisLabelVisible.placeAt($(o.children()[0]));this._axisLabelVisible.attachChange($.proxy(this._showHideAxisLabel,this));o=this._createItemRow(1,e.PROPERTYEDITOR_PREFIX+"view-item-indent1");o.addClass(e.PROPERTYEDITOR_PREFIX+"fontpicker");this._axisLabelFont=new c($(o.children()[0]),{fontFamily:i["fontFamily"],fontSize:i["fontSize"],fontWeight:i["fontWeight"],fontColor:i["fontColor"],fontStyle:i["fontStyle"]});this._axisLabelFontContainer$=o;if(n!=="Unchecked"){this._axisLabelFontContainer$.show()}else{this._axisLabelFontContainer$.hide()}var u=this._createItemRow(1,e.PROPERTYEDITOR_PREFIX+"view-item-row");var _=i[this._axisImageProperty];var v=i[this._axisImageColorProperty];var f=i[this._axisImageVisibleProperty];if(f===null){n=null}else{n=f?f:false}n=l.propertyToToggle(n);this._axisImageVisible=new sap.ui.commons.TriStateCheckBox({text:t.get("PROPERTY_EDITOR_SHOW_AXIS_IMAGE")});this._axisImageVisible.toggle(n);this._axisImageVisible.placeAt($(u.children()[0]));this._axisImageVisible.attachChange($.proxy(this._showHideAxisImage,this));u=this._axisImageRow$=this._createItemRow(2,e.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._axisImage=new p($(u.children()[0]),_,{icons:this._uiConfig.icons});this._axisImageColor=new h($(u.children()[1]),v,{mode:"fill"});this._axisImageSize$=this._createItemRow(2,e.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._axisImageSize$.css({height:"auto"});var m=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_SIZE_OF_ALL_IMAGES")});m.placeAt(this._axisImageSize$.children()[0]);var g=i[this._axisImageSizeProperty]!==undefined&&i[this._axisImageSizeProperty]!==null?i[this._axisImageSizeProperty]:this._axisDefaultImageSize;this._axisImageSize=new sap.ui.commons.Slider({min:0,max:1,value:g,width:"154px",smallStepWidth:.01,liveChange:$.proxy(function(e){this._changeAxisImageSize(e.getParameters().value)},this)});this._axisImageSize.placeAt($(this._axisImageSize$.children()[1]).addClass(e.PROPERTYEDITOR_PREFIX+"views-slider-container "+e.PROPERTYEDITOR_PREFIX+"view-item-padding-bottom"));this._showImagePickers(n!=="Unchecked");this._axisLineVisible.addEventListener(d.PICKED_ITEM_CHANGED,this._showHideAxisLine,this);this._axisLabelFont.addEventListener(d.PICKED_ITEM_CHANGED,this._changeAxisLabelFont,this);this._axisImage.addEventListener(d.PICKED_ITEM_CHANGED,this._changeAxisImage,this);this._axisImageColor.addEventListener(d.PICKED_ITEM_CHANGED,this._changeAxisImageColor,this);if(i.textVisible===undefined||i.iconVisible===undefined){var E=this._getPickerProps(["showDataLabel","fontPicker","showDataLabelImage","imageIcon","imageColor","imageSizeSlider"]);this._updateProperties(E)}}};u.prototype._createItemRow=function(t,i){var r,n,s;n=$(document.createElement("div"));if(i){n.addClass(i)}for(r=0;r<t;r++){s=$(document.createElement("div"));if(r===0){s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(n)}n.appendTo(this._dom$);return n};u.prototype._initialProperties=function(){var e={};e[this._axisLineVisibleProperty]=true;e[this._axisLabelVisibleProperty]=true;e[this._axisSizeProperty]=true;e[this._axisImageProperty]=true;e[this._axisImageColorProperty]=true;e[this._axisImageSizeProperty]=true;e[this._axisImageVisibleProperty]=true;e["fontFamily"]=true;e["fontSize"]=true;e["fontWeight"]=true;e["fontColor"]=true;e["fontStyle"]=true;return this._queryProperties(e)};u.prototype._changeAxisImageSize=function(e){var t={};t[this._axisImageSizeProperty]=e;this._updateProperties(t,false,true)};u.prototype._showHideAxisLine=function(e){var t=e.data.pickedItem;var i={};i[this._axisLineVisibleProperty]=t;i[this._axisTickVisibleProperty]=t;this._updateProperties(i)};u.prototype._showHideAxisLabel=function(e){var t=this._axisLabelVisible.getSelectionState();if(t!=="Unchecked"){this._axisLabelFontContainer$.show()}else{this._axisLabelFontContainer$.hide()}var i={};i[this._axisLabelVisibleProperty]=t!=="Unchecked"?undefined:false;this._updateProperties(i)};u.prototype._changeAxisLabelFont=function(e){var t=e.data.changedItem;this._updateProperties(t)};u.prototype._showHideAxisImage=function(e){var t=this._axisImageVisible.getSelectionState();var i={};i[this._axisImageProperty]=this._axisImage.icon();i[this._axisImageColorProperty]=this._axisImageColor.pickedItem();i[this._axisImageSizeProperty]=this._axisImageSize?this._axisImageSize.getValue():this._axisDefaultImageSize;i[this._axisImageVisibleProperty]=t!=="Unchecked";i[this._axisSizeProperty]=t!=="Unchecked"?.5:.25;this._showImagePickers(t!=="Unchecked");this._updateProperties(i)};u.prototype._changeAxisImage=function(e){var t=e.data.pickedItem;var i={};i[this._axisImageProperty]=t;this._updateProperties(i)};u.prototype._changeAxisImageColor=function(e){var t=e.data.pickedItem;var i={};i[this._axisImageColorProperty]=t;this._updateProperties(i)};u.prototype._showImagePickers=function(e){if(this._axisImageRow$){e?this._axisImageRow$.show():this._axisImageRow$.hide()}if(this._axisImageSize$){e?this._axisImageSize$.show():this._axisImageSize$.hide()}};u.prototype._getPickerProps=function(e){var t={};for(var i in e){switch(e[i]){case"showAxisLine":if(this._axisLineVisible){t[this._axisLineVisibleProperty]=t[this._axisTickVisibleProperty]=this._axisLineVisible.pickedItem()}break;case"showDataLabel":if(this._axisLabelVisible){if(this._axisLabelVisible.getSelectionState()==="Checked"){t["textVisible"]=true}else if(this._axisLabelVisible.getSelectionState()==="Unchecked"){t["textVisible"]=false}}break;case"fontPicker":if(this._axisLabelFont){t["fontFamily"]=this._axisLabelFont.pickedItem()["fontFamily"];t["fontSize"]=this._axisLabelFont.pickedItem()["fontSize"];t["fontWeight"]=this._axisLabelFont.pickedItem()["fontWeight"];t["fontColor"]=this._axisLabelFont.pickedItem()["fontColor"];t["fontStyle"]=this._axisLabelFont.pickedItem()["fontStyle"]}break;case"showDataLabelImage":if(this._axisImageVisible){if(this._axisImageVisible.getSelectionState()==="Checked"){t["iconVisible"]=true}else if(this._axisImageVisible.getSelectionState()==="Unchecked"){t["iconVisible"]=false}}break;case"imageIcon":if(this._axisImage){t["iconSVG"]=this._axisImage.icon()}break;case"imageColor":if(this._axisImageColor){t["iconColor"]=this._axisImageColor.pickedItem()}break;case"imageSizeSlider":if(this._axisImageSize){t["iconSize"]=this._axisImageSize.getValue()}break}}return t};u.prototype._mergeLayoutProperties=function(e,t){if(e&&t){for(var i in t){e[i]=t[i]}}};return u});e("sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase"],function(e,t,i,r){var n=function(e,t){n.superclass.constructor.apply(this,arguments)};e.extend(n,r);n.prototype.createLayout=function(){var e=$(document.createElement("div")).appendTo(this._target.dom$);e.addClass(t.PROPERTYEDITOR_PREFIX+"title-text");e.addClass(t.PROPERTYEDITOR_PREFIX+"view-item");var r=new sap.ui.commons.Label({text:i.get("PROPERTY_EDITOR_LAYOUT")});r.placeAt(e);var n=$(document.createElement("div")).appendTo(this._target.dom$);n.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row "+t.PROPERTYEDITOR_PREFIX+"linestyle");var s=$(document.createElement("div")).appendTo(n);s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");s.addClass(t.PROPERTYEDITOR_PREFIX+"chartarea-layoutbtn");var o=new sap.ui.commons.Button({text:i.get("PROPERTY_EDITOR_CLASSIC_LAYOUT"),press:$.proxy(this._classicBtnPress,this),styled:false,width:"100px"});o.placeAt(s);var a=$(document.createElement("div")).appendTo(n);a.addClass(t.PROPERTYEDITOR_PREFIX+"view-item");a.addClass(t.PROPERTYEDITOR_PREFIX+"chartarea-layoutbtn");var l=new sap.ui.commons.Button({text:i.get("PROPERTY_EDITOR_LEAN_LAYOUT"),press:$.proxy(this._leanBtnPress,this),styled:false,width:"100px"});l.placeAt(a)};n.prototype._classicBtnPress=function(e){var t={title:{visible:true},legend:{visible:true},valueAxis:{title:{visible:true}},valueAxis2:{title:{visible:true}},categoryAxis:{title:{visible:true}},categoryAxis2:{title:{visible:true}}};this._target.proxy.setProperties(t)};n.prototype._leanBtnPress=function(e){var t={title:{visible:false},legend:{visible:false},valueAxis:{title:{visible:false}},valueAxis2:{title:{visible:false}},categoryAxis:{title:{visible:false}},categoryAxis2:{title:{visible:false}}};this._target.proxy.setProperties(t)};return n});e("sap/viz/controls/propertyeditor/sections/views/ChartAreaView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/spin/Spin","sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper"],function(e,t,i,r,n,s,o,a){var l=function(e,t,i){l.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren()};i.extend(l,r);l.prototype._createChildren=function(){this._helper=this._createHelper(a,{});var i=$(document.createElement("div")).appendTo(this._dom$);i.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");var r=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_BACKGROUND_COLOR")});r.placeAt(i);var o=$(document.createElement("div")).appendTo(this._dom$);var l=this._colorPicker=new n(o,this._queryProperty("fill"),{mode:"fill"});this._colorPicker.addEventListener(s.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);var c=this._vizProxy.getSize()};l.prototype._pickerChangedHandler=function(e){var t=e.data.pickedItem;var i={fill:t};this._updateProperties(i)};l.prototype._heightChangedHandler=function(e){var t=this._vizProxy.getSize();var i=parseFloat(e.data.value);if(i!=t.height){this._vizProxy.setSize({height:i,width:t.width})}};l.prototype._widthChangedHandler=function(e){var t=this._vizProxy.getSize();var i=parseFloat(e.data.value);if(i!=t.width){this._vizProxy.setSize({height:t.height,width:i})}};l.prototype._propertyChangedHandler=function(e){if(this._heightSpin&&this._widthSpin){var t=this._vizProxy.getSize();if(t.height!=this._heightSpin.getValue()){this._heightSpin.updateUI(t.height)}if(t.width!=this._widthSpin.getValue()){this._widthSpin.updateUI(t.width)}}};return l});e("sap/viz/controls/propertyeditor/sections/views/ChartTitleView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/TextViewHelper"],function(e,t,i,r){var n=function(e,t,i){n.superclass.constructor.apply(this,arguments);this._createChildren()};e.extend(n,i);n.prototype._createChildren=function(){var e=this._createHelper(r,{visible:{text:t.get("PROPERTY_EDITOR_SHOW_CHART_TITLE"),propertyField:"title.visible",updateLayout:$.proxy(this._updateLayout,this)}})};n.prototype._updateLayout=function(e){if(e){this._updateProperty("title.layout.maxHeight",.1)}else{this._updateProperty("title.layout.maxHeight",0)}};return n});e("sap/viz/controls/propertyeditor/pickers/ThicknessPicker",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);i=this._config||{};this._color=i.color?i.color:"rgb(0,0,0)";this._lineSize=this._pickedItem;this._createChildren();this._list$=null;this._mdHandler=$.proxy(this._mousedownHandler,this)};t.extend(r,i);var n=e.PROPERTYEDITOR_PREFIX+"thicknesspicker-";var s=e.COMMON_PREFIX;var o=[{thickness:1},{thickness:2},{thickness:3},{thickness:4},{thickness:5},{thickness:6}];r.prototype._createChildren=function(){this._container$=$(document.createElement("div")).appendTo(this._dom$);this._container$.addClass("sapUiTfBrd sapUiTfStd  sapUiTfCombo "+n+"container");this._line$=$(document.createElement("div")).appendTo(this._container$);this._line$.addClass(n+"line");this._line$.click($.proxy(this._arrowClickHandler,this));this._arrow$=$(document.createElement("div")).appendTo(this._container$);this._arrow$.addClass("sapUiTfComboIcon");this._arrow$.click($.proxy(this._arrowClickHandler,this));this._applyLine()};r.prototype._createLineList=function(){this._list$=$(document.createElement("div")).appendTo($("body"));this._list$.addClass(n+"list");this._locate();var e=$(document.createElement("ul")).appendTo(this._list$);var t,i,r,s,a,l,c,p,h,d,u;for(t=0;t<o.length;t++){i=o[t];li$=$(document.createElement("li")).appendTo(e);li$.data("line",i.thickness);s=$(document.createElement("div")).appendTo(li$);l=$(document.createElement("div")).addClass(n+"list-line-container").appendTo(s);a=$(document.createElement("div")).css({"margin-top":(20-i.thickness)/2+"px","background-color":this._color,height:i.thickness+"pt"}).appendTo(l);if(i.thickness==this._lineSize){l.removeClass(n+"list-line-container");l.addClass(n+"list-line-container-selected")}li$.click($.proxy(this._lineListClickHandler,this))}$(document).on("mousedown",this._mdHandler);$(window).on("blur",this._mdHandler)};r.prototype._locate=function(){if(!!this._list$){var e;if(!!this._container$){e=this._container$.offset()}else{e=this._dom$.children().offset()}this._list$.css({position:"absolute",top:e.top+2,left:e.left})}};r.prototype._resizer=function(e){if(!e.data.invalidateSize){setTimeout($.proxy(function(){e.data.invalidateSize=false;this._locate()},this),1e3/24)}e.data.invalidateSize=true};r.prototype._arrowClickHandler=function(e){if(this._list$!==null){this._destroyList();return}this._createLineList()};r.prototype._lineListClickHandler=function(e){var t=$(e.currentTarget);var i=t.data("line");this.lineSize(i);this._destroyList()};r.prototype.color=function(e){if(arguments.length>0){this._color=e;this._applyColor();return this}else{return this._color}};r.prototype._applyColor=function(){$("div."+n+"list-line").css("background-color",this._color)};r.prototype.lineSize=function(e){if(arguments.length>0){if(this._lineSize!==e){this._lineSize=e;this._applyLine();this._changePickedItem(this._lineSize)}return this}else{return this._lineSize}};r.prototype._applyLine=function(){this._line$.empty();var e=$(document.createElement("div")).css({"margin-top":(20-this._lineSize)/2+"px","background-color":this._color,height:this._lineSize+"pt"}).addClass(n+"list-line").appendTo(this._line$)};r.prototype._mousedownHandler=function(e){if(this._list$!==null&&this._list$.css("visibility")=="visible"&&$(e.target).closest(this._list$).length<=0&&e.target!==this._arrow$[0]){this._destroyList()}};r.prototype.destroy=function(){r.superclass.destroy.apply(this,arguments);if(this._list$!==null){this._destroyList()}this._line$.empty().detach();this._line$=null;this._arrow$.empty().detach();this._arrow$=null;this._container$.empty().detach();this._container$=null};r.prototype._destroyList=function(){$(document).off("mousedown",this._mdHandler);$(window).off("blur",this._mdHandler);this._list$.empty().detach();this._list$=null};return r});e("sap/viz/controls/propertyeditor/sections/views/PlotAreaView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/ThicknessPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s,o){var a=function(e,t,i){a.superclass.constructor.apply(this,arguments);this._createChildren()};i.extend(a,r);a.prototype._createChildren=function(){var i=this._initialProperties();var r=$(document.createElement("div")).appendTo(this._dom$);r.addClass(e.PROPERTYEDITOR_PREFIX+"view-item");var a=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_BACKGROUND_COLOR")});a.placeAt(r);var l=$(document.createElement("div")).appendTo(this._dom$);var c=this._colorPicker=new n(l,this._queryProperty("fill"),{mode:"fill"});this._colorPicker.addEventListener(o.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);r=$(document.createElement("div")).appendTo(this._dom$);r.addClass(e.PROPERTYEDITOR_PREFIX+"view-item");var p=i["plotArea.gridline.visible"]!==false;var h=this._showGridLineChb=new sap.ui.commons.CheckBox({text:t.get("PROPERTY_EDITOR_SHOW_GRIDLINE"),checked:p,change:$.proxy(function(e){this._showGridLine(e.getParameters().checked)},this)});h.placeAt(r);r=this._thicknessContainer$=$(document.createElement("div")).appendTo(this._dom$);r.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent1");var d=$(document.createElement("div")).appendTo(r).addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell");this._thicknessPicker=new s(d,i["plotArea.gridline.size"]);this._thicknessPicker.addEventListener(o.PICKED_ITEM_CHANGED,this._thicknessChangeHandler,this);var u=$(document.createElement("div")).appendTo(r).addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell");this._tcPicker=new n(u,i["plotArea.gridline.color"]);this._tcPicker.addEventListener(o.PICKED_ITEM_CHANGED,this._tcPickerChangedHandler,this);p?this._thicknessContainer$.show():this._thicknessContainer$.hide()};a.prototype._initialProperties=function(){var e={"plotArea.gridline.visible":true,"plotArea.gridline.color":true,"plotArea.gridline.size":true};return this._queryProperties(e)};a.prototype._showGridLine=function(e){if(e){this._thicknessContainer$.show()}else{this._thicknessContainer$.hide()}var t={"plotArea.gridline.visible":e};this._updateProperties(t)};a.prototype._tcPickerChangedHandler=function(e){var t=e.data.pickedItem;var i={"plotArea.gridline.color":e.data.pickedItem};this._updateProperties(i)};a.prototype._thicknessChangeHandler=function(e){var t=e.data.pickedItem;var i={"plotArea.gridline.size":t};this._updateProperties(i)};a.prototype._pickerChangedHandler=function(e){var t=e.data.pickedItem;var i={fill:t};this._updateProperties(i)};return a});e("sap/viz/controls/propertyeditor/sections/views/DonutPlotAreaView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s){var o=function(e,t,i){o.superclass.constructor.apply(this,arguments);this._createChildren()};i.extend(o,r);o.prototype._createChildren=function(){var i=$(document.createElement("div")).appendTo(this._dom$);i.addClass(e.PROPERTYEDITOR_PREFIX+"view-item");var r=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_BACKGROUND_COLOR")});r.placeAt(i);var o=$(document.createElement("div")).appendTo(this._dom$);var a=this._colorPicker=new n(o,this._queryProperty("fill"),{mode:"fill"});this._colorPicker.addEventListener(s.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this)};o.prototype._pickerChangedHandler=function(e){var t=e.data.pickedItem;var i={fill:t};this._updateProperties(i)};return o});e("sap/viz/controls/propertyeditor/sections/views/LegendView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/propertyeditor/sections/PropertyViewBase"],function(e,t,i,r,n,s){var o=function(e,t,i){o.superclass.constructor.apply(this,arguments);this._showLegendChb=null;this._fontPicker=null;this._showLegendTitleChb=null;this._titleFontPicker=null;this._createChildren();this._legendPosition="right"};i.extend(o,s);o.prototype._createChildren=function(){var i=this._initialProperties();if(i){this._legendPosition=i["legendGroup.layout.position"];var s=$(document.createElement("div")).appendTo(this._dom$);s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item");var o=i["legend.visible"]!==false;var a=this._showLegendChb=new sap.ui.commons.CheckBox({text:t.get("PROPERTY_EDITOR_SHOW_LEGEND"),checked:o,change:$.proxy(function(e){this._showLegend(e.getParameters().checked)},this)});a.placeAt(s);s=this._fontPicker$=$(document.createElement("div")).appendTo(this._dom$);s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._fontPicker=new n(s.get(0),{fontFamily:i["fontFamily"],fontSize:i["fontSize"],fontWeight:i["fontWeight"],fontColor:i["fontColor"],fontStyle:i["fontStyle"]});this._fontPicker.addEventListener(r.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);this._fontPicker.visible(o);s=this._showLegendTitle$=$(document.createElement("div")).appendTo(this._dom$);s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent1");var l=i["legend.title.visible"]!==false;a=this._showLegendTitleChb=new sap.ui.commons.CheckBox({text:t.get("PROPERTY_EDITOR_SHOW_LEGEND_TITLE"),checked:l,change:$.proxy(function(e){this._showLegendTitle(e.getParameters().checked)},this)});a.setVisible(o);a.placeAt(s);s=this._titleFontPicker$=$(document.createElement("div")).appendTo(this._dom$);s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent2");this._titleFontPicker=new n(s.get(0),{fontFamily:i["title-fontFamily"],fontSize:i["title-fontSize"],fontWeight:i["title-fontWeight"],fontColor:i["title-fontColor"],fontStyle:i["title-fontStyle"]});this._titleFontPicker.addEventListener(r.PICKED_ITEM_CHANGED,this._titleFontPickerChangedHandler,this);this._titleFontPicker.visible(o&&i["legend.title.visible"]!==false)}};o.prototype._initialProperties=function(){var e={"legendGroup.layout.position":true,"legend.visible":true,fontFamily:true,fontSize:true,fontWeight:true,fontColor:true,fontStyle:true,"legend.title.visible":true,"title-fontFamily":true,"title-fontSize":true,"title-fontWeight":true,"title-fontColor":true,"title-fontStyle":true};return this._queryProperties(e)};o.prototype._showLegend=function(e){if(e){this._fontPicker$.show();this._showLegendTitle$.show()}else{this._fontPicker$.hide();this._showLegendTitle$.hide()}this._showLegendTitleChb.setVisible(e);this._titleFontPicker.visible(e&&this._showLegendTitleChb.getChecked());var t={"legend.visible":e};if(e){if(this._legendPosition=="right"||this._legendPosition=="left"){t["legendGroup.layout.maxWidth"]=.2;t["legendGroup.layout.maxHeight"]=null}else{t["legendGroup.layout.maxWidth"]=null;t["legendGroup.layout.maxHeight"]=.2}}else{if(this._legendPosition=="right"||this._legendPosition=="left"){t["legendGroup.layout.maxWidth"]=0;t["legendGroup.layout.maxHeight"]=null}else{t["legendGroup.layout.maxWidth"]=null;t["legendGroup.layout.maxHeight"]=0}}this._updateProperties(t)};o.prototype._showLegendTitle=function(e){e?this._titleFontPicker$.show():this._titleFontPicker$.hide();this._updateProperties({"legend.title.visible":e})};o.prototype._fontPickerChangedHandler=function(e){this._updateProperties(e.data.changedItem)};o.prototype._titleFontPickerChangedHandler=function(e){var t={};var i=e.data.changedItem;if(i.fontFamily){t["title-fontFamily"]=i["fontFamily"]}if(i.fontSize){t["title-fontSize"]=i["fontSize"]}if(i.fontWeight){t["title-fontWeight"]=i["fontWeight"]}if(i.fontColor){t["title-fontColor"]=i["fontColor"]}if(i.fontStyle){t["title-fontStyle"]=i["fontStyle"]}this._updateProperties(t)};return o});e("sap/viz/controls/propertyeditor/sections/views/ValueAxisView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/SwitchPicker","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/constants/ChartConst"],function(e,t,i,r,n,s,o,a,l,c){var p=function(e,t,i,r){p.superclass.constructor.apply(this,arguments);this._valueAxisScaleEditor=null;this._axisLineVisible=null;this._axisLabelVisible=null;this._axisLabelFont=null;this._axisTitleVisible=true;this._axisName=a.getValueAxis(this._vizProxy.getType())[0];this._axisVisibleProperty="valueAxis.visible";var n=a.getDirection(l.getVizType(this._vizProxy.getType()));if(n===c.DIRECTION_VERTICAL){this._axisSizeProperty="valueAxis.layout.maxWidth"}else{this._axisSizeProperty="valueAxis.layout.maxHeight"}this._axisLineVisibleProperty="valueAxis.axisLine.visible";this._axisTitleVisibleProperty="valueAxis.title.visible";this._axisLabelVisibleProperty="valueAxis.label.visible";this._axisTickVisibleProperty="valueAxis.axisTick.visible";this._axisDefaultSize=.15;this._valueScaleMaxProperty="plotArea.primaryScale.maxValue";this._valueScaleMinProperty="plotArea.primaryScale.minValue";this._valueScaleAutoMaxProperty="plotArea.primaryScale.autoMaxValue";this._valueScaleAutoMinProperty="plotArea.primaryScale.autoMinValue";this._valueScaleFixedRangeProperty="plotArea.primaryScale.fixedRange";this._createChildren()};e.extend(p,r);p.prototype.destroy=function(){p.superclass.destroy.apply(this,arguments);if(this._valueScaleSlider){this._valueScaleSlider.destroy()}this._valueScaleSlider=null};p.prototype._createChildren=function(){var e=this._initialProperties();if(e){var r=this;this._axisTitleVisible=e[this._axisTitleVisibleProperty];var n=$(document.createElement("div")).appendTo(this._dom$);n.addClass(t.PROPERTYEDITOR_PREFIX+"view-item");var a=this._axisLineVisible=new sap.ui.commons.CheckBox({text:i.get("PROPERTY_EDITOR_SHOW_AXIS_LINE"),checked:e[this._axisLineVisibleProperty],change:$.proxy(function(e){r._showLineTick(e.getParameters().checked)},this)});a.placeAt(n);n=$(document.createElement("div")).appendTo(this._dom$);n.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");var l=e[this._axisLabelVisibleProperty];var a=this._axisLabelVisible=new sap.ui.commons.CheckBox({text:i.get("PROPERTY_EDITOR_SHOW_AXIS_LABEL"),checked:l,change:$.proxy(function(e){r._showLabel(e.getParameters().checked)},this)});a.placeAt(n);n=$(document.createElement("div")).appendTo(this._dom$);n.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent1");var c=this._axisLabelFont=new s(n.get(0),{fontFamily:e["fontFamily"],fontSize:e["fontSize"],fontWeight:e["fontWeight"],fontColor:e["fontColor"],fontStyle:e["fontStyle"]});c.addEventListener(o.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);c.visible(l);var p=this._createItemRow(2,t.PROPERTYEDITOR_PREFIX+"view-item").css({height:"auto"});var h=$(document.createElement("div")).appendTo(this._dom$).addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap");var d=new sap.ui.commons.Label({text:i.get("PROPERTY_EDITOR_AXIS_VALUE_SCALE")});d.placeAt(p.children()[0]);var u=this._queryProperty(this._valueScaleFixedRangeProperty);var _=this._getFixedValueScale();var v=this._getAutoValueScale();var f,m;if(u&&_.max!==null){f=_.max}else{f=v.max}if(u&&_.min!==null){m=_.min}else{m=v.min}var g=f/v.max;g=Math.max(1,Math.min(g,2));var E=$(document.createElement("div")).appendTo(this._dom$).addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell");this._valueScaleSlider=new sap.ui.commons.Slider({max:2,min:1,smallStepWidth:.01,value:g,width:"154px",liveChange:$.proxy(function(e){r._valueScaleSliderChangedHandler(e)},r)});this._valueScaleSlider.placeAt($(p.children()[1]).addClass(t.PROPERTYEDITOR_PREFIX+"views-slider-container"))}};p.prototype._createItemRow=function(e,i){var r,n,s;n=$("<div/>");if(i){n.addClass(i)}for(r=0;r<e;r++){s=$("<div/>");if(r===0){s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(n)}n.appendTo(this._dom$);return n};p.prototype._valueScaleSliderChangedHandler=function(e){var t=parseFloat(e.oSource.getValue());var i={};var r=this._getAutoValueScale();i[this._valueScaleMaxProperty]=Math.round(r.max*t*100)/100;if(r.max*r.min<0){i[this._valueScaleMinProperty]=Math.round(r.min*t*100)/100}i[this._valueScaleFixedRangeProperty]=true;this._updateProperties(i)};p.prototype._getAutoValueScale=function(){var e=this._queryProperty(this._valueScaleAutoMaxProperty);var t=this._queryProperty(this._valueScaleAutoMinProperty);return{max:e,min:t}};p.prototype._getFixedValueScale=function(){var e=this._queryProperty(this._valueScaleMaxProperty);var t=this._queryProperty(this._valueScaleMinProperty);return{max:e,min:t}};p.prototype._initialProperties=function(){var e={"plotArea.primaryScale.maxValue":true};e[this._axisLineVisibleProperty]=true;e[this._axisTitleVisibleProperty]=true;e[this._axisLabelVisibleProperty]=true;e[this._axisTickVisibleProperty]=true;e["fontFamily"]=true;e["fontSize"]=true;e["fontWeight"]=true;e["fontColor"]=true;e["fontStyle"]=true;return this._queryProperties(e)};p.prototype._showLineTick=function(e){var t={};t[this._axisLineVisibleProperty]=e;t[this._axisTickVisibleProperty]=e;this._updateProperties(t)};p.prototype._showLabel=function(e){this._axisLabelFont.visible(e);if(e){this._axisLabelFont._dom$.show()}else{this._axisLabelFont._dom$.hide()}var t={};t[this._axisLabelVisibleProperty]=e;this._updateProperties(t)};p.prototype._fontPickerChangedHandler=function(e){var t=e.data.changedItem;this._updateProperties(t)};p.prototype._mergeLayoutProperties=function(e,t){if(e&&t){for(var i in t){e[i]=t[i]}}};return p});e("sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/propertyeditor/pickers/IconPicker","sap/viz/controls/propertyeditor/utils/PropertyUtil","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/sections/helpers/ViewHelperBase","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/constants/ChartConst"],function(e,t,i,r,n,s,o,a,l,c,p){var h=function(e,t){h.superclass.constructor.apply(this,arguments);this._createChildren()};var d=1.2;i.extend(h,l);h.prototype._createChildren=function(){var i=this._initProperties();if(i){if(this._config.showDataLabel===true){var l=$(document.createElement("div")).appendTo(this._target.dom$);l.addClass(e.PROPERTYEDITOR_PREFIX+"view-item");var c=i["textVisible"];var p=i["dataLabelVisible"];var h=c===undefined?p:c;h=o.propertyToToggle(h);this._showDataLabel=new sap.ui.commons.TriStateCheckBox({text:t.get("PROPERTY_EDITOR_SHOW_DATA_LABEL")});this._showDataLabel.toggle(h);this._showDataLabel.placeAt(l);this._showDataLabel.attachChange($.proxy(this._showDataLabelChangedHandler,this));var d=this._fontPicker$=$(document.createElement("div")).appendTo(this._target.dom$);d.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._fontPicker=new n(d.get(0),{fontFamily:i["fontFamily"],fontSize:i["fontSize"],fontWeight:i["fontWeight"],fontColor:i["fontColor"],fontStyle:i["fontStyle"]});this._fontPicker.addEventListener(a.PICKED_ITEM_CHANGED,this._fontPickerChangedHandler,this);this._showFontPicker(h!=="Unchecked")}if(this._config.showDataLabelImage===true){var u=$(document.createElement("div")).appendTo(this._target.dom$);u.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");var _=i["iconVisible"];_=o.propertyToToggle(_);this._showDataLabelImage=new sap.ui.commons.TriStateCheckBox({text:t.get("PROPERTY_EDITOR_SHOW_DATA_LABEL_IMAGE")});this._showDataLabelImage.toggle(_);this._showDataLabelImage.placeAt(u);this._showDataLabelImage.attachChange($.proxy(this._showDataLabelImageChangedHandler,this));var v=this._createItemRow(2,e.PROPERTYEDITOR_PREFIX+"view-item-indent1");this._imageIconAndColor$=v;var f=$(v.children()[0]);var m=i["iconSVG"];var g=i["iconColor"];this._imageIcon=new s(f,m,{icons:this._target.view._uiConfig.icons});this._imageIcon.addEventListener(a.PICKED_ITEM_CHANGED,this._imageIconChangedHandler,this);var E=$(v.children()[1]);this._imageColor=new r(E,g,{mode:"fill"});this._imageColor.addEventListener(a.PICKED_ITEM_CHANGED,this._imageColorChangedHandler,this);var y=this._imageSize$=$(document.createElement("div"));y.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-indent1").css({height:"auto"});y.appendTo(this._target.dom$);var I=$(document.createElement("div"));I.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");I.appendTo(y);var C=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_DATA_LABEL_IMAGE_SIZE")});C.placeAt(I);var T=$(document.createElement("div")).appendTo(y);T.addClass(e.PROPERTYEDITOR_PREFIX+"views-slider-container");var A=i["iconSize"]!==undefined&&i["iconSize"]!==null?i["iconSize"]:.8;this._imageSizeSlider=new sap.ui.commons.Slider({max:1,min:0,smallStepWidth:.01,value:A,width:"154px",liveChange:$.proxy(function(e){this._imageSizeSliderChangedHandler(e)},this)});this._imageSizeSlider.placeAt(T);this._showImagePickers(_!=="Unchecked")}if(i.textVisible===undefined||i.iconVisible===undefined){var P=this._getPickerProps(["showDataLabel","fontPicker","showDataLabelImage","imageIcon","imageColor","imageSizeSlider"]);this._target.updateProperties(P)}}};h.prototype._initProperties=function(){var e={dataLabelVisible:true,textVisible:true,fontFamily:true,fontSize:true,fontWeight:true,fontColor:true,fontStyle:true,iconVisible:true,iconSVG:true,iconColor:true,iconSize:true};return this._target.queryProperties(e)};h.prototype._createItemRow=function(t,i){var r=$(document.createElement("div"));if(i){r.addClass(i)}for(var n=0;n<t;n++){var s=$(document.createElement("div"));if(n===0){s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(r)}r.appendTo(this._target.dom$);return r};h.prototype._addItemToComboBox=function(e,t){for(var i in t){e.addItem(new sap.ui.core.ListItem({key:t[i].key,text:t[i].text}))}};h.prototype._getPickerProps=function(e){var t={};for(var i in e){switch(e[i]){case"showDataLabel":if(this._showDataLabel){if(this._showDataLabel.getSelectionState()==="Checked"){t["textVisible"]=true}else if(this._showDataLabel.getSelectionState()==="Unchecked"){t["textVisible"]=false}}break;case"fontPicker":if(this._fontPicker){t["fontFamily"]=this._fontPicker.pickedItem()["fontFamily"];t["fontSize"]=this._fontPicker.pickedItem()["fontSize"];t["fontWeight"]=this._fontPicker.pickedItem()["fontWeight"];t["fontColor"]=this._fontPicker.pickedItem()["fontColor"];t["fontStyle"]=this._fontPicker.pickedItem()["fontStyle"]}break;case"showDataLabelImage":if(this._showDataLabelImage){if(this._showDataLabelImage.getSelectionState()==="Checked"){t["iconVisible"]=true}else if(this._showDataLabelImage.getSelectionState()==="Unchecked"){t["iconVisible"]=false}}break;case"imageIcon":if(this._imageIcon){t["iconSVG"]=this._imageIcon.icon()}break;case"imageColor":if(this._imageColor){t["iconColor"]=this._imageColor.pickedItem()}break;case"imageSizeSlider":if(this._imageSizeSlider){t["iconSize"]=this._imageSizeSlider.getValue()}break}}return t};h.prototype._showFontPicker=function(e){if(this._fontPicker$){e!==false?this._fontPicker$.show():this._fontPicker$.hide()}};h.prototype._showImagePickers=function(e){if(this._imageIconAndColor$){e?this._imageIconAndColor$.show():this._imageIconAndColor$.hide()}if(this._imageSize$){e?this._imageSize$.show():this._imageSize$.hide()}};h.prototype._updateDataLabelVisible=function(e){if(e["textVisible"]!==false||e["iconVisible"]!==false){e["dataLabelVisible"]=true}else if(this._target.view._isAllSelected()){e["dataLabelVisible"]=false}};h.prototype._showDataLabelChangedHandler=function(e){var t=this._getPickerProps(["showDataLabel","fontPicker","showDataLabelImage"]);this._updateDataLabelVisible(t);this._showFontPicker(t["textVisible"]===true);this._mergeRangeProperties(t,this._getRangeProperties());this._target.updateProperties(t)};h.prototype._fontPickerChangedHandler=function(e){var t=this._getPickerProps(["fontPicker"]);var i=e.data.changedItem;for(var r in i){if(i[r]){t[r]=i[r]}}this._target.updateProperties(t)};h.prototype._showDataLabelImageChangedHandler=function(e){var t=this._getPickerProps(["showDataLabel","showDataLabelImage","imageIcon","imageColor","imageSizeSlider"]);this._updateDataLabelVisible(t);this._showImagePickers(t["iconVisible"]===true);this._mergeRangeProperties(t,this._getRangeProperties());this._target.updateProperties(t)};h.prototype._imageIconChangedHandler=function(e){var t=this._getPickerProps(["imageIcon"]);t["iconSVG"]=e.data.pickedItem;this._target.updateProperties(t)};h.prototype._imageColorChangedHandler=function(e){var t=this._getPickerProps(["imageColor"]);t["iconColor"]=e.data.pickedItem;this._target.updateProperties(t)};h.prototype._imageSizeSliderChangedHandler=function(e){var t=this._getPickerProps(["imageSizeSlider"]);t["iconSize"]=e.oSource.getValue();this._mergeRangeProperties(t,this._getRangeProperties());this._target.updateProperties(t,false,true)};h.prototype.destroy=function(){if(this._imageSizeSlider){this._imageSizeSlider.destroy()}this._imageSizeSlider=null};h.prototype._getRangeProperties=function(){var e=this._getPickerProps(["showDataLabel","showDataLabelImage"]);var t=c.getVizType(this._target.proxy.getType());if(!this._target.queryProperty("plotArea.primaryScale.fixedRange")){if(p.TYPE_BAR===t){return this._getValueRange(e.textVisible===true||e.iconVisible===true)}else if(p.TYPE_COLUMN===t){return this._getValueRange(e.iconVisible===true)}}};h.prototype._getValueRange=function(e){if(e){var t={};var i=this._target.queryProperty("plotArea.primaryScale.autoMaxValue");var r=this._target.queryProperty("plotArea.primaryScale.autoMinValue");t["plotArea.primaryScale.maxValue"]=parseFloat(i*d);if(i*r<0){t["plotArea.primaryScale.minValue"]=parseFloat(r*d)}t["plotArea.primaryScale.fixedRange"]=true;return t}};h.prototype._mergeRangeProperties=function(e,t){if(e&&t){for(var i in t){e[i]=t[i]}}};return h});e("sap/viz/controls/propertyeditor/sections/views/ColumnDataLabelView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren()};e.extend(r,t);r.prototype.destroy=function(){r.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy()}this._helper=null};r.prototype._createChildren=function(){this._helper=this._createHelper(i,{showDataLabel:true,showDataLabelImage:true})};return r});e("sap/viz/controls/propertyeditor/pickers/ShapePicker",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/helpers/ObjectHelper","sap/viz/controls/propertyeditor/helpers/SVGHelper","sap/viz/controls/propertyeditor/pickers/PickerBase"],function(e,t,i,r,n,s){var o=function(t,i,r){o.superclass.constructor.apply(this,arguments);r=this._config||{};this._icons=r.icons||[];this._defaultIcon=null;this._iconMap={};this._parseIconMap();this._pickedItem={icon:i?i.icon:undefined,color:i?i.color:undefined};if(this._pickedItem.icon===null){this._icon=null}else{this._icon=this._pickedItem.icon?this._pickedItem.icon:this._defaultIcon}this._color=this._pickedItem.color?this._pickedItem.color:c;this._createChildren();this._list$=null;this._container$=null;this._resizeHandler=null;this._mdHandler=e.proxy(this._mousedownHandler,this)};i.extend(o,s);var a=t.PROPERTYEDITOR_PREFIX+"iconpicker-";var l=t.COMMON_PREFIX;var c="rgba(0,0,0,1)";var p=[{type:"shape",id:"rectangle",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<rect x="272" y="6" fill="#F05B26" width="100%" height="100%"/></svg>'},{type:"shape",id:"trapezoid",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="272,6 272,96.197 879.811,96.197 789.666,6 "/></svg>'},{type:"shape",id:"triangle",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="0 0 622 104" enable-background="new 0 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="7,96.196 7,6 614.811,51.098 "/></svg>'},{type:"shape",id:"pike",svg:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"'+'width="100%" height="100%" viewBox="265 0 622 104" enable-background="new 265 0 622 104" xml:space="preserve">'+'<polygon fill="#F05B26" points="789.666,6 272,6 272,96.195 789.666,96.195 879.811,51.098 "/></svg>'}];o.prototype._createChildren=function(){this._container$=e(document.createElement("div")).appendTo(this._dom$);this._container$.addClass("sapUiTfBrd sapUiTfStd  sapUiTfCombo "+a+"container");this._icon$=e(document.createElement("div")).appendTo(this._container$);this._icon$.addClass(a+"icon");this._arrow$=e(document.createElement("div")).appendTo(this._container$);this._arrow$.addClass("sapUiTfComboIcon");this._arrow$.click(e.proxy(this._arrowClickHandler,this));this._applyIcon()};o.prototype._parseIconMap=function(){var e,t;var i=this._icons=p.concat(this._icons);if(i.length){for(e=0;e<i.length;e++){t=i[e];this._iconMap[t.id]=t}if(i[0].type==="shape"){this._defaultIcon={type:"shape",value:i[0].id}}else{this._defaultIcon={type:"svg",value:i[0].svg}}}};o.prototype.icon=function(e){if(arguments.length>0){if(this._icon!==e){this._icon=e;this._applyIcon();this._changePickedItem(this._icon)}return this}else{return this._icon}};o.prototype._applyIcon=function(){if(this.icon()){var e=this.icon().type==="shape"?this._iconMap[this.icon().value].svg:this.icon().value;this._icon$[0].innerHTML=e;var t=this._icon$.children().get(0);if(!t.getAttribute("viewBox")){var i=t.getBBox();t.setAttribute("viewBox",[i.x,i.y,i.width,i.height].join(" "))}if(this.icon().type==="shape"){r.setSVGColor(this._icon$[0],this.color())}else{t.setAttribute("fill",this.color())}}};o.prototype.color=function(e){if(arguments.length>0){this._color=e;this._applyColor();return this}else{return this._color}};o.prototype._applyColor=function(){if(this.color()){e("svg",this._dom$).each(e.proxy(function(e,t){n.setColor(t,this.color())},this))}};o.prototype._createIconList=function(){this._list$=e(document.createElement("div")).appendTo(e("body"));this._list$.addClass(a+"list");this._locate();var t=e(document.createElement("div")).appendTo(this._list$);var i,n,s,o,l,p,h,d,u;for(i=0;i<this._icons.length;i++){s=this._icons[i];n=s.id;o=s.svg;u=e(document.createElement("div")).appendTo(t);u.addClass(a+"list-cell");if(s.type==="shape"){p={type:"shape",value:n}}else{p={type:"svg",value:o}}u.data("icon",p);d=e(document.createElement("div")).appendTo(u);d[0].innerHTML=o;o=d.children().get(0);if(!o.getAttribute("viewBox")){var _=o.getBBox();o.setAttribute("viewBox",[_.x,_.y,_.width,_.height].join(" "))}d.addClass(a+"list-icon");l=this.color()?this.color():c;if(s.type==="shape"){r.setSVGColor(d[0],l)}else{o.setAttribute("fill",l)}u.click(e.proxy(this._iconListClickHandler,this))}this._addEventListeners();e(document).on("mousedown",this._mdHandler);e(window).on("blur",this._mdHandler)};o.prototype._locate=function(){if(!!this._list$){var e;if(!!this._container$){e=this._container$.offset()}else{e=this._dom$.children().offset()}this._list$.css({position:"absolute",top:e.top+2,left:e.left})}};o.prototype._resizer=function(t){if(!t.data.invalidateSize){setTimeout(e.proxy(function(){t.data.invalidateSize=false;this._locate()},this),1e3/24)}t.data.invalidateSize=true};o.prototype._addEventListeners=function(){this._resizeHandler=e.proxy(this._resizer,this);e(window).resize({invalidateSize:false},this._resizeHandler)};o.prototype._iconListClickHandler=function(t){var i=e(t.currentTarget);var r=i.data("icon");this.icon(r);this._destroyList()};o.prototype._arrowClickHandler=function(e){if(this._list$!==null){this._destroyList();return}this._createIconList()};o.prototype._destroyList=function(){e(document).off("mousedown",this._mdHandler);e(window).off("blur",this._mdHandler);e(window).off("resize",this._resizeHandler);this._list$.empty().detach();this._list$=null};o.prototype._mousedownHandler=function(t){if(this._list$!==null&&this._list$.css("visibility")=="visible"&&e(t.target).closest(this._list$).length<=0&&t.target!==this._arrow$[0]){this._destroyList()}};return o});e("sap/viz/controls/propertyeditor/sections/views/ColumnDataPointView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/ShapePicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s,o){var a=function(){a.superclass.constructor.apply(this,arguments);this._defaultShapeFill=null;this._createChildren()};i.extend(a,r);a.prototype._createChildren=function(){var i=this._initialProperties();if(i){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext("color")}var r=this._createItemRow(3,e.PROPERTYEDITOR_PREFIX+"view-item");var a=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_SHAPE_STYLE")});a.placeAt($(r.children()[0]));var l;if(i.dataPointShape===null){l=null}else{l={};l.type=i.dataPointShape?i.dataPointShape.type:"shape";l.value=i.dataPointShape?i.dataPointShape.value:"rectangle"}var c;if(i.lineFill===null){c=null}else{c=i.dataPointShapeFill?i.dataPointShapeFill:this._defaultShapeFill}var p={icon:l};this._shapePicker=new s($(r.children()[1]),p,{icons:this._uiConfig.icons});var h=c;this._colorPicker=new n($(r.children()[2]),h,{mode:"fill"});this._shapePicker.addEventListener(o.PICKED_ITEM_CHANGED,this._shapeChangedHandler,this);this._colorPicker.addEventListener(o.PICKED_ITEM_CHANGED,this._colorChangedHandler,this);r.children()[0].insertAdjacentHTML("afterEnd","<br>")}};a.prototype._createItemRow=function(t,i){var r,n,s;n=$(document.createElement("div"));if(i){n.addClass(i)}for(r=0;r<t;r++){s=$(document.createElement("div")).addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell");s.appendTo(n)}n.appendTo(this._dom$);return n};a.prototype._initialProperties=function(){var e={dataPointShape:true,dataPointShapeFill:true};return this._queryProperties(e)};a.prototype._shapeChangedHandler=function(e){var t=e.data.pickedItem;var i={dataPointShape:t};this._updateProperties(i)};a.prototype._colorChangedHandler=function(e){var t=e.data.pickedItem;var i={dataPointShapeFill:t};this._updateProperties(i)};return a});e("sap/viz/controls/propertyeditor/sections/views/ColumnSeriesView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/ShapePicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/common/property/VizPropertyZone"],function(e,t,i,r,n,s,o,a,l,c){var p=function(){p.superclass.constructor.apply(this,arguments);this._defaultShapeFill=null;if(this._isSeries()){this._createChildrenForSeries()}else{this._createChildrenForDataPoint()}};i.extend(p,s);p.prototype._isSeries=function(){var e=true;var t=this._propertyZones;t.forEach(function(t){if(!t.seriesContext()){e=false;return}});return e};p.prototype._createChildrenForSeries=function(){var i=this._initialProperties();if(i){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext("color")}var n;if(i.lineFill===null){n=null}else{n=i.dataPointShapeFill?i.dataPointShapeFill:this._defaultShapeFill}var s=this._createItemRow(1,e.PROPERTYEDITOR_PREFIX+"view-item");this._seriesItems=this._createSeriesItems();var a=this._genSeriesListItems(this._seriesItems);var c=this._genSelectedSeriesItem();var p=new sap.ui.commons.DropdownBox({width:"76px",selectedKey:Object.keys(c).length==1?Object.keys(c)[0]:null,items:a,change:$.proxy(this._seriesDropdownChangedHandler,this)}).placeAt($(s.children()[0]));if(Object.keys(c).length!=1){r.defer(function(){sap.ui.commons.TextField.prototype.setValue.apply(p,[" "])})}s=this._createItemRow(2,e.PROPERTYEDITOR_PREFIX+"view-item");var h=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_COLOR")}).placeAt($(s.children()[0]));this._colorPicker=new o($(s.children()[1]),n,{mode:"fill"});this._colorPicker.addEventListener(l.PICKED_ITEM_CHANGED,this._colorPickerChangedHandler,this)}};p.prototype._createChildrenForDataPoint=function(){var i=this._initialProperties();if(i){var r=this._createItemRow(3,e.PROPERTYEDITOR_PREFIX+"view-item");var n=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_SHAPE_STYLE")});n.placeAt($(r.children()[0]));var s;if(i.stackShape===null){s=null}else{s={};s.type=i.stackShape?i.stackShape.type:"shape";s.value=i.stackShape?i.stackShape.value:"rectangle"}var o={icon:s};this._shapePicker=new a($(r.children()[1]),o,{icons:this._uiConfig.icons});this._shapePicker.addEventListener(l.PICKED_ITEM_CHANGED,this._shapeChangedHandler,this);var c=new sap.ui.commons.Button({press:$.proxy(this._btnPress,this)});c.placeAt(r.children()[2]);$(r.children()[2]).addClass(e.PROPERTYEDITOR_PREFIX+"rotatebutton-container");r.children()[0].insertAdjacentHTML("afterEnd","<br>")}};p.prototype._createItemRow=function(t,i){var r=$(document.createElement("div"));if(i){r.addClass(i)}for(var n=0;n<t;n++){var s=$(document.createElement("div"));if(n===0){s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(r)}r.appendTo(this._dom$);return r};p.prototype._initialProperties=function(){var e={stackShape:true,dataPointShapeFill:true};return this._queryProperties(e)};p.prototype._shapeChangedHandler=function(e){var t=e.data.pickedItem;var i={stackShape:t};this._updateProperties(i)};p.prototype._btnPress=function(){};p.prototype._seriesDropdownChangedHandler=function(e){var t=e.oSource.getSelectedKey();var i=c.DATA_POINT;var r=this._propertyZones[0];var n=this._seriesItems[t]["seriesData"];r.context(n);this._vizProxy.setPropertyZones([r]);var s=this._initialProperties();if(s){if(!this._isAllSelected()){this._defaultShapeFill=this._getExtraContext("color")}var o;if(s.lineFill===null){o=null}else{o=s.dataPointShapeFill?s.dataPointShapeFill:this._defaultShapeFill}}this._colorPicker.updateColor(o)};p.prototype._colorPickerChangedHandler=function(e){var t=e.data.pickedItem;var i={dataPointShapeFill:t};this._updateProperties(i)};p.prototype._createSeriesItems=function(){var e=this._vizProxy.getVizFeeding();var t=this._vizProxy.getDataset().table();var i=n.buildInfoSeries(e,t);return i};p.prototype._genSeriesListItems=function(e){var t=[];for(item in e){t.push(new sap.ui.core.ListItem({key:e[item].name,text:e[item].name}))}return t};p.prototype._genSelectedSeriesItem=function(){var e=this._vizProxy.getVizFeeding();var t=[];this._propertyZones.forEach(function(e){t.push(e.context())});return n.buildInfoSeries(e,t)};return p});e("sap/viz/controls/propertyeditor/sections/views/DonutDataLabelView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren()};e.extend(r,t);r.prototype.destroy=function(){r.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy()}this._helper=null};r.prototype._createChildren=function(){this._helper=this._createHelper(i,{showDataLabel:true})};return r});e("sap/viz/controls/propertyeditor/sections/views/DonutGetPropertiesByCtx",[],function(){function e(e,t){var i=Object.keys(e),r=Object.keys(t);return i.length>0&&i.every(function(i){return e[i]===t[i]})}function t(t,i){if(!t){return false}if(!Array.isArray(t)){t=[t]}return t.some(function(t){if(!t){return true}return e(t,i)})}function i(e,t){var i;for(var r in e){if(!i){i={}}var n=true;for(var s=0;s<t.length;s++){if(r===t[s]){t.splice(s,1);n=false;break}}if(!n){continue}i[r]=e[r]}return i}return function(e,i){var r=e.ctx;if(!Array.isArray(i)){i=[i]}var n;for(var s=0,o=i.length;s<o;s++){var a=i[s],l=a.ctx,c=a.paras;if(!l){n=c}}var c=this._parameters,p,h=-1,d,u;for(var s=0,o=i.length;s<o;s++){var a=i[s],l=a.ctx,c=a.paras;if(!l){u=s}else if(t(l,r)){d=0;for(var _ in l){d++}if(h<d){h=d;u=s}}}if(i[u]){return i[u].paras}return n}});e("sap/viz/controls/propertyeditor/sections/views/DonutDataPointView",["sap/viz/controls/propertyeditor/sections/views/DonutGetPropertiesByCtx","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ShapePicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/FontPicker","sap/viz/controls/common/property/VizPropertyZone"],function(e,t,i,r,n,s,o,a,l,c,p){var h=function(e,t,i,r){h.superclass.constructor.apply(this,arguments);this._createChildren()};r.extend(h,s);h.prototype._createChildren=function(){var r=this._properties=this._initialProperties();if(r){var s=this._propertyZones[0].context();this._selectedIndex=null;if(s){this._selectedIndex=s._id}var o=-1;var c=this._vizProxy.getDataset();if(r["plotArea.highlight.highlightContext"]&&r["plotArea.highlight.highlightContext"].length>0){o=this._getHighlightContextIndex(r["plotArea.highlight.highlightContext"][0],c.table())}if(this._selectedIndex===null){if(o>-1){this._selectedIndex=o}else{this._selectedIndex=0}var h=c.table()[this._selectedIndex];var s=n.clone(h);s._id=s._contextId;delete s._contextId;this._vizProxy.setPropertyZones([new p(p.DATA_POINT,s)])}var d=this._container$=$(document.createElement("div")).appendTo(this._dom$);var u=$(document.createElement("div")).appendTo(d);u.addClass(t.PROPERTYEDITOR_PREFIX+"view-item "+t.PROPERTYEDITOR_PREFIX+"slicestyle");var _=$(document.createElement("div")).appendTo(u);_.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");var v=new sap.ui.commons.Label({text:i.get("PROPERTY_EDITOR_DONUT_DATA_POINT_SLICE_COLOR")});v.placeAt(_);var f=$(document.createElement("div")).appendTo(u);f.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");var m=null;if(this._propertyZones&&this._propertyZones.length===1){var g=this._propertyZones[0];var E=g.extraContext();if(E&&E.hasOwnProperty("color")){m=E.color}else{m=r["plotArea.colorPalette"][this._selectedIndex];var y=r["plotArea.highlight.contextInfos"];this._setDefaultSelectedContext(c,this._selectedIndex);if(y&&y.length>0){if(c){if(this._DefaultSelectedContext){var I={ctx:this._DefaultSelectedContext};var C=e(I,y);if(C&&C.color){m=C.color}}}}}}var T=new l(f,this._propertyZones.length>1?this._getMultiSelectedColor():m,{mode:"fill"});T.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._cpChangedHandler,this),this);var A=$(document.createElement("div"));A.addClass(t.PROPERTYEDITOR_PREFIX+"view-item");A.appendTo(d);var P=this._highLightCB=new sap.ui.commons.CheckBox({text:i.get("PROPERTY_EDITOR_DONUT_DATA_POINT_HIGHLIGHT"),checked:this._selectedIndex===o,change:$.proxy(this._hlBoxChangedHandler,this),enabled:this._vizProxy.getPropertyZones().length==1});P.placeAt(A);this._subContainer$=$(document.createElement("div"));this._subContainer$.appendTo(d);if(P.getChecked()){this._subContainer$.show()}else{this._subContainer$.hide()}this._createSubContainer()}};h.prototype._setDefaultSelectedContext=function(e,t){this._DefaultSelectedContext=null;if(e){var i=e.dimensions();var r=e.table();if(i&&i.length>0&&r&&r.length>0&&t<r.length){var n=r[t];var s={};for(var o=0;o<i.length;o++){var a=i[o];if(a&&n.hasOwnProperty(a)){s[a]=n[a]}}if(s){this._DefaultSelectedContext=s}else{this._DefaultSelectedContext=null}}}};h.prototype._getHighlightContextIndex=function(e,t){if(!e||!t){return-1}var i=-1;if(t&&t.length>0){var r=null;var n=0;for(;n<t.length;n++){var s=true;r=t[n];if(r&&e){for(var o in e){if(e.hasOwnProperty(o)&&r.hasOwnProperty(o)){if(e[o]===r[o]){s=s&&true}else{s=false;break}}else{s=false}}}else{s=false}if(s){i=n;break}}}return i};h.prototype._createSubContainer=function(){if(this._properties){var e=$(document.createElement("div"));e.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent1");e.appendTo(this._subContainer$);var r=new sap.ui.commons.CheckBox({text:i.get("PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_NAME"),checked:this._properties["plotArea.highlight.centerName.visible"],change:$.proxy(this._showNameChangedHandler,this)});r.placeAt(e);var n=this._showNameFontPicker$=$(document.createElement("div"));n.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent2");n.appendTo(this._subContainer$);var s={fontFamily:this._properties["centerName.fontFamily"],fontSize:this._properties["centerName.fontSize"],fontWeight:this._properties["centerName.fontWeight"],fontColor:this._properties["centerName.fontColor"],fontStyle:this._properties["centerName.fontStyle"]};var o=new c(n.get(0),s,{showColorPicker:false});o.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._nameFPChangedHandler,this),this);if(r.getChecked()){this._showNameFontPicker$.show()}else{this._showNameFontPicker$.hide()}var p=$(document.createElement("div"));p.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent1");p.appendTo(this._subContainer$);var h=new sap.ui.commons.CheckBox({text:i.get("PROPERTY_EDITOR_DONUT_DATA_POINT_SHOW_PERCENTAGE"),checked:this._properties["plotArea.highlight.centerValue.visible"],change:$.proxy(this._showPercentChangedHandler,this)});h.placeAt(p);var d=this._showPercentageFontPicker$=$(document.createElement("div"));d.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent2");d.appendTo(this._subContainer$);var u={fontFamily:this._properties["centerValue.fontFamily"],fontSize:this._properties["centerValue.fontSize"],fontWeight:this._properties["centerValue.fontWeight"],fontColor:this._properties["centerValue.fontColor"],fontStyle:this._properties["centerValue.fontStyle"]};var _=new c(d.get(0),u,{showColorPicker:false});_.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._percentFPChangedHandler,this),this);if(h.getChecked()){this._showPercentageFontPicker$.show()}else{this._showPercentageFontPicker$.hide()}var v=$(document.createElement("div"));v.addClass(t.PROPERTYEDITOR_PREFIX+"view-item-indent1").css({height:"auto"});v.appendTo(this._subContainer$);var f=$(document.createElement("div")).addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");f.appendTo(v);var m=new sap.ui.commons.Label({text:i.get("PROPERTY_EDITOR_DONUT_DATA_POINT_OTHER_SLICE_COLOR")});m.placeAt(f);var g=$(document.createElement("div")).addClass(t.PROPERTYEDITOR_PREFIX+"view-item-row");g.appendTo(v);var E=this._properties["plotArea.highlight.unhighlightSliceColor"];var y=new l(g,E,{mode:"fill"});y.addEventListener(a.PICKED_ITEM_CHANGED,$.proxy(this._otherCPChangedHandler,this),this)}};h.prototype._initialProperties=function(){var e={"plotArea.highlight.highlightContext":true,"plotArea.highlight.unhighlightSliceColor":true,"plotArea.highlight.contextInfos":true,"plotArea.highlight.centerName.visible":true,"plotArea.highlight.centerValue.visible":true,"centerName.fontFamily":true,"centerName.fontSize":true,"centerName.fontWeight":true,"centerName.fontStyle":true,"centerValue.fontFamily":true,"centerValue.fontSize":true,"centerValue.fontWeight":true,"centerValue.fontStyle":true};var t=this._queryProperties(e);var i=t["plotArea.colorPalette"]=this._vizProxy.getProperties().plotArea.colorPalette;var r=i.length;var n=this._vizProxy.getDataset().dataInFields().length;if(r<n){for(var s=r;s++;s<n){i[s]=i[s%r]}}return t};h.prototype._updateProperties=function(e){var t=true;h.superclass._updateProperties.apply(this,[e,t])};h.prototype._getMultiSelectedColor=function(){var e=this._propertyZones;var t=null;if(e&&e.length>0&&e[0].extraContext()){var i=e[0].extraContext();if(i&&i.color){t=i.color;for(var r=1;r<e.length;r++){var n=e[r];if(n&&n.extraContext()){var s=n.extraContext().color;if(t!==s){return null}}}}}return t};h.prototype._hlBoxChangedHandler=function(e){var t=this._highLightCB.getChecked();var i=[];if(t){this._subContainer$.show();if(this._propertyZones&&this._propertyZones.length>0&&this._propertyZones[0]&&this._propertyZones[0]._context){var r=this._propertyZones[0]._context;if(r&&r.hasOwnProperty("_id")){i.push(this._propertyZones[0].getDimensionContext())}}else{if(this._DefaultSelectedContext){i.push(this._DefaultSelectedContext)}}}else{this._subContainer$.hide()}var n={"plotArea.highlight.highlightContext":i,"centerName.fontColor":this._properties["plotArea.colorPalette"][this._selectedIndex],"centerValue.fontColor":this._properties["plotArea.colorPalette"][this._selectedIndex]};this._updateProperties(n)};h.prototype._cpChangedHandler=function(t){var i=t.data.pickedItem;var r=this._properties["plotArea.colorPalette"];var n=this._properties["plotArea.highlight.contextInfos"];var s=this._vizProxy.getPropertyZones();if(!n||n&&n.length<1){n=[]}for(var o=0;o<s.length;o++){var a=s[o].context();if(a){var l=a._id;r[l]=i;a=s[o].getDimensionContext();if((a===null||a===undefined)&&this._DefaultSelectedContext!==null){a=this._DefaultSelectedContext}var c={ctx:a};var p=e(c,n);if(p&&p.color){p.color=i}else{if(!n||n.length===0){n=[]}n.push({ctx:a,paras:{color:i}})}}}this._updateProperties({"plotArea.highlight.contextInfos":n,"centerName.fontColor":r[this._selectedIndex],"centerValue.fontColor":r[this._selectedIndex]})};h.prototype._otherCPChangedHandler=function(e){var t=e.data.pickedItem;this._updateProperties({"plotArea.highlight.unhighlightSliceColor":t})};h.prototype._showNameChangedHandler=function(e){if(e.getParameter("checked")){this._showNameFontPicker$.show()}else{this._showNameFontPicker$.hide()}var t={"plotArea.highlight.centerName.visible":e.getParameter("checked"),"centerName.fontColor":this._properties["plotArea.colorPalette"][this._selectedIndex]};this._updateProperties(t)};h.prototype._showPercentChangedHandler=function(e){if(e.getParameter("checked")){this._showPercentageFontPicker$.show()}else{this._showPercentageFontPicker$.hide()}var t={"plotArea.highlight.centerValue.visible":e.getParameter("checked"),"centerValue.fontColor":this._properties["plotArea.colorPalette"][this._selectedIndex]};this._updateProperties(t)};h.prototype._nameFPChangedHandler=function(e){var t=e.data.changedItem;var i={};if(t.hasOwnProperty("fontFamily")){i["centerName.fontFamily"]=t.fontFamily}if(t.hasOwnProperty("fontSize")){i["centerName.fontSize"]=t.fontSize}if(t.hasOwnProperty("fontWeight")){i["centerName.fontWeight"]=t.fontWeight}if(t.hasOwnProperty("fontStyle")){i["centerName.fontStyle"]=t.fontStyle}this._updateProperties(i)};h.prototype._percentFPChangedHandler=function(e){var t=e.data.changedItem;var i={};if(t.hasOwnProperty("fontFamily")){i["centerValue.fontFamily"]=t.fontFamily}if(t.hasOwnProperty("fontSize")){i["centerValue.fontSize"]=t.fontSize}if(t.hasOwnProperty("fontWeight")){i["centerValue.fontWeight"]=t.fontWeight}if(t.hasOwnProperty("fontStyle")){i["centerValue.fontStyle"]=t.fontStyle}this._updateProperties(i)};return h});e("sap/viz/controls/propertyeditor/sections/views/DonutChartAreaView",["sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/spin/Spin","sap/viz/controls/propertyeditor/sections/helpers/ChartAreaViewHelper"],function(e,t,i,r,n,s,o,a){var l=function(e,t,i){l.superclass.constructor.apply(this,arguments);this._innerCircleSlider=null;this._innerCiccleRatioProperty="plotArea.innerRadiusRatio";this._helper=null;this._createChildren()};i.extend(l,r);l.prototype.destroy=function(){l.superclass.destroy.apply(this,arguments);if(this._innerCircleSlider){this._innerCircleSlider.destroy()}this._innerCircleSlider=null};l.prototype._createChildren=function(){this._helper=this._createHelper(a,{});var i=this._initialProperties();var r=$(document.createElement("div")).appendTo(this._dom$);r.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row "+e.PROPERTYEDITOR_PREFIX+"donut-chartarea");var o=$(document.createElement("div")).appendTo(r);o.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");var l=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_BACKGROUND_COLOR")});l.placeAt(o);var c=$(document.createElement("div")).appendTo(r);c.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");var p=this._colorPicker=new n(c,this._queryProperty("fill"),{mode:"fill"});this._colorPicker.addEventListener(s.PICKED_ITEM_CHANGED,this._pickerChangedHandler,this);var h=this._vizProxy.getSize();r=$(document.createElement("div")).appendTo(this._dom$);r.addClass(e.PROPERTYEDITOR_PREFIX+"view-item "+e.PROPERTYEDITOR_PREFIX+"donut-chartarea");o=$(document.createElement("div")).appendTo(r);o.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");l=new sap.ui.commons.Label({text:t.get("PROPERTY_EDITOR_DONUT_INNER_CIRCLE")});l.placeAt(o);var d=$(document.createElement("div")).appendTo(r);d.addClass(e.PROPERTYEDITOR_PREFIX+"view-item-row");var u=this._innerCircleSlider=new sap.ui.commons.Slider({min:0,max:1,value:i[this._innerCiccleRatioProperty],width:"154px",smallStepWidth:.01,liveChange:$.proxy(function(e){this._changeInnerSize(e.getParameters().value)},this)});u.placeAt(d.addClass(e.PROPERTYEDITOR_PREFIX+"views-slider-container"))};l.prototype._initialProperties=function(){var e={};e[this._innerCiccleRatioProperty]=true;return this._queryProperties(e)};l.prototype._pickerChangedHandler=function(e){var t=e.data.pickedItem;var i={fill:t};this._updateProperties(i)};l.prototype._heightChangedHandler=function(e){var t=this._vizProxy.getSize();var i=parseFloat(e.data.value);if(i!=t.height){this._vizProxy.setSize({height:i,width:t.width})}};l.prototype._widthChangedHandler=function(e){var t=this._vizProxy.getSize();var i=parseFloat(e.data.value);if(i!=t.width){this._vizProxy.setSize({height:t.height,width:i})}};l.prototype._propertyChangedHandler=function(e){if(this._heightSpin&&this._widthSpin){var t=this._vizProxy.getSize();if(t.height!=this._heightSpin.getValue()){this._heightSpin.updateUI(t.height)}if(t.width!=this._widthSpin.getValue()){this._widthSpin.updateUI(t.width)}}};l.prototype._changeInnerSize=function(e){var t={};t[this._innerCiccleRatioProperty]=e;this._updateProperties(t)};return l});e("sap/viz/controls/propertyeditor/sections/views/LineDataPointView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/propertyeditor/pickers/SwitchPicker","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/IconPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent"],function(e,t,i,r,n,s,o,a,l,c){var p=function(){p.superclass.constructor.apply(this,arguments);this._dataPointImageProperty="line.iconSVG";this._dataPointImageColorProperty="line.iconColor";this._dataPointSizeProperty="line.iconSize";this._defaultIcon=null;this._defaultIconColor=null;this._dataPointDefaultSize=8;this._icons=this._uiConfig.icons.concat();this._createChildren()};e.extend(p,i);p.prototype.destroy=function(){p.superclass.destroy.apply(this,arguments);if(this._markerSizeSlider){this._markerSizeSlider.destroy()}this._markerSizeSlider=null};p.prototype._createChildren=function(){var e=this._initialProperties();if(e){var i=this._createItemRow(1,r.PROPERTYEDITOR_PREFIX+"view-item");var s=new sap.ui.commons.Label({text:n.get("PROPERTY_EDITOR_MARKER_SHAPE")});s.placeAt($(i.children()[0]));var o=e[this._dataPointImageProperty];var p=e[this._dataPointImageColorProperty];dataPointImageRow$=this._createItemRow(2,r.PROPERTYEDITOR_PREFIX+"view-item-row");var h=null;var d=null;this._setDefaultIcon("circle");if(o===null){h=null}else{h=o?o:this._defaultIcon}if(p===null){d=null}else{if(!this._isAllSelected()){this._defaultIconColor=this._getExtraContext("color")}d=p?p:this._defaultIconColor}this._dataPointImage=new l($(dataPointImageRow$.children()[0]),h,{icons:this._icons});this._dataPointColor=new a($(dataPointImageRow$.children()[1]),d,{mode:"fill"});var u=this._createItemRow(1,r.PROPERTYEDITOR_PREFIX+"view-item");s=new sap.ui.commons.Label({text:n.get("PROPERTY_EDITOR_SIZE_OF_ALL_MARKERS")});s.placeAt($(u.children()[0]));var _=e[this._dataPointSizeProperty];_=_!==undefined&&_!==null?_:this._dataPointDefaultSize;var v=this._createItemRow(1,r.PROPERTYEDITOR_PREFIX+"view-item-row");var f=this._markerSizeSlider=new sap.ui.commons.Slider({min:0,max:100,value:_,width:"154px",smallStepWidth:1,liveChange:$.proxy(function(e){this._changeMarkerSize(e.getParameters().value)},this)});f.placeAt($(v.children()[0]).addClass(r.PROPERTYEDITOR_PREFIX+"views-slider-container"));this._dataPointImage.addEventListener(c.PICKED_ITEM_CHANGED,this._changeDataPointImage,this);this._dataPointColor.addEventListener(c.PICKED_ITEM_CHANGED,this._changeDataPointImageColor,this);if(this._needApplyDefaultMarker()){t.defer($.proxy(function(){this._applyDefaultMarker()},this))}}};p.prototype._createItemRow=function(e,t){var i,n,s;n=$(document.createElement("div"));if(t){n.addClass(t)}for(i=0;i<e;i++){s=$(document.createElement("div"));if(i===0){s.addClass(r.PROPERTYEDITOR_PREFIX+"view-item-cell-wrap")}else{s.addClass(r.PROPERTYEDITOR_PREFIX+"view-item-cell")}s.appendTo(n)}n.appendTo(this._dom$);return n};p.prototype._initialProperties=function(){var e={};e[this._dataPointImageProperty]=true;e[this._dataPointImageColorProperty]=true;e[this._dataPointSizeProperty]=true;return this._queryProperties(e)};p.prototype._needApplyDefaultMarker=function(){var e={};e[this._dataPointImageProperty]=true;var t=this._vizProxy.queryProperties({propertyZones:[new s(this._propertyZones[0].type())],propertyFields:e});return t[this._dataPointImageProperty]===undefined};p.prototype._applyDefaultMarker=function(){var e={};e[this._dataPointImageProperty]=this._defaultIcon;e[this._dataPointSizeProperty]=this._dataPointDefaultSize;this._updateProperties(e,false,true)};p.prototype._changeMarkerSize=function(e){var t={};t[this._dataPointSizeProperty]=e;this._updateProperties(t,false,true)};p.prototype._changeDataPointImage=function(e){var t=e.data.pickedItem;var i={};i[this._dataPointImageProperty]=t;this._updateProperties(i)};p.prototype._changeDataPointImageColor=function(e){var t=e.data.pickedItem;var i={};i[this._dataPointImageColorProperty]=t;this._updateProperties(i)};p.prototype._setDefaultIcon=function(e){var t,i;for(t=0;t<this._icons.length;t++){i=this._icons[t];if(i.id===e){this._defaultIcon=i.svg;break}}if(!this._defaultIcon){this._defaultIcon='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" viewBox="0 0 400.427 400.38" enable-background="new 0 0 400.427 400.38" xml:space="preserve">'+'<circle cx="200.199" cy="200.186" r="200"/></svg>';var r={id:e,svg:this._defaultIcon};this._icons.unshift(r)}};return p});e("sap/viz/controls/propertyeditor/sections/views/LineDataLabelView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren()};e.extend(r,t);r.prototype.destroy=function(){r.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy()}this._helper=null};r.prototype._createChildren=function(){this._helper=this._createHelper(i,{showDataLabel:true})};return r});e("sap/viz/controls/propertyeditor/pickers/LineStylePicker",["jquery","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/helpers/ObjectHelper","sap/viz/controls/propertyeditor/helpers/SVGHelper","sap/viz/controls/propertyeditor/pickers/ShapePicker"],function(e,t,i,r,n,s){var o=function(e,t,i){this._lineStyles=[this._generateLineStyle("1,0"),this._generateLineStyle("2,4"),this._generateLineStyle("6,6")];o.superclass.constructor.apply(this,arguments)};i.extend(o,s);var a=t.PROPERTYEDITOR_PREFIX+"linestylepicker-";o.prototype._generateLineStyle=function(e){var t={};t.type="shape";t.id=e;t.svg='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" '+'width="100%" height="100%" enable-background="new 265 0 622 104" xml:space="preserve">'+'<g style="stroke-width: 2;stroke: F05B26;"><path d="M0 10 80 10" stroke-dasharray="'+e+'"></path></g></svg>';return t};o.prototype._parseIconMap=function(){var e,t;if(this._lineStyles.length){for(e=0;e<this._lineStyles.length;e++){shape=this._lineStyles[e];this._iconMap[shape.id]=shape}this._defaultIcon={type:"shape",value:this._lineStyles[0].id}}};o.prototype._applyIcon=function(){if(this.icon()&&this.color()){var e=this.icon().type==="shape"?this._iconMap[this.icon().value].svg:this.icon().value;this._icon$[0].innerHTML=e;r.setSVGColor(this._icon$[0],this.color())}};o.prototype._createIconList=function(){this._list$=e(document.createElement("div")).appendTo(e("body"));this._list$.addClass(a+"list");this._locate();var t=e(document.createElement("ul")).appendTo(this._list$);var i,n,s,o,l,c;var p={};for(i=0;i<this._lineStyles.length;i++){o=this._lineStyles[i];n=o.id;s=o.svg;if(o.type==="shape"){p={type:"shape",value:n}}else{p={type:"svg",value:s}}l=e(document.createElement("li")).appendTo(t).addClass(a+"list-li");l.data("icon",p);c=e(document.createElement("div")).appendTo(l);c[0].innerHTML=s;c.addClass(a+"list-shape");r.setSVGColor(c[0],this.color());l.click(e.proxy(this._iconListClickHandler,this));if(this._shape===o){l.removeClass(a+"list-li");l.addClass(a+"list-li-selected")}}e(document).on("mousedown",this._mdHandler);e(window).on("blur",this._mdHandler)};return o});e("sap/viz/controls/propertyeditor/sections/views/LineView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/pickers/ColorPicker","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/LineStylePicker","sap/viz/controls/propertyeditor/spin/Spin"],function(e,t,i,r,n,s,o,a){var l=function(){l.superclass.constructor.apply(this,arguments);this._defaultLineFill=null;this._createChildren()};e.extend(l,t);l.prototype._createChildren=function(){var e=this._initialProperties();if(e){if(!this._isAllSelected()){this._defaultLineFill=this._getExtraContext("color")}var t=this._cpContainer$=$(document.createElement("div")).appendTo(this._dom$);t.addClass(i.PROPERTYEDITOR_PREFIX+"view-item "+i.PROPERTYEDITOR_PREFIX+"linestyle");var l=$(document.createElement("div")).appendTo(t);l.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var c=new sap.ui.commons.Label({text:r.get("PROPERTY_EDITOR_LINE_LINE_COLOR")});c.placeAt(l);var p=$(document.createElement("div")).appendTo(t);p.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var h;if(e.lineFill===null){h=null}else{h=e.lineFill?e.lineFill:this._defaultLineFill}this._colorPicker=new n(p,h,{mode:"fill"});this._colorPicker.addEventListener(s.PICKED_ITEM_CHANGED,this._colorChangedHandler,this);var d=this._thicknessContainer$=$(document.createElement("div")).appendTo(this._dom$);d.addClass(i.PROPERTYEDITOR_PREFIX+"view-item "+i.PROPERTYEDITOR_PREFIX+"linestyle");var u=$(document.createElement("div")).appendTo(d);u.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var _=new sap.ui.commons.Label({text:r.get("PROPERTY_EDITOR_LINE_LINE_THICKNESS")});_.placeAt(u);var v;if(e["plotArea.width"]===null){v=null}else if(e["plotArea.width"]===undefined){v=2}else{v=e["plotArea.width"]}var f=$(document.createElement("div")).appendTo(d);var m=new a(f,{min:0,value:v});m.addEventListener("changed",$.proxy(function(e){this._thicknessChangedHandler(e)},this),this);var g=this._lineStyleContainer$=$(document.createElement("div")).appendTo(this._dom$);g.addClass(i.PROPERTYEDITOR_PREFIX+"view-item "+i.PROPERTYEDITOR_PREFIX+"linestyle");var E=$(document.createElement("div")).appendTo(g);E.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var y=new sap.ui.commons.Label({text:r.get("PROPERTY_EDITOR_LINE_LINE_STYLE")});y.placeAt(E);var I=$(document.createElement("div")).appendTo(g);I.addClass(i.PROPERTYEDITOR_PREFIX+"view-item-row");var C;if(e.lineStyle===null){C=null}else{C={};C.type="shape";C.value=e.lineStyle?e.lineStyle:"1,0"}var T={icon:C};this._stylePicker=new o(I,T);this._stylePicker.addEventListener(s.PICKED_ITEM_CHANGED,this._lineStyleChangedHandler,this)}};l.prototype._initialProperties=function(){var e={lineFill:true,lineStyle:true,"plotArea.width":true};return this._queryProperties(e)};l.prototype._colorChangedHandler=function(e){var t=e.data.pickedItem;var i={lineFill:t};this._updateProperties(i)};l.prototype._thicknessChangedHandler=function(e){var t=parseFloat(e.data.value);this._updateProperty("plotArea.width",t)};l.prototype._lineStyleChangedHandler=function(e){var t=e.data.pickedItem;var i={lineStyle:t.value};this._updateProperties(i)};return l});e("sap/viz/controls/propertyeditor/sections/views/StackedColumnDataLabelView",["sap/viz/controls/common/utils/OOUtil","sap/viz/controls/propertyeditor/sections/PropertyViewBase","sap/viz/controls/propertyeditor/sections/helpers/DataLabelViewHelper"],function(e,t,i){var r=function(e,t,i){r.superclass.constructor.apply(this,arguments);this._helper=null;this._createChildren()};e.extend(r,t);r.prototype.destroy=function(){r.superclass.destroy.apply(this,arguments);if(this._helper){this._helper.destroy()}this._helper=null};r.prototype._createChildren=function(){this._helper=this._createHelper(i,{showDataLabel:true,showDataLabelImage:false})};return r});e("sap/viz/controls/propertyeditor/sections/VizPropertyZoneMap",["sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/sections/Section","sap/viz/controls/propertyeditor/sections/views/CategoryAxisTitleView","sap/viz/controls/propertyeditor/sections/views/ValueAxisTitleView","sap/viz/controls/propertyeditor/sections/views/CategoryAxisView","sap/viz/controls/propertyeditor/sections/views/ChartAreaView","sap/viz/controls/propertyeditor/sections/views/ChartTitleView","sap/viz/controls/propertyeditor/sections/views/PlotAreaView","sap/viz/controls/propertyeditor/sections/views/DonutPlotAreaView","sap/viz/controls/propertyeditor/sections/views/LegendView","sap/viz/controls/propertyeditor/sections/views/ValueAxisView","sap/viz/controls/propertyeditor/sections/views/ColumnDataLabelView","sap/viz/controls/propertyeditor/sections/views/ColumnDataPointView","sap/viz/controls/propertyeditor/sections/views/ColumnSeriesView","sap/viz/controls/propertyeditor/sections/views/DonutDataLabelView","sap/viz/controls/propertyeditor/sections/views/DonutDataPointView","sap/viz/controls/propertyeditor/sections/views/DonutChartAreaView","sap/viz/controls/propertyeditor/sections/views/LineDataPointView","sap/viz/controls/propertyeditor/sections/views/LineDataLabelView","sap/viz/controls/propertyeditor/sections/views/LineView","sap/viz/controls/propertyeditor/sections/views/StackedColumnDataLabelView"],function(e,t,i,r,n,s,o,a,l,c,p,h,d,u,_,v,f,m,g,E,y,I,C,T){var A={};var P="commonChartType";var R=null;var z=function(e,t,i){var r;r=R[e]=R[e]||{};r[t]=i};var O=function(e,t){if(R[e]&&R[e][t]){return R[e][t]}else if(e!==P){return O(P,t)}};A.mapSections=function(e,t){b();return O(e,t)||[]};A.getAvailableSections=function(e){b();if(R[e]){var t=[];for(var i in R[e]){t=t.concat(O(e,i))}t.sort(function(e,t){return e.groupIndex*10+e.itemIndex-(t.groupIndex*10+t.itemIndex)});return t}else if(e!==P){return A.getAvailableSections(P)}};A.queryPropertyZone=function(e,i){b();if(R[e]){for(var r in R[e]){var n=O(e,r);if($.inArray(i,n)!==-1){return new t(r)}}}return null};var b=function(){if(!R){R={};var A;A=P;z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),0,0)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),0,1)]);A=i.getInfoType(e.TYPE_COLUMN);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,v,r.get("PROPERTY_EDITOR_COLUMN_DATA_POINT"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,_,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.X_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,0)]);z(A,t.X_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,1)]);z(A,t.Y_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,2)]);z(A,t.Y_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_BAR);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,v,r.get("PROPERTY_EDITOR_BAR_DATA_POINT"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,_,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.Y_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,0)]);z(A,t.Y_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,1)]);z(A,t.X_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,2)]);z(A,t.X_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_LINE);z(A,t.DATA_POINT,[new n(n.LINE_DATA_POINT,y,r.get("PROPERTY_EDITOR_MARKER"),0,0)]);z(A,t.DATA_LABEL,[new n(n.LINE_DATA_LABEL,I,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.LINE,[new n(n.LINE,C,r.get("PROPERTY_EDITOR_LINE"),0,2)]);z(A,t.X_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,0)]);z(A,t.X_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,1)]);z(A,t.Y_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,2)]);z(A,t.Y_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_HORIZONTAL_LINE);z(A,t.DATA_POINT,[new n(n.LINE_DATA_POINT,y,r.get("PROPERTY_EDITOR_MARKER"),0,0)]);z(A,t.DATA_LABEL,[new n(n.LINE_DATA_LABEL,I,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.LINE,[new n(n.LINE,C,r.get("PROPERTY_EDITOR_LINE"),0,2)]);z(A,t.Y_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,0)]);z(A,t.Y_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,1)]);z(A,t.X_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,2)]);z(A,t.X_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_DONUT);z(A,t.DATA_POINT,[new n(n.DONUT_DATA_POINT,g,r.get("PROPERTY_EDITOR_DONUT_DATA_POINT"),0,0)]);z(A,t.DATA_LABEL,[new n(n.DONUT_DATA_LABEL,m,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,E,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.DONUT_PLOT_AREA,h,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_STACKED_COLUMN);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,f,r.get("PROPERTY_EDITOR_SERIES"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,T,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.X_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,0)]);z(A,t.X_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,1)]);z(A,t.Y_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,2)]);z(A,t.Y_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_STACKED_BAR);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,f,r.get("PROPERTY_EDITOR_SERIES"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,T,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.Y_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,0)]);z(A,t.Y_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,1)]);z(A,t.X_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,2)]);z(A,t.X_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_100_STACKED_COLUMN);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,f,r.get("PROPERTY_EDITOR_SERIES"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,T,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.X_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,0)]);z(A,t.X_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,1)]);z(A,t.Y_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,2)]);z(A,t.Y_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)]);A=i.getInfoType(e.TYPE_100_STACKED_BAR);z(A,t.DATA_POINT,[new n(n.COLUMN_DATA_POINT,f,r.get("PROPERTY_EDITOR_SERIES"),0,0)]);z(A,t.DATA_LABEL,[new n(n.COLUMN_DATA_LABEL,T,r.get("PROPERTY_EDITOR_DATA_LABEL"),0,1)]);z(A,t.Y_AXIS,[new n(n.CATEGORY_AXIS,a,r.get("PROPERTY_EDITOR_VERTICAL_AXIS"),1,0)]);z(A,t.Y_AXIS_TITLE,[new n(n.CATEGORY_AXIS_TITLE,s,r.get("PROPERTY_EDITOR_VERTICAL_AXIS_TITLE"),1,1)]);z(A,t.X_AXIS,[new n(n.VALUE_AXIS,u,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS"),1,2)]);z(A,t.X_AXIS_TITLE,[new n(n.VALUE_AXIS_TITLE,o,r.get("PROPERTY_EDITOR_HORIZONTAL_AXIS_TITLE"),1,3)]);z(A,t.CHART_AREA,[new n(n.CHART_AREA,l,r.get("PROPERTY_EDITOR_CHART_AREA"),2,0)]);z(A,t.CHART_TITLE,[new n(n.CHART_TITLE,c,r.get("PROPERTY_EDITOR_CHART_TITLE"),2,1)]);z(A,t.PLOT_AREA,[new n(n.PLOT_AREA,p,r.get("PROPERTY_EDITOR_PLOT_AREA"),2,2)]);z(A,t.LEGEND,[new n(n.LEGEND,d,r.get("PROPERTY_EDITOR_LEGEND"),2,3)])}};return A});e("sap/viz/controls/propertyeditor/InfoPropertyEditor",["sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/utils/ChartTypeUtil","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/property/VizPropertyZone","sap/viz/controls/propertyeditor/sections/VizPropertyZoneMap","sap/viz/controls/propertyeditor/sections/PropertyViewFactory","sap/viz/controls/propertyeditor/pickers/PickerEvent","sap/viz/controls/propertyeditor/pickers/SectionPicker"],function(e,t,i,r,n,s,o,a,l,c,p,h){var d=function(e,t){d.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyeditor.InfoPropertyEditor";sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_infopropertyeditor_control");this._title$=null;this._sectionPicker=null;this._viewsContainer$=null;this._views=[];this._createChildren();sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:create_infopropertyeditor_control")};i.extend(d,e);d.prototype.destroy=function(){d.superclass.destroy.apply(this,arguments);var e=this._vizProxy();e.removeEventListener("propertyZonesChanged",this._recreateViews,this);e.setPropertyZones([]);this._destroyViews()};d.prototype._onConnect=function(e,t){d.superclass._onConnect.apply(this,arguments);this._updateChildren();this._vizProxy().addEventListener("propertyZonesChanged",this._recreateViews,this)};d.prototype._onDisconnect=function(){d.superclass._onDisconnect.apply(this,arguments);this._vizProxy().removeEventListener("propertyZonesChanged",this._recreateViews,this)};d.prototype._createChildren=function(){var e;this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"main");if(this._uiConfig.enableTitle===true){this._title$=$(document.createElement("div"));this._title$.addClass(t.PROPERTYEDITOR_PREFIX+"title");this._title$.appendTo(this._dom$)}if(this._title$){e=$(document.createElement("div"));e.addClass(t.PROPERTYEDITOR_PREFIX+"title-splitter");e.appendTo(this._dom$)}e=$(document.createElement("div"));e.addClass(t.PROPERTYEDITOR_PREFIX+"section-selector-container");e.appendTo(this._dom$);e=$(document.createElement("div")).appendTo(e);this._sectionPicker=new h(e.get(0),null,{sections:[]});this._sectionPicker.addEventListener(p.PICKED_ITEM_CHANGED,this._sectionPickerChangedHandler,this);this._viewsContainer$=$(document.createElement("div"));this._viewsContainer$.addClass(t.PROPERTYEDITOR_PREFIX+"views-container");this._viewsContainer$.appendTo(this._dom$);this._updateChildren()};d.prototype._updateChildren=function(){sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_infopropertyeditor");var e=this._vizModel().type();if(!s.isInfoChart(e)){return}if(e){if(this._title$){var t=sap.viz.api.manifest.Viz.get(n.getVizType(e))[0].name;this._title$.text(r.substitute(o.get("PROPERTY_EDITOR_TITLE_PREFIX"),t))}this._sectionPicker.sections(l.getAvailableSections(e));this._recreateViews()}else{if(this._title$){this._title$.text(o.get("PROPERTY_EDITOR_TITLE_PLACE_HOLDER"))}this._sectionPicker.sections([]);this._destroyViews()}sap.viz.base.utils.log.Analyzer.pnrProfiling("VizControls:update_infopropertyeditor")};d.prototype._sectionPickerChangedHandler=function(e){var t=e.data.pickedItem;var i=l.queryPropertyZone(this._vizModel().type(),t);this._vizProxy().setPropertyZones([i]);this._recreateViews()};d.prototype._recreateViews=function(){this._destroyViews();this._createViews()};d.prototype._createViews=function(){this._views=[];var e=this._vizProxy().getPropertyZones();if(!e||e.length==0){e=[new a(a.CHART_AREA)];this._vizProxy().setPropertyZones(e)}var i={};e.forEach($.proxy(function(e,t,r){if(i[e.type()]){i[e.type()].push(e)}else{i[e.type()]=[e]}},this));for(var r in i){var n=l.mapSections(this._vizModel().type(),r);n.forEach($.proxy(function(e){this._sectionPicker.pickedItem(e);var n=$(document.createElement("div")).appendTo(this._viewsContainer$);n.addClass(t.PROPERTYEDITOR_PREFIX+"view");var s=c.produce(e,n.get(0),this._uiConfig,this._vizProxy(),i[r]);this._views.push(s)},this))}};d.prototype._destroyViews=function(){if(this._views){this._views.forEach(function(e){e.destroy()})}this._views=null;this._viewsContainer$.empty()};return d});e("sap/viz/controls/propertyeditor/PropertyEditor",["sap/viz/controls/common/VizControlBase","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/propertyeditor/PropertyEditorConfig","sap/viz/controls/propertyeditor/VizPropertyEditor","sap/viz/controls/propertyeditor/InfoPropertyEditor","sap/viz/controls/propertyeditor/events/PropertyEditorEvent","sap/viz/controls/propertyeditor/pickers/ColorPicker"],function(e,t,i,r,n,s,o,a,l,c){var p=function(e,t){p.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.propertyeditor.PropertyEditor";this._uiConfig=t?t:s.instance();try{jQuery.sap.require("sap.ui.commons.Button");jQuery.sap.require("sap.ui.commons.Slider");jQuery.sap.require("sap.ui.commons.ColorPicker");jQuery.sap.require("sap.ui.commons.ToggleButton");jQuery.sap.require("sap.ui.commons.Label");jQuery.sap.require("sap.ui.commons.DropdownBox");jQuery.sap.require("sap.ui.commons.TextField");jQuery.sap.require("sap.ui.commons.CheckBox");jQuery.sap.require("sap.ui.commons.RadioButton");jQuery.sap.require("sap.ui.commons.TriStateCheckBox");jQuery.sap.require("sap.ui.commons.ComboBox")}catch(e){throw r.substitute(n.get("VIZ_COMMON_DEPENDENCY_ERROR"),"sap.ui.commons","PropertyEditor")}this._createChildren();this._recentColors=[];this._colorPickerClass=c;this._colorPickerClass._recentColors=this._recentColors;this._colorPickerClass._eventDispatch.addEventListener(l.RECENTCOLORS_CHANGED,function(e){this._onRecentColorsChange(e)}.bind(this))};i.extend(p,e);p.prototype.update=function(){this._updateChildren()};p.prototype.recentColors=function(e){if(arguments.length>0&&!!e){if(this._colorPickerClass){this._colorPickerClass._recentColors=e}this._recentColors=e;return this}else{return this._recentColors}};p.prototype._onConnect=function(e,t){p.superclass._onConnect.apply(this,arguments);this._updateChildren()};p.prototype._onDisconnect=function(){p.superclass._onDisconnect.apply(this,arguments);if(this._editorInstance){this._editorInstance.disconnect()}};p.prototype._onAfterDisconnect=function(){this._vizModel().type(null);this._updateChildren()};p.prototype._onVizModelChanged=function(e){if(e.data.vizTypeChanged){this._updateChildren()}};p.prototype._createChildren=function(){this._dom$.addClass(t.PROPERTYEDITOR_PREFIX+"main");this._editorInstance=null;this._updateChildren()};p.prototype._onRecentColorsChange=function(e){this._dispatchEvent(e);this._recentColors=e.data};p.prototype._updateChildren=function(){if(this._editorInstance){this._editorInstance.disconnect();this._editorInstance.destroy()}this._dom$.empty();var e=this._vizModel().type();if(!e){return}if(e.indexOf("info/")==0){this._editorInstance=new a(this._dom$,this._uiConfig)}else if(e.indexOf("viz/")==0){this._editorInstance=new o(this._dom$,this._uiConfig)}else{this._editorInstance=new o(this._dom$,this._uiConfig)}if(this._editorInstance){this._editorInstance.connect(this._vizUid)}};p.prototype.destroy=function(){if(this._editorInstance){this._editorInstance.destroy()}p.superclass.destroy.apply(this,arguments)};return p});e("sap/viz/controls/popover/chartpopover/ShapeMarker",[],function(){var e=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare("sap.viz.chartpopover.ShapeMarker");sap.ui.core.Control.extend("sap.viz.chartpopover.ShapeMarker",{metadata:{properties:{type:"string",color:"string",markerSize:"int"}},renderer:{render:function(e,t){var i=t.getMarkerSize()?t.getMarkerSize():10;var r={rx:i/2,ry:i/2,type:t.getType(),borderWidth:0};e.write("<div");e.writeClasses();e.write(">");e.write("<svg width="+i+"px height="+i+"px ");e.write(">");e.write("<path d = '"+t._generateShapePath(r)+"'");e.write(" fill = '"+t.getColor()+"'");e.write(" transform = 'translate("+i/2+","+i/2+")'");e.write("</path>");e.write("</svg>");e.write("</div>");e.writeStyles()}}});sap.viz.chartpopover.ShapeMarker.prototype._generateShapePath=function(e){var t;var i=e.borderWidth/2;switch(e.type){case"circle":t="M"+(-e.rx-i)+",0 A"+(e.rx+i)+","+(e.ry+i)+" 0 1,0 "+(e.rx+i)+",0 A";t+=e.rx+i+","+(e.ry+i)+" 0 1,0 "+(-e.rx-i)+",0z";break;case"cross":t="M"+(-e.rx-i)+","+(-e.ry/3-i)+"H"+(-e.rx/3-i)+"V"+(-e.ry-i)+"H"+(e.rx/3+i);t+="V"+(-e.ry/3-i)+"H"+(e.rx+i)+"V"+(e.ry/3+i)+"H"+(e.rx/3+i);t+="V"+(e.ry+i)+"H"+(-e.rx/3-i)+"V"+(e.ry/3+i)+"H"+(-e.rx-i)+"Z";break;case"diamond":t="M0,"+(-e.ry-i)+"L"+(e.rx+i)+",0"+" 0,"+(e.ry+i)+" "+(-e.rx-i)+",0"+"Z";break;case"square":t="M"+(-e.rx-i)+","+(-e.ry-i)+"L"+(e.rx+i)+",";t+=-e.ry-i+"L"+(e.rx+i)+","+(e.ry+i)+"L"+(-e.rx-i)+","+(e.ry+i)+"Z";break;case"triangle-down":case"triangleDown":t="M0,"+(e.ry+i)+"L"+(e.rx+i)+","+-(e.ry+i)+" "+-(e.rx+i)+","+-(e.ry+i)+"Z";break;case"triangle-up":case"triangleUp":t="M0,"+-(e.ry+i)+"L"+(e.rx+i)+","+(e.ry+i)+" "+-(e.rx+i)+","+(e.ry+i)+"Z";break;case"triangle-left":case"triangleLeft":t="M"+-(e.rx+i)+",0L"+(e.rx+i)+","+(e.ry+i)+" "+(e.rx+i)+","+-(e.ry+i)+"Z";break;case"triangle-right":case"triangleRight":t="M"+(e.rx+i)+",0L"+-(e.rx+i)+","+(e.ry+i)+" "+-(e.rx+i)+","+-(e.ry+i)+"Z";break;case"intersection":t="M"+(e.rx+i)+","+(e.ry+i)+"L"+(e.rx/3+i)+",0L"+(e.rx+i)+","+-(e.ry+i)+"L";t+=e.rx/2-i+","+-(e.ry+i)+"L0,"+(-e.ry/3-i)+"L"+(-e.rx/2+i)+","+-(e.ry+i)+"L";t+=-(e.rx+i)+","+-(e.ry+i)+"L"+-(e.rx/3+i)+",0L"+-(e.rx+i)+","+(e.ry+i)+"L";t+=-e.rx/2+i+","+(e.ry+i)+"L0,"+(e.ry/3+i)+"L"+(e.rx/2-i)+","+(e.ry+i)+"Z";break;case"squareWithRadius":var r=e.rx;var n=r-3;t="M0,"+-r+"L"+-n+","+-r+"Q"+-r+","+-r+" "+-r+","+-n+"L"+-r+","+n+"Q"+-r+","+r+" "+-n+","+r;t+="L"+n+","+r+"Q"+r+","+r+" "+r+","+n+"L"+r+","+-n+"Q"+r+","+-r+" "+n+","+-r+"Z";break}return t}};return{create:function(t,i){try{return new sap.viz.chartpopover.ShapeMarker(t,i)}catch(t){e();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/popover/chartpopover/ContentPanel",["sap/viz/controls/popover/chartpopover/ShapeMarker"],function(e){var t=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare("sap.viz.chartpopover.ContentPanel");sap.ui.core.Control.extend("sap.viz.chartpopover.ContentPanel",{metadata:{publicMethods:["setContentData"]},renderer:{render:function(e,t){e.renderControl(t._oPanel)}}});sap.viz.chartpopover.ContentPanel.prototype.init=function(){this._measureItemsLen=0;this._defaultItemsLineHeight=1.4375;this._spacing=.4375*2;var t=new sap.ui.model.json.JSONModel;this._sModelName="sapvizModel";var i=new sap.m.DisplayListItem({label:"{measureName}",value:"{measureValue}"}).addStyleClass("viz-controls-chartPopover-measures-item");this._oList=new sap.m.List({}).addStyleClass("viz-controls-chartPopover-measures-list");this._oList.setModel(t);this._oList.bindAggregation("items","/items",i);this._oShapeLabel=e.create(this._createId("vizShapeMarker"),{}).addStyleClass("viz-controls-chartPopover-dimension-marker");this._oDimLabel=new sap.m.Label(this._createId("vizDimensionLabel"),{}).addStyleClass("viz-controls-chartPopover-dimension-label");this._oPanel=new sap.m.Panel(this._createId("vizPanel"),{content:[this._oShapeLabel,this._oDimLabel,this._oList]})};sap.viz.chartpopover.ContentPanel.prototype.setContentData=function(e){var t=e.val,i="",r=[];this._measureItemsLen=0;if(t){for(var n=0;n<t.length;n++){if(t[n].type==="dimension"){if(i.length>0){i=i+" - "+t[n].value}else{i=t[n].value}}else if(t[n].type=="measure"){r.push({measureName:t[n].name,measureValue:t[n].value})}}var s=this._oDimLabel.$().css("margin-left");if(s){s=parseInt(s.substr(0,s.length-2));this._oShapeLabel.setMarkerSize(s)}this._oShapeLabel.setColor(e.color).setType(e.shape?e.shape:"square");this._oDimLabel.setText(i);this._oList.getModel().setData({items:r});this._measureItemsLen=r.length}};sap.viz.chartpopover.ContentPanel.prototype.getContentHeight=function(){return this._measureItemsLen>0?(this._measureItemsLen+1)*this._defaultItemsLineHeight+this._spacing:0};sap.viz.chartpopover.ContentPanel.prototype._createId=function(e){return this.getId()+"-"+e};sap.viz.chartpopover.ContentPanel.prototype.exit=function(e){if(this._oList){this._oList.destroy();this._oList=null}if(this._oShapeLabel){this._oShapeLabel.destroy();this._oShapeLabel=null}if(this._oDimLabel){this._oDimLabel.destroy();this._oDimLabel=null}}};return{create:function(e,i){try{return new sap.viz.chartpopover.ContentPanel(e,i)}catch(e){t();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/popover/chartpopover/HeaderBar",[],function(){var e=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare("sap.viz.chartpopover.HeaderBar");sap.m.Bar.extend("sap.viz.chartpopover.HeaderBar",{metadata:{properties:{showNavButton:"boolean",title:"string"},publicMethods:[],events:{navButtonPress:{},closeButtonPress:{}}},renderer:{}});sap.viz.chartpopover.HeaderBar.prototype.getContentLeft=function(){if(!this._oNavButton){this._oNavButton=new sap.m.Button(this._createId("popoverNavButton"),{type:sap.m.ButtonType.Back,press:jQuery.proxy(function(){this.fireNavButtonPress()},this)}).addStyleClass("sapUiIcon")}this._oNavButton.setVisible(this.getShowNavButton());return[this._oNavButton]};sap.viz.chartpopover.HeaderBar.prototype.getContentMiddle=function(){if(!this._oTitleLabel){this._oTitleLabel=new sap.m.Label(this._createId("popoverHeaderTitle"))}this._oTitleLabel.setText(this.getTitle());return[this._oTitleLabel]};sap.viz.chartpopover.HeaderBar.prototype.getContentRight=function(){if(!this._oCloseButton){this._oCloseButton=new sap.m.Button(this._createId("popoverCloseButton"),{icon:sap.ui.core.IconPool.getIconURI("decline"),press:jQuery.proxy(function(){this.fireCloseButtonPress()},this)}).addStyleClass("sapUiIcon")}return[this._oCloseButton]};sap.viz.chartpopover.HeaderBar.prototype.exit=function(){if(this._oCloseButton){this._oCloseButton.destroy();this._oCloseButton=null}if(this._oTitleLabel){this._oTitleLabel.destroy();this._oTitleLabel=null}if(this._oNavButton){this._oNavButton.destroy();this._oNavButton=null}};sap.viz.chartpopover.HeaderBar.prototype._createId=function(e){return this.getId()+"-"+e}};return{create:function(t,i){try{return new sap.viz.chartpopover.HeaderBar(t,i)}catch(t){e();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/popover/chartpopover/SubActionItemsPage",[],function(){var e=function(){
/*
         * Copyright (C) 2009-2013 SAP BOBJ or an SAP affiliate company. All rights reserved
         */
jQuery.sap.declare("sap.viz.chartpopover.SubActionItemsPage");sap.ui.core.Element.extend("sap.viz.chartpopover.SubActionItemsPage",{metadata:{properties:{items:{type:"sap.m.ListBase[]"}}}});sap.viz.chartpopover.SubActionItemsPage.prototype.init=function(){this._oList=new sap.m.List({});this._oPage=new sap.m.Page(this._createId("listPage"),{showNavButton:false,showHeader:false,content:[this._oList]})};sap.viz.chartpopover.SubActionItemsPage.prototype.exit=function(){if(this._oList){this._oList.destroy();this._oList=null}if(this._oPage){this._oPage.destroy();this._oPage=null}};sap.viz.chartpopover.SubActionItemsPage.prototype.getControl=function(){return this._oPage};sap.viz.chartpopover.SubActionItemsPage.prototype.getPageId=function(){return this._oPage.getId()};sap.viz.chartpopover.SubActionItemsPage.prototype.setItems=function(e){this._oList.removeAllItems();var t;for(var i=0;i<e.length;i++){t=new sap.m.ActionListItem({text:e[i].text,press:e[i].press?e[i].press:function(){}});this._oList.addItem(t)}};sap.viz.chartpopover.SubActionItemsPage.prototype._createId=function(e){return this.getId()+"-"+e}};return{create:function(t,i){try{return new sap.viz.chartpopover.SubActionItemsPage(t,i)}catch(t){e();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/popover/chartpopover/ChartPopover",["sap/viz/controls/popover/chartpopover/ContentPanel","sap/viz/controls/popover/chartpopover/HeaderBar","sap/viz/controls/popover/chartpopover/SubActionItemsPage"],function(e,t,i){var r=function(){jQuery.sap.declare("sap.viz.chartpopover.ChartPopover");sap.ui.core.Control.extend("sap.viz.chartpopover.ChartPopover",{metadata:{properties:{customDataControl:{type:"any"},actionItems:{type:"object[]"}}}});sap.viz.chartpopover.ChartPopover.prototype.init=function(){this._listItemHeight=3;this._options=null;this._oContentPanel=e.create(this._createId("vizContentPanel"),{});this._oSelectedLabel=new sap.m.Label(this._createId("vizSelectedLabel"),{});this._oSelectedBar=new sap.m.Bar(this._createId("vizSelectedBar"),{contentMiddle:[this._oSelectedLabel]}).addStyleClass("viz-controls-chartPopover-vizSelectedBar").addStyleClass("viz-controls-chartPopover-vizSelectedBarBorder");this._oHomePage=new sap.m.Page(this._createId("vizHomePage"),{showNavButton:false,showHeader:false,content:[this._oContentPanel]});this._oNavContainer=new sap.m.NavContainer(this._createId("vizNavContainer"),{afterNavigate:jQuery.proxy(function(e){var t=e.getParameter("to").getId();if(t.search("HomePage")!==-1){this._oCustomHeader.setShowNavButton(false).setTitle("Current Selection")}else{this._oCustomHeader.setShowNavButton(true)}},this)});this._oNavContainer.addPage(this._oHomePage);this._oCustomHeader=t.create(this._createId("vizHeaderBar"),{title:"Current Selection",showNavButton:false,closeButtonPress:jQuery.proxy(this.close,this),navButtonPress:jQuery.proxy(this._navigateBack,this)});this._oPopover=new sap.m.ResponsivePopover(this._createId("vizChartPopover"),{modal:false,bounce:true,horizontalScrolling:false,contentWidth:"18rem",contentHeight:"100%",customHeader:this._oCustomHeader,content:[this._oNavContainer]});this._oPopover.addStyleClass("viz-controls-chartPopover");this._oPopover.attachBeforeOpen(jQuery.proxy(this._beforeOpen,this));this._oPopover.attachAfterClose(jQuery.proxy(this._afterClose,this))};sap.viz.chartpopover.ChartPopover.prototype._beforeOpen=function(){var e=0;if(!this._options.data.val||this._options.selectedValues>1){e=this._listItemHeight+.1}var t=this._oContentPanel.getContentHeight()+e;if(this._oContentPanel.getContentHeight()===0){if(!this._oCustomPanel){this._oHomePage.removeContent(this._oContentPanel);this._oSelectedBar.removeStyleClass("viz-controls-chartPopover-vizSelectedBarBorder")}}if(this.getActionItems()){t+=this.getActionItems().length*this._listItemHeight}this._oPopover.setContentHeight(t+"rem")};sap.viz.chartpopover.ChartPopover.prototype._afterClose=function(){if(this._options&&this._options.selectedValues<1){this._oHomePage.removeContent(this._oSelectedBar)}};sap.viz.chartpopover.ChartPopover.prototype.isOpen=function(){return this._oPopover.isOpen()};sap.viz.chartpopover.ChartPopover.prototype.openBy=function(e,t){if(e){this._updateContent();this._updateActionItems();var i=e.getBoundingClientRect();this._oPopover.setOffsetX(parseInt(i.width)).setOffsetY(parseInt(i.height/2));this._navigateBack();this._oPopover.openBy(e,t)}return this};sap.viz.chartpopover.ChartPopover.prototype.close=function(){this._oPopover.close();return this};sap.viz.chartpopover.ChartPopover.prototype.exit=function(){if(this._oNavContainer){this._oNavContainer.destroy();this._oNavContainer=null}if(this._oContentPanel){this._oContentPanel.destroy();this._oContentPanel=null}if(this._oSelectedLabel){this._oSelectedLabel.destroy();this._oSelectedLabel=null}if(this._oHomePage){this._oHomePage.destroy();this._oHomePage=null}if(this._oCustomHeader){this._oCustomHeader.destroy();this._oCustomHeader=null}if(this._oCustomPanel){this._oCustomPanel.destroy();this._oCustomPanel=null}if(this._oPopover){this._oPopover.destroy();this._oPopover=null}this._options=null};sap.viz.chartpopover.ChartPopover.prototype.setOptions=function(e){var t=e.data;this._options=e;this._oContentPanel.setContentData(t);if(!t.val||e.selectedValues>1){this._oSelectedLabel.setText(e.selectedValues+" values selected");this._oHomePage.insertContent(this._oSelectedBar,1)}else{this._oHomePage.removeContent(this._oSelectedBar)}return this};sap.viz.chartpopover.ChartPopover.prototype._updateContent=function(){var e=this.getCustomDataControl();if(e){if(this._oCustomPanel){this._oHomePage.removeContent(this._oCustomPanel)}this._oCustomPanel=e(this._options);this._oHomePage.removeContent(this._oContentPanel);this._oHomePage.insertContent(this._oCustomPanel,0);this._oSelectedBar.addStyleClass("viz-controls-chartPopover-vizSelectedBarBorder")}else{this._oCustomPanel=null;if(this._oHomePage.indexOfContent(this._oContentPanel)===-1){this._oHomePage.insertContent(this._oContentPanel,0);this._oSelectedBar.addStyleClass("viz-controls-chartPopover-vizSelectedBarBorder")}}return this};sap.viz.chartpopover.ChartPopover.prototype._updateActionItems=function(){if(!this._oActionList){var e=this.getActionItems();if(e&&e.length>0){this._actionItems=jQuery.extend(true,this._actionItems,e);var t,r=[];for(var n=0,s=e.length;n<s;n++){t=e[n];if(t.type==="action"){r.push(new sap.m.ActionListItem(this._createId("actionItems-"+n),{text:t.text,press:t.press?t.press:function(){}}))}else if(t.type==="navigation"){r.push(new sap.m.StandardListItem(this._createId("actionItems-"+n),{title:t.text,type:"Navigation",press:jQuery.proxy(function(e){var t=e.getParameter("id");var r=parseInt(t.substring(t.lastIndexOf("-")+1));var n=this._actionItems[r].children;if(n&&n.length>0){if(!this._oSubActionItemsPage){this._oSubActionItemsPage=i.create();this._oNavContainer.addPage(this._oSubActionItemsPage.getControl())}this._oSubActionItemsPage.setItems(n);this._oCustomHeader.setTitle(this._actionItems[r].text);this._navigateTo(this._oSubActionItemsPage.getPageId())}},this)}))}}this._oActionList=new sap.m.List({items:r}).addStyleClass("viz-controls-chartPopover-actionList");this._oHomePage.addContent(this._oActionList)}}};sap.viz.chartpopover.ChartPopover.prototype._navigateBack=function(){this._oNavContainer.back()};sap.viz.chartpopover.ChartPopover.prototype._navigateTo=function(e){this._oNavContainer.to(e)};sap.viz.chartpopover.ChartPopover.prototype._createId=function(e){return this.getId()+"-"+e}};return{create:function(e,t){try{return new sap.viz.chartpopover.ChartPopover(e,t)}catch(e){r();return arguments.callee.apply(this,arguments)}}}});e("sap/viz/controls/popover/PopOver",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/managers/LangManager","sap/viz/controls/popover/chartpopover/ChartPopover"],function(e,t,i,r,n,s){var o=function(e){o.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.popover.PopOver";try{jQuery.sap.require("sap.m.Label");jQuery.sap.require("sap.m.List");jQuery.sap.require("sap.m.Bar");jQuery.sap.require("sap.m.Page");jQuery.sap.require("sap.m.ActionListItem");jQuery.sap.require("sap.m.ResponsivePopover");jQuery.sap.require("sap.m.StandardListItem");jQuery.sap.require("sap.m.DisplayListItem");jQuery.sap.require("sap.m.Panel");jQuery.sap.require("sap.m.Button")}catch(e){throw r.substitute(n.get("VIZ_COMMON_DEPENDENCY_ERROR"),"sap.m","PopOver")}this._chartPopover=s.create(e)};i.extend(o,t);o.prototype._onConnect=function(e,t){o.superclass._onConnect.apply(this,arguments);this._vizProxy().on("showTooltip.PopOver",jQuery.proxy(function(e){this._chartPopover.setOptions(e.data).openBy(e.data.target)},this));this._vizProxy().on("hideTooltip.PopOver",jQuery.proxy(function(){this._chartPopover.close()},this))};o.prototype._onDisconnect=function(){o.superclass._onDisconnect.apply(this,arguments);this._vizProxy().off("showTootip.PopOver");this._vizProxy().off("hideTooltip.PopOver")};o.prototype.destroy=function(){o.superclass.destroy.apply(this,arguments);this._vizProxy().off("showTooltip.PopOver");this._vizProxy().off("hideTooltip.PopOver")};o.prototype.setContents=function(e){for(var t=0;t<e.length;t++){this._chartPopover.addContent(e[t])}};o.prototype.setActionItems=function(e){for(var t=0;t<e.length;t++){this._chartPopover.addActionItem(e[t])}};o.prototype.setSubActionItems=function(e){for(var t=0;t<e.length;t++){this._chartPopover.addSubActionItem(e[t])}};return o});e("sap/viz/controls/dedicatedlegend/DedicatedLegend",["jquery","sap/viz/controls/common/VizControlBase","sap/viz/controls/common/utils/OOUtil","sap/viz/controls/common/utils/Utils","sap/viz/controls/common/managers/LangManager"],function(e,t,i,r,n){var s=function(e){s.superclass.constructor.apply(this,arguments);this.__className="sap.viz.controls.DedicatedLegend.DedicatedLegend";this._defaultChartOption={};try{jQuery.sap.require("sap.m.ResponsivePopover")}catch(e){throw r.substitute(n.get("VIZ_COMMON_DEPENDENCY_ERROR"),"sap.m","DedicatedLegend")}this._options=e};i.extend(s,t);s.prototype._onConnect=function(e,t){s.superclass._onConnect.apply(this,arguments);this._olegendDOMID=this._createId("legends");this._oLegendDOM=new sap.ui.core.HTML;this._oPopover=new sap.m.ResponsivePopover(this._createId("legendPopover"),{dal:false,verticalScrolling:true,horizontalScrolling:false,placement:sap.m.PlacementType.Auto,contentWidth:"18rem",title:"Legends",content:[this._oLegendDOM]});this._oPopover.addStyleClass("viz-controls-dedicatedLegend");this._oPopover.attachBeforeClose(function(){console.log("close")},this);this._maxHeight=this._vizProxy().getSize().height*.8-48-6};s.prototype._open=function(t){this._oPopover.attachBeforeOpen(jQuery.proxy(function(){var t=document.createElementNS("http://www.w3.org/2000/svg","svg");this._vizProxy().setProperties({legendGroup:{renderTo:function(){return t}}});var i=parseInt(e(t).attr("height"))+4;this._oLegendDOM.setContent(e(t).outerHTML());this._oPopover.setContentHeight(Math.min(i,this._maxHeight)+"px")},this));this._oPopover.openBy(t)};s.prototype._onDisconnect=function(){s.superclass._onDisconnect.apply(this,arguments)};s.prototype.destroy=function(){s.superclass.destroy.apply(this,arguments)};s.prototype._createId=function(e){return this._uid+"-"+e};s.prototype.updateLegendVisibility=function(){var e=this._vizProxy().getProperties();if(this._isDefaultLegend(e.legendGroup.layout.position)){if(e.legend&&e.legend.visible||e.sizeLegend&&e.sizeLegend.visible){this._hideLegend(e);this._vizProxy().setProperties(e)}else{this._vizProxy().setProperties(this._defaultChartOption)}}else{if(this._oPopover.isOpen()){this._oPopover.close()}else{this._vizProxy().setProperties(this._defaultChartOption);this._open(this._options.openBy)}}};s.prototype.parseDefaultLegendProperties=function(t){e.extend(true,this._defaultChartOption,t);if(this._defaultChartOption.legend&&this._defaultChartOption.legend.visible===false){if(this._defaultChartOption.sizeLegend){if(this._defaultChartOption.sizeLegend.visible===false){this._defaultChartOption.legend.visible=true;this._defaultChartOption.sizeLegend.visible=true}}else{this._defaultChartOption.legend.visible=true}}if(!this._isDefaultLegend(t.legendGroup.layout.position)){this._hideLegend(t)}return t};s.prototype._isDefaultLegend=function(e){return e==="top"||e==="bottom"?this._vizProxy().getSize().height>=480:this._vizProxy().getSize().width>=600};s.prototype._hideLegend=function(e){if(e.legend){e.legend.visible=false}if(e.sizeLegend){e.sizeLegend.visible=false}};s.prototype._showLegend=function(e){if(e.legend){e.legend.visible=true}if(e.sizeLegend){e.sizeLegend.visible=true}};return s});(function(e){var i="sap/viz/controls/Version,sap/viz/controls/common/config/GlobalConfig,sap/viz/controls/common/constants/ChartConst,sap/viz/controls/common/constants/CSSConst,sap/viz/controls/common/feeds/AnalysisObject,sap/viz/controls/common/feeds/AnalyticalType,sap/viz/controls/common/feeds/AutoFeedingUtils,sap/viz/controls/common/feeds/FeedItem,sap/viz/controls/common/feeds/HierarchyLevelObject,sap/viz/controls/common/filter/AbstractFilter,sap/viz/controls/common/filter/DateRangeFilter,sap/viz/controls/common/filter/NumericRangeFilter,sap/viz/controls/common/filter/ValueFilter,sap/viz/controls/common/managers/DragManager,sap/viz/controls/common/managers/LangManager,sap/viz/controls/common/utils/InfoChartUtil,sap/viz/controls/common/utils/Serialization,sap/viz/controls/common/views/menu/MenuGroup,sap/viz/controls/common/views/menu/MenuItem,sap/viz/controls/services/FakeDataService,sap/viz/controls/builder/VizBuilder,sap/viz/controls/annotation/Annotation,sap/viz/controls/annotationcontrol/AnnotationControl,sap/viz/controls/chart/Chart,sap/viz/controls/plugins/infochart/setup,sap/viz/controls/contextmenu/ContextMenu,sap/viz/controls/custombutton/CustomButton,sap/viz/controls/feeding/FeedingPanel,sap/viz/controls/frame/VizFrame,sap/viz/controls/mapbuilder/MapBuilder,sap/viz/controls/filterbar/FilterBar,sap/viz/controls/filterbar/FilterItem,sap/viz/controls/filterbar0/FilterBar,sap/viz/controls/playcontrol/PlayControl,sap/viz/controls/propertyeditor/PropertyEditor,sap/viz/controls/switchbar/SwitchBar,sap/viz/controls/popover/PopOver,sap/viz/controls/dedicatedlegend/DedicatedLegend".split(/,\s*/);if(i[0]==="// REPLACE_"+"EXPORT_LIST_HERE")i=["sap/viz/controls/annotationcontrol/AnnotationItem","sap/viz/controls/builder/VizBuilder","sap/viz/controls/chart/Chart","sap/viz/controls/common/config/GlobalConfig","sap/viz/controls/common/constants/ChartConst","sap/viz/controls/common/constants/CSSConst","sap/viz/controls/common/feeds/AnalysisObject","sap/viz/controls/common/feeds/AnalyticalType","sap/viz/controls/common/feeds/AutoFeedingUtils","sap/viz/controls/common/feeds/FeedItem","sap/viz/controls/common/feeds/HierarchyLevelObject","sap/viz/controls/common/filter/AbstractFilter","sap/viz/controls/common/filter/DateRangeFilter","sap/viz/controls/common/filter/NumericRangeFilter","sap/viz/controls/common/filter/ValueFilter","sap/viz/controls/common/managers/DragManager","sap/viz/controls/common/managers/LangManager","sap/viz/controls/common/utils/InfoChartUtil","sap/viz/controls/common/utils/Serialization","sap/viz/controls/common/views/menu/MenuGroup","sap/viz/controls/common/views/menu/MenuItem","sap/viz/controls/feeding/FeedingPanel","sap/viz/controls/filterbar/FilterBar","sap/viz/controls/filterbar/FilterItem","sap/viz/controls/frame/VizFrame","sap/viz/controls/mapbuilder/MapBuilder","sap/viz/controls/playcontrol/PlayControl","sap/viz/controls/plugins/infochart/setup","sap/viz/controls/propertyeditor/PropertyEditor","sap/viz/controls/services/FakeDataService","sap/viz/controls/switchbar/SwitchBar","sap/viz/controls/popover/PopOver","sap/viz/controls/dedicatedlegend/DedicatedLegend","sap/viz/controls/Version"];var r=e.jQuery;if(r){if(jQuery.holdReady){jQuery.holdReady(true)}else{jQuery.readyWait+=1}}t(i,function(){var t=arguments;i.forEach(function(i,r){var n=i.split("/");n.reduce(function(e,i,s){if(!e[i]){if(s<n.length-1){e[i]={}}else{e[i]=t[r]}}return e[i]},e)});if(r){if(jQuery.holdReady){jQuery.holdReady(false)}else{jQuery.ready(true)}}})})(this)})();